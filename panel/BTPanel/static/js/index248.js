import{_ as a}from"./index90.js?v=1734676359";import{u as e,G as l,o as s,k as t,j as r,O as o,h as i}from"./utils-lib.js?v=1734676359";import{c as n,r as d,h as m,e as u,o as c,B as p,k as f,l as h,x as g,y as _,C as b,p as w,M as j,A as x,a7 as y,a4 as v}from"./base-lib.js?v=1734676359";import{av as V,aw as k,ax as q}from"./firewall.js?v=1734676359";import{u as C}from"./column.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";const A=n({__name:"index",setup(n){const{mainHeight:A}=e(),H=d(!1),U=d([]),B=d(!1),F=m({cmd:""}),G=d(),M={cmd:[{trigger:["blur","change"],required:!0,message:"请输入进程名称"}]},O=async()=>{await l({loading:H,request:V(),data:[Array,U]})},P=async()=>{await G.value.validate(),await l({loading:"正在添加进程白名单，请稍后...",request:q(F),message:!0}),O(),B.value=!1,F.cmd=""},R=[{label:"进程名",render:a=>u("span",null,[a])},C([{onClick:async a=>{await s({icon:"warning-filled",title:"删除进程白名单【"+a+"】",width:"34rem",content:"删除选中的进程后，该进程将不再进行收到保护，是否继续操作？"}),await l({loading:"正在删除进程白名单，请稍后...",request:k({cmd:a}),message:!0}),O()},title:"删除"}])];return c((()=>{O()})),(e,l)=>{const s=x,n=t,d=r,m=y,c=o,V=v,k=i,q=a,C=p("bt-loading");return f(),h("div",null,[u(q,null,{"header-left":g((()=>[u(s,{type:"primary",onClick:l[0]||(l[0]=a=>B.value=!0)},{default:g((()=>l[3]||(l[3]=[_(" 添加进程白名单 ")]))),_:1})])),content:g((()=>[b(u(n,{column:R,data:w(U),"max-height":w(A)-340,description:"进程白名单列表为空"},null,8,["data","max-height"]),[[C,w(H)],[C,"正在加载进程白名单列表，请稍后...","title"]])])),popup:g((()=>[u(k,{title:"添加进程",modelValue:w(B),"onUpdate:modelValue":l[2]||(l[2]=a=>j(B)?B.value=a:null),area:42,onConfirm:P,showFooter:""},{default:g((()=>[u(V,{ref_key:"addProcessWhiteRef",ref:G,rules:M,model:w(F),class:"p-[2rem]","label-width":"5rem"},{default:g((()=>[u(m,{label:"进程名称",prop:"cmd"},{default:g((()=>[u(d,{modelValue:w(F).cmd,"onUpdate:modelValue":l[1]||(l[1]=a=>w(F).cmd=a),width:"20rem",placeholder:"例:/bin/bash",clearable:""},null,8,["modelValue"])])),_:1}),u(c,{options:[{class:"text-danger",content:"命令需要填写全路径例如：/usr/bin/curl"}],class:"pl-[3.6rem] pt-[.4rem]"})])),_:1},8,["model"])])),_:1},8,["modelValue"])])),_:1})])}}});export{A as default};
