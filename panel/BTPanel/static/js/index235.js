import{u as e,G as a,R as s,H as t,l,_ as c,c as r,d as n,b as i,e as m}from"./utils-lib.js?v=1734676359";import{c as o,t as d,r as u,R as p,k as b,l as f,q as v,p as h,z as x,e as y,J as g,v as _,x as w,y as S,G as k,F as M,bH as C,I as j,aX as T,M as D,A as z,aY as H,bu as P,N as B,b5 as E,bt as O}from"./base-lib.js?v=1734676359";import{$ as I}from"./firewall.js?v=1734676359";import{o as L}from"./validator.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";import"./column.js?v=1734676359";const V={class:"p-[2rem]"},A={class:"head mb-[4rem]"},R={class:"scan-header flex flex-row flex-wrap items-center justify-between"},Z={class:"flex flex-row flex-wrap justify-center items-center"},q={key:0,class:"relative scan-header-cont"},F={key:0,class:"animate-spin absolute top-0 border-primary border-b-2 rounded-full h-full w-full bg-#cccccc00"},N={class:"scan-header-cont flex justify-between flex-col px-[2rem]"},G=["innerHTML"],W={class:"scan-subtitle text-[1.6rem] mt-[1.2rem]"},X={class:"scan-header-cont justify-end relative"},Y={class:"text-[1.5rem]"},J={class:"content"},K={key:0,class:"info"},U={class:"webedit-con flex items-center justify-center"},$={class:"thumbnail-introduce mt-[0rem]"},Q={key:1,class:"scan"},ee={key:0,class:"scan-success border-[0.1rem] p-[2rem] h-[49rem] border-[#e8e8e8] flex items-center justify-center"},ae={class:"flex flex-column items-center"},se={key:1,class:"scan-dangerous"},te={class:"flex items-center"},le={class:"w-[26rem] flex items-center justify-start"},ce={class:"ml-[1.2rem]"},re={class:"text-[#666] text-[1.2rem] ml-[6rem]"},ne={class:"flex items-center justify-between w-full"},ie={class:"flex items-center ml-[1.2rem]"},me={class:"text-[#999] ml-[1.2rem]"},oe={class:"bg-[#f6f6f6] text-[#999] p-[2rem] ml-[1.2rem]"},de={class:"mt-[1.2rem] ml-[2rem]"},ue={class:"flex items-center"},pe=m(o({__name:"index",props:{compData:{default:()=>({isSiteModule:!1})}},setup(m){const o=m,{payment:pe}=e(),{authType:be}=d(pe.value),fe=i(),ve=u(!0),he=u(!1),xe=u({scanTitle:"立即进行漏洞扫描，确保您的网站安全。",scanTime:"您还未进行漏洞扫描!",scanCheckButton:"立即扫描"}),ye=u(["1"]),ge=p([]),_e={4:["danger","严重"],3:["warning","高危"],2:["info","中危"],1:["success","低危"]},we=u("success"),Se=u(!1),ke=async()=>{if("ltd"!==be.value)return fe.error("抱歉！该功能为企业版专享功能！");we.value="loading",xe.value.scanTitle="正在扫描中，请稍后...";try{const{data:e}=await a({request:I(),loading:Se});if(xe.value.scanTitle="扫描完成",xe.value.scanTime="扫描时间：".concat(s(e.time)),xe.value.scanCheckButton="重新检测",ve.value=!1,e.info.length?(he.value=!1,ge.value=e.info,we.value="danger",xe.value.scanCheckButton="重新检测",xe.value.scanTitle="全部【".concat(e.site_num,"个】网站存在风险项<span class='text-danger'>").concat(e.loophole_num,"</span>个")):(he.value=!0,xe.value.scanTitle="当前网站没有风险项"),!1!==(null==e?void 0:e.status)&&!0===o.compData.isSiteModule){const{useSitePhpStore:a}=await t((()=>import("./useStore8.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),{scanData:s}=a();Object.assign(s.value,e)}}catch(e){we.value="success"}},Me=()=>l({title:"设置自动扫描",area:54,component:()=>t((()=>import("./index378.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),showFooter:!0});return(e,a)=>{const s=c,t=r,l=z,i=H,m=n,o=E,d=O,u=P;return b(),f("div",V,[v("div",A,[v("div",R,[v("div",Z,["loading"==h(we)?(b(),f("div",q,[h(Se)?(b(),f("div",F)):x("",!0),y(s,{icon:"scanning-scan",size:60,color:"#20a53a"})])):x("",!0),"success"==h(we)?(b(),g(s,{key:1,icon:"scanning-success",size:80,color:"#20a53a"})):x("",!0),"danger"==h(we)?(b(),g(s,{key:2,icon:"scanning-danger",size:80,color:"#ef0808"})):x("",!0),v("div",N,[v("div",{class:"scan-title text-[2rem] font-bold",innerHTML:h(xe).scanTitle},null,8,G),v("div",W,_(h(xe).scanTime),1)])]),v("div",X,[y(t,{class:"btlink setScanAlarm absolute top-[6rem] right-1rem",onClick:Me},{default:w((()=>a[2]||(a[2]=[S(" 自动扫描>> ")]))),_:1}),y(l,{class:"scan-btn h-[4rem] w-[10rem]",type:"loading"==h(we)||"danger"==h(we)?"default":"primary",size:"large",onClick:ke},{default:w((()=>[v("span",Y,_(h(xe).scanCheckButton),1)])),_:1},8,["type"]),"danger"==h(we)?(b(),g(l,{key:0,class:"scan-btn h-[4rem] w-[10rem]",type:"primary",size:"large",onClick:a[0]||(a[0]=e=>h(L)())},{default:w((()=>a[3]||(a[3]=[v("span",{class:"text-[1.5rem]"},"立即修复",-1)]))),_:1})):x("",!0)])])]),y(i,{class:"!mt-0"}),v("div",J,[h(ve)?(b(),f("div",K,[v("div",U,[y(m,{style:k(e.compData.isSiteModule?"width:40rem":""),src:e.compData.isSiteModule?"/preview/site_scanning.png":"/firewall/safe_detect_scanning.png",class:M(e.compData.isSiteModule?"!w-[34rem] mr-[4rem]":"max-w-[90rem] mr-[4rem]")},null,8,["style","src","class"]),v("div",$,[a[5]||(a[5]=v("span",{class:"text-[1.8rem] font-bold"},"漏洞扫描工具介绍：",-1)),v("ul",{class:M(["block leading-[3rem] mx-[2rem] list-square mt-[2rem]",e.compData.isSiteModule?"text-[1.2rem]":"text-[1.6rem]"])},a[4]||(a[4]=[C("<li data-v-910650bb> 可识别多款开源CMS程序，支持如下： <br data-v-910650bb> 迅睿CMS、pbootcms、苹果CMS、eyoucms、 <br data-v-910650bb> 海洋CMS、ThinkCMF、zfaka、dedecms、 <br data-v-910650bb> MetInfo、emlog、帝国CMS、discuz、 <br data-v-910650bb> Thinkphp、Wordpress、Z-Blog、极致CMS、 <br data-v-910650bb> ShopXO、HYBBS、ECShop、SchoolCMS、 <br data-v-910650bb> phpcms、likeshop、iCMS、WellCMS、 <br data-v-910650bb> chanzhiEPS、PHPOK、LaySNS、骑士CMS、 <br data-v-910650bb> openSNS、齐博CMS、ZZZCMS、prestashop、 <br data-v-910650bb> ThinkphpSHOP、DouPHP、cmseasy、 <br data-v-910650bb> piwigo、phpwind、行云海CMS </li><li data-v-910650bb>可扫描网站中存在的漏洞</li><li data-v-910650bb>提供修复/提供付费解决方案</li>",3)]),2)])])])):(b(),f("div",Q,[h(he)?(b(),f("div",ee,[v("div",ae,[y(m,{src:"/firewall/secure.png",class:"w-[34.0rem] h-[30.1rem]"}),a[6]||(a[6]=v("span",{class:"absolute mt-[10.5rem] text-[2rem] leading-[0.14rem]"}," 当前处于【安全状态】，请继续保持！ ",-1))])])):(b(),f("div",se,[a[10]||(a[10]=v("div",{class:"flex items-center mb-[2rem] text-[#333]"},[v("span",{class:"w-[26rem]"},"网站"),v("span",null,"类型")],-1)),v("div",{class:M(e.compData.isSiteModule?"overflow-auto h-[42rem]":"")},[y(u,{modelValue:h(ye),"onUpdate:modelValue":a[1]||(a[1]=e=>D(ye)?ye.value=e:null),accordion:""},{default:w((()=>[(b(!0),f(j,null,T(h(ge),((e,s)=>(b(),g(d,{key:s},{title:w((()=>[v("div",te,[v("div",le,[y(o,{type:e.cms.length>0?"warning":"success",effect:"dark"},{default:w((()=>[S(_(e.cms.length)+"项 ",1)])),_:2},1032,["type"]),v("span",ce,_(e.name),1)]),v("span",null,_(e.cms_name+"--"+e.version_info),1),v("div",re,[a[8]||(a[8]=S(" 无法自动修复，请手动处理或 ")),y(t,{onClick:B(h(L),["stop"])},{default:w((()=>a[7]||(a[7]=[S(" 联系人工 ")]))),_:1},8,["onClick"])])])])),default:w((()=>[y(u,{accordion:""},{default:w((()=>[(b(!0),f(j,null,T(e.cms,((e,s)=>(b(),g(d,{key:s},{title:w((()=>[v("div",ne,[v("div",ie,[y(o,{type:_e[e.dangerous][0]},{default:w((()=>[S(_(_e[e.dangerous][1]),1)])),_:2},1032,["type"]),v("span",me,_(e.ps),1)]),y(t,{class:"mb-[.2rem] mr-[1.6rem]"},{default:w((()=>a[9]||(a[9]=[S("详情")]))),_:1})])])),default:w((()=>[v("div",oe,"修复建议："+_(e.repair),1)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["modelValue"])],2)]))])),v("div",de,[v("div",ue,[a[12]||(a[12]=S(" 如需支持其他cms程序，请发帖反馈： ")),y(t,{href:"https://www.bt.cn/bbs/thread-89149-1-1.html"},{default:w((()=>a[11]||(a[11]=[S(" https://www.bt.cn/bbs/thread-89149-1-1.html ")]))),_:1})])])])])}}}),[["__scopeId","data-v-910650bb"]]);export{pe as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
