import{R as a,o as e,G as t,l,H as s,S as o,k as i,h as r}from"./utils-lib.js?v=1734676359";import{B as n}from"./index185.js?v=1734676359";import{_ as m}from"./index90.js?v=1734676359";import{_ as d}from"./index97.js?v=1734676359";import{u as p}from"./column.js?v=1734676359";import{c as u,a_ as c,r as _,az as f,e as g,o as w,B as h,k as b,l as j,x,C as U,p as v,q as k,M as P}from"./base-lib.js?v=1734676359";import{al as R,ak as I,bf as L}from"./firewall.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./ace.js?v=1734676359";import"./index91.js?v=1734676359";const V={class:"p-[2rem] min-h-[40rem]"},y={class:"p-[2rem]"},C=u({__name:"index",props:{compData:{default:{}}},setup(u){const C=u,T=c({p:1,limit:10}),q=_(),D=_(!1),S=_(!1),H=_(0),z=_(),E={mode:"ace/mode/nginx",theme:"ace/theme/chrome",wrap:!0,showInvisibles:!1,showFoldWidgets:!1,useSoftTabs:!0,tabSize:2,showPrintMargin:!1,readOnly:!0,fontSize:"12px"},O=async a=>{await e({title:"加入IP白名单",content:"是否将".concat(a.address,"添加到IP白名单？"),icon:"warning-filled"}),await t({loading:"正在添加IP白名单，请稍后...",request:I({start_ip:a.address,end_ip:a.address}),message:!0})},A=async()=>{await t({loading:S,request:L({...T,siteName:C.compData.row.site_name}),data:{data:[Array,q],page:o(H)}})},B=[{label:"时间",render:e=>f("span",a(e.addtime))},{label:"用户IP",render:a=>g("span",{class:"bt-link",onClick:()=>O(a)},[a.address])},{label:"恶意类型",prop:"intercept"},{label:"URL地址",prop:"url"},p([{onClick:async a=>{await e({title:"加入URL白名单",content:"加入URL白名单后此URL将不再进行防御，是否继续操作？",icon:"question-filled"}),await t({loading:"正在加入URL白名单，请稍后...",request:R({url_rule:a.url}),message:!0})},title:"URL加白",width:70},{onClick:a=>{l({title:a.address+"-详情",area:56,component:()=>s((()=>import("./log-detail2.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),compData:{row:a,addIpWhiteEvent:O}})},title:"详情"},{onClick:a=>{D.value=!0,z.value=JSON.stringify(a,null,4)},title:"HTTP"}])];return w((()=>A())),(a,e)=>{const t=i,l=d,s=m,o=n,p=r,u=h("bt-loading");return b(),j("div",V,[g(s,null,{content:x((()=>[U(g(t,{height:"380",column:B,data:v(q)},null,8,["data"]),[[u,v(S)],[u,"正在加载中，请稍后...","title"]])])),"footer-right":x((()=>[g(l,{total:v(H),page:v(T).p,"onUpdate:page":e[0]||(e[0]=a=>v(T).p=a),row:v(T).limit,"onUpdate:row":e[1]||(e[1]=a=>v(T).limit=a),onChange:A},null,8,["total","page","row"])])),_:1}),g(p,{title:a.compData.row.site_name+"HTTP详情",modelValue:v(D),"onUpdate:modelValue":e[3]||(e[3]=a=>P(D)?D.value=a:null),area:60},{default:x((()=>[k("div",y,[g(o,{modelValue:v(z),"onUpdate:modelValue":e[2]||(e[2]=a=>P(z)?z.value=a:null),class:"min-h-[48rem] max-h-[60rem] overflow-auto","editor-option":E},null,8,["modelValue"])])])),_:1},8,["title","modelValue"])])}}});export{C as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
