!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */e=function(){return r};var n,r={},a=Object.prototype,i=a.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",l=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function f(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(n){f=function(t,e,n){return t[e]=n}}function p(t,e,n,r){var a=e&&e.prototype instanceof b?e:b,i=Object.create(a.prototype),s=new P(r||[]);return o(i,"_invoke",{value:T(t,n,s)}),i}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}r.wrap=p;var h="suspendedStart",v="suspendedYield",y="executing",m="completed",g={};function b(){}function w(){}function x(){}var k={};f(k,c,(function(){return this}));var _=Object.getPrototypeOf,L=_&&_(_(M([])));L&&L!==a&&i.call(L,c)&&(k=L);var S=x.prototype=b.prototype=Object.create(k);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function E(e,n){function r(a,o,s,c){var l=d(e[a],e,o);if("throw"!==l.type){var u=l.arg,f=u.value;return f&&"object"==t(f)&&i.call(f,"__await")?n.resolve(f.__await).then((function(t){r("next",t,s,c)}),(function(t){r("throw",t,s,c)})):n.resolve(f).then((function(t){u.value=t,s(u)}),(function(t){return r("throw",t,s,c)}))}c(l.arg)}var a;o(this,"_invoke",{value:function(t,e){function i(){return new n((function(n,a){r(t,e,n,a)}))}return a=a?a.then(i,i):i()}})}function T(t,e,r){var a=h;return function(i,o){if(a===y)throw Error("Generator is already running");if(a===m){if("throw"===i)throw o;return{value:n,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var c=O(s,r);if(c){if(c===g)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===h)throw a=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=y;var l=d(t,e,r);if("normal"===l.type){if(a=r.done?m:v,l.arg===g)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(a=m,r.method="throw",r.arg=l.arg)}}}function O(t,e){var r=e.method,a=t.iterator[r];if(a===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=n,O(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var i=d(a,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,g;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,g):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,g)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function F(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function M(e){if(e||""===e){var r=e[c];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function t(){for(;++a<e.length;)if(i.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=n,t.done=!0,t};return o.next=o}}throw new TypeError(t(e)+" is not iterable")}return w.prototype=x,o(S,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},r.awrap=function(t){return{__await:t}},j(E.prototype),f(E.prototype,l,(function(){return this})),r.AsyncIterator=E,r.async=function(t,e,n,a,i){void 0===i&&(i=Promise);var o=new E(p(t,e,n,a),i);return r.isGeneratorFunction(e)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},j(S),f(S,u,"Generator"),f(S,c,(function(){return this})),f(S,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},r.values=M,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(F),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,a){return s.type="throw",s.arg=t,e.next=r,a&&(e.method="next",e.arg=n),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var c=i.call(o,"catchLoc"),l=i.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),F(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var a=r.arg;F(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:M(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=n),g}},r}function n(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function r(t){return function(){var e=this,r=arguments;return new Promise((function(a,i){var o=t.apply(e,r);function s(t){n(o,a,i,s,c,"next",t)}function c(t){n(o,a,i,s,c,"throw",t)}s(void 0)}))}}System.register(["./utils-lib-legacy.js?v=1734676359","./base-lib-legacy.js?v=1734676359","./column-legacy.js?v=1734676359","./validator-legacy.js?v=1734676359","./site-legacy.js?v=1734676359","./useController-legacy4.js?v=1734676359","./__commonjsHelpers__-legacy.js?v=1734676359","./index-legacy91.js?v=1734676359","./useStore-legacy7.js?v=1734676359","./useStore-legacy8.js?v=1734676359","./useController-legacy3.js?v=1734676359","./useStore-legacy9.js?v=1734676359","./useMethod-legacy5.js?v=1734676359"],(function(t,n){"use strict";var a,i,o,s,c,l,u,f,p,d,h,v,y,m,g,b,w,x,k,_,L,S,j,E,T,O,C,F,P,M,G,H,N,I,A,z,D,R,V,Y,q,J;return{setters:[function(t){a=t.u,i=t.a5,o=t.o,s=t._,c=t.d,l=t.c,u=t.k,f=t.h,p=t.b,d=t.e},function(t){h=t.c,v=t.r,y=t.h,m=t.o,g=t.B,b=t.C,w=t.p,x=t.k,k=t.l,_=t.q,L=t.e,S=t.J,j=t.v,E=t.x,T=t.y,O=t.z,C=t.F,F=t.D,P=t.I,M=t.aX,G=t.M,H=t.n,N=t.A,I=t.b7,A=t.aY,z=t.bt,D=t.bu},function(t){R=t.a},function(t){V=t.aD,Y=t.p},function(t){q=t.scanSiteRepairReq},function(t){J=t.g},null,null,null,null,null,null,null],execute:function(){var n={id:"safeDetectList",class:"p-[2rem]"},B={class:"progress-header"},U={class:"progress-header-cot"},X={class:"flex items-center"},K={key:0,class:"scan-icon relative h-[8rem] w-[8rem] flex"},Q={key:1},W={class:"progress-header-cot h-[8rem]"},Z=["innerHTML"],$={class:"scanning-progress-cont"},tt={class:"progress-header-cot"},et={class:"progress-cont-list"},nt={key:0},rt={class:"inline-grid grid-cols-4 w-full mt-20px"},at=["onClick"],it={class:"progress_type"},ot={class:"flex-1"},st={key:0},ct={key:1},lt={key:2,class:"text-danger mr-[4px]"},ut={key:3,class:"text-primary"},ft={class:"progress_fold text-[1.2rem] flex items-center"},pt={class:"mr-4px"},dt={class:"progress_item_body"},ht={class:"flex items-center justify-between w-full"},vt={class:"flex items-center ml-12px"},yt=["innerHTML"],mt={class:"flex flex-col py-[1rem] px-[1.6rem] text-[1.2rem] progress_item_info"},gt={class:"flex"},bt=["innerHTML"],wt={class:"flex"},xt=["innerHTML"],kt={class:"p-[2rem]"},_t=h({__name:"index",setup:function(t){var d=p(),h=a().payment.value.authType,_t=v(),Lt=v(!1),St=v([{name:"vulscan",title:"漏洞扫描"},{name:"webscan",title:"网站配置安全性"},{name:"filescan",title:"文件泄露"},{name:"backup",title:"备份文件"},{name:"index",title:"首页内容风险"},{name:"webhorse",title:"挂马排查"},{name:"deadchain",title:"坏链扫描"},{name:"database",title:"数据库安全"},{name:"ftps",title:"网站FTP风险"},{name:"backend",title:"网站后台安全"}]),jt=v(""),Et=y({title:"定期扫描网站，提升网站安全性",msg:"当前安全风险未知，请立即扫描",isFirst:!0,error:0,scanStatus:!1,isEnd:!1,siteList:[],time:0,scanTypeStatus:{vulscan:!0,webscan:!0,filescan:!0,backup:!0,index:!0,webhorse:!0,deadchain:!0,database:!0,ftps:!0,backend:!0},btnObj:{text:"立即扫描",type:"primary"},progress:0,progressColor:"#20a53a",progressConfig:{},statusTotal:{},active:{vulscan:!1,webscan:!1,filescan:!1,backup:!1,index:!1,webhorse:!1,deadchain:!1,database:!1,ftps:!1,backend:!1}}),Tt=null,Ot=v(),Ct=v(!1),Ft=v(!1),Pt=v([]),Mt=v([R(),{label:"网站名",prop:"name"}]),Gt=function(){Tt=i({route:"/ws_project",onMessage:At})},Ht=function(){if("ltd"!==h)return d.error("抱歉，该功能为企业版专享功能！");Ct.value=!0,Ft.value||H((function(){}))},Nt=function(t){Ft.value=!0,Et.siteList=t},It=function(){if(0==Et.siteList.length)return d.error("请选择扫描站点");Ct.value=!1,zt()},At=function(t,e){var n=JSON.parse(e.data);if(n.hasOwnProperty("site_list"))return Pt.value=n.site_list,void(Et.siteList=n.site_list);if(n.hasOwnProperty("end")){var r;if(Et.progress=n.bar,Et.msg=n.info,n.dangerous&&(Et.progressConfig[n.type]||(Et.progressConfig[n.type]=[]),Et.progressConfig[n.type].push(n),Et.statusTotal[n.type]?Et.statusTotal[n.type]++:Et.statusTotal[n.type]=1,Et.error++),n.end)return Et.isEnd=!0,Et.scanStatus=!1,null===(r=Tt)||void 0===r||r.close(),J(),void Rt("end");n.type!=jt.value&&(jt.value&&!Et.statusTotal[jt.value]&&(Et.scanTypeStatus[jt.value]=!1),jt.value=n.type)}},zt=function(){var t=r(e().mark((function t(){var n;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Et.time=0,Et.error=0,setInterval((function(){Et.time++}),1e3),"ltd"===h){t.next=5;break}return t.abrupt("return",d.error("抱歉，该功能为企业版专享功能！"));case 5:if(!Et.isFirst){t.next=14;break}if(0!=Et.siteList.length){t.next=8;break}return t.abrupt("return",d.error("未扫描到网站，请选择"));case 8:Dt(),Et.scanStatus=!0,Et.isFirst=!1,Rt("scan"),t.next=27;break;case 14:if(!Et.scanStatus){t.next=23;break}return t.next=17,o({title:"取消扫描",content:"确定取消扫描吗?"});case 17:null===(n=Tt)||void 0===n||n.close(),Et.isFirst=!0,Rt("scan"),qt(),t.next=27;break;case 23:qt(),Dt(),Et.scanStatus=!0,Rt("scan");case 27:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Dt=function(){var t=r(e().mark((function t(){var n;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Gt();case 2:return t.next=4,null===(n=Tt)||void 0===n?void 0:n.send({mod_name:"webscanning",def_name:"ScanAllSite",site_list:Et.siteList.map((function(t){return t.name})),ws_callback:"123"});case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Rt=function(t){switch(t){case"scan":Et.title="正在扫描",Et.isEnd=!1,Et.btnObj.text="取消扫描",Et.btnObj.type="warning";break;case"end":var e="";e=0==Et.error?"当前安全风险未知，请立即扫描":'共发现<span class="text-danger">'.concat(Et.error,"</span>项风险"),Et.title="检测完成,"+e,Et.msg="扫描完成，共耗时"+Et.time+"秒",Et.btnObj.text="重新扫描",Et.btnObj.type="primary"}},Vt=function(){var t=r(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:q(),V();case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Yt=function(t){"free"==h&&Y({sourceId:65})},qt=function(){jt.value="",Et.scanStatus=!1,Et.isEnd=!1,Et.error=0,Et.time=0,Et.progress=0,Et.progressConfig={vulscan:[],webscan:[],filescan:[],backup:[],index:[],webhorse:[],deadchain:[],database:[],ftps:[],backend:[]},Et.statusTotal={},Et.active={vulscan:!1,webscan:!1,filescan:!1,backup:!1,index:!1,webhorse:!1,deadchain:!1,database:!1,ftps:!1,backend:!1},Et.scanTypeStatus={vulscan:!0,webscan:!0,filescan:!0,backup:!0,index:!0,webhorse:!0,deadchain:!0,database:!0,ftps:!0,backend:!0},Et.btnObj.text="立即扫描",Et.btnObj.type="primary",Et.title="定期扫描网站，提升网站安全性",Et.msg="当前安全风险未知，请立即扫描"};return m((function(){var t;Gt(),null===(t=Tt)||void 0===t||t.send({mod_name:"webscanning",def_name:"GetAllSite",ws_callback:""})})),function(t,e){var r=s,a=N,i=I,o=A,p=c,d=l,v=z,y=D,m=u,H=f,R=g("bt-loading");return b((x(),k("div",n,[_("div",B,[_("div",U,[_("div",X,[w(Et).scanStatus?(x(),k("div",K,[e[1]||(e[1]=_("div",{class:"animate-spin absolute top-0 border-primary border-b-2 rounded-full h-full w-full bg-#cccccc00"},null,-1)),L(r,{icon:"scanning-danger",size:60,color:"#F39C12",class:"m-auto"})])):(x(),k("div",Q,[w(Et).warn||w(Et).error?(x(),S(r,{key:0,icon:"scanning-danger",size:70,color:"#ef0808"})):(x(),S(r,{key:1,icon:"scanning-"+(w(Et).isEnd?"success":"danger"),size:72,color:w(Et).isEnd?"#20a53a":"#F39C12"},null,8,["icon","color"]))]))])]),_("div",W,[_("div",{class:"scanning-progress-title",innerHTML:w(Et).title},null,8,Z),_("div",$,j(w(Et).msg.length>35?w(Et).msg.substring(0,35)+"...":w(Et).msg),1)]),_("div",tt,[w(Et).isFirst||w(Et).isEnd?(x(),S(a,{key:0,type:"text",onClick:Ht},{default:E((function(){return e[2]||(e[2]=[T(" 选择网站 ")])})),_:1})):O("",!0),L(a,{class:C({"warning-hover":w(Et).scanStatus}),plain:!!w(Et).scanStatus,type:w(Et).btnObj.type,onClick:zt},{default:E((function(){return[T(j(w(Et).btnObj.text),1)]})),_:1},8,["class","plain","type"]),w(Et).isEnd?(x(),S(a,{key:1,type:"default",onClick:Vt},{default:E((function(){return e[3]||(e[3]=[T(" 联系客服 ")])})),_:1})):O("",!0)])]),b(L(i,{class:"!w-full",color:w(Et).progressColor,"show-text":!1,"stroke-width":2,percentage:w(Et).progress},null,8,["color","percentage"]),[[F,w(Et).scanStatus]]),b(L(o,{class:"!mt-0 !mb-20px !bg-[#F1F1F1]"},null,512),[[F,!w(Et).scanStatus]]),_("div",et,[w(Et).scanStatus||w(Et).isEnd?O("",!0):(x(),k("div",nt,[e[4]||(e[4]=_("div",{class:"font-bold text-[1.6rem] text-[#666] my-[4rem]"},"支持网站以下安全扫描项:",-1)),_("div",rt,[(x(!0),k(P,null,M(w(St),(function(t,e){return x(),k("div",{key:e,class:"flex flex-col inline-block items-center mb-20px"},[L(p,{class:"w-[4rem] inline-block mb-8px opacity-90",src:"/scan/scanning-"+t.name+"-ico.svg"},null,8,["src"]),T(" "+j(t.title),1)])})),128))])])),w(Et).scanStatus||w(Et).isEnd?(x(!0),k(P,{key:1},M(w(St),(function(t,n){return x(),k("div",{key:n,class:C([t.name+"_item "+(w(Et).active[t.name]?"active":""),"progress_item"])},[_("div",{class:"progress_item_header",onClick:function(e){return function(t){Et.active[t]||(Et.active[t]=!1),Et.active[t]=!Et.active[t]}(t.name)}},[_("div",it,[L(p,{class:"mr-12px w-[2rem]",src:"/scan/scanning-"+t.name+"-ico.svg"},null,8,["src"]),_("span",null,j(t.title),1)]),_("div",ot,[w(Et).scanStatus&&w(jt)==t.name?(x(),k("span",st," 正在扫描... ")):w(Et).scanStatus&&w(jt)!=t.name&&!w(Et).statusTotal[t.name]&&w(Et).scanTypeStatus[t.name]?(x(),k("span",ct," 等待扫描 ")):w(Et).statusTotal[t.name]?(x(),k("span",lt," 发现"+j(w(Et).statusTotal[t.name])+"项危险 ",1)):(x(),k("span",ut,"无风险项"))]),_("div",ft,[_("span",pt,j(w(Et).active[t.name]?"收起":"展开"),1),_("i",{class:C(w(Et).active[t.name]?"svgtofont-el-arrow-up":"svgtofont-el-arrow-down")},null,2)])],8,at),b(_("div",dt,[L(y,{accordion:""},{default:E((function(){return[(x(!0),k(P,null,M(w(Et).progressConfig[t.name],(function(t,n){return x(),S(v,{key:n,disabled:"free"==w(h)},{title:E((function(){return[_("div",ht,[_("div",vt,[_("span",{innerHTML:t.info},null,8,yt)]),L(d,{class:"mb-2px mr-4px",onClick:Yt},{default:E((function(){return e[5]||(e[5]=[T(" 详情 ")])})),_:1})])]})),default:E((function(){return[_("div",mt,[_("div",gt,[e[6]||(e[6]=_("span",{class:"w-[6rem] flex-shrink-0 inline-block"}," 详情： ",-1)),_("span",{class:"leading-[1.6rem]",innerHTML:t.detail},null,8,bt)]),L(o,{class:"!my-8px"}),_("div",wt,[e[7]||(e[7]=_("span",{class:"w-[6rem] flex-shrink-0 inline-block"}," 修复方案： ",-1)),_("span",{innerHTML:t.repair},null,8,xt)])])]})),_:2},1032,["disabled"])})),128))]})),_:2},1024)],512),[[F,w(Et).active[t.name]]])],2)})),128)):O("",!0)]),L(H,{title:"选择扫描网站",modelValue:w(Ct),"onUpdate:modelValue":e[0]||(e[0]=function(t){return G(Ct)?Ct.value=t:null}),ref_key:"scanSiteListDialog",ref:Ot,area:[45,33],onConfirm:It,showFooter:""},{default:E((function(){return[_("div",kt,[L(m,{ref_key:"scanSiteTableRef",ref:_t,data:w(Pt),column:w(Mt),"max-height":296,onSelectionChange:Nt,description:"网站列表为空"},null,8,["data","column"])])]})),_:1},8,["modelValue"])])),[[R,w(Lt)]])}}});t("default",d(_t,[["__scopeId","data-v-0294aa7b"]]))}}}))}();
