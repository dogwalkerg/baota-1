import{H as e}from"./utils-lib.js?v=1734676359";import{m as a,n as t,g as s,s as l,o}from"./api.js?v=1734676359";import{c as n,p as i,r as c,h as r,o as m,B as d,k as u,l as p,e as f,x as h,C as v,J as g,I as y,aX as _,q as w,v as k,z as x,y as b,M as j}from"./base-lib.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";const D={key:0,class:"mr-1rem"},I={class:"inline-block w-full flex items-center justify-between"},E=["title"],V={class:"truncate max-w-[12rem]"},C={key:0,class:"h-4rem flex items-center justify-center text-lighter"},B={key:1,class:"h-4rem flex items-center justify-center text-lighter text-12px"},A=n({__name:"cosfs-mount",props:{dependencies:{default:()=>({})}},setup(n){const A=n,{BtDialog:F,BtInputIcon:N,BtSvgIcon:S,ElDropdown:q,ElDropdownItem:L,ElDropdownMenu:M,ElForm:z,ElButton:H,ElFormItem:O}=i(A.dependencies.components),{useAxios:P,useMessage:R,useDialog:U}=i(A.dependencies.hooks),{fileSelectionDialog:J}=i(A.dependencies.dialog),{getDiskList:T}=i(A.dependencies.custom),X=R(),$=c(!1),G=c(!1),K=c([]),Q=c(!1),W=c(!1),Y=c(),Z=r({region:"",bucket_name:"",path:""}),ee=r({path:[{required:!0,message:"请选择文件目录",trigger:"blur"}]}),ae=()=>{J({type:"dir",change:e=>{Z.path=e}})},te=()=>{U({isAsync:!0,component:()=>e((()=>import("./config3.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),title:!1,area:[48],compData:{dependencies:A.dependencies}})},se=e=>{const{Name:a,Location:t}=K.value[e];Z.region=t,Z.bucket_name=a,Z.path="/www/cosfs/".concat(a.replace(/([-][^-]+)$/,"")),W.value=!0},le=async()=>{try{await Y.value.validate();const e=X.load("正在挂载，请稍后..."),t=await a(Z);X.request(t),t.status&&(W.value=!1,oe(),T()),e.close()}catch(e){}},oe=async()=>{try{G.value=!0;const e=await t();e.status&&(K.value=e.data.list)}catch(e){}finally{G.value=!1}},ne=async()=>{try{const{data:e}=await s();!1===(null==e?void 0:e.status)&&(null==e?void 0:e.msg)&&(Q.value=!0),e&&(async()=>{try{const e=await o({sName:"cosfs"});e.data.setup&&oe(),$.value=e.data.setup}catch(e){}})(),$.value=!!e}catch(e){}};return m((()=>{l(P),ne()})),(e,a)=>{const t=d("bt-loading"),s=d("trim");return i($)?(u(),p("div",D,[f(i(q),{placement:"bottom-start",onCommand:se},{dropdown:h((()=>[v((u(),g(i(M),{class:"w-20rem"},{default:h((()=>[i(Q)?(u(),p("div",B,[a[4]||(a[4]=b("未关联腾讯云API密钥")),w("a",{class:"bt-link cursor-pointer ml-4px",onClick:te},">>关联密钥")])):(u(),p(y,{key:0},[(u(!0),p(y,null,_(i(K),((e,t)=>(u(),g(i(L),{key:t,command:t},{default:h((()=>[w("div",I,[w("div",{class:"flex items-center",title:e.Name.split("-")[0]},[f(i(S),{name:"file-hdd",size:"1.4",class:"mr-4px"}),w("div",V,k(e.Name.split("-")[0]),1)],8,E),a[3]||(a[3]=w("div",{class:"text-primary"},"挂载",-1))])])),_:2},1032,["command"])))),128)),i(K).length?x("",!0):(u(),p("div",C,"暂无未挂载存储桶"))],64))])),_:1})),[[t,i(G)]])])),default:h((()=>[f(i(H),null,{default:h((()=>a[2]||(a[2]=[b("腾讯云COSFS挂载工具"),w("i",{class:"svgtofont-el-arrow-down el-icon--right"},null,-1)]))),_:1})])),_:1}),f(i(F),{title:"【".concat(i(Z).bucket_name,"】本地挂载"),modelValue:i(W),"onUpdate:modelValue":a[1]||(a[1]=e=>j(W)?W.value=e:null),"show-footer":!0,area:[50],"confirm-text":"挂载",onConfirm:le},{default:h((()=>[f(i(z),{ref_key:"mountFromRef",ref:Y,class:"p-2rem",model:i(Z),rules:i(ee)},{default:h((()=>[f(i(O),{label:"挂载地址",prop:"path"},{default:h((()=>[v(f(i(N),{modelValue:i(Z).path,"onUpdate:modelValue":a[0]||(a[0]=e=>i(Z).path=e),name:"path",icon:"el-folder-opened",width:"32rem",placeholder:"请选择文件目录",onIconClick:ae},null,8,["modelValue"]),[[s]])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])])):x("",!0)}}});export{A as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
