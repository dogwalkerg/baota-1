import{u as e,M as a,j as l,v as t,_ as s,E as u,e as o,J as n,df as r,dg as i,a4 as p,bd as d,l as c,H as v,c as m,O as b,b as y}from"./utils-lib.js?v=1734676359";import{r as h,c as w,aD as f,o as _,k,J as g,x as T,q as N,H as V,p as x,M as L,l as D,aX as S,I as U,z as C,e as B,y as E,ah as A,a7 as M,bO as I,ag as j,X as O,F as H,G as R,v as P,C as q,D as z,w as F,h as Q,Q as $,aw as W,a4 as G,t as Z,s as J,i as X,ae as K,ad as Y,A as ee,at as ae,av as le,bQ as te}from"./base-lib.js?v=1734676359";import{f as se,ay as ue,p as oe}from"./validator.js?v=1734676359";import{_ as ne}from"./index88.js?v=1734676359";import{U as re,V as ie,W as pe,X as de,Y as ce,Z as ve,_ as me,$ as be,a0 as ye,a1 as he,a2 as we}from"./useMethod2.js?v=1734676359";import{C as fe,t as _e,g as ke}from"./index13.js?v=1734676359";e();const ge=h([{value:"mysql",label:"MySQL"},{value:"mongodb",label:"MongoDB"},{value:"redis",label:"Redis"},{value:"pgsql",label:"PgSQL"}]),Te=h({toShell:{label:"脚本内容",placeholder:"请输入脚本内容",inputType:"textarea",notice:!1,keyword:!0,helpList:[{content:"为了保证服务器的安全稳定，shell脚本中以下命令不可使用：shutdown, init 0, mkfs, passwd, chpasswd, --stdin, mkfs.ext, mke2fs"}]},site:{backLabel:"备份网站",inputType:"textarea",placeholder:"每行一条规则,目录不能以/结尾，\n示例：data/config.php\nstatic/upload\n*.log,",label:"排除规则",notice:!0},database:{notice:!0,backLabel:"数据库",helpList:[{content:"远程数据库不支持备份表"}]},logs:{selectLabel:"切割日志",helpList:[{content:"只切分项目的访问日志，如需对项目日志进行切分，请前往【网站-**项目-项目日志】进行配置"},{content:"日志切割后会在选择的目录下产生/history_backups文件夹，切割后的日志存储在这个文件夹中"}]},special_log:{label:"切割路径",selectLabel:"保留最新"},enterpriseBackup:{backLabel:"备份数据库",label:"压缩密码",notice:!0,placeholder:"请输入压缩密码",iconType:"el-refresh",helpList:[{content:"【使用提醒】当前数据库暂不支持SQLServer、MongoDB、Redis、PgSQL备份"}]},path:{backLabel:"备份目录",notice:!0,label:"排除规则",inputType:"textarea",placeholder:"每行一条规则,目录不能以/结尾，\n示例：data/config.php\nstatic/upload\n*.log,"},syncTime:{selectLabel:"时区选择",helpList:[{content:"默认从NTP服务器同步时间，失败时将同步bt.cn的服务器时间。"}]},rememory:{helpList:[{content:"释放PHP、MYSQL、PURE-FTPD、APACHE、NGINX的内存占用,建议在每天半夜执行!"}]},toUrl:{label:"URL地址",placeholder:"请输入URL地址"},to_post:{label:"URL地址",placeholder:"请输入URL地址"},webshell:{selectLabel:"查杀站点"},site_restart:{backLabel:"网站",notice:!1,helpList:[{content:"执行周期为每天一次"}]},log_cleanup:{helpList:[{content:"自定义选择的目录支持切割的日志类型有：.log、.txt、.out、.err、.log.1"}]},startup_services:{label:"脚本内容",placeholder:"请输入脚本内容",inputType:"textarea"}}),Ne=h([{value:"toShell",label:"Shell脚本"},{value:"site",label:"备份网站"},{value:"database",label:"备份数据库"},{label:"数据库增量备份",value:"enterpriseBackup"},{value:"logs",label:"网站日志切割"},{value:"path",label:"备份目录"},{value:"webshell",label:"木马查杀"},{value:"syncTime",label:"同步时间"},{value:"rememory",label:"释放内存"},{value:"toUrl",label:"访问URL-GET"},{value:"to_post",label:"访问URL-POST"},{value:"site_restart",label:"网站启停"},{value:"log_cleanup",label:"定时清理日志"}]),Ve=h([{value:"all",label:"所有日志"},{value:"system_log",label:"系统日志"},{value:"panel_log",label:"面板日志"},{value:"www_log",label:"网站日志"},{value:"usranalyse_log",label:"堡塔防入侵日志"},{value:"mysql_log",label:"MySQL日志"},{value:"Recycle",label:"回收站日志"},{value:"mail_log",label:"邮件日志"},{value:"php_session",label:"PHP会话日志"},{value:"total_log",label:"网站统计报表日志"},{value:"user_config",label:"用户配置日志"}]),xe=h([{label:"不接收任何消息通知",value:0},{label:"任务执行失败接收通知",value:1}]),Le=h({scriptText:"",args:""}),De=(e,a)=>({taskName:[{required:!0,message:"任务名称不可为空",trigger:["blur","input"]}],save:[{required:!0,message:"保留最新份数不可为空",trigger:"blur"},{validator:(e,a,l)=>{const t=Number(a);t<0||0===t?l(new Error("请输入不为0的数字")):l()},trigger:"blur"}],path:[{validator:(e,l,t)=>{"path"===a.type&&""===l?t(new Error("输入内容不可为空")):t()},trigger:["blur","input"]}],inputData:[{validator:(e,l,t)=>{const s=l.lastIndexOf("."),u=l.substring(s+1);"path"===a.type||"startup_services"===a.type||"enterpriseBackup"===a.type?t():"site"!==a.type&&""===l&&"logs"!==a.type?t(new Error("输入内容不可为空")):"special_log"===a.type&&"log"!==u?t(new Error("日志文件后缀必须为.log")):t()},trigger:["blur","change","input"]}],stopTime:[{validator:(e,l,t)=>{"site_restart"===a.type&&null===l?t(new Error("内容不可为空")):t()},trigger:["blur","change","input"]}],startTime:[{validator:(e,l,t)=>{"site_restart"===a.type&&null===l?t(new Error("内容不可为空")):"site_restart"===a.type&&null!==l&&a.stopTime===l?t(new Error("开启时间不可与停止时间相同")):t()},trigger:["blur","change","input"]}]}),Se=h({type:"day",week:"1",hour:"1",minute:"30",second:"5",where1:"1",timeSet:["1"],timeType:"sday",specialHour:[0],specialMinute:[0]}),Ue=h({notice:0,noticeChannel:"all",keyword:"",flock:!0}),Ce=h({databaseType:"mysql",databaseName:"all",databaseTable:[""],siteName:"all",number:3,backServer:"localhost",path:""}),Be=h({fileNum:5,isSplit:!1,fileType:"0"}),Ee=h([]),Ae=h(0),Me=h([]),Ie=h([]),je=h([]),Oe=h([]),He=()=>{Object.assign(Se.value,{type:"day",week:"1",hour:"1",minute:"30",second:"5",where1:"1",timeSet:["1"],timeType:"sday",specialHour:[0],specialMinute:[0]}),Object.assign(Ue.value,{notice:0,noticeChannel:"",keyword:"",flock:!0})},Re={class:"flex items-center"},Pe={class:"text-[1.2rem] flex items-center"},qe={key:0,class:"mx-[8px]"},ze=w({__name:"select-item",props:{selectLabel:{default:"脚本内容"},type:{default:""},selectData:{}},emits:["update:saveNumber","update:select","update:changeZone"],setup(e,{emit:t}){const s=e,u=h(180),o=h([]),n=h(["Asia","Shanghai"]),r=h(""),i=t,p=h([]),d=e=>{e<1&&(a.warn("保留最新的份数不能小于1"),u.value=1),i("update:saveNumber",u.value)},c=e=>{r.value=e,i("update:select",e)},v=e=>{n.value=e,i("update:changeZone",e)};return f((()=>{var e,a,l,t,i,d;if("logs"==s.type||"webshell"==s.type)o.value=je.value,(null==(e=o.value)?void 0:e.length)&&!["all","ALL"].includes(null==(l=null==(a=o.value)?void 0:a[0])?void 0:l.value)&&o.value.unshift({name:"全部",value:"all",ps:"所有数据"}),r.value=null==(i=null==(t=o.value)?void 0:t[0])?void 0:i.name;else if("syncTime"==s.type){let e=[];Object.keys(Ie.value).forEach((a=>{let l={};l.value=a,l.label=a,l.children=[],Ie.value[a].forEach((e=>{l.children.push({value:e,label:e})})),e.push(l)})),p.value=e}s.selectData&&(r.value="ALL"===s.selectData.sName||""===s.selectData.sName?"全部":s.selectData.sName,u.value=s.selectData.save||180,n.value=null==(d=s.selectData)?void 0:d.sName.split("/"))})),_((()=>{Ce.value.number=u.value})),(e,a)=>{const t=j,s=A,i=l,m=M,b=I;return k(),g(m,{label:e.selectLabel},{default:T((()=>{var l;return[N("div",Re,[V(e.$slots,"before"),"special_log"!=e.type&&"syncTime"!==e.type?(k(),g(s,{key:0,class:"!w-[16rem]",modelValue:x(r),"onUpdate:modelValue":a[0]||(a[0]=e=>L(r)?r.value=e:null),disabled:!!(null==(l=e.selectData)?void 0:l.id),onChange:c,filterable:""},{default:T((()=>[(k(!0),D(U,null,S(x(o),(e=>(k(),g(t,{key:e.value,label:e.name,value:e.name},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])):C("",!0),"webshell"!==e.type&&"syncTime"!=e.type?(k(),g(m,{key:1,prop:"save",class:"!mt-0"},{default:T((()=>[N("div",Pe,["special_log"!=e.type?(k(),D("span",qe)):C("",!0),B(i,{onChange:d,type:"number",min:1,width:"12rem",modelValue:x(u),"onUpdate:modelValue":a[1]||(a[1]=e=>L(u)?u.value=e:null)},{append:T((()=>a[3]||(a[3]=[E(" 份 ")]))),_:1},8,["modelValue"])])])),_:1})):C("",!0),"syncTime"==e.type?(k(),g(b,{key:2,class:"w-[32rem]",modelValue:x(n),"onUpdate:modelValue":a[2]||(a[2]=e=>L(n)?n.value=e:null),options:x(p)&&x(p).length?x(p):[],onChange:v,props:{expandTrigger:"hover"}},null,8,["modelValue","options"])):C("",!0),V(e.$slots,"after")])]})),_:3},8,["label"])}}}),Fe={class:"flex items-center"},Qe=w({__name:"input-item",props:{label:{default:"脚本内容"},inputType:{default:"input"},resize:{default:"none"},iconType:{default:!1},placeholder:{default:"请输入内容信息"},inputValue:{}},emits:["update:changeInput"],setup(e,{emit:a}){const o=e,n=h(""),r=a,i=e=>{"object"!=typeof e&&r("update:changeInput",e)},p=()=>{if("el-refresh"===o.iconType)n.value=t()};return f((()=>{"URL地址"==o.label?n.value="http://":n.value="",o.inputValue&&(n.value=o.inputValue)})),(e,a)=>{const t=s,o=u,r=l,d=M;return k(),g(d,{label:e.label,prop:"inputData"},{default:T((()=>[N("div",Fe,[V(e.$slots,"before"),B(r,{ref:"inputData",onChange:i,onInput:i,class:H("切割路径"===e.label?"radius-r0":""),width:"textarea"===e.inputType?"60rem":"26rem",style:R("width: ".concat("textarea"===e.inputType?"60rem":"26rem")),placeholder:e.placeholder,type:e.inputType,modelValue:x(n),"onUpdate:modelValue":a[0]||(a[0]=e=>L(n)?n.value=e:null),resize:e.resize,rows:10,isNull:!0,iconType:e.iconType},O({_:2},[e.iconType?{name:"append",fn:T((()=>[B(o,{onClick:p},{default:T((()=>[B(t,{icon:e.iconType,class:"cursor-pointer"},null,8,["icon"])])),_:1})])),key:"0"}:void 0]),1032,["class","width","style","placeholder","type","modelValue","resize","iconType"]),V(e.$slots,"after")])])),_:3},8,["label"])}}}),$e={class:"flex items-center"},We={class:"flex items-center justify-between"},Ge={style:{float:"left"}},Ze=o(w({__name:"back-server-item",props:{rowData:{default:()=>{}},type:{}},emits:["update:backServer"],setup(e,{emit:a}){const l=e,t=a,s=e=>{Ce.value.backServer=e,t("update:backServer",e)},u=[{validator:(e,a,l)=>{Array.isArray(Ce.value.backServer)?0===Ce.value.backServer.length?l(new Error("请选择备份服务器")):l():""===Ce.value.backServer?l(new Error("请选择备份服务器")):l()},message:"请选择至少一个备份服务器",trigger:["blur","change"]}];return _((()=>{var e,a;l.rowData&&"enterpriseBackup"==l.rowData.sType&&(Ce.value.backServer=-1!==(null==(a=null==(e=l.rowData)?void 0:e.backupTo)?void 0:a.indexOf("|"))?l.rowData.backupTo.split("|"):l.rowData.backupTo),l.rowData||"enterpriseBackup"!==l.type||(Ce.value.backServer="localhost")})),(e,a)=>{const l=j,t=A,o=M;return k(),g(o,{label:"备份到",class:"diy-el-form",rules:u,prop:"backupData"},{default:T((()=>{var u,o;return[N("div",$e,[(k(),g(t,{modelValue:x(Ce).backServer,"onUpdate:modelValue":a[0]||(a[0]=e=>x(Ce).backServer=e),filterable:"",onChange:s,class:"!w-[16rem]","collapse-tags":"",key:e.type,multiple:!(!e.rowData||-1===(null==(o=null==(u=e.rowData)?void 0:u.backupTo)?void 0:o.indexOf("|"))||"enterpriseBackup"!==e.type)},{default:T((()=>[(k(!0),D(U,null,S(x(Oe),(e=>(k(),g(l,{key:e.value,disabled:"localhost"!==e.value&&!e.status,label:e.name,value:e.value},{default:T((()=>[N("div",We,[N("span",Ge,P(e.name),1),q(N("span",{class:"float-right text-[1.2rem] text-danger ml-12px"},P(e.status?"":"[未配置]"),513),[[z,"localhost"!==e.value]])])])),_:2},1032,["disabled","label","value"])))),128))])),_:1},8,["modelValue","multiple"]))])]})),_:1})}}}),[["__scopeId","data-v-7ffc038d"]]),Je={class:"flex items-center"},Xe={key:0,class:"ml-[12px] mr-[8px] text-[1.2rem] text-[#666]"},Ke=o(w({__name:"db-and-site-item",props:{type:{default:""},multiple:{type:Boolean,default:!1},rowData:{},databaseList:{default:()=>[]}},emits:["updata:tableOptions","updata:backupDrop","updata:backupValue"],setup(e,{emit:a}){var l,t;const s=e,u=e=>{let a=decodeURIComponent(e);return a=a.replace(/&lt;/g,"<").replace(/&gt;/g,">"),r(e)},o=h([]),i=h("site"==s.type?Ce.value.siteName:"site_restart"==s.type?(null==(t=null==(l=je.value)?void 0:l[0])?void 0:t.name)||"":Ce.value.databaseName),p=h("/www/wwwroot"),d=a,c=async e=>{if(s.multiple&&(e.length&&""!=e[e.length-1]||(i.value=["全部"]),e.length>1&&"全部"==e[0]?i.value=null==e?void 0:e.filter((e=>"全部"!=e)):e.length>1&&"全部"==e[e.length-1]&&(i.value=["全部"])),"site"==s.type||"site_restart"==s.type)Ce.value.siteName=["全部","所有"].includes(i.value)?"ALL":i.value;else if("database"==s.type)Ce.value.databaseTable=i.value,d("updata:tableOptions","全部"!==i.value?o.value.find((e=>e.name==i.value)):[]),d("updata:backupValue","全部"==i.value?"ALL":i.value);else if("enterpriseBackup"==s.type)try{const a=(await ce()).data.find((a=>a.name==e));d("updata:tableOptions",a)}catch(a){}else Ce.value.databaseName=e},v=()=>{var e;(null==(e=s.rowData)?void 0:e.id)||se({type:"all",path:"/www/wwwroot",change:e=>{p.value=e,d("updata:backupDrop",e)}})},m=e=>{p.value=e,d("updata:backupDrop",e)};return f((async()=>{var e,a,l,t,u,n,r,p,c,v,m,b,y,h;"site"==s.type||"site_restart"==s.type?o.value=je.value:(o.value=Me.value,"enterpriseBackup"===s.type&&(o.value=null==(e=s.databaseList)?void 0:e.filter((e=>"全部"!=e.name)),(null==(a=o.value)?void 0:a.find((e=>e.name==i.value)))||(Ce.value.databaseName=null==(l=o.value[0])?void 0:l.name,i.value=null==(u=null==(t=o.value)?void 0:t[0])?void 0:u.name)),"database"===s.type&&(o.value=Me.value,Ce.value!==i.value&&(i.value=Ce.value.databaseName)));let w=!["ALL","all"].includes(null==(r=null==(n=o.value)?void 0:n[0])?void 0:r.value);if((s.multiple&&w&&"enterpriseBackup"!=s.type||["database","site","site_restart"].includes(s.type)&&w)&&o.value.unshift({name:"site_restart"!==s.type?"全部":"所有",value:"ALL",ps:s.type.indexOf("site")>-1?"所有网站":"所有数据"}),s.multiple&&!s.rowData&&(Ce.value.siteName=["全部"],Ce.value.databaseName=["全部"],i.value=["全部"]),"enterpriseBackup"===(null==(p=s.rowData)?void 0:p.sType)){i.value=s.rowData.sName;const e=null==(c=(await ce()).data)?void 0:c.find((e=>e.name==s.rowData.sName));d("updata:tableOptions",e)}"database"!==s.type||s.rowData||(null==(v=o.value)?void 0:v.find((e=>e.name==i.value)))||(i.value=null==(b=null==(m=o.value)?void 0:m[0])?void 0:b.name,Ce.value.databaseName=i.value),"all"!=i.value&&"ALL"!=i.value||(i.value="全部"),"ALL"===(null==(y=s.rowData)?void 0:y.sName)&&(null==(h=s.rowData)?void 0:h.id)&&(i.value="全部")})),_((()=>{var e,a;if("path"==s.type&&(p.value=Ce.value.path||"/www/wwwroot",Ce.value.path=p.value),"site"==s.type&&(Ce.value.siteName=["all","ALL"].includes(Ce.value.siteName)?"全部":Ce.value.siteName,i.value=Ce.value.siteName),"site_restart"==s.type&&(s.rowData?i.value=Ce.value.siteName:i.value=null==(a=null==(e=o.value)?void 0:e[0])?void 0:a.name),"database"==s.type)if(s.rowData){i.value=s.rowData.sName;const e=o.value.find((e=>e.name==s.rowData.sName));d("updata:tableOptions",e&&(null==e?void 0:e.table_list)?e:[]),d("updata:backupValue",i.value)}else i.value="全部",d("updata:backupValue","ALL")})),(e,a)=>{var l,t;const s=ne,r=M,d=j,b=A;return k(),D("div",Je,["database"==e.type?(k(),D("span",Xe,P("database"==e.type?"数据库":""),1)):C("",!0),B(r,{prop:"path"},{default:T((()=>{var l;return["path"==e.type?(k(),g(s,{key:0,modelValue:x(p),"onUpdate:modelValue":a[0]||(a[0]=e=>L(p)?p.value=e:null),icon:"el-folder-opened",onIconClick:v,width:"24rem",disabled:!!(null==(l=e.rowData)?void 0:l.id),onInput:m},null,8,["modelValue","disabled"])):C("",!0)]})),_:1}),"path"!=e.type?(k(),g(b,{disabled:!!(null==(l=e.rowData)?void 0:l.id),onChange:c,modelValue:x(i),"onUpdate:modelValue":a[1]||(a[1]=e=>L(i)?i.value=e:null),filterable:"",key:Math.random().toString(),title:(null==(t=x(i))?void 0:t.length)?x(i):"",class:"!w-[20rem]",multiple:x(n)(x(i))&&e.multiple,"collapse-tags":""},{default:T((()=>[(k(!0),D(U,null,S(x(o),((e,a)=>(k(),g(d,{key:a,label:"".concat(e.name+((null==e?void 0:e.ps)?"["+u(e.ps)+"]":"")),value:e.name},null,8,["label","value"])))),128))])),_:1},8,["disabled","modelValue","title","multiple"])):C("",!0)])}}}),[["__scopeId","data-v-4c9ac741"]]),Ye={class:"flex items-center flex-wrap gap-y-[1rem]"},ea={class:"text-[1.2rem] flex items-center"},aa={key:0,class:"ml-[16px] mr-[8px]"},la=o(w({__name:"complex-type-item",props:{backLabel:{default:"备份数据"},type:{default:""},multiple:{type:Boolean,default:!1},tableData:{default:()=>[]},rowData:{default:()=>{}}},setup(e){const a=e,t=h(a.type),s=h(!1),u=h({saveNum:Ce.value.number||3,tableValue:[]}),o=h([]),r=e=>{"object"!=typeof e&&(Ce.value.number=e)},p=e=>{e&&(o.value=null==e?void 0:e.table_list,Ce.value.databaseName=e.name,Ce.value.databaseTable),u.value.tableValue=""},d=e=>{e.length&&""!=e[e.length-1]||(Ce.value.databaseTable=[""]),n(e)&&e.length>1&&""==e[0]?Ce.value.databaseTable=e.filter((e=>""!=e)):n(e)&&e.length>1&&""==e[e.length-1]?Ce.value.databaseTable=[""]:Ce.value.databaseTable=e,u.value.tableValue=Ce.value.databaseTable},c=e=>{Ce.value.path=e},v=e=>{s.value=!!(n(e)&&1===e.length||"string"==typeof e&&"全部"!==e),Ce.value.databaseName=e,Ce.value.databaseTable=[""]};return F((()=>a.type),(e=>{t.value=e}),{immediate:!0}),f((()=>{var e,l,t;a.tableData&&((null==(e=o.value)?void 0:e.length)||(o.value=null==(l=a.tableData[0])?void 0:l.table_list,Ce.value.databaseTable=[""],u.value.tableValue="")),a.rowData&&(u.value.saveNum=a.rowData.save,u.value.tableValue=[],u.value.tableValue.push("database"==a.type?(null==(t=a.rowData)?void 0:t.table_list)||"":a.rowData.sBody),1===u.value.tableValue.length&&(u.value.tableValue=u.value.tableValue[0]))})),_((()=>{})),(e,a)=>{const m=j,b=A,y=M,h=l;return k(),g(y,{label:e.backLabel},{default:T((()=>{var l,w;return[N("div",Ye,[V(e.$slots,"back-before",{},void 0,!0),B(Ke,{rowData:e.rowData,type:x(t),databaseList:e.tableData,multiple:e.multiple,"onUpdata:tableOptions":p,"onUpdata:backupDrop":c,"onUpdata:backupValue":v},null,8,["rowData","type","databaseList","multiple"]),"enterpriseBackup"==e.type&&(null==(l=x(o))?void 0:l.length)>0||"database"==e.type&&!x(i)&&"mysql"==x(Ce).databaseType&&(null==(w=x(o))?void 0:w.length)>0&&x(s)?(k(),g(y,{key:0,class:"ml-[12px]"},{default:T((()=>{var l,t;return[B(b,{title:x(n)(x(u).tableValue)?null==(l=x(u).tableValue)?void 0:l.join("\n"):x(u).tableValue,modelValue:x(u).tableValue,"onUpdate:modelValue":a[0]||(a[0]=e=>x(u).tableValue=e),multiple:x(n)(x(u).tableValue),filterable:"",onChange:d,"collapse-tags":"","empty-values":[null,void 0],class:"!w-[20rem]",disabled:!!(null==(t=e.rowData)?void 0:t.id)},{default:T((()=>[(k(!0),D(U,null,S(x(o),(e=>(k(),g(m,{key:e.value,label:e.tb_name,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["title","modelValue","multiple","disabled"])]})),_:1})):C("",!0),"site_restart"!==e.type?(k(),g(Ze,{key:1,rowData:e.rowData,type:e.type},null,8,["rowData","type"])):C("",!0),"site_restart"!==e.type&&"enterpriseBackup"!==e.type?(k(),g(y,{key:2,prop:"save",class:"!mt-0 anotherClass"},{default:T((()=>[N("div",ea,["special_log"!=e.type?(k(),D("span",aa,"保留最新")):C("",!0),B(h,{modelValue:x(u).saveNum,"onUpdate:modelValue":a[1]||(a[1]=e=>x(u).saveNum=e),onChange:r,type:"number",width:"12rem",class:"!w-12rem",min:1,textType:"份"},{append:T((()=>a[2]||(a[2]=[E(" 份 ")]))),_:1},8,["modelValue"])])])),_:1})):C("",!0)])]})),_:3},8,["label"])}}}),[["__scopeId","data-v-429b14a8"]]),ta={class:"flex items-center"},sa=w({__name:"file-split-item",props:{rowData:{default:()=>{}}},emits:["update:backServer"],setup(e,{emit:a}){var t;const s=e,u=h(!(!s.rowData||"localhost"!=s.rowData.backupTo)),o=[{name:"不拆分",value:"0"},{name:"按文件大小拆分",value:"size"},{name:"按数量拆分",value:"num"}],n=h((null==(t=s.rowData)?void 0:t.split_type)||"0"),r=e=>{"num"==e?Be.value.fileNum=5:"size"==e&&(Be.value.fileNum=1024),Be.value.fileType=e},i=e=>{Be.value.fileNum=Number(e.target.value)};return f((()=>{s.rowData&&(Be.value.fileNum=s.rowData.split_value,Be.value.fileType=s.rowData.split_type)})),F((()=>Ce.value.backServer),(e=>{u.value="localhost"==e,"localhost"==e&&(n.value="0")}),{immediate:!0}),(e,a)=>{const t=j,s=A,p=l,d=M;return k(),g(d,{label:"文件拆分"},{default:T((()=>[N("div",ta,[B(s,{modelValue:x(n),"onUpdate:modelValue":a[0]||(a[0]=e=>L(n)?n.value=e:null),class:"mr-[4px] !w-[13rem]",onChange:r,disabled:x(u)},{default:T((()=>[(k(),D(U,null,S(o,(e=>B(t,{key:e.value,label:e.name,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue","disabled"]),"0"!==x(n)?(k(),D("div",{key:0,onInput:i,class:"text-[1.2rem] flex items-center"},[B(p,{modelValue:x(Be).fileNum,"onUpdate:modelValue":a[1]||(a[1]=e=>x(Be).fileNum=e),type:"number",width:"14rem"},{append:T((()=>[E(P("num"==x(n)?"个":"MB"),1)])),_:1},8,["modelValue"])],32)):C("",!0),a[2]||(a[2]=N("span",{class:"text-[#666] text-[1.2rem] leading-8 ml-8x"},"*为避免文件过大导致上传失败，可以选择按大小或数量拆分。仅文件超过 5GB 时支持拆分，小文件请忽略 ",-1))])])),_:1})}}}),ua={class:"flex items-center"},oa={class:"defineClass"},na={class:"flex items-center"},ra={class:"flex items-center"},ia={class:"flex items-center"},pa={class:"flex items-center"},da=o(w({__name:"alert-form-item",props:{isCronTab:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1},showKeyword:{type:Boolean,default:!1},showNotice:{type:Boolean,default:!0},needAll:{type:Boolean,default:!1},showSecond:{type:Boolean,default:!1},isTask:{type:Boolean,default:!1},labelWidth:{default:""},showStopWeb:{type:Boolean,default:!1},stopSite:{type:Boolean,default:!0}},emits:["crontab","siteWeb"],setup(e,{expose:a,emit:t}){const s=e,u=h(s.stopSite),o=t,n=h(),r=h(0),i=h(!1);let d=h([{type:"day",text:"每天",showDay:!1,showHour:!0,showMinute:!0,showSecond:!1},{type:"day-n",text:"N天",showDay:!0,showHour:!0,showMinute:!0,showSecond:!1},{type:"hour",text:"每小时",showDay:!1,showHour:!1,showMinute:!0,showSecond:!1},{type:"hour-n",text:"N小时",showDay:!1,showHour:!0,showMinute:!0,showSecond:!1},{type:"minute-n",text:"N分钟",showDay:!1,showHour:!1,showMinute:!0,showSecond:!1},{type:"week",text:"每周",showDay:!1,showHour:!0,showMinute:!0,showSecond:!1},{type:"month",text:"每月",showDay:!0,showHour:!0,showMinute:!0,showSecond:!1}]);const c=Q({where1:[{validator:(e,a,l)=>{"day-n"===Se.value.type||"month"===Se.value.type?Number.parseInt(a)>31||Number.parseInt(a)<1||!Number.isInteger(parseFloat(a))?l(new Error("请输入1-31的整数")):""===a?l(new Error("请输入天数")):l():l()},trigger:["blur","change"]}],hour:[{validator:(e,a,l)=>{"minute-n"!==Se.value.type&&"hour"!==Se.value.type&&"second-n"!==Se.value.type||l(),Number.parseInt(a)>23||Number.parseInt(a)<0||!Number.isInteger(parseFloat(a))?l(new Error("请输入0-23的整数")):""===a?l(new Error("请输入小时")):"hour-n"===Se.value.type&&0===Number.parseInt(a)?l(new Error("小时不能为0")):l()},trigger:["blur","change"]}],minute:[{validator:(e,a,l)=>{Number.parseInt(a)>59||Number.parseInt(a)<0||!Number.isInteger(parseFloat(a))?l(new Error("请输入0-59的整数")):""===a?l(new Error("请输入分钟")):"minute-n"===Se.value.type&&(Number.parseInt(a)<1||!/^[1-9]\d*$/.test(a))?l(new Error("请输入1-59的整数")):l()},trigger:["blur","change"]}],second:[{validator:(e,a,l)=>{"second-n"===Se.value.type?!Number.isInteger(parseFloat(a))||Number.parseInt(a)>59||Number.parseInt(a)<1?l(new Error("请输入1-59的整数")):""===a?l(new Error("请输入秒")):l():l()},trigger:["blur","change"]}],timeSet:[{validator:(e,a,l)=>{"sweek"!==Se.value.type||a.length?l():l(new Error("请选择时间"))},trigger:"change"}],specialHour:[{validator:(e,a,l)=>{"sweek"!==Se.value.type||a.length?l():l(new Error("请选择小时"))},trigger:"change"}],specialMinute:[{validator:(e,a,l)=>{"sweek"!==Se.value.type||a.length?l():l(new Error("请选择分钟"))},trigger:"change"}]}),v=e=>{Ue.value.noticeChannel=e},m=e=>{n.value.clearValidate()},b=e=>{Ue.value.notice=e,1===e&&(Ue.value.noticeChannel="all")},y=(e,a=!1)=>{s.isEdit||(Ue.value.notice=0,a&&He()),Se.value.type=e,r.value=d.value.findIndex((a=>a.type===e)),"minute-n"===Se.value.type&&(Se.value.where1=Se.value.minute),"hour-n"===Se.value.type&&(Se.value.where1=Se.value.hour),"second-n"===Se.value.type?(Ue.value.flock=!1,i.value=!0):i.value=!1,n.value&&n.value.clearValidate(),o("crontab","custom"==e)};f((()=>{y(Se.value.type)})),_((()=>{y(Se.value.type,!0),s.isCronTab&&s.showSecond&&d.value.push({type:"second-n",text:"N秒",showDay:!1,showHour:!1,showMinute:!1,showSecond:!0}),s.isCronTab&&d.value.push({type:"sweek",text:"自定义",showDay:!1,showHour:!0,showMinute:!0,showSecond:!1}),s.isTask&&d.value.push({type:"custom",text:"自定义",showDay:!1,showHour:!1,showMinute:!1,showSecond:!1})}));const w=e=>{o("siteWeb",e)};return a({form:n}),(e,a)=>{const t=j,s=A,o=M,h=l,f=$,_=W,I=p,O=ue,H=G;return k(),D("div",null,[B(H,{ref_key:"form",ref:n,rules:x(c),"label-width":e.labelWidth,inline:!0,model:x(Se),class:"demo-form-inline"},{default:T((()=>[B(o,{class:"!w-full"},{default:T((()=>[B(o,{label:"执行周期"},{default:T((()=>{var l,u,n,i;return[N("div",ua,[B(o,{class:"el-form-item-item"},{default:T((()=>[B(s,{onChange:a[0]||(a[0]=e=>y(x(Se).type,!0)),class:"!w-[8rem]",modelValue:x(Se).type,"onUpdate:modelValue":a[1]||(a[1]=e=>x(Se).type=e)},{default:T((()=>[(k(!0),D(U,null,S(x(d),((a,l)=>(k(),D(U,null,["second-n"!==a.type||e.showSecond?(k(),g(t,{key:l,label:a.text,value:a.type},null,8,["label","value"])):C("",!0)],64)))),256))])),_:1},8,["modelValue"])])),_:1}),e.isCronTab&&"sweek"==x(Se).type?(k(),D(U,{key:0},[B(o,{class:"el-form-item-item"},{default:T((()=>[B(s,{class:"!w-[8rem]",modelValue:x(Se).timeType,"onUpdate:modelValue":a[2]||(a[2]=e=>x(Se).timeType=e),onChange:m},{default:T((()=>[B(t,{label:"每天",value:"sday"}),B(t,{label:"每周",value:"sweek"}),B(t,{label:"每月",value:"smonth"})])),_:1},8,["modelValue"])])),_:1}),"sweek"===x(Se).timeType?(k(),g(o,{key:0,class:"el-form-item-item",prop:"timeSet"},{default:T((()=>[B(s,{class:"!w-[16rem]",modelValue:x(Se).timeSet,"onUpdate:modelValue":a[3]||(a[3]=e=>x(Se).timeSet=e),multiple:"","collapse-tags":""},{default:T((()=>[B(t,{label:"周一",value:"1"}),B(t,{label:"周二",value:"2"}),B(t,{label:"周三",value:"3"}),B(t,{label:"周四",value:"4"}),B(t,{label:"周五",value:"5"}),B(t,{label:"周六",value:"6"}),B(t,{label:"周日",value:"7"})])),_:1},8,["modelValue"])])),_:1})):C("",!0),"smonth"===x(Se).timeType?(k(),g(o,{key:1,class:"el-form-item-item",prop:"timeSet"},{default:T((()=>[B(s,{class:"!w-[14rem] cycle-select",modelValue:x(Se).timeSet,"onUpdate:modelValue":a[4]||(a[4]=e=>x(Se).timeSet=e),multiple:"","collapse-tags":"","collapse-tags-tooltip":""},{default:T((()=>[(k(),D(U,null,S(30,((e,a)=>B(t,{key:e,label:e,value:"".concat(e)},null,8,["label","value"]))),64))])),_:1},8,["modelValue"]),a[17]||(a[17]=N("span",{class:"el-input-group__append cycle-unit"},"号",-1))])),_:1})):C("",!0),B(o,{class:"el-form-item-item",prop:"specialHour"},{default:T((()=>[B(s,{class:"!w-[14rem] cycle-select",modelValue:x(Se).specialHour,"onUpdate:modelValue":a[5]||(a[5]=e=>x(Se).specialHour=e),multiple:"","collapse-tags":""},{default:T((()=>[(k(),D(U,null,S(24,((e,a)=>B(t,{key:a,label:a,value:a},null,8,["label","value"]))),64))])),_:1},8,["modelValue"]),a[18]||(a[18]=N("span",{class:"el-input-group__append cycle-unit"},"点",-1))])),_:1}),B(o,{class:"el-form-item-item",prop:"specialMinute"},{default:T((()=>[B(s,{class:"!w-[14rem] cycle-select",modelValue:x(Se).specialMinute,"onUpdate:modelValue":a[6]||(a[6]=e=>x(Se).specialMinute=e),multiple:"","collapse-tags":""},{default:T((()=>[(k(),D(U,null,S(60,((e,a)=>(k(),D(U,null,[a%5==0?(k(),g(t,{key:a,label:a,value:a},null,8,["label","value"])):C("",!0)],64)))),64))])),_:1},8,["modelValue"]),a[19]||(a[19]=N("span",{class:"el-input-group__append cycle-unit"},"分",-1))])),_:1})],64)):(k(),D(U,{key:1},["week"==x(Se).type?(k(),g(o,{key:0,class:"el-form-item-item"},{default:T((()=>[B(s,{class:"!w-[8rem]",modelValue:x(Se).week,"onUpdate:modelValue":a[7]||(a[7]=e=>x(Se).week=e)},{default:T((()=>[B(t,{label:"周一",value:"1"}),B(t,{label:"周二",value:"2"}),B(t,{label:"周三",value:"3"}),B(t,{label:"周四",value:"4"}),B(t,{label:"周五",value:"5"}),B(t,{label:"周六",value:"6"}),B(t,{label:"周日",value:"7"})])),_:1},8,["modelValue"])])),_:1})):C("",!0),(null==(l=x(d)[x(r)])?void 0:l.showDay)?(k(),g(o,{key:1,class:"el-form-item-item",prop:"where1"},{default:T((()=>[B(h,{modelValue:x(Se).where1,"onUpdate:modelValue":a[8]||(a[8]=e=>x(Se).where1=e),min:1,width:"10rem",textType:"天",type:"number"},{append:T((()=>a[20]||(a[20]=[E(" 天 ")]))),_:1},8,["modelValue"])])),_:1})):C("",!0),(null==(u=x(d)[x(r)])?void 0:u.showHour)?(k(),g(o,{key:2,class:"el-form-item-item",prop:"hour"},{default:T((()=>[B(h,{modelValue:x(Se).hour,"onUpdate:modelValue":a[9]||(a[9]=e=>x(Se).hour=e),width:"10rem",textType:"小时",max:"23",min:"0",type:"number"},{append:T((()=>a[21]||(a[21]=[E(" 小时 ")]))),_:1},8,["modelValue"])])),_:1})):C("",!0),(null==(n=x(d)[x(r)])?void 0:n.showMinute)?(k(),g(o,{key:3,class:"el-form-item-item",prop:"minute"},{default:T((()=>{var e;return[(null==(e=x(d)[x(r)])?void 0:e.showMinute)?(k(),g(h,{key:0,modelValue:x(Se).minute,"onUpdate:modelValue":a[10]||(a[10]=e=>x(Se).minute=e),width:"10rem",max:"59",min:"0",type:"number"},{append:T((()=>a[22]||(a[22]=[E(" 分钟 ")]))),_:1},8,["modelValue"])):C("",!0)]})),_:1})):C("",!0),(null==(i=x(d)[x(r)])?void 0:i.showSecond)?(k(),g(o,{key:4,class:"el-form-item-item",prop:"second"},{default:T((()=>{var e;return[(null==(e=x(d)[x(r)])?void 0:e.showSecond)?(k(),g(h,{key:0,modelValue:x(Se).second,"onUpdate:modelValue":a[11]||(a[11]=e=>x(Se).second=e),width:"10rem",max:"59",min:"0",type:"number"},{append:T((()=>a[23]||(a[23]=[E(" 秒 ")]))),_:1},8,["modelValue"])):C("",!0)]})),_:1})):C("",!0)],64))])]})),_:1}),N("div",oa,[e.isCronTab?(k(),g(o,{key:0,label:" ",class:"!mt-0 defineClass"},{default:T((()=>[N("div",na,[B(f,{modelValue:x(Ue).flock,"onUpdate:modelValue":a[12]||(a[12]=e=>x(Ue).flock=e),disabled:x(i)},{default:T((()=>a[24]||(a[24]=[E(" 开启进程锁")]))),_:1},8,["modelValue","disabled"]),B(_,{placement:"right-start",width:"440","popper-class":"white-tips-popover",trigger:"hover",content:""},{default:T((()=>a[25]||(a[25]=[N("div",{class:"p-12x"},[N("span",{class:"text-[#666]"}," 在同一时间内只用一个进程在执行，若上一个进程未执行结束，下一次不执行 ")],-1),N("i",{slot:"reference",class:"el-icon-question text-warning ml-12x"},null,-1)]))),_:1})])])),_:1})):C("",!0),e.showStopWeb?(k(),g(o,{key:1,label:" ",class:"!mt-0 defineClass"},{default:T((()=>[N("div",ra,[B(f,{modelValue:x(u),"onUpdate:modelValue":a[13]||(a[13]=e=>L(u)?u.value=e:null),onChange:w},{default:T((()=>a[26]||(a[26]=[E(" 网站停用时是否停止备份")]))),_:1},8,["modelValue"]),B(_,{placement:"right-start",width:"220","popper-class":"white-tips-popover",trigger:"hover",content:""},{reference:T((()=>a[27]||(a[27]=[N("i",{class:"svgtofont-el-question-filled text-warning ml-[12px]"},null,-1)]))),default:T((()=>[a[28]||(a[28]=N("span",{class:"text-[#666]"}," 该功能不支持反向代理和html项目 ",-1))])),_:1})])])),_:1})):C("",!0)])])),_:1}),V(e.$slots,"center",{},void 0,!0),e.showNotice?(k(),g(o,{key:0,label:"备份提醒",prop:"notice",class:"!mt-1.6rem"},{default:T((()=>[N("div",ia,[B(I,{class:"!w-[20rem]",modelValue:x(Ue).notice,"onUpdate:modelValue":a[14]||(a[14]=e=>x(Ue).notice=e),options:x(xe),onChange:b},null,8,["modelValue","options"]),1===x(Ue).notice?(k(),g(o,{key:0,label:"消息通道"},{default:T((()=>[B(O,{modelValue:x(Ue).noticeChannel,"onUpdate:modelValue":a[15]||(a[15]=e=>x(Ue).noticeChannel=e),multiple:!1,options:[{label:"全部通道",value:"all"}],onChange:v,class:"!w-16rem"},null,8,["modelValue"])])),_:1})):C("",!0),q(B(o,{label:"关键词匹配",class:"!mt-0"},{default:T((()=>[N("div",pa,[B(_,{placement:"top-start",width:"290","popper-class":"white-tips-popover",trigger:"focus",content:""},{default:T((()=>[a[29]||(a[29]=N("div",{class:"p-[12px]"},[N("div",null,[E("1、在shell程序中不要"),N("span",{class:"text-danger"},"中断"),E("执行如（exit等）")]),N("div",null,[E("2、输出"),N("span",{class:"text-danger"},"关键词"),E("（建议5位且程序中不会出现）")]),N("div",null,[E("3、匹配到关键词"),N("span",{class:"text-danger"},"发送告警")])],-1)),B(h,{slot:"reference",class:"mr-[4px]",modelValue:x(Ue).keyword,"onUpdate:modelValue":a[16]||(a[16]=e=>x(Ue).keyword=e),disabled:e.isEdit,width:"16rem",placeholder:"请输入关键词",type:"text"},null,8,["modelValue","disabled"])])),_:1})])])),_:1},512),[[z,e.showKeyword&&1===x(Ue).notice]])])])),_:1})):C("",!0),V(e.$slots,"bottom",{},void 0,!0)])),_:3},8,["rules","label-width","model"])])}}}),[["__scopeId","data-v-2728988a"]]),ca={class:"p-[2rem] add-task"},va={class:"flex items-center"},ma={style:{float:"left"}},ba={key:0,style:{float:"right"}},ya={key:1,class:"flex items-baseline"},ha=["innerHTML"],wa={class:"text-[1.2rem] text-[#666] flex items-center h-full"},fa={class:"text-[1.2rem] text-[#666] flex items-center h-full"},_a={key:0,class:"el-input-group__append"},ka={class:"ml-[8px]"},ga={key:1,class:"text-danger text-[1.2rem]"},Ta={class:"w-[56rem]"},Na={class:"flex items-center"},Va={class:"min-h-[3.2rem] flex items-center"},xa=w({__name:"index",setup(a,{expose:t}){var o,r,i,w,V,I,H;const R=y(),{payment:q,panel:z,push:ce}=e(),{backupPath:xe}=Z(z.value),{authType:Re}=Z(q.value),Pe=fe(),{rowData:qe}=J(Pe),Fe=h(Ne),$e=h(),We=h(qe.value&&""!==qe.value.log_cut_path?2:1),Ge=h(qe.value&&""!==qe.value.log_cut_path?qe.value.log_cut_path.replace(/,/g,"\n"):""),Ze=h(["mail","dingding","feishu","weixin","sms","wx_account"]),Je=Q({type:qe.value?qe.value.sType:"toShell",taskName:qe.value?qe.value.rname||qe.value.name:"",inputData:qe.value?"toUrl"===qe.value.sType||"to_post"===qe.value.sType?qe.value.urladdress:qe.value.sBody:"",zone:["Asia","Shanghai"],save:qe.value?qe.value.save:Number(Ce.value.number),otherTypeSiteName:"",postParam:qe.value&&"to_post"===qe.value.sType?qe.value.post_param?JSON.parse(qe.value.post_param):[]:[{paramName:"",paramValue:""}],stopTime:(null==(o=qe.value)?void 0:o.special_time)?qe.value.special_time.split(",")[1]:null,startTime:(null==(r=qe.value)?void 0:r.special_time)?qe.value.special_time.split(",")[0]:null,clearType:qe.value?""!==qe.value.log_cut_path?[]:qe.value.sName.split(","):[],userAgent:qe.value?qe.value.user_agent:"",version:qe.value?qe.value.version:"",stop_site:!!qe.value&&Boolean(Number(qe.value.stop_site))}),Xe=h(),Ke=h(),Ye=h("toShell"),ea=h(!!(null==(i=qe.value)?void 0:i.save_local)),aa=h(!!(null==(w=qe.value)?void 0:w.backup_mode)),ta=h(qe.value?"logs"===qe.value.sType?null==(V=qe.value)?void 0:V.log_cut_path:null==(I=qe.value)?void 0:I.db_backup_path:xe.value),ua=h([]),oa=h(!1),na=h(!1),ra=h(qe.value?"toUrl"===qe.value.sType||"to_post"===qe.value.sType?qe.value.urladdress:"mysql_increment_backup"===qe.value.sType||"enterpriseBackup"===qe.value.sType?"":(null==(H=qe.value)?void 0:H.sBody)||"":""),ia=h(qe.value&&"toShell"===qe.value.sType?qe.value.user:""),pa=h({isZoneListLoaded:!1,isSiteListLoaded:!1,isMsgConfigLoaded:!1,isDatabaseListLoaded:!1});X((()=>{let e=[],a=Number(Se.value.minute);if(a>0&&a<60){for(let l=a;l<60;l+=a)e.push(l);return e.unshift(0),e}return[]}));const xa=e=>!isNaN(Number(e))&&Number(e)<10?"0"+e:e,La=X((()=>{var e,a,l,t,s;let u="",o={1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六",7:"周日"},n=Se.value.type,r=(null==(e=Se.value.hour)?void 0:e.toString())||"--",i=(null==(a=Se.value.minute)?void 0:a.toString())||"--",p=(null==(l=Se.value.where1)?void 0:l.toString())||"--",d=(null==(t=Se.value.week)?void 0:t.toString())||"--",c=(null==(s=Se.value.second)?void 0:s.toString())||"--";if(["day","day-n","hour","week","month","minute-n","hour-n","second-n"].includes(n)){const e="".concat(xa(r),":").concat(xa(i)," 执行一次");switch(n){case"day":u="每天的 ".concat(e);break;case"day-n":u="每隔 ".concat(p," 天的 ").concat(e);break;case"hour":u="每小时的第 ".concat(i," 分钟执行一次");break;case"week":u="每周 ".concat(o[d]," 的 ").concat(e);break;case"month":u="每月 ".concat(p," 号 ").concat(e);break;case"minute-n":u="每小时的第0分钟开始，每隔 ".concat(i," 分钟执行一次");break;case"hour-n":u="每天0点开始，每隔 ".concat(r," 小时的第 ").concat(i," 分钟执行一次");break;case"second-n":u="每隔 ".concat(c," 秒执行一次")}}else u="";return u}));F((()=>Je.type),(e=>{ta.value="logs"===e?"/www/wwwlogs":xe.value}));const Da=h(De(Xe.value,Je)),Sa=e=>{e.row.xh=e.rowIndex+1},Ua=e=>{Ue.value.noticeChannel=e},Ca=e=>{},Ba=()=>{se({type:"dir",change:e=>{const a=Ge.value.split("\n").filter((e=>""!==e));a.push(e),Ge.value=a.join("\n"),Je.taskName="日志清理[".concat(a.length>0?a[0]:"").concat(a.length>1?"...等".concat(a.length,"项"):"","]")}})},Ea=()=>{se({type:"dir",path:ta.value,change:e=>{ta.value=e}})},Aa=e=>{var a,l;e.length>1&&(null==(a=Ke.value)||a.clearSelection(),null==(l=Ke.value)||l.toggleRowSelection(e.pop()))},Ma=()=>{Je.postParam.push({paramName:"",paramValue:""})},Ia=e=>{var a,l,t,s;if(Ye.value=e,ua.value=[],oa.value=!1,"enterpriseBackup"===e&&"enterprise"!==q.value.authType){const e=document.querySelector(".el-dialog__footer .el-button--primary span");(null==e?void 0:e.innerHTML)&&(e.innerHTML="升级为企业版")}else{const e=document.querySelector(".el-dialog__footer .el-button--primary");(null==e?void 0:e.innerHTML)&&(e.innerHTML="确定")}switch(e){case"enterpriseBackup":ja(),oa.value=!0,Je.taskName="[勿删]数据库增量备份[ "+((null==(a=Me.value[0])?void 0:a.name)||"")+" ]",Ce.value.backServer="localhost";break;case"site":Je.taskName="备份网站[所有]",oa.value=!0,Ce.value.siteName="全部";break;case"site_restart":const e=je.value;Je.taskName="网站启停["+(null==(l=e[0])?void 0:l.name)+"]",oa.value=!0,Ce.value.siteName=null==(t=e[0])?void 0:t.name;break;case"database":Je.taskName="备份MySQL数据库[所有]",Ce.value.databaseName=["全部"],oa.value=!0;break;case"logs":oa.value=!0,Je.taskName="切割日志[所有]";break;case"webshell":oa.value=!0,Je.taskName="木马查杀[所有]",Ue.value.noticeChannel="";break;case"log_cleanup":Je.taskName="日志清理";break;case"rememory":Je.taskName="释放内存";break;case"toUrl":Je.taskName="访问URL-[ http:// ]";break;case"to_post":Je.taskName="访问URL-POST[ http:// ]";break;case"syncTime":Je.taskName="定期同步服务器时间["+Je.zone[0]+"/"+Je.zone[1]+"]";break;case"path":Ce.value.backServer="/www/wwwroot",Je.taskName="备份目录[/www/wwwroot ]";break;case"startup_services":Je.taskName="开机自启动[所有]";break;default:Je.taskName=""}Ya(e),Ce.value.backServer="localhost",Ce.value.number=3,ra.value="",Ga(),null==(s=Xe.value)||s.clearValidate()},ja=async()=>{try{const e=await ve();ua.value=e.data.data}catch(e){}},Oa=async()=>{if(!d(Je.inputData))return R.error("请输入正确的url地址");{const a=R.load("正在测试，请稍候...");try{const e=await me({url:Je.inputData});c({title:"测试URL结果",area:59,component:()=>v((()=>import("./index354.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),compData:{result:e.data}})}catch(e){}finally{a.close()}}},Ha=e=>{var a;if(Je.inputData=e,!(null==(a=qe.value)?void 0:a.id)){const a=Je.taskName.indexOf("访问URL-")>-1;"toUrl"===Ye.value&&a&&(Je.taskName="访问URL-GET[ "+e+" ]"),"to_post"===Ye.value&&a&&(Je.taskName="访问URL-POST[ "+e+" ]")}"special_log"===Ye.value&&(Je.taskName="指定["+e+"]日志切割")},Ra=e=>{switch(e){case 1:qa(Je.clearType);break;case 2:Pa()}},Pa=()=>{let e=Ge.value.split("\n");Je.taskName="日志清理[".concat(e.length>0?e[0]:"").concat(e.length>1?"...等".concat(e.length,"项"):"","]")},qa=e=>{var a;let l=(null==(a=Ve.value.find((a=>a.value===e[0])))?void 0:a.label)||"";Je.clearType=e,Je.taskName="日志清理[".concat(l).concat(e.length>1?"...等".concat(e.length,"项"):"","]")},za=async()=>{c({title:"选择脚本",area:40,component:()=>v((()=>import("./index355.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),compData:{inputData:ra.value,value:Je.inputData},showFooter:!0})},Fa=e=>{Je.taskName="定期同步服务器时间["+e[0]+"/"+e[1]+"]",Je.zone=[e[0],e[1]]},Qa=e=>{Je.save=e,Ce.value.number=e},$a=e=>{Je.taskName="".concat("webshell"===Je.type?"木马查杀":"切割日志","[").concat("all"===e?"所有":e,"]"),Je.otherTypeSiteName="all"===e?"ALL":e},Wa=async()=>{var e,a,l;const t=await(async()=>{var e;let a={name:Je.taskName,...Se.value,sType:Ye.value,sBody:"",sName:"",backupTo:"",save:Ce.value.number,urladdress:"toUrl"===Ye.value||"to_post"===Ye.value?Je.inputData:"",save_local:ea.value?1:0,notice:Ue.value.notice?1:0,notice_channel:Ue.value.notice?Ue.value.noticeChannel:"",datab_name:"",tables_name:"",keyword:Ue.value.keyword?Ue.value.keyword:"",flock:Ue.value.flock?1:0,stop_site:Je.stop_site?1:0};if("all"===a.notice_channel&&(a.notice_channel=Ze.value.join(",")),["site","database","enterpriseBackup","path"].includes(Ye.value)&&(a.backupTo=Ce.value.backServer),"syncTime"===Ye.value&&(a.region=Je.zone[0],a.zone=Je.zone[1],a.sType="sync_time",a.sName=Je.zone[0]+"/"+Je.zone[1]),["toShell","path","site"].includes(Ye.value)&&(a.sBody=Je.inputData),"logs"===Ye.value&&(a.sName=Je.otherTypeSiteName||"ALL",a.log_cut_path=ta.value),"special_log"===Ye.value&&(a.sName=Je.inputData),"site"==Ye.value&&(a.sName=n(Ce.value.siteName)?Ce.value.siteName.includes("全部")?"ALL":Ce.value.siteName.join(","):Ce.value.siteName),"database"===Ye.value&&(a.db_type=Ce.value.databaseType,a.sName=n(Ce.value.databaseTable)?Ce.value.databaseTable.includes("全部")||Ce.value.databaseTable.includes("")?"ALL":Ce.value.databaseTable.join(","):Ce.value.databaseTable,a.backup_mode=aa.value?1:0,"mysql"===Ce.value.databaseType&&(a.db_name=Ce.value.databaseName,a.datab_name=Ce.value.databaseName,a.table_list=n(Ce.value.databaseTable)?Ce.value.databaseTable.join(","):Ce.value.databaseTable,a.sName=n(Ce.value.databaseName)?Ce.value.databaseName.includes("全部")?"ALL":Ce.value.databaseName.join(","):Ce.value.databaseName),"mysql"!==Ce.value.databaseType&&(a.sName=Ce.value.databaseName)),"database"!==Ye.value&&"site"!==Ye.value&&"path"!==Ye.value||(a.split_type="0"===Be.value.fileType?"":Be.value.fileType,a.split_value=Be.value.fileNum,a.save=Ce.value.number,a.more="ALL",a.db_backup_path=ta.value),"enterpriseBackup"===Ye.value&&(a.zip_password=Je.inputData,a.db_name=Ce.value.databaseName,a.datab_name=Ce.value.databaseName,a.tb_name=n(Ce.value.databaseTable)?Ce.value.databaseTable.join(","):Ce.value.databaseTable,a.backupTo=n(a.backupTo)?a.backupTo.join("|"):a.backupTo),"path"===Ye.value&&(a.sName=Ce.value.path),qe.value&&(a.id=qe.value.id),"to_post"===Ye.value){let e=[];Je.postParam.forEach((a=>{(a.paramName||a.paramValue)&&e.push(a)})),a.post_param=JSON.stringify(e)}if("sweek"===a.type){a.time_set=a.timeSet.join(","),delete a.timeSet,a.time_type=a.timeType,delete a.timeType,a.where1="5",a.hour="1",a.minute="5",a.week="1";let e=[];a.specialHour.forEach((l=>{a.specialMinute.forEach((a=>{e.push((l<10?"0"+l:l)+":"+(a<10?"0"+a:a)),e=Array.from(new Set(e))}))})),a.special_time=e.join(",")}if("site_restart"==Ye.value){const l=je.value;a.special_time=Je.startTime+","+Je.stopTime,a.sName=["ALL","all","全部","所有"].includes(Ce.value.siteName)?null==(e=l[0])?void 0:e.name:Ce.value.siteName,a.save="",a.where1="5",a.hour="1",a.minute="5",a.week="1",a.type="minute-n"}return"log_cleanup"==Ye.value&&(1===We.value?a.sName=Je.clearType.join(","):(a.sName="user_config",a.log_cut_path=Ge.value.replace(/\n/g,",")),a.save=""),"toUrl"!==Ye.value&&"to_post"!==Ye.value||(a.user_agent=Je.userAgent,a.save=""),"toShell"===Ye.value&&(a.version=Je.version,a.save="",a.user=ia.value),"startup_services"===Ye.value&&(a.type="",a.where1="",a.hour="",a.minute="",a.save="",a.sBody=Je.inputData),"webshell"===Ye.value&&(a.save="",a.sName=Je.otherTypeSiteName||"ALL",a.urladdress=Ue.value.noticeChannel),a.second="second-n"===a.type?a.second:"",delete a.specialHour,delete a.specialMinute,a.sName=["全部","所有"].includes(a.sName)?"ALL":a.sName,a})();let s,u;try{if(1===t.notice&&""===t.notice_channel)return R.error("请选择消息通道"),!1;if("webshell"===t.sType&&!t.urladdress)return R.error("请选择消息通道"),!1;if(!qe.value&&"sync_time"===t.sType&&_e.value.some((e=>"sync_time"===e.sType)))return R.error("已有同步时间任务，请勿重复添加"),!1;if("log_cleanup"===t.sType){if(1===We.value&&""===t.sName)return R.error("请选择清理类型"),!1;if(2===We.value&&""===t.log_cut_path)return R.error("请选择清理目录"),!1}return"rememory"!==t.sType&&"sync_time"!==t.sType||(t.save=""),await Xe.value.validate(),u=R.load("正在提交，请稍候..."),s=(null==(e=qe.value)?void 0:e.id)&&"enterpriseBackup"!==Ye.value?await be(t):(null==(a=qe.value)?void 0:a.id)&&"enterpriseBackup"===Ye.value?await ye(t):(null==(l=qe.value)?void 0:l.id)||"enterpriseBackup"!==Ye.value?await we(t):await he(t),u.close(),s.msg.includes("系统加固")?void c({title:"临时关闭系统加固",area:44,component:()=>v((()=>import("./index356.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),showFooter:!0}):(R.request(s),s.status&&(ke(),Ga()),s.status)}catch(o){u.close()}},Ga=()=>{He(),Object.assign(Ce.value,{databaseType:"mysql",databaseName:"all",databaseTable:[""],siteName:"all",number:3,backServer:"localhost",path:""}),Object.assign(Be.value,{fileNum:5,isSplit:!1,fileType:"0"})},Za=async e=>{Ce.value.databaseType=e;const a=await ie({db_type:e});Me.value=a.data},Ja=()=>{se({type:"file",path:"/www/wwwlogs",change:e=>{ra.value=e}})},Xa=X((()=>{var e;const a=Ye.value,l=Ce.value.backServer,t=!!qe.value,s=!!(null==(e=Te.value[a])?void 0:e.backLabel);return!!(s&&"localhost"!==l&&"enterpriseBackup"!==a||t&&s&&"localhost"!==l)})),Ka=(e,a,l)=>{let t="string"==typeof Ce.value.databaseName&&"mysql"==Ce.value.databaseType&&"database"===Ye.value&&Ce.value.databaseName!==a[0]&&"全部"!==Ce.value.databaseName?Ce.value.databaseName:"";if("ALL"===Ce.value.databaseName&&(t=""),n(a)&&0===a.length)return Je.taskName="".concat(e,"[").concat(l,"]");"string"==typeof a&&(a=[a]);const s=n(Ce.value.databaseTable)?Ce.value.databaseTable.join(","):Ce.value.databaseTable;n(a)&&(a.includes("全部")||a.includes("ALL")||a.includes(""))?Je.taskName="".concat(e,"[").concat(t||"所有"," ").concat(t?" - "+(s||"所有"):"","]"):Je.taskName="".concat(e,"[ ").concat(t?t+" - ":"").concat((null==a?void 0:a[0])||""," ]")};F((()=>Ce.value.path),(e=>{"path"===Je.type&&(Je.taskName="备份目录[ "+e+" ]")})),F((()=>Ce.value.number),(e=>{Je.save=Number(Ce.value.number)})),F((()=>Le.value.scriptText),(e=>{var a;"toShell"===Ye.value&&(ra.value=e,Je.inputData=e,(null==(a=Xe.value)?void 0:a.clearValidat)&&Xe.value.clearValidate())})),F((()=>Le.value.args),(e=>{Je.version=e})),f((()=>{var e,a,l,t,s;if(Ce.value.siteName||Ce.value.databaseName||Ce.value.databaseTable){if("site"===Ye.value&&!(null==(e=qe.value)?void 0:e.id)){const e="all"===Ce.value.siteName?"所有":Ce.value.siteName;Ka("备份网站",e,"网站")}if("site_restart"===Ye.value&&!(null==(a=qe.value)?void 0:a.id)){const e=je.value;Je.taskName="网站启停["+(["ALL","all","全部","所有"].includes(Ce.value.siteName)?null==(l=e[0])?void 0:l.name:Ce.value.siteName)+"]"}if("database"!==Ye.value||(null==(t=qe.value)?void 0:t.id)||Ka("备份".concat(Ce.value.databaseType,"数据库"),"mysql"===Ce.value.databaseType?Ce.value.databaseTable:Ce.value.databaseName,"数据库"),"enterpriseBackup"===Ye.value&&!(null==(s=qe.value)?void 0:s.id)){const e=n(Ce.value.databaseTable)?Ce.value.databaseTable.join(","):Ce.value.databaseTable;Je.taskName="[勿删]数据库增量备份[ "+(Ce.value.databaseName||"")+"-"+(e||"所有")+" ]"}}})),f((()=>{var e;if(qe.value){let a=qe.value;Ce.value.backServer=a.backupTo,Ce.value.databaseType=a.db_type,Ce.value.number=a.save,"sync_time"===a.sType&&(a.sType="syncTime"),Je.type=a.sType,"mysql_increment_backup"===a.sType&&(a.sType="enterpriseBackup",Je.type="enterpriseBackup",Ce.value.databaseTable=null==(e=a.sBody)?void 0:e.split(",")),"path"===a.sType&&(Ce.value.path=a.sName),Ye.value=a.sType,Ce.value.databaseName=-1!==a.sName.indexOf(",")?a.sName.split(","):a.sName,Ce.value.siteName="site_restart"===a.sType?a.sName:-1!==a.sName.indexOf(",")?a.sName.split(","):a.sName;const l=a.special_time.split(",");let t=[],s=[];l.forEach((e=>{t.push(parseInt(e.split(":")[0])||0),s.push(parseInt(e.split(":")[1])||0),t=Array.from(new Set(t)),s=Array.from(new Set(s))})),Se.value={type:a.type,hour:a.where_hour,minute:a.where_minute,where1:a.where1,week:a.where1,timeType:a.time_type||"sday",timeSet:a.time_set?a.time_set.split(","):["1"],specialHour:t,specialMinute:s,second:a.second||"5"},"minute-n"===a.type?Se.value.minute=a.where1:"hour-n"===a.type?Se.value.hour=a.where1:"sweek"===a.type&&(Se.value.week=a.where1),"special_log"===a.sType&&(ra.value=a.sName),"toUrl"===a.sType&&(ra.value=a.urladdress),Ue.value.notice=a.notice?1:0,Ue.value.noticeChannel="webshell"===a.sType?a.urladdress||a.notice_channel:a.notice_channel===Ze.value.join(",")?"all":a.notice_channel,Ue.value.keyword=a.keyword||"",Ue.value.flock=!!a.flock}})),t({onConfirm:async()=>{if("ltd"===Re.value||"enterpriseBackup"!==Ye.value)return De(Xe.value,Je),["special_log","site_restart","startup_services"].includes(Ye.value)||await $e.value.form.validate(),Wa();oe({sourceId:53})}});const Ya=e=>{var a;!pa.value.isSiteListLoaded&&["site","database","enterpriseBackup","logs","path","webshell","site_restart"].includes(e)&&((async()=>{var e;try{const a=await de({type:"sites"});je.value=a.data.data,Oe.value=a.data.orderOpt,0!==Oe.value.length&&"localhost"===(null==(e=Oe.value)?void 0:e[0].value)||Oe.value.unshift({name:"服务器磁盘",value:"localhost"})}catch(a){}})(),pa.value.isSiteListLoaded=!0),pa.value.isZoneListLoaded||"syncTime"!==e||((async()=>{try{const e=await pe();Ie.value=e.data}catch(e){}})(),pa.value.isZoneListLoaded=!0),pa.value.isDatabaseListLoaded||"database"!==e||(!(null==(a=qe.value)?void 0:a.id)&&qe.value||(async()=>{try{const e=Date.now();if(e-Ae.value>3e4){const a=await ie();Me.value=a.data,Ae.value=e}}catch(e){}})(),pa.value.isDatabaseListLoaded=!0)},el=e=>{Je.stop_site=e};return _((async()=>{var e;""===(null==(e=qe.value)?void 0:e.id)&&(e=>{switch(e){case"enterpriseBackup":ja(),oa.value=!0,Ce.value.backServer="localhost";break;case"database":Za(Ce.value.databaseType)}})(qe.value.sType),(!qe.value||qe.value&&"toShell"===qe.value.sType)&&(async()=>{try{const{data:e}=await re({all_user:!0});(null==e?void 0:e.length)&&(Ee.value=e.map((e=>({label:e,value:e}))))}catch(e){}})(),qe.value&&Ya(qe.value.sType)})),(e,a)=>{const t=j,o=A,n=W,r=M,i=l,d=K,c=Y,v=ee,y=p,h=$,w=ne,f=s,_=u,V=ae,I=m,H=le,R=ue,q=te,z=b,F=G;return k(),D("div",ca,[B(F,{model:x(Je),ref_key:"crontabForm",ref:Xe,disabled:x(na),rules:x(Da)},{default:T((()=>{var e,l,s,u,p,m,b,A,M,j,F;return[B(r,{label:"任务类型"},{default:T((()=>[N("div",va,[B(o,{modelValue:x(Je).type,"onUpdate:modelValue":a[0]||(a[0]=e=>x(Je).type=e),disabled:!!x(qe),onChange:Ia,class:"!w-[13.8rem]","popper-class":"task-dropdown"},{default:T((()=>[(k(!0),D(U,null,S(x(Fe),(e=>(k(),g(t,{key:e.value,label:e.label,title:e.label,value:e.value},{default:T((()=>[N("span",ma,P(e.label),1),"enterpriseBackup"===e.value?(k(),D("span",ba,a[14]||(a[14]=[N("i",{class:"svgtofont-icon-ltd ml-4px text-[#9B7E48] !text-[1.6rem]"},null,-1)]))):C("",!0)])),_:2},1032,["label","title","value"])))),128))])),_:1},8,["modelValue","disabled"]),B(n,{placement:"top-start",width:"260","popper-class":"green-tips-popover",trigger:"hover",content:""},{reference:T((()=>a[15]||(a[15]=[N("i",{class:"svgtofont-el-question-filled text-warning ml-[12px]"},null,-1)]))),default:T((()=>[a[16]||(a[16]=N("div",null,[N("span",{class:"text-[#fff]"},"任务类型包含以下部分：Shell脚本、备份网站、备份数据库、数据库增量备份、网站日志切割、自定义日志切割、释放内存、访问URL-GET、访问URL-POST、备份目录、木马查杀、同步时间")],-1))])),_:1})])])),_:1}),B(r,{label:"任务名称",prop:"taskName"},{default:T((()=>[B(i,{disabled:x(oa),ref:"crontabFormName",placeholder:"请输入计划任务名称",modelValue:x(Je).taskName,"onUpdate:modelValue":a[1]||(a[1]=e=>x(Je).taskName=e),width:"35rem"},null,8,["disabled","modelValue"])])),_:1}),"log_cleanup"===x(Ye)?(k(),g(r,{key:0,label:"清理类型"},{default:T((()=>{var e;return[B(c,{modelValue:x(We),"onUpdate:modelValue":a[2]||(a[2]=e=>L(We)?We.value=e:null),onChange:Ra,disabled:!!(null==(e=x(qe))?void 0:e.id)},{default:T((()=>[B(d,{label:1},{default:T((()=>a[17]||(a[17]=[E("选择类型")]))),_:1}),B(d,{label:2},{default:T((()=>a[18]||(a[18]=[E("自定义路径")]))),_:1})])),_:1},8,["modelValue","disabled"])]})),_:1})):C("",!0),"log_cleanup"===x(Ye)?(k(),g(r,{key:1,label:" ",prop:"clearType"},{default:T((()=>{var e,l,s;return[1===x(We)?(k(),g(o,{key:0,onChange:qa,disabled:!!(null==(e=x(qe))?void 0:e.id),modelValue:x(Je).clearType,"onUpdate:modelValue":a[3]||(a[3]=e=>x(Je).clearType=e),multiple:"","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":5,placeholder:"请选择清理类型",class:"!w-[35rem] bt-multiple-select"},{default:T((()=>[(k(!0),D(U,null,S(x(Ve),(e=>(k(),g(t,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["disabled","modelValue"])):C("",!0),2===x(We)?(k(),D("div",ya,[B(i,{type:"textarea",placeholder:"请选择或输入自定义目录,一行一个",modelValue:x(Ge),"onUpdate:modelValue":a[4]||(a[4]=e=>L(Ge)?Ge.value=e:null),onChange:Pa,disabled:!!(null==(l=x(qe))?void 0:l.id),width:"50rem"},null,8,["modelValue","disabled"]),B(v,{class:"!h-[3rem] !ml-[1rem] !self-end",type:"default",onClick:Ba,disabled:!!(null==(s=x(qe))?void 0:s.id)},{default:T((()=>a[19]||(a[19]=[E("添加目录")]))),_:1},8,["disabled"])])):C("",!0)]})),_:1})):C("",!0),"special_log"!==x(Ye)&&"site_restart"!==x(Ye)&&"startup_services"!==x(Ye)?(k(),g(r,{key:2},{default:T((()=>{var e,l;return[B(da,{ref_key:"alertForm",ref:$e,"is-cron-tab":!0,isEdit:!!x(qe),"show-second":"toShell"===x(Ye)||"toUrl"===x(Ye)||"to_post"===x(Ye),"show-keyword":!!(null==(e=x(Te)[x(Ye)])?void 0:e.keyword),"show-notice":!!(null==(l=x(Te)[x(Ye)])?void 0:l.notice),"show-stop-web":"site"===x(Ye),"stop-site":x(Je).stop_site,onSiteWeb:el,needAll:"webshell"!==x(Ye)},O({center:T((()=>[x(La)?(k(),D("div",{key:0,class:"text-1.2rem ml-[10rem] mt-[1.2rem] leading-[1rem]",innerHTML:x(La)},null,8,ha)):C("",!0)])),_:2},[x(Ue).notice&&["site","database","path"].includes(x(Je).type)?{name:"bottom",fn:T((()=>[a[20]||(a[20]=N("div",{class:"text-1.2rem ml-10rem mt-1.2rem leading-[1rem]"},"检查到磁盘剩余空间小于备份文件的 5 倍或者小于 1GB 时会发送磁盘不足的提示",-1))])),key:"0"}:void 0]),1032,["isEdit","show-second","show-keyword","show-notice","show-stop-web","stop-site","needAll"])]})),_:1})):C("",!0),(null==(e=x(Te)[x(Ye)])?void 0:e.backLabel)?(k(),g(la,{key:3,backLabel:null==(l=x(Te)[x(Ye)])?void 0:l.backLabel,tableData:x(ua),type:x(Ye),rowData:x(qe),multiple:("enterpriseBackup"===x(Ye)||x(Ye),!1)},{"back-before":T((()=>{var e;return["database"===x(Ye)?(k(),g(y,{key:0,modelValue:x(Ce).databaseType,"onUpdate:modelValue":a[5]||(a[5]=e=>x(Ce).databaseType=e),disabled:!!(null==(e=x(qe))?void 0:e.id),options:x(ge),class:"!w-[10rem] mr-[8px]",onChange:Za},null,8,["modelValue","disabled","options"])):C("",!0)]})),_:1},8,["backLabel","tableData","type","rowData","multiple"])):C("",!0),x(Xa)&&"site_restart"!==x(Ye)?(k(),g(sa,{key:4,rowData:x(qe),type:x(Ye)},null,8,["rowData","type"])):C("",!0),(null==(s=x(Te)[x(Ye)])?void 0:s.backLabel)&&"localhost"!==x(Ce).backServer&&"site_restart"!==x(Ye)?(k(),g(r,{key:5,label:"备份设置"},{default:T((()=>[N("div",wa,[B(h,{modelValue:x(ea),"onUpdate:modelValue":a[6]||(a[6]=e=>L(ea)?ea.value=e:null),class:"!mr-12x"},{default:T((()=>a[21]||(a[21]=[E(" 同时保留本地备份（和云存储保留份数一致） ")]))),_:1},8,["modelValue"])])])),_:1})):C("",!0),("database"!==x(Ye)&&"site"!==x(Ye)||"localhost"!==x(Ce).backServer&&!x(ea))&&"logs"!==x(Ye)?C("",!0):(k(),g(r,{key:6,label:"logs"===x(Ye)?"存储路径":"备份路径"},{default:T((()=>[B(w,{placeholder:"请输入".concat("logs"===x(Ye)?"存储路径":"备份路径","，为空默认为").concat("logs"===x(Ye)?"/www/wwwlogs":x(xe)),modelValue:x(ta),"onUpdate:modelValue":a[7]||(a[7]=e=>L(ta)?ta.value=e:null),icon:"el-folder-opened",onIconClick:Ea,width:"42rem"},null,8,["placeholder","modelValue"])])),_:1},8,["label"])),"database"===x(Ye)?(k(),g(r,{key:7,label:" "},{default:T((()=>[N("div",fa,[B(h,{modelValue:x(aa),"onUpdate:modelValue":a[8]||(a[8]=e=>L(aa)?aa.value=e:null),class:"!mr-[12px]"},{default:T((()=>a[22]||(a[22]=[E("使用数据库对应账号备份")]))),_:1},8,["modelValue"]),a[23]||(a[23]=N("span",{class:"text-[#999] text-[1.2rem]"}," *注意：目前只支持mysql数据库的本地数据库备份 ",-1))])])),_:1})):C("",!0),(null==(u=x(Te)[x(Ye)])?void 0:u.selectLabel)?(k(),g(ze,{key:8,type:x(Ye),"onUpdate:changeZone":Fa,"onUpdate:saveNumber":Qa,"onUpdate:select":$a,selectData:x(qe),selectLabel:null==(p=x(Te)[x(Ye)])?void 0:p.selectLabel},null,8,["type","selectData","selectLabel"])):C("",!0),"toShell"===x(Ye)?(k(),g(r,{key:9,label:"执行用户"},{default:T((()=>[B(y,{modelValue:x(ia),"onUpdate:modelValue":a[9]||(a[9]=e=>L(ia)?ia.value=e:null),options:x(Ee),filterable:"",placeholder:"默认使用root用户执行",class:"!w-[24rem]",onChange:Ca},null,8,["modelValue","options"])])),_:1})):C("",!0),!(null==(m=x(Te)[x(Ye)])?void 0:m.label)||"enterpriseBackup"==x(Ye)&&"site_restart"==x(Ye)&&x(qe)?C("",!0):(k(),g(Qe,{key:10,placeholder:null==(b=x(Te)[x(Ye)])?void 0:b.placeholder,"icon-type":null==(A=x(Te)[x(Ye)])?void 0:A.iconType,"input-type":null==(M=x(Te)[x(Ye)])?void 0:M.inputType,label:null==(j=x(Te)[x(Ye)])?void 0:j.label,inputValue:x(ra),"onUpdate:changeInput":Ha},{after:T((()=>["special_log"===x(Ye)?(k(),D("div",_a,[B(_,{onClick:Ja},{default:T((()=>[B(f,{icon:"el-folder-opened",class:"cursor-pointer"})])),_:1})])):C("",!0),N("div",ka,["toUrl"===x(Ye)?(k(),g(v,{key:0,type:"default",onClick:Oa},{default:T((()=>a[24]||(a[24]=[E("测试url")]))),_:1})):C("",!0),"enterpriseBackup"===x(Ye)?(k(),D("span",ga,"*注意：请牢记压缩密码，以免因压缩密码导致无法恢复和下载数据")):C("",!0),"toShell"===x(Ye)?(k(),g(v,{key:2,type:"default",class:"relative -top-[8rem]",onClick:za},{default:T((()=>a[25]||(a[25]=[E(" 选择脚本 ")]))),_:1})):C("",!0)])])),_:1},8,["placeholder","icon-type","input-type","label","inputValue"])),"to_post"===x(Ye)||"toUrl"===x(Ye)?(k(),g(r,{key:11,label:"User-Agent"},{default:T((()=>[B(i,{type:"textarea",placeholder:"请输入User-Agent配置",modelValue:x(Je).userAgent,"onUpdate:modelValue":a[10]||(a[10]=e=>x(Je).userAgent=e),width:"50rem"},null,8,["modelValue"])])),_:1})):C("",!0),"to_post"===x(Ye)?(k(),g(r,{key:12,label:"参数配置"},{default:T((()=>[N("div",Ta,[B(H,{ref_key:"paramTableRef",ref:Ke,class:"param-table",data:x(Je).postParam,"row-class-name":Sa,"max-height":"200",onSelectionChange:Aa},{default:T((()=>[B(V,{label:"参数名",prop:"paramName",width:"240"},{default:T((({row:e})=>[B(i,{modelValue:e.paramName,"onUpdate:modelValue":a=>e.paramName=a,type:"text",size:"small"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),B(V,{label:"参数值",prop:"paramValue"},{default:T((({row:e})=>[B(i,{modelValue:e.paramValue,"onUpdate:modelValue":a=>e.paramValue=a,type:"text",size:"small"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),B(V,{label:"操作",align:"right",width:"70"},{default:T((({row:e,index:l})=>[B(I,{class:"mr-4x",onClick:e=>((e,a)=>{Je.postParam.splice(a,1)})(0,l)},{default:T((()=>a[26]||(a[26]=[E("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),B(v,{type:"primary",size:"small",onClick:Ma,class:"!mt-[1rem]"},{default:T((()=>a[27]||(a[27]=[N("i",{class:"svgtofont-el-plus text-white font-bold mr-[0.4rem]"},null,-1),E("添加参数 ")]))),_:1})])])),_:1})):C("",!0),"webshell"===x(Ye)?(k(),g(r,{key:13,label:"消息通道"},{default:T((()=>[B(R,{modelValue:x(Ue).noticeChannel,"onUpdate:modelValue":a[11]||(a[11]=e=>x(Ue).noticeChannel=e),isDefault:!0,multiple:!1,class:"!w-16rem",onChange:Ua,limit:["sms"]},null,8,["modelValue"])])),_:1})):C("",!0),"site_restart"===x(Ye)?(k(),g(r,{key:14,label:"开启时间"},{default:T((()=>[N("div",Na,[B(r,{label:"",prop:"startTime"},{default:T((()=>[B(q,{"prefix-icon":"none",clearable:"",placeholder:"请选择开启时间",class:"!w-22rem",modelValue:x(Je).startTime,"onUpdate:modelValue":a[12]||(a[12]=e=>x(Je).startTime=e),"picker-options":{start:"00:00",step:"00:05",end:"23:59"}},null,8,["modelValue"])])),_:1}),B(r,{label:"停止时间",prop:"stopTime",class:"!mt-0"},{default:T((()=>[B(q,{"prefix-icon":"none",clearable:"",placeholder:"请选择停止时间",class:"!w-22rem",modelValue:x(Je).stopTime,"onUpdate:modelValue":a[13]||(a[13]=e=>x(Je).stopTime=e),"picker-options":{start:"00:00",step:"00:05",end:"23:59"}},null,8,["modelValue"])])),_:1})])])),_:1})):C("",!0),(null==(F=x(Te)[x(Ye)])?void 0:F.helpList)?(k(),g(r,{key:15,label:"温馨提示"},{default:T((()=>{var e;return[N("div",Va,[B(z,{options:null==(e=x(Te)[x(Ye)])?void 0:e.helpList,"list-style":"disc",class:"ml-[12px] text-[1.2rem]"},null,8,["options"])])]})),_:1})):C("",!0)]})),_:1},8,["model","disabled","rules"])])}}}),La=Object.freeze(Object.defineProperty({__proto__:null,default:xa},Symbol.toStringTag,{value:"Module"}));export{La as i,Le as s};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
