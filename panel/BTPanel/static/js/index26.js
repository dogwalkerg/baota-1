import{_ as e}from"./index90.js?v=1734676359";import{u as t,af as s,ak as a,c as l,b as n,al as i,am as o,an as r,ao as c,e as m}from"./utils-lib.js?v=1734676359";import{u as p}from"./index124.js?v=1734676359";import{c as u,r as d,h as f,o as k,aB as y,p as h,k as v,J as x,x as b,l as g,q as _,e as j,y as w,z as C,s as B,az as S,an as D,ap as I,ao as q,a1 as L,a5 as P}from"./base-lib.js?v=1734676359";import{h as R}from"./validator.js?v=1734676359";import"./index.vue_vue_type_style_index_0_scoped_03ce946a_lang.js?v=1734676359";import{a as T,o as H,g as O,u as A}from"./column.js?v=1734676359";import{g as F}from"./useStore3.js?v=1734676359";import{D as N,u as W,a as z,b as J,c as E,g as G,d as K,s as M,e as V,f as Q,o as U,h as X,i as Y,j as Z}from"./useController.js?v=1734676359";import{N as $}from"./useMethods.js?v=1734676359";import{B as ee}from"./index117.js?v=1734676359";import{_ as te}from"./index116.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index107.js?v=1734676359";import"./index91.js?v=1734676359";const se={key:0,class:"flex items-center"},ae={key:1,class:"flex items-center"},le=u({__name:"index",emits:["init"],setup(e,{expose:i,emit:o}){const r=n(),c=o,{plugin:m}=t(),p=d(m.value.webserver),u=d(!1),B=d(!1),S=f({title:"",name:"",status:!0,version:"",admin:!1,s_version:"",setup:!1});let D=!1;const I=async(e=!1)=>{try{if(D)return;const{data:t}=await a({name:"web"});t.status||e||setTimeout((()=>{I()}),3e3),t.status&&!e&&c("init"),u.value=!t.status,Object.assign(S,t),"nginx"!==t.name&&(u.value=!0,B.value=t.status)}catch(t){e||setTimeout((()=>{I()}),3e3)}};return k((()=>{I(!0)})),y((()=>{D=!0})),i({checkInstallStatus:I,pluginInfo:S,maskLayer:u,webServerType:p}),(e,t)=>{const a=l,n=te;return h(u)?(v(),x(n,{key:0,width:"38rem"},{content:b((()=>[h(B)?(v(),g("div",ae,t[3]||(t[3]=[_("span",null,"Docker项目只支持nginx环境",-1)]))):(v(),g("div",se,[t[2]||(t[2]=_("span",null,"未安装运行环境，",-1)),j(a,{onClick:t[0]||(t[0]=e=>(async e=>{const{data:t}=await s({sName:e.name});if("-1"===t.task)return r.error("当前插件正在安装，不可重复安装");R({name:null==t?void 0:t.name,type:"i",pluginInfo:t}),I()})({name:"nginx"})),class:"!font-bold !text-[1.4rem]"},{default:b((()=>t[1]||(t[1]=[w("安装Nginx")]))),_:1})]))])),_:1})):C("",!0)}}}),ne={class:"p-[1.6rem]"},ie={class:"flex items-center ml-1rem"};const oe=m(u({__name:"index",setup(s){const{mainHeight:a}=t(),{getDockerSiteList:n,setDockerSiteStatus:m,setDockerSiteRemark:u,delDockerSite:d,resetData:f}=N(),{refs:{isRefreshSiteList:y}}=F(),{pluginInfo:x,classList:C,statusFilterKey:R}=B(N()),{BtOperation:te}=i({options:[{type:"button",label:"创建",active:!0,onClick:()=>K()},{type:"button",label:"运行环境",onClick:()=>M()},{type:"button",label:"常用设置",onClick:()=>V()},{type:"custom",render:()=>j(ee,{style:"margin-left:1.2rem;",isRequest:!1,pluginInfo:x.value},null)}]}),se=c([Y({callback:()=>{},classList:C}),{label:"删除项目",value:"delete",event:Z}]),ae=p({key:"classify",name:"Docker分类",options:()=>[{label:"全部分类",value:"all"}],event:Q,ignore:["0","-2"],field:"name"}),{BtTable:oe,BtPage:re,BtRefresh:ce,BtSearch:me,BtColumn:pe,BtBatch:ue,BtTableCategory:de,refresh:fe}=o({request:e=>n({p:e.p||1,row:e.limit||20,query:e.search||"",...e.classify&&"all"!==e.classify?{classify:e.classify}:{},..."all"!==R.value?{type:R.value}:{}}),columns:[T(),W({onClick:U,openPlugin:X}),{label:"类型",prop:"type",minWidth:90,renderHeader(){const e=[{title:"全部",key:"all"},{title:"JAVA",key:"java"},{title:"Go",key:"go"},{title:"PHP",key:"php"},{title:"Python",key:"python"},{title:"反向代理",key:"proxy"},{title:"Docker应用",key:"app"}];return S("div",{class:"flex items-center flex-nowrap"},["",S(D,{onCommand:e=>{R.value=e,fe()}},{default:()=>S("span",{class:"text-[1.2rem] flex items-center"},[[j("span",{class:"status-header-text leading-[1.5] whitespace-nowrap"},[w("类型"),"all"===R.value?"":"(".concat(e.find((e=>e.key===R.value)).title,")")])],S("i",{class:"svgtofont-el-arrow-down "})]),dropdown:()=>{let t;return j(q,null,"function"==typeof(s=t=e.map((e=>j(I,{command:e.key},{default:()=>[e.title]}))))||"[object Object]"===Object.prototype.toString.call(s)&&!P(s)?t:{default:()=>[t]});var s}})])}},z({prop:"status",onClick:e=>{const t="1"===e.status?0:1;m({status:t,id:e.id,site_name:e.name,edate:e.edate})},onFilterEvent:e=>{R.value=e,fe()}}),{label:"根目录",prop:"path",minWidth:200,isCustom:!0,render:e=>j("div",null,[j("span",{class:"w-full whitespace-pre-line inline-block bt-link leading-[16px]",onClick:()=>H(e,"path"),title:"点击打开目录"},[e.path])])},J(),O({request:(e,t)=>{u({remark:t,id:e.id,site_name:e.name})},prop:"remark",width:200}),E({onClick:e=>U(e,"ssl")}),A([{onClick:e=>{X(e,"monitor-setting")},title:"统计"},{onClick:e=>{X(e,"bt_waf")},title:"WAF"},{title:"设置",onClick:U},{title:"删除",onClick:e=>{d(e)}}])],extension:[ae,se,r(y)]});return k((()=>{G()})),L((()=>{f()})),(t,s)=>{const n=l,i=e;return v(),g("div",ne,[j(le,{ref:"envRef",onInit:h(fe)},null,8,["onInit"]),j(i,null,{"header-left":b((()=>[j(h(te)),_("div",ie,[_("div",{class:"flex items-center",onClick:s[0]||(s[0]=(...e)=>h($)&&h($)(...e))},s[1]||(s[1]=[_("i",{class:"svgtofont-desired text-[1.6rem]"},null,-1),_("span",{class:"bt-link"},"需求反馈",-1)])),j(n,{href:"https://www.bt.cn/bbs/thread-140664-1-1.html",class:"ml-10px"},{default:b((()=>s[2]||(s[2]=[w(">>使用帮助")]))),_:1})])])),"header-right":b((()=>[j(h(de),{class:"!w-[160px] mr-[10px]"}),j(h(me),{class:"mr-[10px] !w-[26rem]",placeholder:"请输入项目名称或备注"}),j(h(ce),{class:"mr-[10px]"}),j(h(pe))])),content:b((()=>[j(h(oe),{"max-height":h(a)},null,8,["max-height"])])),"footer-left":b((()=>[j(h(ue))])),"footer-right":b((()=>[j(h(re))])),_:1})])}}}),[["__scopeId","data-v-ccfbe2e9"]]);export{oe as default};
