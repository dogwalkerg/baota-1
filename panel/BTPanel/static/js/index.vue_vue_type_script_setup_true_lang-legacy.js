!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function n(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?t(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function r(t,n,r){return(n=function(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,n||"default");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function a(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */a=function(){return n};var t,n={},r=Object.prototype,u=r.hasOwnProperty,l=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function f(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(t){f=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var a=t&&t.prototype instanceof w?t:w,u=Object.create(a.prototype),o=new L(r||[]);return l(u,"_invoke",{value:P(e,n,o)}),u}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=d;var v="suspendedStart",m="suspendedYield",h="executing",y="completed",x={};function w(){}function b(){}function g(){}var _={};f(_,i,(function(){return this}));var V=Object.getPrototypeOf,k=V&&V(V(T([])));k&&k!==r&&u.call(k,i)&&(_=k);var C=g.prototype=w.prototype=Object.create(_);function S(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function U(t,n){function r(a,l,o,i){var c=p(t[a],t,l);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"==e(f)&&u.call(f,"__await")?n.resolve(f.__await).then((function(e){r("next",e,o,i)}),(function(e){r("throw",e,o,i)})):n.resolve(f).then((function(e){s.value=e,o(s)}),(function(e){return r("throw",e,o,i)}))}i(c.arg)}var a;l(this,"_invoke",{value:function(e,t){function u(){return new n((function(n,a){r(e,t,n,a)}))}return a=a?a.then(u,u):u()}})}function P(e,n,r){var a=v;return function(u,l){if(a===h)throw Error("Generator is already running");if(a===y){if("throw"===u)throw l;return{value:t,done:!0}}for(r.method=u,r.arg=l;;){var o=r.delegate;if(o){var i=A(o,r);if(i){if(i===x)continue;return i}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===v)throw a=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=h;var c=p(e,n,r);if("normal"===c.type){if(a=r.done?y:m,c.arg===x)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(a=y,r.method="throw",r.arg=c.arg)}}}function A(e,n){var r=n.method,a=e.iterator[r];if(a===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,A(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),x;var u=p(a,e.iterator,n.arg);if("throw"===u.type)return n.method="throw",n.arg=u.arg,n.delegate=null,x;var l=u.arg;return l?l.done?(n[e.resultName]=l.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,x):l:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,x)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function T(n){if(n||""===n){var r=n[i];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var a=-1,l=function e(){for(;++a<n.length;)if(u.call(n,a))return e.value=n[a],e.done=!1,e;return e.value=t,e.done=!0,e};return l.next=l}}throw new TypeError(e(n)+" is not iterable")}return b.prototype=g,l(C,"constructor",{value:g,configurable:!0}),l(g,"constructor",{value:b,configurable:!0}),b.displayName=f(g,s,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,f(e,s,"GeneratorFunction")),e.prototype=Object.create(C),e},n.awrap=function(e){return{__await:e}},S(U.prototype),f(U.prototype,c,(function(){return this})),n.AsyncIterator=U,n.async=function(e,t,r,a,u){void 0===u&&(u=Promise);var l=new U(d(e,t,r,a),u);return n.isGeneratorFunction(t)?l:l.next().then((function(e){return e.done?e.value:l.next()}))},S(C),f(C,s,"Generator"),f(C,i,(function(){return this})),f(C,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var n in this)"t"===n.charAt(0)&&u.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,a){return o.type="throw",o.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var l=this.tryEntries[a],o=l.completion;if("root"===l.tryLoc)return r("end");if(l.tryLoc<=this.prev){var i=u.call(l,"catchLoc"),c=u.call(l,"finallyLoc");if(i&&c){if(this.prev<l.catchLoc)return r(l.catchLoc,!0);if(this.prev<l.finallyLoc)return r(l.finallyLoc)}else if(i){if(this.prev<l.catchLoc)return r(l.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<l.finallyLoc)return r(l.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&u.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var l=a?a.completion:{};return l.type=e,l.arg=t,a?(this.method="next",this.next=a.finallyLoc,x):this.complete(l)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),x},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),x}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;E(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:T(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),x}},n}function u(e,t,n,r,a,u,l){try{var o=e[u](l),i=o.value}catch(e){return void n(e)}o.done?t(i):Promise.resolve(i).then(r,a)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var l=e.apply(t,n);function o(e){u(l,r,a,o,i,"next",e)}function i(e){u(l,r,a,o,i,"throw",e)}o(void 0)}))}}System.register(["./base-lib-legacy.js?v=1734676359","./useStore-legacy.js?v=1734676359","./utils-lib-legacy.js?v=1734676359","./validator-legacy.js?v=1734676359","./config-legacy.js?v=1734676359","./index-legacy96.js?v=1734676359","./index-legacy90.js?v=1734676359","./index-legacy89.js?v=1734676359","./useMethod-legacy.js?v=1734676359","./index-legacy97.js?v=1734676359","./column-legacy.js?v=1734676359"],(function(e,t){"use strict";var r,u,o,i,c,s,f,d,p,v,m,h,y,x,w,b,g,_,V,k,C,S,U,P,A,j,E,L,T,O,q,I,N,K,z,F,D,M,B,G,H,R,Y,J,Q,X,Z,$,W,ee,te,ne,re,ae,ue,le,oe,ie,ce,se,fe,de,pe,ve,me,he,ye,xe,we,be,ge,_e,Ve,ke,Ce,Se,Ue,Pe,Ae,je,Ee,Le,Te,Oe,qe,Ie,Ne,Ke,ze,Fe,De,Me,Be,Ge,He,Re;return{setters:[function(e){r=e.c,u=e.r,o=e.h,i=e.o,c=e.k,s=e.l,f=e.e,d=e.x,p=e.p,v=e.M,m=e.y,h=e.q,y=e.aj,x=e.A,w=e.a7,b=e.a4,g=e.w,_=e.B,V=e.C,k=e.v,C=e.I,S=e.z,U=e.aX,P=e.J,A=e.aT,j=e.Q,E=e.ah,L=e.ae,T=e.ad,O=e.aN,q=e.ag,I=e.D,N=e.R,K=e.aY,z=e.af,F=e.i},function(e){D=e.g},function(e){M=e.G,B=e.K,G=e.h,H=e.M,R=e.x,Y=e.l,J=e.H,Q=e.L,X=e.N,Z=e.c,$=e.j,W=e.d,ee=e.O,te=e.k,ne=e.e,re=e.P,ae=e.Q,ue=e.B,le=e.s,oe=e.R,ie=e.o,ce=e.S},function(e){se=e._},function(e){fe=e.p,de=e.q,pe=e.r,ve=e.t,me=e.u,he=e.v,ye=e.w,xe=e.x,we=e.y,be=e.z,ge=e.A,_e=e.B,Ve=e.C,ke=e.D,Ce=e.E,Se=e.F,Ue=e.G,Pe=e.H,Ae=e.I,je=e.J,Ee=e.K,Le=e.L,Te=e.M,Oe=e.N,qe=e.O,Ie=e.P,Ne=e.Q,Ke=e.R,ze=e.S},function(e){Fe=e.C,De=e.a},function(e){Me=e._},function(e){Be=e._},function(e){Ge=e.o},function(e){He=e._},function(e){Re=e.u}],execute:function(){var Ye={class:"p-16px"},Je=r({__name:"index",setup:function(e){var t=u([]),n=u(null),r=u(!1),g=u(!1),_=o({type:[],options:"",id:""}),V=null,k={type:[{required:!0,validator:function(e,t,n){0===_.type.length?n(new Error("请选择告警方式")):n()},trigger:["blur","change"]}]},C=function(){var e=l(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}g.value=!0,e.next=6;break;case 4:return e.next=6,M({loading:"正在保存信息配置，请稍后...",request:fe({task_id:_.id,status:t?1:0}),message:!0,success:function(e){e.status||(r.value=!t)}});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){g.value=!1,A()},U=function(){var e=l(a().mark((function e(){var t,u,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.value.validate();case 2:return t={},u={send_interval:0,time_range:[0,86399]},l={day_num:0,total:0},t=V?{task_data:V.task_data,sender:_.type,time_rule:u,number_rule:l}:{task_data:{tid:"6",type:"panel_safe_push",title:"面板安全告警",status:r.value,count:0,interval:600,project:"",help:600},sender:_.type,time_rule:u,number_rule:l},e.next=8,M({loading:"正在保存信息配置，请稍后...",request:de({task_data:JSON.stringify(t),template_id:"6"}),message:!0});case 8:return e.next=10,P();case 10:A(),g.value=!1;case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=l(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M({request:B(),data:{data:[Array,t]}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(){var e,n=null===(e=t.value)||void 0===e?void 0:e.find((function(e){return"panel_safe_push"===e.keyword}));n?(_.type=n.sender,r.value=n.status,_.id=n.id,V=n):(_.type=[],r.value=!1,V=null)};return i(l(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P();case 2:A();case 3:case"end":return e.stop()}}),e)})))),function(e,t){var a=y,u=x,l=w,o=se,i=b,V=G;return c(),s("div",null,[f(p(Fe),{label:"面板安全告警"},{value:d((function(){return[f(a,{modelValue:p(r),"onUpdate:modelValue":t[0]||(t[0]=function(e){return v(r)?r.value=e:null}),onChange:C},null,8,["modelValue"]),f(u,{size:"small",class:"!ml-12px",onClick:t[1]||(t[1]=function(e){return g.value=!0})},{default:d((function(){return t[6]||(t[6]=[m("提醒方式")])})),_:1})]})),desc:d((function(){return t[7]||(t[7]=[h("span",null,"告警内容包含：面板用户变更、面板日志删除、面板开启开发者、面板开启API",-1)])})),_:1}),f(V,{title:"面板安全告警",modelValue:p(g),"onUpdate:modelValue":t[4]||(t[4]=function(e){return v(g)?g.value=e:null}),showFooter:"",area:[48],onConfirm:t[5]||(t[5]=function(e){return U()}),onCancel:S,confirmText:"保存配置"},{default:d((function(){return[h("div",Ye,[f(i,{ref_key:"ruleFormRef",ref:n,"label-width":"10rem",rules:k,model:p(_)},{default:d((function(){return[f(l,{label:"安全提醒"},{default:d((function(){return[f(a,{modelValue:p(r),"onUpdate:modelValue":t[2]||(t[2]=function(e){return v(r)?r.value=e:null})},null,8,["modelValue"])]})),_:1}),f(l,{label:"告警方式",prop:"type"},{default:d((function(){return[f(o,{class:"!w-[30rem]",modelValue:p(_).type,"onUpdate:modelValue":t[3]||(t[3]=function(e){return p(_).type=e}),limit:["sms"]},null,8,["modelValue"])]})),_:1})]})),_:1},8,["model"])])]})),_:1},8,["modelValue"])])}}}),Qe={class:"p-[24px]"},Xe={class:"inline-block mr-[32px]"},Ze={class:"font-bold text-[1.2rem]"},$e={class:"inline-block mr-[32px]"},We={class:"font-bold text-[1.2rem]"},et={class:"inline-block mr-[32px]"},tt={class:"font-bold text-[1.2rem]"},nt={class:"mt-2 flex items-center"},rt={class:"w-[20rem] flex"},at={class:"mt-2 flex items-center"},ut={class:"mt-6 sslPanel"},lt={class:"flex justify-between"},ot={class:"flex items-center w-full"},it={class:"flex mt-[12px]"},ct={class:"flex-1 mr-[20px]"},st={class:"flex-1"},ft={class:"list-disc text-[#777] px-[20px] pt-[12px] leading-8"},dt={class:"flex items-center"},pt={class:"pt-[20px] flex flex-col"},vt={class:"flex items-center mt-[12px] ml-[4px] px-[20px]"},mt={class:"bg-[#f6f8f8] footer-btn flex items-center justify-end mt-[20px] p-[12px] w-full"},ht={class:"p-[2rem]"},yt={class:"flex items-center justify-center mb-[16px]"},xt={class:"flex flex-col bg-[#f7f7f7] p-[20px]"},wt={key:1},bt={class:"w-[24rem]"},gt={class:"w-[24rem]"},_t={class:"list-disc ml-[20px] mt-[12px] leading-10 text-[#666]"},Vt={class:"flex items-center"},kt={class:"p-[1.5rem]"},Ct={class:"max-h-[38rem] overflow-auto"},St=r({__name:"index",setup:function(e){var n,r=D().refs,i=r.safeConfig,I=r.noPortConfig,N=r.openSSLPopup,K=u(!1),z=u(!1),F=u(!1),B=u(!1),ne=u(),re=u(5),ae=u({sllType:1,privateKey:"",certPem:"",checked:!1,email:"",resource:"http"}),ue=u({cert_type:"",domain:"",email:""}),le=u(!1),oe=u({certPem:"",download_root:!1,info:{},privateKey:"",rep:!1,root_password:""}),ie=[{title:"自签证书",key:1,disabled:!1},{title:"Let's Encrypt",key:2,disabled:!i.value.domain},{title:"其他证书",key:3,disabled:!1}],ce=u([]),se=o({index:"",cert_type:"",privateKey:"",certPem:"",email:"",auth_type:""}),fe=u(!1),de=[{content:"解析域名需要一定时间来生效,完成所以上所有解析操作后,请等待1分钟后再点击验证按钮"},{content:"可通过CMD命令来手动验证域名解析是否生效:\n\t\t nslookup -q=txt _acme-challenge.".concat(null===(n=i.value.domain)||void 0===n?void 0:n.replace("*.",""))},{content:"若您使用的是宝塔云解析插件,阿里云DNS,DnsPod作为DNS,可使用DNS接口自动解析"}],ye=[{label:"解析域名",prop:"domain"},{label:"记录值",showOverflowTooltip:!0,render:function(e){var t="dns"===ae.value.resource?e.auth_value:e.file_path;return f("div",{class:"flex items-center"},[f("div",{class:"truncate w-[15rem]"},[t]),f("span",{class:"svgtofont-icon-copy ml-[4px] text-[#666] text-[1.6rem] w-[1.6rem] cursor-pointer",onClick:function(){return R({value:t})}},null)])}},{label:"类型",render:function(e){return"dns"===ae.value.resource?f("span",null,[e.type]):f("div",{class:"flex items-center"},[f("div",{class:"truncate w-[15rem]"},[e.content]),f("span",{class:"svgtofont-icon-copy ml-[4px] text-[#666] text-[1.6rem] w-[1.6rem] cursor-pointer",onClick:function(){return R({value:e.content})}},null)])}},{label:"必需",prop:"must",width:100}],xe=function(){var e=l(a().mark((function e(){var t,n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Se();case 3:return t=e.sent,e.next=6,pe(se);case 6:n=e.sent,r=n.data,null==t||t.close(),H.request(r),r.status&&Ce(r),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0);case 16:return e.prev=16,fe.value=!1,e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[0,13,16,19]])})));return function(){return e.apply(this,arguments)}}(),we=function(e){ae.value.sllType=e},be=function(){var e=l(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return le.value=!0,e.prev=1,e.next=4,M({loading:"正在保存面板证书配置，请稍候...",request:ve({privateKey:oe.value.privateKey,certPem:oe.value.certPem}),message:!0,success:_e});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1);case 9:return e.prev=9,le.value=!1,e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[1,6,9,12]])})));return function(){return e.apply(this,arguments)}}(),ge=function(){Y({title:"证书夹",area:70,compData:{onRefresh:function(e){oe.value.certPem=(null==e?void 0:e.fullchain)||"",oe.value.privateKey=(null==e?void 0:e.privkey)||"",oe.value.info=(null==e?void 0:e.info)||{}}},component:function(){return J((function(){return t.import("./cert-folder-legacy.js?v=1734676359")}),void 0,t.meta.url)}})},_e=function(){var e=l(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return le.value=!0,e.prev=1,e.next=4,M({loading:"正在获取面板证书配置，请稍候...",request:me(),success:function(e){var t,n;oe.value=e.data,ae.value.privateKey=null===(t=e.data)||void 0===t?void 0:t.privateKey,ae.value.certPem=null===(n=e.data)||void 0===n?void 0:n.certPem}});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1);case 9:return e.prev=9,le.value=!1,e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[1,6,9,12]])})));return function(){return e.apply(this,arguments)}}(),Ve=function(){var e=l(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,he();case 3:t=e.sent,n=t.data,ue.value=n,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),ke=function(){var e=l(a().mark((function e(t,n,r){var u,o,i,c,s,f,d,p;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,2!==ae.value.sllType||u.test(ae.value.email)){e.next=4;break}return H.error("请输入正确的邮箱地址"),e.abrupt("return");case 4:return e.prev=4,c={cert_type:t,privateKey:n,certPem:r},0===t&&(delete c.cert_type,c.privateKey,c.certPem),2===ae.value.sllType&&(c.email=ae.value.email,c.auth_type=ae.value.resource),2===ae.value.sllType?setTimeout(l(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Se();case 2:s=e.sent;case 3:case"end":return e.stop()}}),e)}))),500):f=H.load("正在设置面板证书配置，请稍候..."),e.next=11,pe(c);case 11:return p=e.sent,d=p.data,null===(o=s)||void 0===o||o.close(),null===(i=f)||void 0===i||i.close(),e.next=17,Ce(d,c);case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(4);case 22:return e.prev=22,le.value=!1,F.value=!1,e.finish(22);case 26:case"end":return e.stop()}}),e,null,[[4,19,22,26]])})));return function(t,n,r){return e.apply(this,arguments)}}(),Ce=function(){var e=l(a().mark((function e(t,n){var r,u,l,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.status){e.next=11;break}return r=H.load("正在刷新页面，请稍候..."),e.next=4,new Promise((function(e){return setTimeout(e,2e3)}));case 4:r.close(),Q(),sessionStorage.clear(),window.location.href="".concat("http:"===location.protocol?"https":"http","://").concat(window.location.host).concat(i.value.admin_path),le.value=!1,e.next=14;break;case 11:u=n.certPem,l=n.cert_type,o=n.privateKey,i.value.panelSSl=!i.value.panelSSl,X(t,"auths")&&(ce.value=t.auths,se.index=t.index,se.certPem=u,se.cert_type=l,se.privateKey=o,se.email=ae.value.email,se.auth_type=ae.value.resource,fe.value=!0);case 14:H.request(t);case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Se=function(){return Y({area:[50,25],component:function(){return J((function(){return t.import("./cert-progress-legacy.js?v=1734676359")}),void 0,t.meta.url)}})};g(I,(function(e){e.value&&(oe.value.privateKey=I.value.key,oe.value.certPem=I.value.cert,oe.value.info.subject=I.value.certInfo.subject,oe.value.info.issuer=I.value.certInfo.issuer,oe.value.info.notAfter=I.value.certInfo.notAfter)})),g(N,(function(e){e&&(F.value=!0,Ve(),N.value=!1)}),{deep:!0});var Ue=function(e){(e?F:z).value&&(e?F.value=!1:z.value=!1,i.value.panelSSl=!i.value.panelSSl)},Pe=function(e){(e?F:z).value&&function(e){if(!B.value&&!e)return H.error("请勾选并同意承担风险");e?ke(1,ae.value.privateKey,ae.value.certPem):(ke(0),z.value=!1)}(e)};return function(e,t){var n=y,r=x,a=Z,u=A,l=$,o=G,g=j,I=Be,N=W,D=O,M=q,Y=E,J=w,Q=L,X=T,ue=b,se=te,pe=Me,ve=ee,me=_("bt-loading");return c(),s("div",null,[f(p(Fe),{label:"面板SSL"},{value:d((function(){return[f(n,{modelValue:p(i).panelSSl,"onUpdate:modelValue":t[0]||(t[0]=function(e){return p(i).panelSSl=e}),onChange:t[1]||(t[1]=function(e){return(t=p(i).panelSSl)?(F.value=!0,Ve()):z.value=!0,void(t?(clearInterval(ne.value),ne.value=null,re.value=5):(ne.value&&clearInterval(ne.value),ne.value=setInterval((function(){re.value--,re.value<=0&&(clearInterval(ne.value),ne.value=null,re.value=5)}),1e3)));var t})},null,8,["modelValue"]),f(r,{size:"small",class:"!ml-[12px]",onClick:t[2]||(t[2]=function(e){return K.value=!0,void _e()})},{default:d((function(){return t[23]||(t[23]=[m(" 面板SSL配置 ")])})),_:1})]})),desc:d((function(){return[t[25]||(t[25]=h("span",null,"为面板设置https协议访问，提升面板访问安全性，",-1)),f(a,{href:"https://www.bt.cn/bbs/thread-105443-1-1.html"},{default:d((function(){return t[24]||(t[24]=[m("了解详情")])})),_:1})]})),_:1}),f(o,{title:"自定义面板证书",modelValue:p(K),"onUpdate:modelValue":t[9]||(t[9]=function(e){return v(K)?K.value=e:null}),area:[70]},{default:d((function(){return[V((c(),s("div",Qe,[f(u,{type:"success",closable:!1},{default:d((function(){return[h("div",Xe,[t[26]||(t[26]=m(" 认证域名：")),h("span",Ze,k(p(oe).info.subject),1)]),h("div",$e,[t[27]||(t[27]=m(" 证书品牌：")),h("span",We,k(p(oe).info.issuer),1)]),h("div",et,[t[28]||(t[28]=m(" 到期时间： ")),h("span",tt,k(p(oe).info.notAfter),1)])]})),_:1}),t[46]||(t[46]=h("div",{class:"mt-6 flex items-center text-[#20a53a] font-bold"},[h("span",null,"堡塔APP IOS端使用https证书需要使用非自签证书")],-1)),p(oe).download_root?(c(),s(C,{key:0},[h("div",nt,[t[32]||(t[32]=h("span",null,"温馨提示：当前证书为自签证书，需要安装本地根证书，",-1)),f(r,{size:"small",type:"primary",class:"mr-[8px]"},{default:d((function(){return t[29]||(t[29]=[h("a",{href:"/download?filename=/www/server/panel/ssl/baota_root.pfx",target:"_blank"},"下载根证书",-1)])})),_:1}),p(oe).root_password?(c(),s(C,{key:0},[t[31]||(t[31]=h("span",null,"证书密码：",-1)),h("div",rt,[f(l,{modelValue:p(oe).root_password,"onUpdate:modelValue":t[3]||(t[3]=function(e){return p(oe).root_password=e}),disabled:!0,placeholder:"密码为空"},null,8,["modelValue"]),f(r,{type:"primary",class:"align-sub",onClick:t[4]||(t[4]=function(e){return function(e){if(!e)return H.error("当前密码为空，无法复制！");R({value:e})}(p(oe).root_password||"")})},{default:d((function(){return t[30]||(t[30]=[m("复制 ")])})),_:1})])],64)):S("",!0)]),h("div",at,[t[34]||(t[34]=h("span",null,[h("span",{class:"text-danger"},"MAC"),m("专用本地根证书：")],-1)),f(r,{size:"small",type:"primary",class:"mr-[8px]"},{default:d((function(){return t[33]||(t[33]=[h("a",{href:"/download?filename=/www/server/panel/ssl/baota_root.crt",target:"_blank"},"下载根证书",-1)])})),_:1}),t[35]||(t[35]=h("span",null,[m("* 无密码 "),h("span",{class:"text-danger"},"MAC"),m("需要设置信任此证书")],-1))])],64)):S("",!0),h("div",ut,[h("div",lt,[h("div",ot,[t[37]||(t[37]=h("span",{class:"mr-4px"},"面板SSL",-1)),f(n,{modelValue:p(i).panelSSl,"onUpdate:modelValue":t[5]||(t[5]=function(e){return p(i).panelSSl=e}),onChange:t[6]||(t[6]=function(e){return t=p(i).panelSSl,void ke(t?1:0,oe.value.privateKey,oe.value.certPem);var t})},null,8,["modelValue"]),f(a,{href:"https://www.bt.cn/bbs/thread-105443-1-1.html",class:"ml-[12px]"},{default:d((function(){return t[36]||(t[36]=[m(" 如何开启证书？ ")])})),_:1})]),f(r,{size:"small",class:"float-right",onClick:ge},{default:d((function(){return t[38]||(t[38]=[m("证书夹")])})),_:1})]),h("div",it,[h("div",ct,[t[39]||(t[39]=h("div",{class:"text-[1.2rem] mb-[8px]"},"密钥(KEY)",-1)),f(l,{class:"text-[1.2rem]",type:"textarea",modelValue:p(oe).privateKey,"onUpdate:modelValue":t[7]||(t[7]=function(e){return p(oe).privateKey=e}),rows:13,size:"small"},null,8,["modelValue"])]),h("div",st,[t[40]||(t[40]=h("div",{class:"text-[1.2rem] mb-[8px]"},"证书(PEM格式)",-1)),f(l,{type:"textarea",modelValue:p(oe).certPem,"onUpdate:modelValue":t[8]||(t[8]=function(e){return p(oe).certPem=e}),rows:13,size:"small"},null,8,["modelValue"])])]),f(r,{type:"primary",class:"!mt-4",onClick:be},{default:d((function(){return t[41]||(t[41]=[m("保存")])})),_:1})]),h("ul",ft,[h("li",null,[h("div",dt,[t[43]||(t[43]=m(" 粘贴您的*.key以及*.pem内容，然后保存即可 ")),f(a,{href:"https://www.bt.cn/bbs/thread-105443-1-1.html"},{default:d((function(){return t[42]||(t[42]=[m("帮助")])})),_:1})])]),t[44]||(t[44]=h("li",null,"如果浏览器提示证书链不完整,请检查是否正确拼接PEM证书",-1)),t[45]||(t[45]=h("li",null,"PEM格式证书 = 域名证书.crt + 根证书(root_bundle).crt",-1))])])),[[me,p(le)],[me,"正在获取证书信息，请稍候...","title"]])]})),_:1},8,["modelValue"]),f(o,{title:"关闭面板SSL",area:38,modelValue:p(z),"onUpdate:modelValue":t[13]||(t[13]=function(e){return v(z)?z.value=e:null}),onCancel:t[14]||(t[14]=function(e){return Ue(!1)})},{default:d((function(){return[h("div",pt,[t[49]||(t[49]=h("div",{class:"flex items-center px-[20px]"},[h("i",{class:"svgtofont-el-warning-filled text-[#e6a23c] !text-[4rem] pr-4"}),h("span",{class:"text-[1.4rem] leading-10 text-danger"},"关闭SSL后请使用安全登录模式进行登录，否则会存在“重放攻击”风险，是否确定关闭？")],-1)),h("div",vt,[f(g,{modelValue:p(B),"onUpdate:modelValue":t[10]||(t[10]=function(e){return v(B)?B.value=e:null}),class:"!mr-[4px]"},null,8,["modelValue"]),t[47]||(t[47]=m(" 我已了解风险，确认关闭 "))]),h("div",mt,[f(r,{type:"warning",onClick:t[11]||(t[11]=function(e){return Ue(!1)})},{default:d((function(){return t[48]||(t[48]=[m("取消")])})),_:1}),f(r,{type:"danger",onClick:t[12]||(t[12]=function(e){return Pe(!1)}),disabled:!!p(ne)||!p(B)},{default:d((function(){return[m("确认关闭SSL "+k(p(ne)?"（剩余".concat(p(re),"秒可操作）"):""),1)]})),_:1},8,["disabled"])])])]})),_:1},8,["modelValue"]),f(o,{title:"面板证书SSL",area:[54],modelValue:p(F),"onUpdate:modelValue":t[19]||(t[19]=function(e){return v(F)?F.value=e:null}),"show-footer":!0,onConfirm:t[20]||(t[20]=function(e){return Pe(!0)}),onCancel:t[21]||(t[21]=function(e){return Ue(!0)})},{default:d((function(){return[h("div",ht,[h("div",yt,[f(I,{name:"scanning-success",size:"3.2"}),t[50]||(t[50]=h("p",{class:"text-[2.1rem] ml-[4px]"},"立即【开启SSL证书】保护面板安全",-1))]),h("div",xt,[t[51]||(t[51]=h("span",null,"访问步骤：",-1)),t[52]||(t[52]=h("ul",{class:"list-decimal ml-[20px] mt-[4px] leading-10"},[h("li",null,"开启https"),h("li",null,"使用https网站访问面板"),h("li",null,"如提醒风险（正常现象）点击【高级】或【详情】如下图"),h("li",null,"【继续访问】或【接受风险并继续】")],-1)),f(N,{src:"/other/bt-https.png",class:"block mt-[4px] h-[18rem] w-[28rem]"})]),f(ue,{ref:"form",model:p(ae),class:"my-6"},{default:d((function(){return[f(J,{label:"类型"},{default:d((function(){return[f(Y,{modelValue:p(ae).sllType,"onUpdate:modelValue":t[15]||(t[15]=function(e){return p(ae).sllType=e}),class:"!w-[28rem]",onChange:we},{default:d((function(){return[(c(),s(C,null,U(ie,(function(e){return f(M,{key:e.key,label:e.title,value:e.key,disabled:e.disabled},{default:d((function(){return[2!==e.key||p(i).domain?(c(),s("span",wt,k(e.title),1)):(c(),P(D,{key:0,class:"item",effect:"dark",content:"Let's Encrypt证书类型需要绑定域名才能选择",placement:"top-start"},{default:d((function(){return[h("span",null,k(e.title),1)]})),_:2},1024))]})),_:2},1032,["label","value","disabled"])})),64))]})),_:1},8,["modelValue"])]})),_:1}),2==p(ae).sllType?(c(),P(J,{key:0,label:"验证方法"},{default:d((function(){return[f(X,{modelValue:p(ae).resource,"onUpdate:modelValue":t[16]||(t[16]=function(e){return p(ae).resource=e})},{default:d((function(){return[f(Q,{label:"http",value:"http"},{default:d((function(){return t[53]||(t[53]=[m("文件验证")])})),_:1}),f(Q,{label:"dns",value:"dns"},{default:d((function(){return t[54]||(t[54]=[m("DNS验证")])})),_:1})]})),_:1},8,["modelValue"])]})),_:1})):S("",!0),3==p(ae).sllType?(c(),P(J,{key:1,label:"密钥(KEY)"},{default:d((function(){return[h("div",bt,[f(l,{modelValue:p(ae).privateKey,"onUpdate:modelValue":t[17]||(t[17]=function(e){return p(ae).privateKey=e}),type:"textarea",rows:4},null,8,["modelValue"])])]})),_:1})):S("",!0),3==p(ae).sllType?(c(),P(J,{key:2,label:"证书(PEM格式)"},{default:d((function(){return[h("div",gt,[f(l,{modelValue:p(ae).certPem,"onUpdate:modelValue":t[18]||(t[18]=function(e){return p(ae).certPem=e}),type:"textarea",rows:4},null,8,["modelValue"])])]})),_:1})):S("",!0)]})),_:1},8,["model"]),h("ul",_t,[h("li",null,[h("div",Vt,[t[56]||(t[56]=m("开启后导致面板不能访问，可以点击查看")),f(a,{href:"https://www.bt.cn/bbs/thread-117246-1-1.html"},{default:d((function(){return t[55]||(t[55]=[m("解决方法")])})),_:1})])]),t[57]||(t[57]=h("li",null,"自签证书不被浏览器信任，显示不安全是正常现象",-1))])])]})),_:1},8,["modelValue"]),f(o,{modelValue:p(fe),"onUpdate:modelValue":t[22]||(t[22]=function(e){return v(fe)?fe.value=e:null}),area:70,title:"手动".concat("dns"===p(ae).resource?"解析TXT记录":"创建验证文件")},{default:d((function(){return[h("div",kt,[t[59]||(t[59]=m(" 请按以下列表做TXT解析: ")),f(pe,null,{content:d((function(){return[h("div",Ct,[(c(!0),s(C,null,U(p(ce),(function(e,t){return c(),s(C,null,[e.data.length?(c(),s("div",{key:t},[h("span",null,"验证域名："+k(e.domain),1),f(se,{class:"my-[1rem]",column:ye,data:e.data},null,8,["data"])])):S("",!0)],64)})),256))])]})),"footer-right":d((function(){return[f(r,{onClick:xe},{default:d((function(){return t[58]||(t[58]=[m("验证")])})),_:1})]})),_:1}),f(ve,{options:de,listStyle:"disc",class:"ml-[20px]"})])]})),_:1},8,["modelValue","title"])])}}}),Ut=ne(St,[["__scopeId","data-v-8760e57a"]]),Pt=r({__name:"index",setup:function(e){var r=D().getCertListData,o=u({}),s=u("配置一个域名来访问面板"),v=function(){var e=l(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}w(),e.next=6;break;case 4:return e.next=6,M({loading:"正在删除面板生成的域名，请稍候...",request:ye(),message:!0,success:r});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(){Y({title:"免端口访问配置",component:function(){return J((function(){return t.import("./no-port-config-legacy.js?v=1734676359")}),void 0,t.meta.url)},compData:n(n({},o.value),{},{refresh:b}),area:80,onCancel:function(){o.value.proxy_stats=!o.value.proxy_stats}})},b=function(){var e=l(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M({request:xe(),success:function(e){var t=e.data;o.value={addr:(null==t?void 0:t.addr)||"",cert:(null==t?void 0:t.cert)||"",key:(null==t?void 0:t.key)||"",proxy_stats:(null==t?void 0:t.proxy_stats)||!1,domain:(null==t?void 0:t.domain)||"",certInfo:(null==t?void 0:t.info)||{}}}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return i((function(){return b()})),function(e,t){var n=y,r=x;return c(),P(p(Fe),{label:"免端口访问"},{value:d((function(){return[f(n,{modelValue:p(o).proxy_stats,"onUpdate:modelValue":t[0]||(t[0]=function(e){return p(o).proxy_stats=e}),onChange:t[1]||(t[1]=function(e){return v(p(o).proxy_stats)})},null,8,["modelValue"]),f(r,{size:"small",class:"!ml-12px",onClick:t[2]||(t[2]=function(e){return w()})},{default:d((function(){return t[3]||(t[3]=[m(" 免端口访问配置 ")])})),_:1})]})),desc:d((function(){return[h("span",null,k(p(s)),1)]})),_:1})}}}),At={class:"p-[24px]"},jt=r({__name:"index",setup:function(e){var t=D().refs.safeConfig;u(!1);var r=u(!1);u(!1);var i=o({basic_user:"",basic_pwd:"",open:!0}),g=function(){var e=l(a().mark((function e(n){var u,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=4;break}Ge({content:['<span class="text-danger">必须要用到且了解此功能才决定自己是否要开启!!<span>',"开启后，以任何方式访问面板，将先要求输入BasicAuth用户名和密码","开启后，能有效防止面板被扫描发现，但并不能代替面板本身的帐号密码","请牢记BasicAuth密码，一但忘记将无法访问面板","如忘记密码，可在SSH通过bt命令来关闭BasicAuth验证"],isShowAppCode:!1,checkTip:'我已了解详情,并愿意承担风险！<a class="bt-link" href="https://www.bt.cn/bbs/thread-34374-1-1.html" target="_blank">什么是BasicAuth认证？</a>',onConfirm:function(){return r.value=!0},onCancel:function(){return t.value.basicAuth=!1}}),e.next=10;break;case 4:return e.next=6,we({open:"False",basic_user:"",basic_pwd:""});case 6:u=e.sent,l=u.data,H.request(l),l.status&&setTimeout((function(){return window.location.reload()}),1e3);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=l(a().mark((function e(){var t,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,we(n(n({},i),{},{open:i.open?"True":"False"}));case 3:t=e.sent,u=t.data,H.request(u),u.status&&(r.value=!1,window.location.reload()),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return function(e,n){var a=y,u=Z,l=w,o=$,V=x,k=b,C=G;return c(),s("div",null,[f(p(Fe),{label:"BasicAuth认证"},{value:d((function(){return[f(a,{modelValue:p(t).basicAuth,"onUpdate:modelValue":n[0]||(n[0]=function(e){return p(t).basicAuth=e}),onChange:n[1]||(n[1]=function(e){return g(p(t).basicAuth)})},null,8,["modelValue"])]})),desc:d((function(){return[n[10]||(n[10]=h("span",null,"为面板增加一道基于BasicAuth的认证服务，有效防止面板被扫描，",-1)),f(u,{href:"https://www.bt.cn/bbs/thread-34374-1-1.html"},{default:d((function(){return n[9]||(n[9]=[m("了解详情")])})),_:1})]})),_:1}),f(C,{title:"配置BasicAuth认证",modelValue:p(r),"onUpdate:modelValue":n[7]||(n[7]=function(e){return v(r)?r.value=e:null}),area:50,onCancel:n[8]||(n[8]=function(e){return t.value.basicAuth=!t.value.basicAuth,void i.open})},{default:d((function(){return[h("div",At,[f(k,{modelValue:p(i),"onUpdate:modelValue":n[6]||(n[6]=function(e){return v(i)?i.value=e:null})},{default:d((function(){return[f(l,{label:"服务状态"},{default:d((function(){return[f(a,{modelValue:p(i).open,"onUpdate:modelValue":n[2]||(n[2]=function(e){return p(i).open=e})},null,8,["modelValue"])]})),_:1}),f(l,{label:"用户名"},{default:d((function(){return[f(o,{class:"!w-[28.8rem]",modelValue:p(i).basic_user,"onUpdate:modelValue":n[3]||(n[3]=function(e){return p(i).basic_user=e}),placeholder:"请设置用户名"},null,8,["modelValue"])]})),_:1}),f(l,{label:"密码"},{default:d((function(){return[f(o,{class:"!w-[28.8rem]",modelValue:p(i).basic_pwd,"onUpdate:modelValue":n[4]||(n[4]=function(e){return p(i).basic_pwd=e}),placeholder:"请输入密码"},null,8,["modelValue"])]})),_:1}),f(l,{label:" "},{default:d((function(){return[f(V,{type:"primary",onClick:n[5]||(n[5]=function(e){return _()})},{default:d((function(){return n[11]||(n[11]=[m("保存")])})),_:1})]})),_:1})]})),_:1},8,["modelValue"]),n[12]||(n[12]=h("ul",{class:"pl-[32px] list-disc help leading-8"},[h("li",null,"注意：请不要在这里使用您的常用密码，这可能导致密码泄漏!"),h("li",null,"开启后，以任何方式访问面板，将先要求输入BasicAuth用户名和密码"),h("li",null,"开启后，能有效防止面板被扫描发现，但并不能代替面板本身的帐号密码"),h("li",null,"请牢记BasicAuth密码，一但忘记将无法访问面板"),h("li",null,"如忘记密码，可在SSH通过bt命令来关闭BasicAuth验证")],-1))])]})),_:1},8,["modelValue"])])}}}),Et=r({__name:"index",setup:function(e){var n=D().refs.safeConfig;u(!1);var r=function(){Ge({content:['<span class="text-danger">必须要用到且了解此功能才决定自己是否要开启!!<span>','<span class="text-danger">如果无法验证，命令行输入"bt 24" 取消动态口令认证<span>',"开启服务后，请立即绑定，以免出现面板不能访问。","请先下载宝塔APP或(谷歌认证器)，并完成安装和初始化。",'基于google Authenticator 开发,如遇到问题请<a class="btlink" href="https://www.bt.cn/bbs/forum.php?mod=viewthread&tid=105839">查看详情</a>'],isShowAppCode:!0,onConfirm:function(){return w(1)}})},o=function(){n.value.checkTwoStep?v():r()},v=function(){Y({title:"动态口令配置",component:function(){return J((function(){return t.import("./dyname-pwd-config-legacy.js?v=1734676359")}),void 0,t.meta.url)},area:55})},w=function(){var e=l(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M({loading:"正在设置动态口令配置，请稍候...",request:be({act:t}),message:!0,success:function(){t&&v()}});case 2:e.sent.status&&(n.value.checkTwoStep=Boolean(t));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=l(a().mark((function e(){var t,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ge();case 2:t=e.sent,r=t.data,n.value.checkTwoStep=r.status;case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return i((function(){b()})),function(e,t){var a=y,u=x,l=Z;return c(),s("div",null,[f(p(Fe),{label:"动态口令认证"},{value:d((function(){return[f(a,{modelValue:p(n).checkTwoStep,"onUpdate:modelValue":t[0]||(t[0]=function(e){return p(n).checkTwoStep=e}),onChange:t[1]||(t[1]=function(e){return t=p(n).checkTwoStep,n.value.checkTwoStep=!t,void(t?r():w(Number(t)));var t})},null,8,["modelValue"]),f(u,{size:"small",class:"!ml-12px",onClick:o},{default:d((function(){return t[2]||(t[2]=[m("动态口令配置")])})),_:1})]})),desc:d((function(){return[t[4]||(t[4]=h("span",null,"(Google Authenticator，谷歌身份认证)为面板提供动态口令的登录的验证，",-1)),f(l,{href:"https://www.bt.cn/bbs/forum.php?mod=viewthread&tid=105839"},{default:d((function(){return t[3]||(t[3]=[m("了解详情")])})),_:1})]})),_:1})])}}}),Lt={class:"p-[2rem]"},Tt={class:"flex mt-12px"},Ot={class:"flex-1 mr-20px relative"},qt={class:"placeholder"},It={class:"flex-1 relative"},Nt={class:"placeholder"},Kt={key:1,class:"help-list !pl-20px mt-12px !bg-[#fff] !py-0"},zt={class:"text-[1.2rem] flex items-center"},Ft=r({__name:"index",setup:function(e){var t=D().refs.safeConfig,n=u(!1),r=u(!1),i=u(!1),w=o({loading:!1,title:"正在获取证书信息，请稍候..."}),b=u({crl:"",cert:""}),k=function(){var e=l(a().mark((function e(){var r,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w.title="正在获取证书信息，请稍候...",w.loading=!0,n.value=!0,e.prev=3,e.next=6,_e();case 6:r=e.sent,u=r.data,t.value.sslVerify=u.status,b.value.crl=u.crl,b.value.cert=u.ca,e.next=17;break;case 13:e.prev=13,e.t0=e.catch(3),n.value=!1;case 17:return e.prev=17,w.loading=!1,e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[3,13,17,20]])})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=l(a().mark((function e(u){var l,o,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.value.panelSSl){e.next=5;break}return H.error("请先开启面板SSL证书后重试"),t.value.sslVerify=!1,e.abrupt("return");case 5:return e.next=7,_e();case 7:if(l=e.sent,o=l.data,b.value.crl=o.crl,b.value.cert=o.ca,r.value=!0,!u){e.next=16;break}n.value=!0,e.next=21;break;case 16:return e.next=18,Ve({status:0});case 18:i=e.sent,i.data.status&&window.location.reload();case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(0);case 26:case"end":return e.stop()}}),e,null,[[0,23]])})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=l(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,b.value.crl){e.next=3;break}return e.abrupt("return",H.error("注销列表(crl)不能为空"));case 3:if(b.value.cert){e.next=5;break}return e.abrupt("return",H.error("证书(cert)不能为空"));case 5:if(!r.value||i.value){e.next=7;break}return e.abrupt("return",H.error("请勾选并同意承担风险"));case 7:return w.title="正在保存，请稍候...",w.loading=!0,e.next=11,M({request:Ve({crl:b.value.crl,cert:b.value.cert,status:r.value?1:0}),message:!0});case 11:return t=e.sent,e.next=14,re();case 14:return t.status&&window.location.reload(),e.abrupt("return",t.status);case 18:e.prev=18,e.t0=e.catch(0);case 21:return e.prev=21,w.loading=!1,e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[0,18,21,24]])})));return function(){return e.apply(this,arguments)}}();return g(n,(function(e,t){!e&&(b.value.crl="",b.value.cert="")})),function(e,a){var u=y,l=x,o=Z,g=$,E=j,L=G,T=_("bt-loading");return c(),s("div",null,[f(p(Fe),{label:"访问设备验证"},{value:d((function(){return[f(u,{modelValue:p(t).sslVerify,"onUpdate:modelValue":a[0]||(a[0]=function(e){return p(t).sslVerify=e}),onChange:a[1]||(a[1]=function(e){return U(p(t).sslVerify)})},null,8,["modelValue"]),f(l,{size:"small",class:"!ml-12px",onClick:k},{default:d((function(){return a[7]||(a[7]=[m("访问设备验证配置")])})),_:1})]})),desc:d((function(){return[a[9]||(a[9]=h("span",null," 基于SSL证书双向验证，开启后电脑需要安装此证书，否则将无法访问，属于极高安全级别的访问限制方式，类似银行账号U盘密钥登录。 ",-1)),f(o,{href:"https://www.bt.cn/bbs/thread-77863-1-1.html"},{default:d((function(){return a[8]||(a[8]=[m("了解详情")])})),_:1})]})),_:1}),f(L,{title:"自定义证书",modelValue:p(n),"onUpdate:modelValue":a[5]||(a[5]=function(e){return v(n)?n.value=e:null}),area:70,showFooter:"",onConfirm:A,onCancel:a[6]||(a[6]=function(e){return r.value&&(t.value.sslVerify=!t.value.sslVerify),void(r.value=!1)})},{default:d((function(){return[V((c(),s("div",Lt,[p(r)?(c(),s(C,{key:0},[a[10]||(a[10]=h("div",{class:"flex items-center"},[h("i",{class:"svgtofont-el-warning-filled text-[#E6A23C] !text-[4rem] pr-4"}),h("p",{class:"text-[2.1rem]"},"风险操作！此功能不懂请勿开启！")],-1)),a[11]||(a[11]=h("ul",{class:"help-list"},[h("li",{class:"text-danger"},"必须要用到且了解此功能才决定自己是否要开启！"),h("li",null,"开启后电脑需要安装此证书，否则将无法访问，属于【极高安全级别】的限制，类似银行账号U盘密钥登录。"),h("li",null,"注销列表(crl)和证书(cert)可通过企业版插件[堡塔限制访问型证书->双向认证->服务器证书]获取。"),h("li",null,"开启之前请先下载好对应的[客户端证书]，否则将无法访问面板。"),h("li",null,"开启访问设备验证后，未授权的用户访问将会出现400错误。"),h("li",null,"开启后导致面板不能访问，命令行：bt 29 关闭访问设备验证。")],-1))],64)):S("",!0),h("div",Tt,[h("div",Ot,[a[12]||(a[12]=h("div",{class:"text-[1.2rem] mb-8px"},"注销列表(crl)",-1)),f(g,{class:"text-[1.2rem]",type:"textarea",modelValue:p(b).crl,"onUpdate:modelValue":a[2]||(a[2]=function(e){return p(b).crl=e}),rows:13,size:"small"},null,8,["modelValue"]),V(h("span",qt,"请粘贴您的注销列表（crl）",512),[[I,""===p(b).crl]])]),h("div",It,[a[13]||(a[13]=h("div",{class:"text-[1.2rem] mb-8px"},"证书(cert)",-1)),f(g,{type:"textarea",modelValue:p(b).cert,"onUpdate:modelValue":a[3]||(a[3]=function(e){return p(b).cert=e}),rows:13,size:"small"},null,8,["modelValue"]),V(h("span",Nt,"请粘贴您的证书(cert)",512),[[I,""===p(b).cert]])])]),p(r)?(c(),P(E,{key:2,modelValue:p(i),"onUpdate:modelValue":a[4]||(a[4]=function(e){return v(i)?i.value=e:null}),class:"mt-12px px-16px"},{default:d((function(){return[h("div",zt,[a[16]||(a[16]=m(" 已了经解详情,并愿意承担风险！ ")),f(o,{href:"https://www.bt.cn/bbs/thread-77863-1-1.html",target:"_blank"},{default:d((function(){return a[15]||(a[15]=[m(" 了解详情 ")])})),_:1})])]})),_:1},8,["modelValue"])):(c(),s("ul",Kt,a[14]||(a[14]=[h("li",null,"粘贴您的注销列表(crl)以及证书(cert)，然后保存即可。",-1),h("li",null,"注销列表(crl)和证书(cert)可通过企业版插件[堡塔限制访问型证书->双向认证->服务器证书]获取。",-1)])))])),[[T,p(w).loading],[T,p(w).title,"title"]])]})),_:1},8,["modelValue"])])}}}),Dt=ne(Ft,[["__scopeId","data-v-0180c4d5"]]),Mt=r({__name:"index",setup:function(e){var t=D().refs.safeConfig,n=u(!1),r=u(!1),o=function(e){e?n.value=!0:r.value=!0},i=function(e){var a=e?n:r;a.value&&(t.value.pawComplexity=!t.value.pawComplexity,a.value=!1)},x=function(e){var t=e?n:r;t.value&&(t.value=!1,b())},w=function(){var e=l(a().mark((function e(){var n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ce();case 3:n=e.sent,r=n.data,t.value.pawComplexity=r.password_safe,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=l(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M({loading:"正在设置密码复杂度，请稍候...",request:ke(),message:!0,success:w});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return function(e,a){var u=y,l=G;return c(),s("div",null,[f(p(Fe),{label:"密码复杂度验证"},{value:d((function(){return[f(u,{modelValue:p(t).pawComplexity,"onUpdate:modelValue":a[0]||(a[0]=function(e){return p(t).pawComplexity=e}),onChange:o},null,8,["modelValue"])]})),desc:d((function(){return a[7]||(a[7]=[h("span",null,"为面板密码提供复杂度验证方式，复杂度验证规则：",-1),h("span",{class:"text-danger"},"密码必须满足密码长度大于8位且大写字母、小写字母、数字、特殊字符至少3项组合",-1)])})),_:1}),f(l,{title:"开启 密码复杂度验证",modelValue:p(n),"onUpdate:modelValue":a[1]||(a[1]=function(e){return v(n)?n.value=e:null}),area:36,"show-footer":!0,onConfirm:a[2]||(a[2]=function(e){return x(!0)}),onCancel:a[3]||(a[3]=function(e){return i(!0)})},{default:d((function(){return a[8]||(a[8]=[h("div",{class:"p-[2rem] flex"},[h("i",{class:"svgtofont-el-warning-filled text-[#E6A23C] !text-[4rem] pr-4"}),h("p",{class:"text-[1.4rem] leading-8"},[m(" 开启密码复杂度验证后，将会对密码进行复杂度判断，规则： "),h("span",{class:"text-danger"},"密码必须满足密码长度大于8位且大写字母、小写字母、数字、特殊字符至少3项组合"),m(" ，继续操作！ ")])],-1)])})),_:1},8,["modelValue"]),f(l,{title:"关闭 密码复杂度验证",modelValue:p(r),"onUpdate:modelValue":a[4]||(a[4]=function(e){return v(r)?r.value=e:null}),area:[36,"auto"],"show-footer":!0,onConfirm:a[5]||(a[5]=function(e){return x(!1)}),onCancel:a[6]||(a[6]=function(e){return i(!1)})},{default:d((function(){return a[9]||(a[9]=[h("div",{class:"p-[2rem] flex"},[h("i",{class:"svgtofont-el-warning-filled text-[#E6A23C] !text-[4rem] pr-4"}),h("p",{class:"text-[1.4rem] leading-8"},"关闭密码复杂度后，密码登录将不再验证密码复杂度，这将会导致面板安全性下降，继续操作！")],-1)])})),_:1},8,["modelValue"])])}}}),Bt={class:"w-[26rem]"},Gt=r({__name:"index",setup:function(e){var t=D(),n=t.refs.safeConfig,r=t.saveConfig;return function(e,t){var a=$,u=x;return c(),P(p(Fe),{label:"绑定域名"},{value:d((function(){return[h("div",Bt,[f(a,{modelValue:p(n).domain,"onUpdate:modelValue":t[0]||(t[0]=function(e){return p(n).domain=e})},null,8,["modelValue"])]),f(u,{type:"primary",class:"!ml-12px",onClick:t[1]||(t[1]=function(e){r("正在绑定域名，请稍候...")})},{default:d((function(){return t[2]||(t[2]=[m("保存")])})),_:1})]})),desc:d((function(){return t[3]||(t[3]=[h("span",null,"为面板绑定一个访问域名，",-1),h("span",{class:"text-danger"},"注意：一旦绑定域名，只能通过域名访问面板",-1)])})),_:1})}}}),Ht={class:"w-[26rem]"},Rt=r({__name:"index",setup:function(e){var t=D(),n=t.refs.safeConfig,r=t.saveConfig,u=function(){var e=l(a().mark((function e(){var t,u,l,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=/^((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})){3}$/,u=n.value.limitip.split(",").join("-").split("-"),l=!0,u.length)for(o=0;o<u.length;o++)0==t.test(u[o])&&(l=!1);if(l||!(n.value.limitip.length>0)){e.next=8;break}return e.abrupt("return",H.error("请输入正确的ip地址"));case 8:r("正在保存授权IP，请稍候...");case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return function(e,t){var r=$,a=x;return c(),P(p(Fe),{label:"授权IP"},{value:d((function(){return[h("div",Ht,[f(r,{modelValue:p(n).limitip,"onUpdate:modelValue":t[0]||(t[0]=function(e){return p(n).limitip=e}),placeholder:"示例: 1.1.1.1,2.2.2.1-2.2.2.2"},null,8,["modelValue"])]),f(a,{type:"primary",class:"!ml-12px",onClick:t[1]||(t[1]=function(e){return u()})},{default:d((function(){return t[2]||(t[2]=[m("保存")])})),_:1})]})),desc:d((function(){return t[3]||(t[3]=[h("span",null,"设置访问授权IP，多个IP地址，请使用“,”分割，",-1),h("span",{class:"text-danger"},"注意：一旦设置授权IP，只有指定IP的电脑能访问面板",-1)])})),_:1})}}}),Yt={class:"p-[2rem]"},Jt={class:"text-[1.2rem] flex items-center"},Qt=r({__name:"index",setup:function(e){var t=D().refs,n=t.safeConfig,r=t.openPortPopup,o=u(8888),i=u(!1),y=u(!1),_=function(){y.value=!0,o.value=n.value.port},V=function(){var e=l(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M({loading:"正在设置面板端口，请稍候...",request:Se({port:o.value}),message:!0});case 2:ue("".concat(location.protocol,"//").concat(location.hostname,":").concat(o.value).concat(location.pathname),2e3);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return g((function(){return r}),(function(e){e&&(_(),r.value=!1)}),{deep:!0}),function(e,t){var r=$,a=x,u=w,l=b,g=Z,k=j,C=G;return c(),s("div",null,[f(p(Fe),{label:"面板端口"},{value:d((function(){return[f(r,{modelValue:p(n).port,"onUpdate:modelValue":t[0]||(t[0]=function(e){return p(n).port=e}),disabled:"",class:"!w-[26rem]"},null,8,["modelValue"]),f(a,{type:"primary",class:"!ml-12px",onClick:_},{default:d((function(){return t[5]||(t[5]=[m("设置")])})),_:1})]})),desc:d((function(){return t[6]||(t[6]=[h("span",null,[h("span",null,"建议端口范围8888 - 65535，"),h("span",{class:"text-danger"},"注意：有安全组的服务器请提前在安全组放行新端口")],-1)])})),_:1}),f(C,{title:"设置面板端口",modelValue:p(y),"onUpdate:modelValue":t[3]||(t[3]=function(e){return v(y)?y.value=e:null}),area:40,"show-footer":!0,onConfirm:t[4]||(t[4]=function(e){return function(){if(!i.value)return H.error("请勾选同意协议");var e=Number(o.value);if(!ae(e))return H.error("端口格式错误，请重新输入");y.value=!1,V()}()})},{default:d((function(){return[h("div",Yt,[t[9]||(t[9]=h("ul",{class:"help-list"},[h("li",null,"建议端口范围8888 - 65535，"),h("li",null,"注意：有安全组的服务器请提前在安全组放行新端口"),h("li",null,"如果修改端口导致面板无法访问，请在SSH命令行通过bt命令改回原来的端口")],-1)),f(l,{id:"panelPostFrom",class:"mt-[24px] flex justify-center","label-position":"left"},{default:d((function(){return[f(u,{label:"面板端口"},{default:d((function(){return[f(r,{modelValue:p(o),"onUpdate:modelValue":t[1]||(t[1]=function(e){return v(o)?o.value=e:null}),class:"w-[21rem] edit-input"},null,8,["modelValue"])]})),_:1})]})),_:1}),f(k,{modelValue:p(i),"onUpdate:modelValue":t[2]||(t[2]=function(e){return v(i)?i.value=e:null}),class:"pl-16px"},{default:d((function(){return[h("div",Jt,[t[8]||(t[8]=m("我已了解,")),f(g,{href:"https://www.bt.cn/bbs/thread-40037-1-1.html"},{default:d((function(){return t[7]||(t[7]=[m("如何放行端口？")])})),_:1})])]})),_:1},8,["modelValue"])])]})),_:1},8,["modelValue"])])}}}),Xt=ne(Qt,[["__scopeId","data-v-e4d5d363"]]),Zt={class:"p-[2.8rem]"},$t=r({__name:"index",setup:function(e){var t=D().refs.safeConfig,n=u(""),r=u(!1),o=function(){n.value=t.value.admin_path,r.value=!0},i=function(){var e=l(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le(t);case 2:return t=e.sent,e.next=5,M({request:Ue({admin_path:t}),message:!0,loading:"正在设置安全入口，请稍候..."});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return function(e,a){var u=$,l=x,y=w,g=b,_=G;return c(),s("div",null,[f(p(Fe),{label:"安全入口"},{value:d((function(){return[f(u,{modelValue:p(t).admin_path,"onUpdate:modelValue":a[0]||(a[0]=function(e){return p(t).admin_path=e}),disabled:"",class:"!w-[26rem]"},null,8,["modelValue"]),f(l,{type:"primary",class:"!ml-12px",onClick:o},{default:d((function(){return a[4]||(a[4]=[m("设置")])})),_:1})]})),desc:d((function(){return a[5]||(a[5]=[h("span",null,"面板管理入口，设置后只能通过指定安全入口登录面板,如: /www_bt_cn",-1)])})),_:1}),f(_,{title:"设置面板安全入口",modelValue:p(r),"onUpdate:modelValue":a[2]||(a[2]=function(e){return v(r)?r.value=e:null}),area:40,"show-footer":"",onConfirm:a[3]||(a[3]=function(e){return t.value.admin_path=n.value,i(n.value),void(r.value=!1)})},{default:d((function(){return[h("div",Zt,[f(g,{class:"flex justify-center","label-position":"right"},{default:d((function(){return[f(y,{label:"安全入口"},{default:d((function(){return[f(u,{modelValue:p(n),"onUpdate:modelValue":a[1]||(a[1]=function(e){return v(n)?n.value=e:null}),class:"!w-[24rem]"},null,8,["modelValue"])]})),_:1})]})),_:1})])]})),_:1},8,["modelValue"])])}}}),Wt=ne($t,[["__scopeId","data-v-9989a3a1"]]),en={class:"p-[2rem]"},tn=r({__name:"index",setup:function(e){var t,n=D().refs.safeConfig,r=N([{key:403,title:"403-拒绝访问"},{key:404,title:"404-页面不存在"},{key:416,title:"416-无效的请求"},{key:408,title:"408-客户端超时"},{key:400,title:"400-客户端请求错误"},{key:401,title:"401-未授权访问"}]),o=u(!1),i=u(404),y=u(null===(t=r.value.find((function(e){return e.key===n.value.statusCode})))||void 0===t?void 0:t.title),_=function(){var e=l(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t?Number(t):t+="",e.next=3,M({loading:"正在设置未认证响应状态，请稍候...",request:Pe({status_code:t}),message:!0});case 3:r.value.forEach((function(e){e.key==i.value&&(n.value.statusCode=e.key,y.value=e.title)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return g((function(){return n.value.statusCode}),(function(e){r.value.forEach((function(e){e.key===n.value.statusCode&&(y.value=e.title)}))})),function(e,t){var a=$,u=x,l=q,g=E,V=w,k=b,S=G;return c(),s("div",null,[f(p(Fe),{label:"未认证响应状态"},{value:d((function(){return[f(a,{modelValue:p(y),"onUpdate:modelValue":t[0]||(t[0]=function(e){return v(y)?y.value=e:null}),disabled:"",class:"!w-[26rem]"},null,8,["modelValue"]),f(u,{type:"primary",class:"!ml-12px",onClick:t[1]||(t[1]=function(e){return o.value=!0,void r.value.forEach((function(e){e.key==n.value.statusCode&&(i.value=e.key)}))})},{default:d((function(){return t[5]||(t[5]=[m("设置")])})),_:1})]})),desc:d((function(){return t[6]||(t[6]=[h("span",null,"用于在未登录且未正确输入安全入口时的响应，可用于隐藏面板特征",-1)])})),_:1}),f(S,{title:"设置未认证时的响应状态",modelValue:p(o),"onUpdate:modelValue":t[3]||(t[3]=function(e){return v(o)?o.value=e:null}),area:42,"show-footer":"",onConfirm:t[4]||(t[4]=function(e){return o.value=!1,void _(i.value)})},{default:d((function(){return[h("div",en,[f(k,{class:"my-[12px] flex justify-center","label-position":"right"},{default:d((function(){return[f(V,{label:"响应状态"},{default:d((function(){return[f(g,{modelValue:p(i),"onUpdate:modelValue":t[2]||(t[2]=function(e){return v(i)?i.value=e:null}),placeholder:"请选择",class:"!w-[20rem]"},{default:d((function(){return[(c(!0),s(C,null,U(p(r),(function(e){return c(),P(l,{key:e.key,label:e.title,value:e.key},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1})]})),_:1}),t[7]||(t[7]=h("ul",{class:"px-[16px] py-[2px] list-disc"},[h("li",{class:"h-[2.4rem] text-danger"},"用于未登录且未正确输入安全入口时的响应,用于隐藏面板特征")],-1))])]})),_:1},8,["modelValue"])])}}}),nn=ne(tn,[["__scopeId","data-v-8fbf9d55"]]),rn={class:"w-[26rem]"},an={class:"p-[2rem]"},un=r({__name:"index",setup:function(e){var t=D().refs.safeConfig,n=u(),r=u({day:0}),y=u(""),_=u(!1),V=0,k=o({day:[{validator:function(e,t,n){Number.parseInt(t)<0||!Number.isInteger(parseFloat(t))?n(new Error("请输入大于等于0的整数")):n()},trigger:["input","change"]}]});g((function(){return _.value}),(function(e){e&&(r.value.day=V)}));var C=function(){var e=l(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.value.validate();case 2:_.value=!1,U(r.value.day),S();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=l(a().mark((function e(){var n,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ce();case 3:n=e.sent,(u=n.data).expire?y.value=oe(u.expire_time,"yyyy/MM/dd HH:mm:ss")+" （剩余"+u.expire_day+"天过期）":y.value="未设置",r.value.day=u.expire,V=u.expire,t.value.pawComplexity=u.password_safe,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=l(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M({loading:"正在设置密码过期时间，请稍候...",request:Ae({expire:t}),message:!0});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return i((function(){S()})),function(e,t){var a=$,u=x,l=w,o=b,i=G;return c(),s("div",null,[f(p(Fe),{label:"密码过期时间"},{value:d((function(){return[h("div",rn,[f(a,{modelValue:p(y),"onUpdate:modelValue":t[0]||(t[0]=function(e){return v(y)?y.value=e:null}),disabled:""},null,8,["modelValue"])]),f(u,{type:"primary",class:"!ml-12px",onClick:t[1]||(t[1]=function(e){return _.value=!0})},{default:d((function(){return t[5]||(t[5]=[m("设置")])})),_:1})]})),desc:d((function(){return t[6]||(t[6]=[h("span",null,"为面板密码设置过期时间，过期后需要重新设置密码",-1)])})),_:1}),f(i,{title:"设置密码过期时间",modelValue:p(_),"onUpdate:modelValue":t[3]||(t[3]=function(e){return v(_)?_.value=e:null}),area:40,"show-footer":!0,onConfirm:t[4]||(t[4]=function(e){return C()})},{default:d((function(){return[h("div",an,[f(o,{ref_key:"pwdFormRef",ref:n,rules:p(k),model:p(r),class:"my-[12px] flex justify-center","label-position":"left"},{default:d((function(){return[f(l,{label:"密码过期时间",prop:"day"},{default:d((function(){return[f(a,{modelValue:p(r).day,"onUpdate:modelValue":t[2]||(t[2]=function(e){return p(r).day=e}),"text-type":"天",type:"number",min:"0",class:"!w-[16rem]"},{append:d((function(){return t[7]||(t[7]=[m(" 天 ")])})),_:1},8,["modelValue"])]})),_:1})]})),_:1},8,["rules","model"]),t[8]||(t[8]=h("ul",{class:"px-[1.6rem] py-[.2rem] list-disc"},[h("li",{class:"h-[2.4rem] text-danger"},"面板密码过期时间设置，过期后需要重新设置密码"),h("li",{class:"h-[2.4rem]"},"密码过期时间为“0天”，则关闭密码过期时间功能")],-1))])]})),_:1},8,["modelValue"])])}}}),ln={class:"p-[2rem] flex"},on={class:"p-[2rem]"},cn=r({__name:"index",setup:function(e){var t=u(!1),n=u([]),r=u(!1),y=u(0),g=o({p:1,rows:10}),k=u(!1),C=u(!1),U=u([]),A=u(!1),j=u(),E=u({checkboxValue:"3小时",day:1}),L=u(""),O=u(),q=u(),I=u(!1),N={day:[{validator:function(e,t,n){(t<=0||t%1!=0)&&"自定义"===E.value.checkboxValue?n(new Error("自定义时间为大于0的整数！")):n()},trigger:["blur","change","input"]}]},F=function(){var e=l(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.value=!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=[{label:"登录IP",render:function(e){return e.login_addr||"未登录"}},{label:"状态",width:90,render:function(e,t){switch(e.state){case-1:return f("span",{class:"text-[brown]"},[m("已过期")]);case 0:return f("span",{class:"text-primary"},[m("待使用")]);case 1:return"已使用"}}},{label:"登录时间",render:function(e){return 0==e.login_time?"未登录":oe(e.addtime,"yyyy/MM/dd HH:mm:ss")}},{label:"过期时间",render:function(e){return oe(e.expire)}},{label:"操作",width:120,align:"right",render:function(e){return f("div",{class:"flex items-center justify-end"},[f("div",{class:"1"==e.state?"":"hidden"},[f("span",{class:"bt-link",onClick:function(){return J(e.id,e.login_addr)}},[m("操作日志")]),f(K,{direction:"vertical"},null)]),f("span",{class:"bt-link",onClick:function(){return Y(e.id)}},[m("删除")])])}}],B=[{label:"操作类型",prop:"type"},{label:"操作时间",prop:"addtime"},{label:"日志",prop:"log",width:350}],H=function(){var e=l(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.value.validate();case 2:return I.value=!1,e.next=5,X();case 5:null!=(t=e.sent)&&t.status&&(A.value=!0);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=l(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O.value=t,e.next=3,ie({title:"删除未使用授权",content:"删除授权记录，是否继续？",icon:"warning-filled"});case 3:return e.next=5,M({loading:"正在删除临时授权，请稍候...",request:je({id:t}),message:!0});case 5:W();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(e,t){k.value=!0,O.value=e,q.value=t,Q()},Q=function(){return Z(O.value)},X=function(){var e=l(a().mark((function e(){var t,n,r,u,l,o,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=E.value,n=t.checkboxValue,r=t.day,u="自定义"===n?24*r:n.replaceAll("小时",""),l=Math.floor(Date.now()/1e3),u=60*parseInt(u)*60+l,e.next=6,M({loading:"正在创建临时授权链接，请稍候...",request:Ee({expire_time:u}),message:!0,data:{token:String,expire:Number,status:Boolean}});case 6:return o=e.sent,W(),i=window.location.protocol+"//"+window.location.host+"/login?",L.value=i+"\ntmp_token="+o.token,e.abrupt("return",o);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=l(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M({loading:C,request:Le({id:t}),data:[Array,U]});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=l(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M({loading:r,request:Te(g),data:{data:[Array,n],page:ce(y)}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return i((function(){W()})),function(e,a){var u=x,l=te,o=He,i=Me,O=G,K=z,M=T,Y=w,J=$,X=b,Z=_("bt-loading");return c(),s("div",null,[f(p(Fe),{label:"临时访问授权"},{value:d((function(){return[f(u,{type:"primary",onClick:a[0]||(a[0]=function(e){return F()})},{default:d((function(){return a[13]||(a[13]=[m("临时访问授权管理")])})),_:1})]})),desc:d((function(){return a[14]||(a[14]=[h("span",null,"为非管理员临时提供面板访问权限",-1)])})),_:1}),f(O,{title:"临时授权管理",modelValue:p(t),"onUpdate:modelValue":a[4]||(a[4]=function(e){return v(t)?t.value=e:null}),area:70},{default:d((function(){return[f(i,{class:"p-6"},{"header-left":d((function(){return[f(u,{type:"primary",onClick:a[1]||(a[1]=function(e){return I.value=!0})},{default:d((function(){return a[15]||(a[15]=[m("创建临时授权 ")])})),_:1})]})),content:d((function(){return[V(f(l,{ref:"tempAuthTable",data:p(n),column:D,"max-height":380},null,8,["data"]),[[Z,p(r)]])]})),"footer-right":d((function(){return[f(o,{page:p(g).p,"onUpdate:page":a[2]||(a[2]=function(e){return p(g).p=e}),row:p(g).rows,"onUpdate:row":a[3]||(a[3]=function(e){return p(g).rows=e}),total:p(y),onChange:W},null,8,["page","row","total"])]})),_:1})]})),_:1},8,["modelValue"]),f(O,{title:"风险提示",modelValue:p(I),"onUpdate:modelValue":a[7]||(a[7]=function(e){return v(I)?I.value=e:null}),area:54,"show-footer":!0,onConfirm:a[8]||(a[8]=function(e){return H()})},{default:d((function(){return[h("div",ln,[a[19]||(a[19]=h("i",{class:"svgtofont-el-warning-filled text-[#E6A23C] !text-[4rem] pr-4"},null,-1)),h("div",null,[a[17]||(a[17]=h("p",{class:"text-[1.4rem] leading-10 text-danger"},"注意1：滥用临时授权可能导致安全风险。",-1)),a[18]||(a[18]=h("p",{class:"text-[1.4rem] leading-10 text-danger"},"注意2：请勿在公共场合发布临时授权连接",-1)),f(X,{ref_key:"authFormRef",ref:j,rules:N,model:p(E),"label-position":"left",class:"my-[1rem]"},{default:d((function(){return[f(Y,{label:"授权时间"},{default:d((function(){return[f(M,{modelValue:p(E).checkboxValue,"onUpdate:modelValue":a[5]||(a[5]=function(e){return p(E).checkboxValue=e})},{default:d((function(){return[f(K,{label:"3小时"}),f(K,{label:"6小时"}),f(K,{label:"9小时"}),f(K,{label:"12小时"}),f(K,{label:"自定义"})]})),_:1},8,["modelValue"])]})),_:1}),"自定义"===p(E).checkboxValue?(c(),P(Y,{key:0,label:"自定义时间",prop:"day"},{default:d((function(){return[f(J,{modelValue:p(E).day,"onUpdate:modelValue":a[6]||(a[6]=function(e){return p(E).day=e}),width:"16rem",textType:"天",min:"1",type:"number"},{append:d((function(){return a[16]||(a[16]=[m("天")])})),_:1},8,["modelValue"])]})),_:1})):S("",!0)]})),_:1},8,["model"])])])]})),_:1},8,["modelValue"]),f(O,{title:"创建临时授权",modelValue:p(A),"onUpdate:modelValue":a[11]||(a[11]=function(e){return v(A)?A.value=e:null}),area:57},{default:d((function(){return[h("div",on,[a[21]||(a[21]=h("div",null,"临时授权地址",-1)),f(J,{class:"my-5",type:"textarea",rows:2,modelValue:p(L),"onUpdate:modelValue":a[9]||(a[9]=function(e){return v(L)?L.value=e:null})},null,8,["modelValue"]),f(u,{type:"primary",class:"copy",onClick:a[10]||(a[10]=function(e){return t=p(L),R({value:t});var t})},{default:d((function(){return a[20]||(a[20]=[m("复制地址")])})),_:1}),a[22]||(a[22]=h("ul",{class:"ml-6 mt-8 list-disc"},[h("li",{class:"text-medium h-[2.4rem]"},"临时授权生成后1小时内使用有效，为一次性授权，使用后立即失效"),h("li",{class:"text-medium h-[2.4rem]"},"使用临时授权登录面板后1小时内拥有面板所有权限，请勿在公共场合发布临时授权连接"),h("li",{class:"text-medium h-[2.4rem]"},"授权连接信息仅在此处显示一次，若在使用前忘记，请重新生成")],-1))])]})),_:1},8,["modelValue"]),f(O,{title:"查看操作日志【".concat(p(q),"】"),modelValue:p(k),"onUpdate:modelValue":a[12]||(a[12]=function(e){return v(k)?k.value=e:null}),area:70},{default:d((function(){return[f(i,{class:"p-6"},{"header-left":d((function(){return[f(u,{onClick:Q,type:"primary"},{default:d((function(){return a[23]||(a[23]=[m("刷新日志")])})),_:1})]})),content:d((function(){return[V(f(l,{ref:"tempAuthLogTable","max-height":380,data:p(U),column:B},null,8,["data"]),[[Z,p(C)],[Z,"正在获取日志，请稍候...","title"]])]})),_:1})]})),_:1},8,["title","modelValue"])])}}}),sn=r({__name:"index",setup:function(e){var n=u({}),r=F((function(){var e;return"true"==(null===(e=n.value)||void 0===e?void 0:e.limit_area_status)})),o=function(){var e=l(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Y({title:"设置地区登录限制",component:function(){return J((function(){return t.import("./area-config-legacy.js?v=1734676359")}),void 0,t.meta.url)},compData:{limitArea:n.value,onRefresh:w},showFooter:!0,area:70});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=l(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie({title:"".concat(t?"开启":"关闭","地区登录限制"),content:"".concat(t?"开启后，将会对面板登录地区进行限制":"关闭后，设置的地区登录将失效","，是否继续操作？"),icon:"warning-filled"});case 2:return e.next=4,M({loading:"正在设置，请稍候...",request:Oe({limit_area_status:t}),message:!0,success:w});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=l(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M({request:qe(),data:{limit_area:Object,limit_area_status:String,limit_type:String}});case 2:t=e.sent,n.value=t;case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return i(l(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",w());case 1:case"end":return e.stop()}}),e)})))),function(e,t){var n=y,a=x;return c(),P(p(Fe),{label:"地区登录限制"},{value:d((function(){return[f(n,{modelValue:p(r),"onUpdate:modelValue":t[0]||(t[0]=function(e){return v(r)?r.value=e:null}),onChange:s},null,8,["modelValue"]),f(a,{type:"default",size:"small",class:"!ml-12px",disabled:e.loading,onClick:o},{default:d((function(){return t[1]||(t[1]=[m("设置地区登录限制")])})),_:1},8,["disabled"])]})),desc:d((function(){return t[2]||(t[2]=[h("span",null,"设置面板地区登录策略",-1)])})),_:1})}}}),fn={class:"px-[2rem]"},dn={class:"p-[2rem]"},pn=r({__name:"index",setup:function(e){var t=D().refs.safeConfig,n=u(!1),r=u(!1),o=u([]),g=u(!1),k=u(),C=u(!1),S=function(){var e=l(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M({loading:"正在设置，请稍候...",request:Ie({status:t?1:0}),message:!0});case 2:U();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=l(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M({request:Ne(),success:function(e){var n=e.data,r=n.msg||n,a=r.status,u=r.ua_list;t.value.uaAstrict=1===Number(a),o.value=u}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=l(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M({loading:"正在删除，请稍候...",request:ze({id:t.id}),message:!0});case 2:U();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=l(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k.value){e.next=2;break}return e.abrupt("return",H.error("请输入User-Agent"));case 2:return e.next=4,M({loading:"正在设置，请稍候...",request:C.value?Ie({new_name:k.value,id:C.value}):Ke({ua_list:k.value}),message:!0});case 4:U(),C.value=!1,k.value="",g.value=!1;case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=[{label:"User-Agent",prop:"name"},Re([{onClick:function(e){C.value=e.id,k.value=e.name,g.value=!0},title:"编辑"},{onClick:function(e){return P(e)},title:"删除"}])];return i((function(){return U()})),function(e,a){var u=y,l=x,i=te,C=Me,U=G,P=$,E=w,L=b,T=_("bt-loading");return c(),s("div",null,[f(p(Fe),{label:"User-Agent限制"},{value:d((function(){return[f(u,{modelValue:p(t).uaAstrict,"onUpdate:modelValue":a[0]||(a[0]=function(e){return p(t).uaAstrict=e}),onChange:a[1]||(a[1]=function(e){return S(p(t).uaAstrict)})},null,8,["modelValue"]),f(l,{size:"small",class:"!ml-12px",onClick:a[2]||(a[2]=function(e){return n.value=!0})},{default:d((function(){return a[7]||(a[7]=[m("User-Agent限制配置")])})),_:1})]})),desc:d((function(){return a[8]||(a[8]=[h("span",null,"设置限制访问User-Agent",-1)])})),_:1}),f(U,{modelValue:p(n),"onUpdate:modelValue":a[4]||(a[4]=function(e){return v(n)?n.value=e:null}),area:70,title:"User-Agent限制配置"},{default:d((function(){return[h("div",fn,[f(C,{class:"py-20px"},{"header-left":d((function(){return[f(l,{onClick:a[3]||(a[3]=function(e){return g.value=!0}),type:"primary"},{default:d((function(){return a[9]||(a[9]=[m("添加User-Agent")])})),_:1})]})),content:d((function(){return[V(f(i,{ref:"uaTable",column:j,data:p(o),description:"User-Agent列表为空","max-height":400},null,8,["data"]),[[T,p(r)],[T,"正在加载User-Agent列表，请稍后...","title"]])]})),_:1})])]})),_:1},8,["modelValue"]),f(U,{modelValue:p(g),"onUpdate:modelValue":a[6]||(a[6]=function(e){return v(g)?g.value=e:null}),area:50,title:"User-Agent",showFooter:"",onConfirm:A},{default:d((function(){return[h("div",dn,[f(L,{ref:"uaFormRef",model:p(k),"label-position":"left"},{default:d((function(){return[f(E,{label:"User-Agent",prop:"name"},{default:d((function(){return[f(P,{modelValue:p(k),"onUpdate:modelValue":a[5]||(a[5]=function(e){return v(k)?k.value=e:null}),type:"textarea",width:"32rem",rows:4},null,8,["modelValue"])]})),_:1})]})),_:1},8,["model"])])]})),_:1},8,["modelValue"])])}}});e("_",r({__name:"index",setup:function(e){var t=D().refs.settingSearch;return function(e,n){return c(),s("div",null,[V(f(De,null,{default:d((function(){return n[0]||(n[0]=[m("安全设置")])})),_:1},512),[[I,""===p(t)]]),f(Je),f(Ut),f(Pt),f(jt),f(Et),f(Dt),f(Mt),f(Gt),f(Rt),f(Xt),f(Wt),f(nn),f(un),f(cn),f(sn),f(pn)])}}}))}}}))}();
