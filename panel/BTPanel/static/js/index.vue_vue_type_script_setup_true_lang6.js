import{_ as a}from"./index116.js?v=1734676359";import{c as s,r as t,b8 as e,h as n,o as i,aB as o,p as r,k as l,J as m,x as c,l as u,q as p,e as f,y as v,z as d,aY as x}from"./base-lib.js?v=1734676359";import{u as y,af as k,ak as b,c as g,b as _}from"./utils-lib.js?v=1734676359";import{h as w}from"./validator.js?v=1734676359";import{u as h}from"./useStore7.js?v=1734676359";const j={key:0,class:"content-mask"},I={key:1,class:"content-mask"},T=s({__name:"index",props:{compData:{default:{}}},emits:["init"],setup(s,{expose:T,emit:S}){const C=_(),D=S,{plugin:N,getGlobalInfo:q}=y(),{activeType:z}=h(),A=t(N.value.webserver),B=e("_".concat(z.value,"_mask"),!1),G=t(!1),J=n({title:"",name:"",status:!0,version:"",admin:!1,s_version:"",setup:!1}),L=async a=>{const{data:s}=await k({sName:a.name});if("-1"===s.task)return C.error("当前插件正在安装，不可重复安装");w({name:null==s?void 0:s.name,type:"i",pluginInfo:s}),Y()};let O=!1;const Y=async(a=!1)=>{try{if(O)return;const{data:s}=await b({name:"web"});s.status||a||setTimeout((()=>{Y()}),3e3),s.status&&!a&&D("init"),B.value=!s.status,Object.assign(J,s),"proxy"===z.value&&"nginx"!==s.name&&(B.value=!0,G.value=s.status)}catch(s){a||setTimeout((()=>{Y()}),3e3)}};return i((()=>{Y(!0)})),o((()=>{O=!0})),T({checkInstallStatus:Y,pluginInfo:J,maskLayer:B,webServerType:A}),(s,t)=>{const e=g,n=x,i=a;return r(B)?(l(),m(i,{key:0,width:"38rem"},{content:c((()=>[r(G)?(l(),u("div",I,t[6]||(t[6]=[p("span",null,"反向代理项目只支持nginx环境",-1)]))):(l(),u("div",j,[t[4]||(t[4]=p("i",{class:"svgtofont-el-warning text-warning !text-[2.2rem] mr-4px"},null,-1)),t[5]||(t[5]=p("span",null,"未安装运行环境，",-1)),f(e,{onClick:t[0]||(t[0]=a=>L({name:"nginx"})),class:"!font-bold !text-[1.4rem]"},{default:c((()=>t[2]||(t[2]=[v("安装Nginx")]))),_:1}),f(n,{direction:"vertical"}),"proxy"!==s.compData.type?(l(),m(e,{key:0,onClick:t[1]||(t[1]=a=>L({name:"apache"})),class:"!font-bold !text-[1.4rem]"},{default:c((()=>t[3]||(t[3]=[v("安装Apache")]))),_:1})):d("",!0)]))])),_:1})):d("",!0)}}});export{T as _};
