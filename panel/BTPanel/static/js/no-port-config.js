import{l as e,H as a,o as l,G as t,j as s,c as o,M as m}from"./utils-lib.js?v=1734676359";import{c as r,r as i,k as n,l as c,q as u,e as d,p,x as v,I as f,aX as x,M as _,z as y,y as D,ad as V,A as b,v as k,ae as h}from"./base-lib.js?v=1734676359";import{_ as g}from"./config.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";const w={class:"p-24px"},j={class:"flex items-center"},z={class:"w-[20rem] flex ml-[1rem]"},E={class:"my-6 flex items-center leading-[3rem]"},A={class:"flex ml-[1rem]"},M={key:0,class:"flex mt-12px"},P={class:"flex-1 mr-20px"},U={class:"flex-1"},I={class:"list-disc text-[#777] px-20px pt-12px"},q={class:"flex items-center"},C=r({__name:"no-port-config",props:{compData:{}},emits:["close"],setup(r,{emit:C}){const H=r,K=C,L=i("auto"),S=[{title:"自定义证书",value:"auto"},{title:"不部署证书",value:"no"},{title:"选择已有证书",value:"select"}],Z=i(H.compData),G=l=>{L.value=l,"select"===l&&e({title:"选择已有证书",component:()=>a((()=>import("./cert-list-dialog.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),area:70,compData:{refreshData:e=>{Z.value.domain=(null==e?void 0:e.dns[0].replace(/^\*\./,"panel."))||"",Z.value.cert=(null==e?void 0:e.fullchain)||"",Z.value.key=(null==e?void 0:e.privkey)||"",Z.value.certInfo=e.info||{}}}})},N=async()=>{(H.compData.domain?/^(?!:\/\/)([a-zA-Z0-9-_]{1,63}\.)+[a-zA-Z]{2,6}$/.test(H.compData.domain)?"no"===L.value||H.compData.key&&H.compData.cert||(m.error("请填写证书内容"),0):(m.error("域名格式不正确"),0):(m.error("域名不能为空"),0))&&(await l({title:"提示",icon:"warning-filled",content:"基于Nginx/Apache，如果环境运行异常会导致无法访问，是否继续操作？"}),await t({loading:"正在设置免端口访问配置，请稍候...",request:g({domain:H.compData.domain,privateKey:H.compData.key,certPem:H.compData.cert}),message:!0}),H.compData.refresh(),K("close"))};return(e,a)=>{const l=s,t=h,m=V,r=b,i=o;return n(),c("div",w,[u("div",j,[a[4]||(a[4]=u("span",null,"绑定域名：",-1)),u("div",z,[d(l,{modelValue:p(Z).domain,"onUpdate:modelValue":a[0]||(a[0]=e=>p(Z).domain=e),placeholder:"请输入绑定域名"},null,8,["modelValue"])])]),u("div",E,[a[5]||(a[5]=u("span",null,"SSL证书：",-1)),u("div",A,[d(m,{modelValue:p(L),"onUpdate:modelValue":a[1]||(a[1]=e=>_(L)?L.value=e:null),size:"small",onChange:G},{default:v((()=>[(n(),c(f,null,x(S,((e,a)=>d(t,{key:a,label:e.value},{default:v((()=>[u("span",null,k(e.title),1)])),_:2},1032,["label"]))),64))])),_:1},8,["modelValue"])])]),"no"!==p(L)?(n(),c("div",M,[u("div",P,[a[6]||(a[6]=u("div",{class:"text-[1.2rem] mb-[.8rem]"},"密钥(KEY)",-1)),d(l,{class:"text-[1.2rem]",type:"textarea",modelValue:p(Z).key,"onUpdate:modelValue":a[2]||(a[2]=e=>p(Z).key=e),rows:13,size:"small"},null,8,["modelValue"])]),u("div",U,[a[7]||(a[7]=u("div",{class:"text-[1.2rem] mb-[.8rem]"},"证书(PEM格式)",-1)),d(l,{type:"textarea",modelValue:p(Z).cert,"onUpdate:modelValue":a[3]||(a[3]=e=>p(Z).cert=e),rows:13,size:"small"},null,8,["modelValue"])])])):y("",!0),d(r,{onClick:N,type:"primary",class:"mt-4"},{default:v((()=>a[8]||(a[8]=[D("保存")]))),_:1}),u("ul",I,[a[11]||(a[11]=u("li",null,"配置此域名的证书到面板，浏览器即可信任访问",-1)),u("li",null,[u("div",q,[a[10]||(a[10]=D(" 粘贴您的*.key以及*.pem内容，然后保存即可 ")),d(i,{href:"https://www.bt.cn/bbs/thread-105443-1-1.html"},{default:v((()=>a[9]||(a[9]=[D("帮助")]))),_:1})])]),a[12]||(a[12]=u("li",null,"如果浏览器提示证书链不完整,请检查是否正确拼接PEM证书",-1)),a[13]||(a[13]=u("li",null,"PEM格式证书 = 域名证书.crt + 根证书(root_bundle).crt",-1))])])}}});export{C as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
