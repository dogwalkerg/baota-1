import{G as e,b3 as a,M as l,ah as s,aU as t,O as o,aa as n,e as r}from"./utils-lib.js?v=1734676359";import{_ as u}from"./index101.js?v=1734676359";import{r as i,c,o as m,B as p,k as d,J as v,x as f,e as _,q as y,p as h,M as b,C as w,y as g,l as x,I as k,aX as V,v as C,z as j,ay as U,A as q,ag as A,ah as T,at as S,av as B,P,a7 as R,a4 as H}from"./base-lib.js?v=1734676359";import{B as I}from"./index185.js?v=1734676359";import{_ as O}from"./index91.js?v=1734676359";import{S as W,_ as D}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1734676359";import{S as K,_ as z}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1734676359";import{ak as E,al as M,R as F,P as G,m as J,am as N,an as Q,ao as X,Q as L}from"./validator.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./ace.js?v=1734676359";import"./column.js?v=1734676359";const Y=K(),Z=W(),$=i({}),ee={UpTime:"启动时间(Uptime)",IdleWorkers:"空闲进程(IdleWorkers)",TotalAccesses:"总连接数(TotalAccesses)",TotalKBytes:"传送总字节(TotalkBytes)",workermem:"Apache使用内存",workercpu:"Apache使用CPU",ReqPerSec:"每秒请求数(ReqPerSec)",RestartTime:"重启时间(RestartTime)",BusyWorkers:"繁忙进程(BusyWorkers)"},ae=i([]),le=i("service"),se=i(""),te=i(!1),oe=i(!1),ne=i([]),re=i(""),ue=i(""),ie=i([]),ce=[{content:"此处为apache主配置文件,若您不了解配置规则,请勿随意修改"}],me=i(!1),pe=a=>{e({loading:"正在设置守护进程，请稍后...",request:E({status:a?1:0}),message:!0,success:e=>{e.status||(me.value=!a)}})},de=async()=>{let a={};ae.value.forEach((e=>{a[e.name]=e.value})),await e({loading:"正在保存中，请稍后...",request:M(a),message:!0})},ve=async()=>{await e({loading:"正在保存中，请稍后...",request:a({path:"/www/server/apache/conf/httpd.conf",data:se.value,encoding:"utf-8"}),message:!0})},fe=async()=>{await e({loading:te,request:F({path:"/www/wwwlogs/error_log"}),data:{data:[String,re]}})},_e=async e=>{let[a,t]=e.version.split("."),o=[a,t].join(".");if(ue.value!==o)try{await G({sName:"apache",version:ue.value,min_version:""}),J()}catch(n){s(n)}else l.error("当前版本与选择版本一致")},ye=({props:{name:a}})=>{switch(a){case"service":he();break;case"performance":(async()=>{await e({loading:te,request:Q(),data:[Array,ae]})})();break;case"config":(async()=>{await e({loading:te,request:L({path:"/www/server/apache/conf/httpd.conf"}),data:{data:[String,se]}})})();break;case"load":(async()=>{await e({loading:te,request:X(),success:e=>{ne.value=[],Object.keys(e.data).forEach((a=>{ne.value.push({name:a,ps:ee[a],value:e.data[a]})}))}})})();break;case"logs":fe()}},he=e=>{le.value="service",e&&($.value=e),Z.init($.value),Y.init({name:"apache"}),ue.value=$.value.version.split(".")[0]+"."+$.value.version.split(".")[1],ie.value=$.value.versions,(async()=>{try{const e=await N();me.value=1===e.data.status}catch(e){}})()},be={class:"my-[12px]"},we={class:"flex text-[#666] items-center"},ge={class:"flex flex-col text-[#666] performance"},xe={key:0,class:"flex items-center"},ke={key:1,class:"flex items-center"},Ve=r(c({__name:"index",props:{compData:{default:{}}},emits:["close"],setup(e,{emit:a}){const l=e;return m((()=>{he(l.compData)})),(e,a)=>{const l=O,s=t,r=o,i=U,c=I,m=q,W=A,K=T,E=S,M=B,F=P,G=R,J=H,N=u,Q=n,X=p("bt-loading");return d(),v(Q,{modelValue:h(le),"onUpdate:modelValue":a[4]||(a[4]=e=>b(le)?le.value=e:null),type:"left-bg-card",onTabClick:h(ye)},{default:f((()=>[_(i,{label:"服务",name:"service"},{default:f((()=>[_(D),_(z),_(l,{direction:"horizontal"}),y("div",null,[y("div",null,[a[5]||(a[5]=y("span",null,"守护进程：",-1)),_(s,{class:"mr-[2rem]",modelValue:h(me),"onUpdate:modelValue":a[0]||(a[0]=e=>b(me)?me.value=e:null),onChange:h(pe)},null,8,["modelValue","onChange"])]),_(r,{class:"mt-1rem",options:[{content:"守护进程可以在Apache服务停止后自动启动，保证Apache服务一直运行。"}]})])])),_:1}),_(i,{label:"配置文件",name:"config"},{default:f((()=>[a[7]||(a[7]=y("span",{class:"my-[4px] text-[#666]"},"提示：Ctrl+F 搜索关键字，Ctrl+S 保存，Ctrl+H 查找替换",-1)),y("div",be,[w(_(c,{class:"!h-[40rem] !w-[54rem] my-[12px]",modelValue:h(se),"onUpdate:modelValue":a[1]||(a[1]=e=>b(se)?se.value=e:null),id:"configContent",filePath:"/www/server/apache/conf/httpd.conf"},null,8,["modelValue"]),[[X,h(te)]])]),_(m,{type:"primary",onClick:h(ve)},{default:f((()=>a[6]||(a[6]=[g("保存")]))),_:1},8,["onClick"]),_(r,{options:h(ce),class:"ml-[20px] mt-[20px]"},null,8,["options"])])),_:1}),_(i,{label:"版本切换",name:"version"},{default:f((()=>[y("div",we,[a[9]||(a[9]=y("span",null,"选择版本",-1)),_(K,{class:"mx-[12px] !w-[18rem]",modelValue:h(ue),"onUpdate:modelValue":a[2]||(a[2]=e=>b(ue)?ue.value=e:null)},{default:f((()=>[(d(!0),x(k,null,V(h(ie),((e,a)=>(d(),v(W,{key:a,label:"apache "+e.m_version,value:e.m_version},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),_(m,{type:"primary",onClick:a[3]||(a[3]=a=>h(_e)(e.compData))},{default:f((()=>a[8]||(a[8]=[g("切换")]))),_:1})])])),_:1}),_(i,{label:"负载状态",name:"load"},{default:f((()=>[w((d(),v(M,{maxHeight:"500",data:h(ne),border:"",style:{width:"100%"}},{default:f((()=>[_(E,{prop:"ps",label:"字段"}),_(E,{prop:"value",label:"当前值"})])),_:1},8,["data"])),[[X,h(te)]])])),_:1}),w((d(),v(i,{label:"性能调整",name:"performance"},{default:f((()=>[y("div",ge,[_(J,{"label-position":"right","label-width":"186px"},{default:f((()=>[(d(!0),x(k,null,V(h(ae),((e,a)=>(d(),v(G,{label:e.name,key:a},{default:f((()=>["KeepAlive"!=e.name?(d(),x("div",xe,[_(F,{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,type:"worker_processes"!==e.name?"number":""},null,8,["modelValue","onUpdate:modelValue","type"]),y("span",null,C(e.ps),1)])):j("",!0),"KeepAlive"==e.name?(d(),x("div",ke,[_(K,{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,class:"!w-[8rem] mr-8px"},{default:f((()=>[_(W,{label:"开启",value:"On"}),_(W,{label:"关闭",value:"Off"})])),_:2},1032,["modelValue","onUpdate:modelValue"]),y("span",null,C(e.ps),1)])):j("",!0)])),_:2},1032,["label"])))),128)),_(G,{label:" "},{default:f((()=>[_(m,{onClick:h(de),type:"primary"},{default:f((()=>a[10]||(a[10]=[g("保存")]))),_:1},8,["onClick"])])),_:1})])),_:1})])])),_:1})),[[X,h(oe)]]),_(i,{label:"运行日志",name:"logs"},{default:f((()=>[w(_(N,{content:h(re),autoScroll:!0,isHtml:!0,"full-screen":{title:"全屏查看日志",onRefresh:h(fe)},style:"height:540px"},null,8,["content","full-screen"]),[[X,h(te)]])])),_:1})])),_:1},8,["modelValue","onTabClick"])}}}),[["__scopeId","data-v-896483af"]]);export{Ve as default};
