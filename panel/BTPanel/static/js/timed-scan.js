import{c as e,o as l,B as a,k as o,l as s,C as t,p as u,J as d,x as n,e as r,z as i,q as m,Q as p,b5 as c,y as f,v as _,I as V,D as y,N as v,aj as b,a7 as g,b2 as h,b3 as k,P as U,a4 as j}from"./base-lib.js?v=1734676359";import{ay as x}from"./validator.js?v=1734676359";import{U as C,j as F,a4 as w,e as D}from"./utils-lib.js?v=1734676359";import{u as I,b as L,c as A,d as S,f as z,h as P,j as q,t as B}from"./index257.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";import"./column.js?v=1734676359";import"./useStore5.js?v=1734676359";const H={class:"px-[2rem] py-[2.4rem]"},J={class:"condition-risk"},M={class:"flex items-center"},N={class:"tip"},O={key:0},Q=D(e({__name:"timed-scan",setup(e,{expose:D}){const{isAutoScan:Q,ruleForm:T,userOptions:E,isLoading:G,addFtpInfo:K}=I();return l(L),D({onConfirm:A}),(e,l)=>{const D=b,I=g,L=C,A=F,R=w,W=h,X=k,Y=U,Z=x,$=j,ee=a("bt-loading");return o(),s("div",H,[t((o(),d($,{ref_key:"addFtpInfo",ref:K,model:u(T),class:"btCustomForm p-0","label-width":"4rem",rules:u(B),onSubmit:l[13]||(l[13]=v((()=>{}),["prevent"]))},{default:n((()=>[u(Q)?(o(),d(I,{key:0,label:"告警状态"},{default:n((()=>[r(D,{modelValue:u(T).status,"onUpdate:modelValue":l[0]||(l[0]=e=>u(T).status=e),"active-color":"#20A53A","inactive-color":"#cdcdcd"},null,8,["modelValue"])])),_:1})):i("",!0),r(I,{label:"安全风险项",prop:"risk"},{default:n((()=>[m("div",J,[r(u(p),{modelValue:u(T).login_error,"onUpdate:modelValue":l[1]||(l[1]=e=>u(T).login_error=e)},{default:n((()=>[l[14]||(l[14]=m("span",null,"多次登录失败",-1)),r(u(c),{type:"info",class:"risk-tag",title:u(T).config.login_error_des},{default:n((()=>[f(_(u(T).config.login_error_des),1)])),_:1},8,["title"])])),_:1},8,["modelValue"]),r(u(p),{modelValue:u(T).time,"onUpdate:modelValue":l[2]||(l[2]=e=>u(T).time=e)},{default:n((()=>{var e;return[l[15]||(l[15]=m("span",null,"登录时间异常",-1)),r(u(c),{type:"info",class:"risk-tag",title:null==(e=u(T).config)?void 0:e.time_des},{default:n((()=>{var e;return[f(_(null==(e=u(T).config)?void 0:e.time_des),1)]})),_:1},8,["title"])]})),_:1},8,["modelValue"]),r(u(p),{modelValue:u(T).area,"onUpdate:modelValue":l[3]||(l[3]=e=>u(T).area=e)},{default:n((()=>{var e;return[l[16]||(l[16]=m("span",null,"登录地区异常",-1)),r(u(c),{type:"info",class:"risk-tag",title:null==(e=u(T).config)?void 0:e.area_des},{default:n((()=>{var e,l,a;return[f(_((null==(l=null==(e=u(T).config)?void 0:e.area)?void 0:l.country.length)?null==(a=u(T).config)?void 0:a.area_des:"未配置"),1)]})),_:1},8,["title"])]})),_:1},8,["modelValue"]),r(u(p),{modelValue:u(T).anonymous,"onUpdate:modelValue":l[4]||(l[4]=e=>u(T).anonymous=e),disabled:"other"===u(T).user&&!u(Q)},{default:n((()=>l[17]||(l[17]=[m("span",null,"匿名用户登录",-1)]))),_:1},8,["modelValue","disabled"]),r(u(p),{modelValue:u(T).upload_shell,"onUpdate:modelValue":l[5]||(l[5]=e=>u(T).upload_shell=e)},{default:n((()=>{var e;return[l[18]||(l[18]=m("span",null,"上传脚本文件",-1)),r(u(c),{type:"info",class:"risk-tag",title:null==(e=u(T).config)?void 0:e.upload_shell_des},{default:n((()=>{var e,l,a;return[f(_((null==(l=null==(e=u(T).config)?void 0:e.upload_shell)?void 0:l.length)?null==(a=u(T).config)?void 0:a.upload_shell_des:"未配置"),1)]})),_:1},8,["title"])]})),_:1},8,["modelValue"]),m("span",{class:"bt-link",onClick:l[6]||(l[6]=(...e)=>u(S)&&u(S)(...e))}," 【设置扫描触发条件】 ")])])),_:1}),u(Q)?(o(),s(V,{key:2},[t(r(I,{label:"周期",prop:"cycle"},{default:n((()=>[r(Y,{class:"max-w-[16rem]",modelValue:u(T).cycle,"onUpdate:modelValue":l[11]||(l[11]=e=>u(T).cycle=e),min:1,type:"number"},{append:n((()=>[r(X,{type:"flex"},{default:n((()=>[r(W,null,{default:n((()=>l[19]||(l[19]=[m("span",null,"天",-1)]))),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1},512),[[y,!1]]),r(I,{label:"告警方式",prop:"value"},{default:n((()=>[r(Z,{modelValue:u(T).channel,"onUpdate:modelValue":l[12]||(l[12]=e=>u(T).channel=e),multiple:!0,class:"!w-30rem"},null,8,["modelValue"])])),_:1})],64)):(o(),s(V,{key:1},[r(I,{label:"扫描日志天数",prop:"otherDay"},{default:n((()=>[r(L,{type:"button",size:"small",modelValue:u(T).day,"onUpdate:modelValue":l[7]||(l[7]=e=>u(T).day=e),options:u(z)},null,8,["modelValue","options"]),"other"===u(T).day?(o(),d(A,{key:0,type:"number",modelValue:u(T).otherDay,"onUpdate:modelValue":l[8]||(l[8]=e=>u(T).otherDay=e),modelModifiers:{number:!0},class:"!inline-block ml-[1rem]"},null,8,["modelValue"])):i("",!0)])),_:1}),r(I,{label:"FTP用户",prop:"userList"},{default:n((()=>[m("div",M,[r(R,{class:"!w-[16rem]",modelValue:u(T).user,"onUpdate:modelValue":l[9]||(l[9]=e=>u(T).user=e),options:u(P),onChange:u(q)},null,8,["modelValue","options","onChange"]),"other"===u(T).user?(o(),d(R,{key:0,class:"ml-[1rem]",multiple:"","collapse-tags":"",filterable:"",modelValue:u(T).userList,"onUpdate:modelValue":l[10]||(l[10]=e=>u(T).userList=e),options:u(E)},null,8,["modelValue","options"])):i("",!0)])])),_:1})],64))])),_:1},8,["model","rules"])),[[ee,u(G)]]),m("div",N,[m("ul",null,[u(Q)?(o(),s("li",O,"默认扫描全部用户30天的日志")):i("",!0),l[20]||(l[20]=m("li",null,"【多次登录失败】检测时间为：5分钟",-1))])])])}}}),[["__scopeId","data-v-284fa37a"]]);export{Q as default};
