import{c as e,r as l,h as a,o as t,k as s,l as n,e as u,x as o,p as r,M as d,y as i,q as c,aj as m,A as p,a7 as v,a4 as f,w as _,B as y,C as x,v as w,I as h,z as V,aX as b,J as g,aT as k,Q as C,ah as U,ae as S,ad as A,aN as P,ag as T,D as j,R as q,aY as I,af as E,i as K}from"./base-lib.js?v=1734676359";import{g as L}from"./useStore.js?v=1734676359";import{G as z,K as D,h as M,M as B,x as N,l as R,H as F,L as O,N as H,c as G,j as J,d as Q,O as X,k as Y,e as Z,P as $,Q as W,B as ee,s as le,R as ae,o as te,S as se}from"./utils-lib.js?v=1734676359";import{_ as ne}from"./validator.js?v=1734676359";import{p as ue,q as oe,r as re,t as de,u as ie,v as ce,w as me,x as pe,y as ve,z as fe,A as _e,B as ye,C as xe,D as we,E as he,F as Ve,G as be,H as ge,I as ke,J as Ce,K as Ue,L as Se,M as Ae,N as Pe,O as Te,P as je,Q as qe,R as Ie,S as Ee}from"./config.js?v=1734676359";import{C as Ke,a as Le}from"./index96.js?v=1734676359";import{_ as ze}from"./index90.js?v=1734676359";import{_ as De}from"./index89.js?v=1734676359";import{o as Me}from"./useMethod.js?v=1734676359";import{_ as Be}from"./index97.js?v=1734676359";import{u as Ne}from"./column.js?v=1734676359";const Re={class:"p-16px"},Fe=e({__name:"index",setup(e){const _=l([]),y=l(null),x=l(!1),w=l(!1),h=a({type:[],options:"",id:""});let V=null;const b={type:[{required:!0,validator:(e,l,a)=>{0===h.type.length?a(new Error("请选择告警方式")):a()},trigger:["blur","change"]}]},g=async e=>{e?w.value=!0:await z({loading:"正在保存信息配置，请稍后...",request:ue({task_id:h.id,status:e?1:0}),message:!0,success:l=>{l.status||(x.value=!e)}})},k=()=>{w.value=!1,U()},C=async()=>{await z({request:D(),data:{data:[Array,_]}})},U=()=>{var e;const l=null==(e=_.value)?void 0:e.find((e=>"panel_safe_push"===e.keyword));l?(h.type=l.sender,x.value=l.status,h.id=l.id,V=l):(h.type=[],x.value=!1,V=null)};return t((async()=>{await C(),U()})),(e,l)=>{const a=m,t=p,_=v,S=ne,A=f,P=M;return s(),n("div",null,[u(r(Ke),{label:"面板安全告警"},{value:o((()=>[u(a,{modelValue:r(x),"onUpdate:modelValue":l[0]||(l[0]=e=>d(x)?x.value=e:null),onChange:g},null,8,["modelValue"]),u(t,{size:"small",class:"!ml-12px",onClick:l[1]||(l[1]=e=>w.value=!0)},{default:o((()=>l[6]||(l[6]=[i("提醒方式")]))),_:1})])),desc:o((()=>l[7]||(l[7]=[c("span",null,"告警内容包含：面板用户变更、面板日志删除、面板开启开发者、面板开启API",-1)]))),_:1}),u(P,{title:"面板安全告警",modelValue:r(w),"onUpdate:modelValue":l[4]||(l[4]=e=>d(w)?w.value=e:null),showFooter:"",area:[48],onConfirm:l[5]||(l[5]=e=>(async()=>{await y.value.validate();let e={},l={send_interval:0,time_range:[0,86399]},a={day_num:0,total:0};e=V?{task_data:V.task_data,sender:h.type,time_rule:l,number_rule:a}:{task_data:{tid:"6",type:"panel_safe_push",title:"面板安全告警",status:x.value,count:0,interval:600,project:"",help:600},sender:h.type,time_rule:l,number_rule:a},await z({loading:"正在保存信息配置，请稍后...",request:oe({task_data:JSON.stringify(e),template_id:"6"}),message:!0}),await C(),U(),w.value=!1})()),onCancel:k,confirmText:"保存配置"},{default:o((()=>[c("div",Re,[u(A,{ref_key:"ruleFormRef",ref:y,"label-width":"10rem",rules:b,model:r(h)},{default:o((()=>[u(_,{label:"安全提醒"},{default:o((()=>[u(a,{modelValue:r(x),"onUpdate:modelValue":l[2]||(l[2]=e=>d(x)?x.value=e:null)},null,8,["modelValue"])])),_:1}),u(_,{label:"告警方式",prop:"type"},{default:o((()=>[u(S,{class:"!w-[30rem]",modelValue:r(h).type,"onUpdate:modelValue":l[3]||(l[3]=e=>r(h).type=e),limit:["sms"]},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])])),_:1},8,["modelValue"])])}}}),Oe={class:"p-[24px]"},He={class:"inline-block mr-[32px]"},Ge={class:"font-bold text-[1.2rem]"},Je={class:"inline-block mr-[32px]"},Qe={class:"font-bold text-[1.2rem]"},Xe={class:"inline-block mr-[32px]"},Ye={class:"font-bold text-[1.2rem]"},Ze={class:"mt-2 flex items-center"},$e={class:"w-[20rem] flex"},We={class:"mt-2 flex items-center"},el={class:"mt-6 sslPanel"},ll={class:"flex justify-between"},al={class:"flex items-center w-full"},tl={class:"flex mt-[12px]"},sl={class:"flex-1 mr-[20px]"},nl={class:"flex-1"},ul={class:"list-disc text-[#777] px-[20px] pt-[12px] leading-8"},ol={class:"flex items-center"},rl={class:"pt-[20px] flex flex-col"},dl={class:"flex items-center mt-[12px] ml-[4px] px-[20px]"},il={class:"bg-[#f6f8f8] footer-btn flex items-center justify-end mt-[20px] p-[12px] w-full"},cl={class:"p-[2rem]"},ml={class:"flex items-center justify-center mb-[16px]"},pl={class:"flex flex-col bg-[#f7f7f7] p-[20px]"},vl={key:1},fl={class:"w-[24rem]"},_l={class:"w-[24rem]"},yl={class:"list-disc ml-[20px] mt-[12px] leading-10 text-[#666]"},xl={class:"flex items-center"},wl={class:"p-[1.5rem]"},hl={class:"max-h-[38rem] overflow-auto"},Vl=Z(e({__name:"index",setup(e){var t;const{refs:{safeConfig:j,noPortConfig:q,openSSLPopup:I}}=L(),E=l(!1),K=l(!1),D=l(!1),Z=l(!1),$=l(),W=l(5),ee=l({sllType:1,privateKey:"",certPem:"",checked:!1,email:"",resource:"http"}),le=l({cert_type:"",domain:"",email:""}),ae=l(!1),te=l({certPem:"",download_root:!1,info:{},privateKey:"",rep:!1,root_password:""}),se=[{title:"自签证书",key:1,disabled:!1},{title:"Let's Encrypt",key:2,disabled:!j.value.domain},{title:"其他证书",key:3,disabled:!1}],ne=l([]),ue=a({index:"",cert_type:"",privateKey:"",certPem:"",email:"",auth_type:""}),oe=l(!1),me=[{content:"解析域名需要一定时间来生效,完成所以上所有解析操作后,请等待1分钟后再点击验证按钮"},{content:"可通过CMD命令来手动验证域名解析是否生效:\n\t\t nslookup -q=txt _acme-challenge.".concat(null==(t=j.value.domain)?void 0:t.replace("*.",""))},{content:"若您使用的是宝塔云解析插件,阿里云DNS,DnsPod作为DNS,可使用DNS接口自动解析"}],pe=[{label:"解析域名",prop:"domain"},{label:"记录值",showOverflowTooltip:!0,render(e){const l="dns"===ee.value.resource?e.auth_value:e.file_path;return u("div",{class:"flex items-center"},[u("div",{class:"truncate w-[15rem]"},[l]),u("span",{class:"svgtofont-icon-copy ml-[4px] text-[#666] text-[1.6rem] w-[1.6rem] cursor-pointer",onClick:()=>N({value:l})},null)])}},{label:"类型",render:e=>"dns"===ee.value.resource?u("span",null,[e.type]):u("div",{class:"flex items-center"},[u("div",{class:"truncate w-[15rem]"},[e.content]),u("span",{class:"svgtofont-icon-copy ml-[4px] text-[#666] text-[1.6rem] w-[1.6rem] cursor-pointer",onClick:()=>N({value:e.content})},null)])},{label:"必需",prop:"must",width:100}],ve=async()=>{try{const e=await be(),{data:l}=await re(ue);null==e||e.close(),B.request(l),l.status&&Ve(l)}catch(e){}finally{oe.value=!1}},fe=e=>{ee.value.sllType=e},_e=async()=>{ae.value=!0;try{await z({loading:"正在保存面板证书配置，请稍候...",request:de({privateKey:te.value.privateKey,certPem:te.value.certPem}),message:!0,success:xe})}catch(e){}finally{ae.value=!1}},ye=()=>{R({title:"证书夹",area:70,compData:{onRefresh:e=>{te.value.certPem=(null==e?void 0:e.fullchain)||"",te.value.privateKey=(null==e?void 0:e.privkey)||"",te.value.info=(null==e?void 0:e.info)||{}}},component:()=>F((()=>import("./cert-folder.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)})},xe=async()=>{ae.value=!0;try{await z({loading:"正在获取面板证书配置，请稍候...",request:ie(),success:e=>{var l,a;te.value=e.data,ee.value.privateKey=null==(l=e.data)?void 0:l.privateKey,ee.value.certPem=null==(a=e.data)?void 0:a.certPem}})}catch(e){}finally{ae.value=!1}},we=async()=>{try{const{data:e}=await ce();le.value=e}catch(e){}},he=async(e,l,a)=>{if(2!==ee.value.sllType||/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(ee.value.email))try{const t={cert_type:e,privateKey:l,certPem:a};let s,n,u;0===e&&(delete t.cert_type,t.privateKey,t.certPem),2===ee.value.sllType&&(t.email=ee.value.email,t.auth_type=ee.value.resource),2===ee.value.sllType?setTimeout((async()=>{s=await be()}),500):n=B.load("正在设置面板证书配置，请稍候...");u=(await re(t)).data,null==s||s.close(),null==n||n.close(),await Ve(u,t)}catch(t){}finally{ae.value=!1,D.value=!1}else B.error("请输入正确的邮箱地址")},Ve=async(e,l)=>{if(e.status){const e=B.load("正在刷新页面，请稍候...");await new Promise((e=>setTimeout(e,2e3))),e.close(),O(),sessionStorage.clear(),window.location.href="".concat("http:"===location.protocol?"https":"http","://").concat(window.location.host).concat(j.value.admin_path),ae.value=!1}else{const{certPem:a,cert_type:t,privateKey:s}=l;j.value.panelSSl=!j.value.panelSSl,H(e,"auths")&&(ne.value=e.auths,ue.index=e.index,ue.certPem=a,ue.cert_type=t,ue.privateKey=s,ue.email=ee.value.email,ue.auth_type=ee.value.resource,oe.value=!0)}B.request(e)},be=()=>R({area:[50,25],component:()=>F((()=>import("./cert-progress.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)});_(q,(e=>{e.value&&(te.value.privateKey=q.value.key,te.value.certPem=q.value.cert,te.value.info.subject=q.value.certInfo.subject,te.value.info.issuer=q.value.certInfo.issuer,te.value.info.notAfter=q.value.certInfo.notAfter)})),_(I,(e=>{e&&(D.value=!0,we(),I.value=!1)}),{deep:!0});const ge=e=>{(e?D:K).value&&(e?D.value=!1:K.value=!1,j.value.panelSSl=!j.value.panelSSl)},ke=e=>{(e?D:K).value&&(e=>{if(!Z.value&&!e)return B.error("请勾选并同意承担风险");e?he(1,ee.value.privateKey,ee.value.certPem):(he(0),K.value=!1)})(e)};return(e,l)=>{const a=m,t=p,_=G,q=k,I=J,L=M,z=C,R=De,F=Q,O=P,H=T,le=U,ue=v,re=S,de=A,ie=f,ce=Y,Ve=ze,be=X,Ce=y("bt-loading");return s(),n("div",null,[u(r(Ke),{label:"面板SSL"},{value:o((()=>[u(a,{modelValue:r(j).panelSSl,"onUpdate:modelValue":l[0]||(l[0]=e=>r(j).panelSSl=e),onChange:l[1]||(l[1]=e=>{return(l=r(j).panelSSl)?(D.value=!0,we()):K.value=!0,void(l?(clearInterval($.value),$.value=null,W.value=5):($.value&&clearInterval($.value),$.value=setInterval((()=>{W.value--,W.value<=0&&(clearInterval($.value),$.value=null,W.value=5)}),1e3)));var l})},null,8,["modelValue"]),u(t,{size:"small",class:"!ml-[12px]",onClick:l[2]||(l[2]=e=>(E.value=!0,void xe()))},{default:o((()=>l[23]||(l[23]=[i(" 面板SSL配置 ")]))),_:1})])),desc:o((()=>[l[25]||(l[25]=c("span",null,"为面板设置https协议访问，提升面板访问安全性，",-1)),u(_,{href:"https://www.bt.cn/bbs/thread-105443-1-1.html"},{default:o((()=>l[24]||(l[24]=[i("了解详情")]))),_:1})])),_:1}),u(L,{title:"自定义面板证书",modelValue:r(E),"onUpdate:modelValue":l[9]||(l[9]=e=>d(E)?E.value=e:null),area:[70]},{default:o((()=>[x((s(),n("div",Oe,[u(q,{type:"success",closable:!1},{default:o((()=>[c("div",He,[l[26]||(l[26]=i(" 认证域名：")),c("span",Ge,w(r(te).info.subject),1)]),c("div",Je,[l[27]||(l[27]=i(" 证书品牌：")),c("span",Qe,w(r(te).info.issuer),1)]),c("div",Xe,[l[28]||(l[28]=i(" 到期时间： ")),c("span",Ye,w(r(te).info.notAfter),1)])])),_:1}),l[46]||(l[46]=c("div",{class:"mt-6 flex items-center text-[#20a53a] font-bold"},[c("span",null,"堡塔APP IOS端使用https证书需要使用非自签证书")],-1)),r(te).download_root?(s(),n(h,{key:0},[c("div",Ze,[l[32]||(l[32]=c("span",null,"温馨提示：当前证书为自签证书，需要安装本地根证书，",-1)),u(t,{size:"small",type:"primary",class:"mr-[8px]"},{default:o((()=>l[29]||(l[29]=[c("a",{href:"/download?filename=/www/server/panel/ssl/baota_root.pfx",target:"_blank"},"下载根证书",-1)]))),_:1}),r(te).root_password?(s(),n(h,{key:0},[l[31]||(l[31]=c("span",null,"证书密码：",-1)),c("div",$e,[u(I,{modelValue:r(te).root_password,"onUpdate:modelValue":l[3]||(l[3]=e=>r(te).root_password=e),disabled:!0,placeholder:"密码为空"},null,8,["modelValue"]),u(t,{type:"primary",class:"align-sub",onClick:l[4]||(l[4]=e=>(e=>{if(!e)return B.error("当前密码为空，无法复制！");N({value:e})})(r(te).root_password||""))},{default:o((()=>l[30]||(l[30]=[i("复制 ")]))),_:1})])],64)):V("",!0)]),c("div",We,[l[34]||(l[34]=c("span",null,[c("span",{class:"text-danger"},"MAC"),i("专用本地根证书：")],-1)),u(t,{size:"small",type:"primary",class:"mr-[8px]"},{default:o((()=>l[33]||(l[33]=[c("a",{href:"/download?filename=/www/server/panel/ssl/baota_root.crt",target:"_blank"},"下载根证书",-1)]))),_:1}),l[35]||(l[35]=c("span",null,[i("* 无密码 "),c("span",{class:"text-danger"},"MAC"),i("需要设置信任此证书")],-1))])],64)):V("",!0),c("div",el,[c("div",ll,[c("div",al,[l[37]||(l[37]=c("span",{class:"mr-4px"},"面板SSL",-1)),u(a,{modelValue:r(j).panelSSl,"onUpdate:modelValue":l[5]||(l[5]=e=>r(j).panelSSl=e),onChange:l[6]||(l[6]=e=>{return l=r(j).panelSSl,void he(l?1:0,te.value.privateKey,te.value.certPem);var l})},null,8,["modelValue"]),u(_,{href:"https://www.bt.cn/bbs/thread-105443-1-1.html",class:"ml-[12px]"},{default:o((()=>l[36]||(l[36]=[i(" 如何开启证书？ ")]))),_:1})]),u(t,{size:"small",class:"float-right",onClick:ye},{default:o((()=>l[38]||(l[38]=[i("证书夹")]))),_:1})]),c("div",tl,[c("div",sl,[l[39]||(l[39]=c("div",{class:"text-[1.2rem] mb-[8px]"},"密钥(KEY)",-1)),u(I,{class:"text-[1.2rem]",type:"textarea",modelValue:r(te).privateKey,"onUpdate:modelValue":l[7]||(l[7]=e=>r(te).privateKey=e),rows:13,size:"small"},null,8,["modelValue"])]),c("div",nl,[l[40]||(l[40]=c("div",{class:"text-[1.2rem] mb-[8px]"},"证书(PEM格式)",-1)),u(I,{type:"textarea",modelValue:r(te).certPem,"onUpdate:modelValue":l[8]||(l[8]=e=>r(te).certPem=e),rows:13,size:"small"},null,8,["modelValue"])])]),u(t,{type:"primary",class:"!mt-4",onClick:_e},{default:o((()=>l[41]||(l[41]=[i("保存")]))),_:1})]),c("ul",ul,[c("li",null,[c("div",ol,[l[43]||(l[43]=i(" 粘贴您的*.key以及*.pem内容，然后保存即可 ")),u(_,{href:"https://www.bt.cn/bbs/thread-105443-1-1.html"},{default:o((()=>l[42]||(l[42]=[i("帮助")]))),_:1})])]),l[44]||(l[44]=c("li",null,"如果浏览器提示证书链不完整,请检查是否正确拼接PEM证书",-1)),l[45]||(l[45]=c("li",null,"PEM格式证书 = 域名证书.crt + 根证书(root_bundle).crt",-1))])])),[[Ce,r(ae)],[Ce,"正在获取证书信息，请稍候...","title"]])])),_:1},8,["modelValue"]),u(L,{title:"关闭面板SSL",area:38,modelValue:r(K),"onUpdate:modelValue":l[13]||(l[13]=e=>d(K)?K.value=e:null),onCancel:l[14]||(l[14]=e=>ge(!1))},{default:o((()=>[c("div",rl,[l[49]||(l[49]=c("div",{class:"flex items-center px-[20px]"},[c("i",{class:"svgtofont-el-warning-filled text-[#e6a23c] !text-[4rem] pr-4"}),c("span",{class:"text-[1.4rem] leading-10 text-danger"},"关闭SSL后请使用安全登录模式进行登录，否则会存在“重放攻击”风险，是否确定关闭？")],-1)),c("div",dl,[u(z,{modelValue:r(Z),"onUpdate:modelValue":l[10]||(l[10]=e=>d(Z)?Z.value=e:null),class:"!mr-[4px]"},null,8,["modelValue"]),l[47]||(l[47]=i(" 我已了解风险，确认关闭 "))]),c("div",il,[u(t,{type:"warning",onClick:l[11]||(l[11]=e=>ge(!1))},{default:o((()=>l[48]||(l[48]=[i("取消")]))),_:1}),u(t,{type:"danger",onClick:l[12]||(l[12]=e=>ke(!1)),disabled:!!r($)||!r(Z)},{default:o((()=>[i("确认关闭SSL "+w(r($)?"（剩余".concat(r(W),"秒可操作）"):""),1)])),_:1},8,["disabled"])])])])),_:1},8,["modelValue"]),u(L,{title:"面板证书SSL",area:[54],modelValue:r(D),"onUpdate:modelValue":l[19]||(l[19]=e=>d(D)?D.value=e:null),"show-footer":!0,onConfirm:l[20]||(l[20]=e=>ke(!0)),onCancel:l[21]||(l[21]=e=>ge(!0))},{default:o((()=>[c("div",cl,[c("div",ml,[u(R,{name:"scanning-success",size:"3.2"}),l[50]||(l[50]=c("p",{class:"text-[2.1rem] ml-[4px]"},"立即【开启SSL证书】保护面板安全",-1))]),c("div",pl,[l[51]||(l[51]=c("span",null,"访问步骤：",-1)),l[52]||(l[52]=c("ul",{class:"list-decimal ml-[20px] mt-[4px] leading-10"},[c("li",null,"开启https"),c("li",null,"使用https网站访问面板"),c("li",null,"如提醒风险（正常现象）点击【高级】或【详情】如下图"),c("li",null,"【继续访问】或【接受风险并继续】")],-1)),u(F,{src:"/other/bt-https.png",class:"block mt-[4px] h-[18rem] w-[28rem]"})]),u(ie,{ref:"form",model:r(ee),class:"my-6"},{default:o((()=>[u(ue,{label:"类型"},{default:o((()=>[u(le,{modelValue:r(ee).sllType,"onUpdate:modelValue":l[15]||(l[15]=e=>r(ee).sllType=e),class:"!w-[28rem]",onChange:fe},{default:o((()=>[(s(),n(h,null,b(se,(e=>u(H,{key:e.key,label:e.title,value:e.key,disabled:e.disabled},{default:o((()=>[2!==e.key||r(j).domain?(s(),n("span",vl,w(e.title),1)):(s(),g(O,{key:0,class:"item",effect:"dark",content:"Let's Encrypt证书类型需要绑定域名才能选择",placement:"top-start"},{default:o((()=>[c("span",null,w(e.title),1)])),_:2},1024))])),_:2},1032,["label","value","disabled"]))),64))])),_:1},8,["modelValue"])])),_:1}),2==r(ee).sllType?(s(),g(ue,{key:0,label:"验证方法"},{default:o((()=>[u(de,{modelValue:r(ee).resource,"onUpdate:modelValue":l[16]||(l[16]=e=>r(ee).resource=e)},{default:o((()=>[u(re,{label:"http",value:"http"},{default:o((()=>l[53]||(l[53]=[i("文件验证")]))),_:1}),u(re,{label:"dns",value:"dns"},{default:o((()=>l[54]||(l[54]=[i("DNS验证")]))),_:1})])),_:1},8,["modelValue"])])),_:1})):V("",!0),3==r(ee).sllType?(s(),g(ue,{key:1,label:"密钥(KEY)"},{default:o((()=>[c("div",fl,[u(I,{modelValue:r(ee).privateKey,"onUpdate:modelValue":l[17]||(l[17]=e=>r(ee).privateKey=e),type:"textarea",rows:4},null,8,["modelValue"])])])),_:1})):V("",!0),3==r(ee).sllType?(s(),g(ue,{key:2,label:"证书(PEM格式)"},{default:o((()=>[c("div",_l,[u(I,{modelValue:r(ee).certPem,"onUpdate:modelValue":l[18]||(l[18]=e=>r(ee).certPem=e),type:"textarea",rows:4},null,8,["modelValue"])])])),_:1})):V("",!0)])),_:1},8,["model"]),c("ul",yl,[c("li",null,[c("div",xl,[l[56]||(l[56]=i("开启后导致面板不能访问，可以点击查看")),u(_,{href:"https://www.bt.cn/bbs/thread-117246-1-1.html"},{default:o((()=>l[55]||(l[55]=[i("解决方法")]))),_:1})])]),l[57]||(l[57]=c("li",null,"自签证书不被浏览器信任，显示不安全是正常现象",-1))])])])),_:1},8,["modelValue"]),u(L,{modelValue:r(oe),"onUpdate:modelValue":l[22]||(l[22]=e=>d(oe)?oe.value=e:null),area:70,title:"手动".concat("dns"===r(ee).resource?"解析TXT记录":"创建验证文件")},{default:o((()=>[c("div",wl,[l[59]||(l[59]=i(" 请按以下列表做TXT解析: ")),u(Ve,null,{content:o((()=>[c("div",hl,[(s(!0),n(h,null,b(r(ne),((e,l)=>(s(),n(h,null,[e.data.length?(s(),n("div",{key:l},[c("span",null,"验证域名："+w(e.domain),1),u(ce,{class:"my-[1rem]",column:pe,data:e.data},null,8,["data"])])):V("",!0)],64)))),256))])])),"footer-right":o((()=>[u(t,{onClick:ve},{default:o((()=>l[58]||(l[58]=[i("验证")]))),_:1})])),_:1}),u(be,{options:me,listStyle:"disc",class:"ml-[20px]"})])])),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-8760e57a"]]),bl=e({__name:"index",setup(e){const{getCertListData:a}=L(),n=l({}),d=l("配置一个域名来访问面板"),v=()=>{R({title:"免端口访问配置",component:()=>F((()=>import("./no-port-config.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),compData:{...n.value,refresh:f},area:80,onCancel:()=>{n.value.proxy_stats=!n.value.proxy_stats}})},f=async()=>{await z({request:pe(),success:({data:e})=>{n.value={addr:(null==e?void 0:e.addr)||"",cert:(null==e?void 0:e.cert)||"",key:(null==e?void 0:e.key)||"",proxy_stats:(null==e?void 0:e.proxy_stats)||!1,domain:(null==e?void 0:e.domain)||"",certInfo:(null==e?void 0:e.info)||{}}}})};return t((()=>f())),(e,l)=>{const t=m,f=p;return s(),g(r(Ke),{label:"免端口访问"},{value:o((()=>[u(t,{modelValue:r(n).proxy_stats,"onUpdate:modelValue":l[0]||(l[0]=e=>r(n).proxy_stats=e),onChange:l[1]||(l[1]=e=>(async e=>{e?v():await z({loading:"正在删除面板生成的域名，请稍候...",request:me(),message:!0,success:a})})(r(n).proxy_stats))},null,8,["modelValue"]),u(f,{size:"small",class:"!ml-12px",onClick:l[2]||(l[2]=e=>v())},{default:o((()=>l[3]||(l[3]=[i(" 免端口访问配置 ")]))),_:1})])),desc:o((()=>[c("span",null,w(r(d)),1)])),_:1})}}}),gl={class:"p-[24px]"},kl=e({__name:"index",setup(e){const{refs:{safeConfig:t}}=L();l(!1);const _=l(!1);l(!1);const y=a({basic_user:"",basic_pwd:"",open:!0});return(e,l)=>{const a=m,x=G,w=v,h=J,V=p,b=f,g=M;return s(),n("div",null,[u(r(Ke),{label:"BasicAuth认证"},{value:o((()=>[u(a,{modelValue:r(t).basicAuth,"onUpdate:modelValue":l[0]||(l[0]=e=>r(t).basicAuth=e),onChange:l[1]||(l[1]=e=>(async e=>{if(e)Me({content:['<span class="text-danger">必须要用到且了解此功能才决定自己是否要开启!!<span>',"开启后，以任何方式访问面板，将先要求输入BasicAuth用户名和密码","开启后，能有效防止面板被扫描发现，但并不能代替面板本身的帐号密码","请牢记BasicAuth密码，一但忘记将无法访问面板","如忘记密码，可在SSH通过bt命令来关闭BasicAuth验证"],isShowAppCode:!1,checkTip:'我已了解详情,并愿意承担风险！<a class="bt-link" href="https://www.bt.cn/bbs/thread-34374-1-1.html" target="_blank">什么是BasicAuth认证？</a>',onConfirm:()=>_.value=!0,onCancel:()=>t.value.basicAuth=!1});else{const{data:e}=await ve({open:"False",basic_user:"",basic_pwd:""});B.request(e),e.status&&setTimeout((()=>window.location.reload()),1e3)}})(r(t).basicAuth))},null,8,["modelValue"])])),desc:o((()=>[l[10]||(l[10]=c("span",null,"为面板增加一道基于BasicAuth的认证服务，有效防止面板被扫描，",-1)),u(x,{href:"https://www.bt.cn/bbs/thread-34374-1-1.html"},{default:o((()=>l[9]||(l[9]=[i("了解详情")]))),_:1})])),_:1}),u(g,{title:"配置BasicAuth认证",modelValue:r(_),"onUpdate:modelValue":l[7]||(l[7]=e=>d(_)?_.value=e:null),area:50,onCancel:l[8]||(l[8]=e=>(t.value.basicAuth=!t.value.basicAuth,void y.open))},{default:o((()=>[c("div",gl,[u(b,{modelValue:r(y),"onUpdate:modelValue":l[6]||(l[6]=e=>d(y)?y.value=e:null)},{default:o((()=>[u(w,{label:"服务状态"},{default:o((()=>[u(a,{modelValue:r(y).open,"onUpdate:modelValue":l[2]||(l[2]=e=>r(y).open=e)},null,8,["modelValue"])])),_:1}),u(w,{label:"用户名"},{default:o((()=>[u(h,{class:"!w-[28.8rem]",modelValue:r(y).basic_user,"onUpdate:modelValue":l[3]||(l[3]=e=>r(y).basic_user=e),placeholder:"请设置用户名"},null,8,["modelValue"])])),_:1}),u(w,{label:"密码"},{default:o((()=>[u(h,{class:"!w-[28.8rem]",modelValue:r(y).basic_pwd,"onUpdate:modelValue":l[4]||(l[4]=e=>r(y).basic_pwd=e),placeholder:"请输入密码"},null,8,["modelValue"])])),_:1}),u(w,{label:" "},{default:o((()=>[u(V,{type:"primary",onClick:l[5]||(l[5]=e=>(async()=>{try{const{data:e}=await ve({...y,open:y.open?"True":"False"});B.request(e),e.status&&(_.value=!1,window.location.reload())}catch(e){}})())},{default:o((()=>l[11]||(l[11]=[i("保存")]))),_:1})])),_:1})])),_:1},8,["modelValue"]),l[12]||(l[12]=c("ul",{class:"pl-[32px] list-disc help leading-8"},[c("li",null,"注意：请不要在这里使用您的常用密码，这可能导致密码泄漏!"),c("li",null,"开启后，以任何方式访问面板，将先要求输入BasicAuth用户名和密码"),c("li",null,"开启后，能有效防止面板被扫描发现，但并不能代替面板本身的帐号密码"),c("li",null,"请牢记BasicAuth密码，一但忘记将无法访问面板"),c("li",null,"如忘记密码，可在SSH通过bt命令来关闭BasicAuth验证")],-1))])])),_:1},8,["modelValue"])])}}}),Cl=e({__name:"index",setup(e){const{refs:{safeConfig:a}}=L();l(!1);const d=()=>{Me({content:['<span class="text-danger">必须要用到且了解此功能才决定自己是否要开启!!<span>','<span class="text-danger">如果无法验证，命令行输入"bt 24" 取消动态口令认证<span>',"开启服务后，请立即绑定，以免出现面板不能访问。","请先下载宝塔APP或(谷歌认证器)，并完成安装和初始化。",'基于google Authenticator 开发,如遇到问题请<a class="btlink" href="https://www.bt.cn/bbs/forum.php?mod=viewthread&tid=105839">查看详情</a>'],isShowAppCode:!0,onConfirm:()=>_(1)})},v=()=>{a.value.checkTwoStep?f():d()},f=()=>{R({title:"动态口令配置",component:()=>F((()=>import("./dyname-pwd-config.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),area:55})},_=async e=>{(await z({loading:"正在设置动态口令配置，请稍候...",request:fe({act:e}),message:!0,success:()=>{e&&f()}})).status&&(a.value.checkTwoStep=Boolean(e))};return t((()=>{(async()=>{const{data:e}=await _e();a.value.checkTwoStep=e.status})()})),(e,l)=>{const t=m,f=p,y=G;return s(),n("div",null,[u(r(Ke),{label:"动态口令认证"},{value:o((()=>[u(t,{modelValue:r(a).checkTwoStep,"onUpdate:modelValue":l[0]||(l[0]=e=>r(a).checkTwoStep=e),onChange:l[1]||(l[1]=e=>{return l=r(a).checkTwoStep,a.value.checkTwoStep=!l,void(l?d():_(Number(l)));var l})},null,8,["modelValue"]),u(f,{size:"small",class:"!ml-12px",onClick:v},{default:o((()=>l[2]||(l[2]=[i("动态口令配置")]))),_:1})])),desc:o((()=>[l[4]||(l[4]=c("span",null,"(Google Authenticator，谷歌身份认证)为面板提供动态口令的登录的验证，",-1)),u(y,{href:"https://www.bt.cn/bbs/forum.php?mod=viewthread&tid=105839"},{default:o((()=>l[3]||(l[3]=[i("了解详情")]))),_:1})])),_:1})])}}}),Ul={class:"p-[2rem]"},Sl={class:"flex mt-12px"},Al={class:"flex-1 mr-20px relative"},Pl={class:"placeholder"},Tl={class:"flex-1 relative"},jl={class:"placeholder"},ql={key:1,class:"help-list !pl-20px mt-12px !bg-[#fff] !py-0"},Il={class:"text-[1.2rem] flex items-center"},El=Z(e({__name:"index",setup(e){const{refs:{safeConfig:t}}=L(),v=l(!1),f=l(!1),w=l(!1),b=a({loading:!1,title:"正在获取证书信息，请稍候..."}),k=l({crl:"",cert:""}),U=async()=>{b.title="正在获取证书信息，请稍候...",b.loading=!0,v.value=!0;try{const{data:e}=await ye();t.value.sslVerify=e.status,k.value.crl=e.crl,k.value.cert=e.ca}catch(e){v.value=!1}finally{b.loading=!1}},S=async()=>{try{if(!k.value.crl)return B.error("注销列表(crl)不能为空");if(!k.value.cert)return B.error("证书(cert)不能为空");if(f.value&&!w.value)return B.error("请勾选并同意承担风险");b.title="正在保存，请稍候...",b.loading=!0;const e=await z({request:xe({crl:k.value.crl,cert:k.value.cert,status:f.value?1:0}),message:!0});return await $(),e.status&&window.location.reload(),e.status}catch(e){}finally{b.loading=!1}};return _(v,((e,l)=>{!e&&(k.value.crl="",k.value.cert="")})),(e,l)=>{const a=m,_=p,A=G,P=J,T=C,q=M,I=y("bt-loading");return s(),n("div",null,[u(r(Ke),{label:"访问设备验证"},{value:o((()=>[u(a,{modelValue:r(t).sslVerify,"onUpdate:modelValue":l[0]||(l[0]=e=>r(t).sslVerify=e),onChange:l[1]||(l[1]=e=>(async e=>{try{if(!t.value.panelSSl)return B.error("请先开启面板SSL证书后重试"),void(t.value.sslVerify=!1);const{data:l}=await ye();if(k.value.crl=l.crl,k.value.cert=l.ca,f.value=!0,e)v.value=!0;else{const{data:e}=await xe({status:0});e.status&&window.location.reload()}}catch(l){}})(r(t).sslVerify))},null,8,["modelValue"]),u(_,{size:"small",class:"!ml-12px",onClick:U},{default:o((()=>l[7]||(l[7]=[i("访问设备验证配置")]))),_:1})])),desc:o((()=>[l[9]||(l[9]=c("span",null," 基于SSL证书双向验证，开启后电脑需要安装此证书，否则将无法访问，属于极高安全级别的访问限制方式，类似银行账号U盘密钥登录。 ",-1)),u(A,{href:"https://www.bt.cn/bbs/thread-77863-1-1.html"},{default:o((()=>l[8]||(l[8]=[i("了解详情")]))),_:1})])),_:1}),u(q,{title:"自定义证书",modelValue:r(v),"onUpdate:modelValue":l[5]||(l[5]=e=>d(v)?v.value=e:null),area:70,showFooter:"",onConfirm:S,onCancel:l[6]||(l[6]=e=>(f.value&&(t.value.sslVerify=!t.value.sslVerify),void(f.value=!1)))},{default:o((()=>[x((s(),n("div",Ul,[r(f)?(s(),n(h,{key:0},[l[10]||(l[10]=c("div",{class:"flex items-center"},[c("i",{class:"svgtofont-el-warning-filled text-[#E6A23C] !text-[4rem] pr-4"}),c("p",{class:"text-[2.1rem]"},"风险操作！此功能不懂请勿开启！")],-1)),l[11]||(l[11]=c("ul",{class:"help-list"},[c("li",{class:"text-danger"},"必须要用到且了解此功能才决定自己是否要开启！"),c("li",null,"开启后电脑需要安装此证书，否则将无法访问，属于【极高安全级别】的限制，类似银行账号U盘密钥登录。"),c("li",null,"注销列表(crl)和证书(cert)可通过企业版插件[堡塔限制访问型证书->双向认证->服务器证书]获取。"),c("li",null,"开启之前请先下载好对应的[客户端证书]，否则将无法访问面板。"),c("li",null,"开启访问设备验证后，未授权的用户访问将会出现400错误。"),c("li",null,"开启后导致面板不能访问，命令行：bt 29 关闭访问设备验证。")],-1))],64)):V("",!0),c("div",Sl,[c("div",Al,[l[12]||(l[12]=c("div",{class:"text-[1.2rem] mb-8px"},"注销列表(crl)",-1)),u(P,{class:"text-[1.2rem]",type:"textarea",modelValue:r(k).crl,"onUpdate:modelValue":l[2]||(l[2]=e=>r(k).crl=e),rows:13,size:"small"},null,8,["modelValue"]),x(c("span",Pl,"请粘贴您的注销列表（crl）",512),[[j,""===r(k).crl]])]),c("div",Tl,[l[13]||(l[13]=c("div",{class:"text-[1.2rem] mb-8px"},"证书(cert)",-1)),u(P,{type:"textarea",modelValue:r(k).cert,"onUpdate:modelValue":l[3]||(l[3]=e=>r(k).cert=e),rows:13,size:"small"},null,8,["modelValue"]),x(c("span",jl,"请粘贴您的证书(cert)",512),[[j,""===r(k).cert]])])]),r(f)?(s(),g(T,{key:2,modelValue:r(w),"onUpdate:modelValue":l[4]||(l[4]=e=>d(w)?w.value=e:null),class:"mt-12px px-16px"},{default:o((()=>[c("div",Il,[l[16]||(l[16]=i(" 已了经解详情,并愿意承担风险！ ")),u(A,{href:"https://www.bt.cn/bbs/thread-77863-1-1.html",target:"_blank"},{default:o((()=>l[15]||(l[15]=[i(" 了解详情 ")]))),_:1})])])),_:1},8,["modelValue"])):(s(),n("ul",ql,l[14]||(l[14]=[c("li",null,"粘贴您的注销列表(crl)以及证书(cert)，然后保存即可。",-1),c("li",null,"注销列表(crl)和证书(cert)可通过企业版插件[堡塔限制访问型证书->双向认证->服务器证书]获取。",-1)])))])),[[I,r(b).loading],[I,r(b).title,"title"]])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-0180c4d5"]]),Kl=e({__name:"index",setup(e){const{refs:{safeConfig:a}}=L(),t=l(!1),p=l(!1),v=e=>{e?t.value=!0:p.value=!0},f=e=>{const l=e?t:p;l.value&&(a.value.pawComplexity=!a.value.pawComplexity,l.value=!1)},_=e=>{const l=e?t:p;l.value&&(l.value=!1,x())},y=async()=>{try{const{data:e}=await he();a.value.pawComplexity=e.password_safe}catch(e){}},x=async()=>{await z({loading:"正在设置密码复杂度，请稍候...",request:we(),message:!0,success:y})};return(e,l)=>{const y=m,x=M;return s(),n("div",null,[u(r(Ke),{label:"密码复杂度验证"},{value:o((()=>[u(y,{modelValue:r(a).pawComplexity,"onUpdate:modelValue":l[0]||(l[0]=e=>r(a).pawComplexity=e),onChange:v},null,8,["modelValue"])])),desc:o((()=>l[7]||(l[7]=[c("span",null,"为面板密码提供复杂度验证方式，复杂度验证规则：",-1),c("span",{class:"text-danger"},"密码必须满足密码长度大于8位且大写字母、小写字母、数字、特殊字符至少3项组合",-1)]))),_:1}),u(x,{title:"开启 密码复杂度验证",modelValue:r(t),"onUpdate:modelValue":l[1]||(l[1]=e=>d(t)?t.value=e:null),area:36,"show-footer":!0,onConfirm:l[2]||(l[2]=e=>_(!0)),onCancel:l[3]||(l[3]=e=>f(!0))},{default:o((()=>l[8]||(l[8]=[c("div",{class:"p-[2rem] flex"},[c("i",{class:"svgtofont-el-warning-filled text-[#E6A23C] !text-[4rem] pr-4"}),c("p",{class:"text-[1.4rem] leading-8"},[i(" 开启密码复杂度验证后，将会对密码进行复杂度判断，规则： "),c("span",{class:"text-danger"},"密码必须满足密码长度大于8位且大写字母、小写字母、数字、特殊字符至少3项组合"),i(" ，继续操作！ ")])],-1)]))),_:1},8,["modelValue"]),u(x,{title:"关闭 密码复杂度验证",modelValue:r(p),"onUpdate:modelValue":l[4]||(l[4]=e=>d(p)?p.value=e:null),area:[36,"auto"],"show-footer":!0,onConfirm:l[5]||(l[5]=e=>_(!1)),onCancel:l[6]||(l[6]=e=>f(!1))},{default:o((()=>l[9]||(l[9]=[c("div",{class:"p-[2rem] flex"},[c("i",{class:"svgtofont-el-warning-filled text-[#E6A23C] !text-[4rem] pr-4"}),c("p",{class:"text-[1.4rem] leading-8"},"关闭密码复杂度后，密码登录将不再验证密码复杂度，这将会导致面板安全性下降，继续操作！")],-1)]))),_:1},8,["modelValue"])])}}}),Ll={class:"w-[26rem]"},zl=e({__name:"index",setup(e){const{refs:{safeConfig:l},saveConfig:a}=L();return(e,t)=>{const n=J,d=p;return s(),g(r(Ke),{label:"绑定域名"},{value:o((()=>[c("div",Ll,[u(n,{modelValue:r(l).domain,"onUpdate:modelValue":t[0]||(t[0]=e=>r(l).domain=e)},null,8,["modelValue"])]),u(d,{type:"primary",class:"!ml-12px",onClick:t[1]||(t[1]=e=>{a("正在绑定域名，请稍候...")})},{default:o((()=>t[2]||(t[2]=[i("保存")]))),_:1})])),desc:o((()=>t[3]||(t[3]=[c("span",null,"为面板绑定一个访问域名，",-1),c("span",{class:"text-danger"},"注意：一旦绑定域名，只能通过域名访问面板",-1)]))),_:1})}}}),Dl={class:"w-[26rem]"},Ml=e({__name:"index",setup(e){const{refs:{safeConfig:l},saveConfig:a}=L();return(e,t)=>{const n=J,d=p;return s(),g(r(Ke),{label:"授权IP"},{value:o((()=>[c("div",Dl,[u(n,{modelValue:r(l).limitip,"onUpdate:modelValue":t[0]||(t[0]=e=>r(l).limitip=e),placeholder:"示例: 1.1.1.1,2.2.2.1-2.2.2.2"},null,8,["modelValue"])]),u(d,{type:"primary",class:"!ml-12px",onClick:t[1]||(t[1]=e=>(async()=>{let e=/^((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})){3}$/,t=l.value.limitip.split(",").join("-").split("-"),s=!0;if(t.length)for(let l=0;l<t.length;l++)0==e.test(t[l])&&(s=!1);if(!s&&l.value.limitip.length>0)return B.error("请输入正确的ip地址");a("正在保存授权IP，请稍候...")})())},{default:o((()=>t[2]||(t[2]=[i("保存")]))),_:1})])),desc:o((()=>t[3]||(t[3]=[c("span",null,"设置访问授权IP，多个IP地址，请使用“,”分割，",-1),c("span",{class:"text-danger"},"注意：一旦设置授权IP，只有指定IP的电脑能访问面板",-1)]))),_:1})}}}),Bl={class:"p-[2rem]"},Nl={class:"text-[1.2rem] flex items-center"},Rl=Z(e({__name:"index",setup(e){const{refs:{safeConfig:a,openPortPopup:t}}=L(),m=l(8888),y=l(!1),x=l(!1),w=()=>{x.value=!0,m.value=a.value.port},h=async()=>{await z({loading:"正在设置面板端口，请稍候...",request:Ve({port:m.value}),message:!0}),ee("".concat(location.protocol,"//").concat(location.hostname,":").concat(m.value).concat(location.pathname),2e3)};return _((()=>t),(e=>{e&&(w(),t.value=!1)}),{deep:!0}),(e,l)=>{const t=J,_=p,V=v,b=f,g=G,k=C,U=M;return s(),n("div",null,[u(r(Ke),{label:"面板端口"},{value:o((()=>[u(t,{modelValue:r(a).port,"onUpdate:modelValue":l[0]||(l[0]=e=>r(a).port=e),disabled:"",class:"!w-[26rem]"},null,8,["modelValue"]),u(_,{type:"primary",class:"!ml-12px",onClick:w},{default:o((()=>l[5]||(l[5]=[i("设置")]))),_:1})])),desc:o((()=>l[6]||(l[6]=[c("span",null,[c("span",null,"建议端口范围8888 - 65535，"),c("span",{class:"text-danger"},"注意：有安全组的服务器请提前在安全组放行新端口")],-1)]))),_:1}),u(U,{title:"设置面板端口",modelValue:r(x),"onUpdate:modelValue":l[3]||(l[3]=e=>d(x)?x.value=e:null),area:40,"show-footer":!0,onConfirm:l[4]||(l[4]=e=>(()=>{if(!y.value)return B.error("请勾选同意协议");const e=Number(m.value);if(!W(e))return B.error("端口格式错误，请重新输入");x.value=!1,h()})())},{default:o((()=>[c("div",Bl,[l[9]||(l[9]=c("ul",{class:"help-list"},[c("li",null,"建议端口范围8888 - 65535，"),c("li",null,"注意：有安全组的服务器请提前在安全组放行新端口"),c("li",null,"如果修改端口导致面板无法访问，请在SSH命令行通过bt命令改回原来的端口")],-1)),u(b,{id:"panelPostFrom",class:"mt-[24px] flex justify-center","label-position":"left"},{default:o((()=>[u(V,{label:"面板端口"},{default:o((()=>[u(t,{modelValue:r(m),"onUpdate:modelValue":l[1]||(l[1]=e=>d(m)?m.value=e:null),class:"w-[21rem] edit-input"},null,8,["modelValue"])])),_:1})])),_:1}),u(k,{modelValue:r(y),"onUpdate:modelValue":l[2]||(l[2]=e=>d(y)?y.value=e:null),class:"pl-16px"},{default:o((()=>[c("div",Nl,[l[8]||(l[8]=i("我已了解,")),u(g,{href:"https://www.bt.cn/bbs/thread-40037-1-1.html"},{default:o((()=>l[7]||(l[7]=[i("如何放行端口？")]))),_:1})])])),_:1},8,["modelValue"])])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-e4d5d363"]]),Fl={class:"p-[2.8rem]"},Ol=Z(e({__name:"index",setup(e){const{refs:{safeConfig:a}}=L(),t=l(""),m=l(!1),_=()=>{t.value=a.value.admin_path,m.value=!0},y=async e=>{e=await le(e),await z({request:be({admin_path:e}),message:!0,loading:"正在设置安全入口，请稍候..."})};return(e,l)=>{const x=J,w=p,h=v,V=f,b=M;return s(),n("div",null,[u(r(Ke),{label:"安全入口"},{value:o((()=>[u(x,{modelValue:r(a).admin_path,"onUpdate:modelValue":l[0]||(l[0]=e=>r(a).admin_path=e),disabled:"",class:"!w-[26rem]"},null,8,["modelValue"]),u(w,{type:"primary",class:"!ml-12px",onClick:_},{default:o((()=>l[4]||(l[4]=[i("设置")]))),_:1})])),desc:o((()=>l[5]||(l[5]=[c("span",null,"面板管理入口，设置后只能通过指定安全入口登录面板,如: /www_bt_cn",-1)]))),_:1}),u(b,{title:"设置面板安全入口",modelValue:r(m),"onUpdate:modelValue":l[2]||(l[2]=e=>d(m)?m.value=e:null),area:40,"show-footer":"",onConfirm:l[3]||(l[3]=e=>(a.value.admin_path=t.value,y(t.value),void(m.value=!1)))},{default:o((()=>[c("div",Fl,[u(V,{class:"flex justify-center","label-position":"right"},{default:o((()=>[u(h,{label:"安全入口"},{default:o((()=>[u(x,{modelValue:r(t),"onUpdate:modelValue":l[1]||(l[1]=e=>d(t)?t.value=e:null),class:"!w-[24rem]"},null,8,["modelValue"])])),_:1})])),_:1})])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-9989a3a1"]]),Hl={class:"p-[2rem]"},Gl=Z(e({__name:"index",setup(e){var a;const{refs:{safeConfig:t}}=L(),m=q([{key:403,title:"403-拒绝访问"},{key:404,title:"404-页面不存在"},{key:416,title:"416-无效的请求"},{key:408,title:"408-客户端超时"},{key:400,title:"400-客户端请求错误"},{key:401,title:"401-未授权访问"}]),y=l(!1),x=l(404),w=l(null==(a=m.value.find((e=>e.key===t.value.statusCode)))?void 0:a.title),V=async e=>{e?Number(e):e+="",await z({loading:"正在设置未认证响应状态，请稍候...",request:ge({status_code:e}),message:!0}),m.value.forEach((e=>{e.key==x.value&&(t.value.statusCode=e.key,w.value=e.title)}))};return _((()=>t.value.statusCode),(e=>{m.value.forEach((e=>{e.key===t.value.statusCode&&(w.value=e.title)}))})),(e,l)=>{const a=J,_=p,k=T,C=U,S=v,A=f,P=M;return s(),n("div",null,[u(r(Ke),{label:"未认证响应状态"},{value:o((()=>[u(a,{modelValue:r(w),"onUpdate:modelValue":l[0]||(l[0]=e=>d(w)?w.value=e:null),disabled:"",class:"!w-[26rem]"},null,8,["modelValue"]),u(_,{type:"primary",class:"!ml-12px",onClick:l[1]||(l[1]=e=>(y.value=!0,void m.value.forEach((e=>{e.key==t.value.statusCode&&(x.value=e.key)}))))},{default:o((()=>l[5]||(l[5]=[i("设置")]))),_:1})])),desc:o((()=>l[6]||(l[6]=[c("span",null,"用于在未登录且未正确输入安全入口时的响应，可用于隐藏面板特征",-1)]))),_:1}),u(P,{title:"设置未认证时的响应状态",modelValue:r(y),"onUpdate:modelValue":l[3]||(l[3]=e=>d(y)?y.value=e:null),area:42,"show-footer":"",onConfirm:l[4]||(l[4]=e=>(y.value=!1,void V(x.value)))},{default:o((()=>[c("div",Hl,[u(A,{class:"my-[12px] flex justify-center","label-position":"right"},{default:o((()=>[u(S,{label:"响应状态"},{default:o((()=>[u(C,{modelValue:r(x),"onUpdate:modelValue":l[2]||(l[2]=e=>d(x)?x.value=e:null),placeholder:"请选择",class:"!w-[20rem]"},{default:o((()=>[(s(!0),n(h,null,b(r(m),(e=>(s(),g(k,{key:e.key,label:e.title,value:e.key},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),l[7]||(l[7]=c("ul",{class:"px-[16px] py-[2px] list-disc"},[c("li",{class:"h-[2.4rem] text-danger"},"用于未登录且未正确输入安全入口时的响应,用于隐藏面板特征")],-1))])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-8fbf9d55"]]),Jl={class:"w-[26rem]"},Ql={class:"p-[2rem]"},Xl=e({__name:"index",setup(e){const{refs:{safeConfig:m}}=L(),y=l(),x=l({day:0}),w=l(""),h=l(!1);let V=0;const b=a({day:[{validator:(e,l,a)=>{Number.parseInt(l)<0||!Number.isInteger(parseFloat(l))?a(new Error("请输入大于等于0的整数")):a()},trigger:["input","change"]}]});_((()=>h.value),(e=>{e&&(x.value.day=V)}));const g=async()=>{try{const{data:e}=await he();e.expire?w.value=ae(e.expire_time,"yyyy/MM/dd HH:mm:ss")+" （剩余"+e.expire_day+"天过期）":w.value="未设置",x.value.day=e.expire,V=e.expire,m.value.pawComplexity=e.password_safe}catch(e){}},k=async e=>{await z({loading:"正在设置密码过期时间，请稍候...",request:ke({expire:e}),message:!0})};return t((()=>{g()})),(e,l)=>{const a=J,t=p,m=v,_=f,V=M;return s(),n("div",null,[u(r(Ke),{label:"密码过期时间"},{value:o((()=>[c("div",Jl,[u(a,{modelValue:r(w),"onUpdate:modelValue":l[0]||(l[0]=e=>d(w)?w.value=e:null),disabled:""},null,8,["modelValue"])]),u(t,{type:"primary",class:"!ml-12px",onClick:l[1]||(l[1]=e=>h.value=!0)},{default:o((()=>l[5]||(l[5]=[i("设置")]))),_:1})])),desc:o((()=>l[6]||(l[6]=[c("span",null,"为面板密码设置过期时间，过期后需要重新设置密码",-1)]))),_:1}),u(V,{title:"设置密码过期时间",modelValue:r(h),"onUpdate:modelValue":l[3]||(l[3]=e=>d(h)?h.value=e:null),area:40,"show-footer":!0,onConfirm:l[4]||(l[4]=e=>(async()=>{await y.value.validate(),h.value=!1,k(x.value.day),g()})())},{default:o((()=>[c("div",Ql,[u(_,{ref_key:"pwdFormRef",ref:y,rules:r(b),model:r(x),class:"my-[12px] flex justify-center","label-position":"left"},{default:o((()=>[u(m,{label:"密码过期时间",prop:"day"},{default:o((()=>[u(a,{modelValue:r(x).day,"onUpdate:modelValue":l[2]||(l[2]=e=>r(x).day=e),"text-type":"天",type:"number",min:"0",class:"!w-[16rem]"},{append:o((()=>l[7]||(l[7]=[i(" 天 ")]))),_:1},8,["modelValue"])])),_:1})])),_:1},8,["rules","model"]),l[8]||(l[8]=c("ul",{class:"px-[1.6rem] py-[.2rem] list-disc"},[c("li",{class:"h-[2.4rem] text-danger"},"面板密码过期时间设置，过期后需要重新设置密码"),c("li",{class:"h-[2.4rem]"},"密码过期时间为“0天”，则关闭密码过期时间功能")],-1))])])),_:1},8,["modelValue"])])}}}),Yl={class:"p-[2rem] flex"},Zl={class:"p-[2rem]"},$l=e({__name:"index",setup(e){const m=l(!1),_=l([]),w=l(!1),h=l(0),b=a({p:1,rows:10}),k=l(!1),C=l(!1),U=l([]),S=l(!1),P=l(),T=l({checkboxValue:"3小时",day:1}),j=l(""),q=l(),K=l(),L=l(!1),D={day:[{validator:(e,l,a)=>{(l<=0||l%1!=0)&&"自定义"===T.value.checkboxValue?a(new Error("自定义时间为大于0的整数！")):a()},trigger:["blur","change","input"]}]},B=[{label:"登录IP",render:e=>e.login_addr||"未登录"},{label:"状态",width:90,render:(e,l)=>{switch(e.state){case-1:return u("span",{class:"text-[brown]"},[i("已过期")]);case 0:return u("span",{class:"text-primary"},[i("待使用")]);case 1:return"已使用"}}},{label:"登录时间",render:e=>0==e.login_time?"未登录":ae(e.addtime,"yyyy/MM/dd HH:mm:ss")},{label:"过期时间",render:e=>ae(e.expire)},{label:"操作",width:120,align:"right",render:e=>u("div",{class:"flex items-center justify-end"},[u("div",{class:"1"==e.state?"":"hidden"},[u("span",{class:"bt-link",onClick:()=>O(e.id,e.login_addr)},[i("操作日志")]),u(I,{direction:"vertical"},null)]),u("span",{class:"bt-link",onClick:()=>F(e.id)},[i("删除")])])}],R=[{label:"操作类型",prop:"type"},{label:"操作时间",prop:"addtime"},{label:"日志",prop:"log",width:350}],F=async e=>{q.value=e,await te({title:"删除未使用授权",content:"删除授权记录，是否继续？",icon:"warning-filled"}),await z({loading:"正在删除临时授权，请稍候...",request:Ce({id:e}),message:!0}),X()},O=(e,l)=>{k.value=!0,q.value=e,K.value=l,H()},H=()=>Q(q.value),G=async()=>{const{checkboxValue:e,day:l}=T.value;let a="自定义"===e?24*l:e.replaceAll("小时",""),t=Math.floor(Date.now()/1e3);a=60*parseInt(a)*60+t;const s=await z({loading:"正在创建临时授权链接，请稍候...",request:Ue({expire_time:a}),message:!0,data:{token:String,expire:Number,status:Boolean}});X();let n=window.location.protocol+"//"+window.location.host+"/login?";return j.value=n+"\ntmp_token="+s.token,s},Q=async e=>{await z({loading:C,request:Se({id:e}),data:[Array,U]})},X=async()=>{await z({loading:w,request:Ae(b),data:{data:[Array,_],page:se(h)}})};return t((()=>{X()})),(e,l)=>{const a=p,t=Y,q=Be,I=ze,z=M,F=E,O=A,Q=v,Z=J,$=f,W=y("bt-loading");return s(),n("div",null,[u(r(Ke),{label:"临时访问授权"},{value:o((()=>[u(a,{type:"primary",onClick:l[0]||(l[0]=e=>(async()=>m.value=!0)())},{default:o((()=>l[13]||(l[13]=[i("临时访问授权管理")]))),_:1})])),desc:o((()=>l[14]||(l[14]=[c("span",null,"为非管理员临时提供面板访问权限",-1)]))),_:1}),u(z,{title:"临时授权管理",modelValue:r(m),"onUpdate:modelValue":l[4]||(l[4]=e=>d(m)?m.value=e:null),area:70},{default:o((()=>[u(I,{class:"p-6"},{"header-left":o((()=>[u(a,{type:"primary",onClick:l[1]||(l[1]=e=>L.value=!0)},{default:o((()=>l[15]||(l[15]=[i("创建临时授权 ")]))),_:1})])),content:o((()=>[x(u(t,{ref:"tempAuthTable",data:r(_),column:B,"max-height":380},null,8,["data"]),[[W,r(w)]])])),"footer-right":o((()=>[u(q,{page:r(b).p,"onUpdate:page":l[2]||(l[2]=e=>r(b).p=e),row:r(b).rows,"onUpdate:row":l[3]||(l[3]=e=>r(b).rows=e),total:r(h),onChange:X},null,8,["page","row","total"])])),_:1})])),_:1},8,["modelValue"]),u(z,{title:"风险提示",modelValue:r(L),"onUpdate:modelValue":l[7]||(l[7]=e=>d(L)?L.value=e:null),area:54,"show-footer":!0,onConfirm:l[8]||(l[8]=e=>(async()=>{await P.value.validate(),L.value=!1;const e=await G();(null==e?void 0:e.status)&&(S.value=!0)})())},{default:o((()=>[c("div",Yl,[l[19]||(l[19]=c("i",{class:"svgtofont-el-warning-filled text-[#E6A23C] !text-[4rem] pr-4"},null,-1)),c("div",null,[l[17]||(l[17]=c("p",{class:"text-[1.4rem] leading-10 text-danger"},"注意1：滥用临时授权可能导致安全风险。",-1)),l[18]||(l[18]=c("p",{class:"text-[1.4rem] leading-10 text-danger"},"注意2：请勿在公共场合发布临时授权连接",-1)),u($,{ref_key:"authFormRef",ref:P,rules:D,model:r(T),"label-position":"left",class:"my-[1rem]"},{default:o((()=>[u(Q,{label:"授权时间"},{default:o((()=>[u(O,{modelValue:r(T).checkboxValue,"onUpdate:modelValue":l[5]||(l[5]=e=>r(T).checkboxValue=e)},{default:o((()=>[u(F,{label:"3小时"}),u(F,{label:"6小时"}),u(F,{label:"9小时"}),u(F,{label:"12小时"}),u(F,{label:"自定义"})])),_:1},8,["modelValue"])])),_:1}),"自定义"===r(T).checkboxValue?(s(),g(Q,{key:0,label:"自定义时间",prop:"day"},{default:o((()=>[u(Z,{modelValue:r(T).day,"onUpdate:modelValue":l[6]||(l[6]=e=>r(T).day=e),width:"16rem",textType:"天",min:"1",type:"number"},{append:o((()=>l[16]||(l[16]=[i("天")]))),_:1},8,["modelValue"])])),_:1})):V("",!0)])),_:1},8,["model"])])])])),_:1},8,["modelValue"]),u(z,{title:"创建临时授权",modelValue:r(S),"onUpdate:modelValue":l[11]||(l[11]=e=>d(S)?S.value=e:null),area:57},{default:o((()=>[c("div",Zl,[l[21]||(l[21]=c("div",null,"临时授权地址",-1)),u(Z,{class:"my-5",type:"textarea",rows:2,modelValue:r(j),"onUpdate:modelValue":l[9]||(l[9]=e=>d(j)?j.value=e:null)},null,8,["modelValue"]),u(a,{type:"primary",class:"copy",onClick:l[10]||(l[10]=e=>{return l=r(j),N({value:l});var l})},{default:o((()=>l[20]||(l[20]=[i("复制地址")]))),_:1}),l[22]||(l[22]=c("ul",{class:"ml-6 mt-8 list-disc"},[c("li",{class:"text-medium h-[2.4rem]"},"临时授权生成后1小时内使用有效，为一次性授权，使用后立即失效"),c("li",{class:"text-medium h-[2.4rem]"},"使用临时授权登录面板后1小时内拥有面板所有权限，请勿在公共场合发布临时授权连接"),c("li",{class:"text-medium h-[2.4rem]"},"授权连接信息仅在此处显示一次，若在使用前忘记，请重新生成")],-1))])])),_:1},8,["modelValue"]),u(z,{title:"查看操作日志【".concat(r(K),"】"),modelValue:r(k),"onUpdate:modelValue":l[12]||(l[12]=e=>d(k)?k.value=e:null),area:70},{default:o((()=>[u(I,{class:"p-6"},{"header-left":o((()=>[u(a,{onClick:H,type:"primary"},{default:o((()=>l[23]||(l[23]=[i("刷新日志")]))),_:1})])),content:o((()=>[x(u(t,{ref:"tempAuthLogTable","max-height":380,data:r(U),column:R},null,8,["data"]),[[W,r(C)],[W,"正在获取日志，请稍候...","title"]])])),_:1})])),_:1},8,["title","modelValue"])])}}}),Wl=e({__name:"index",setup(e){const a=l({}),n=K((()=>{var e;return"true"==(null==(e=a.value)?void 0:e.limit_area_status)})),v=async()=>{R({title:"设置地区登录限制",component:()=>F((()=>import("./area-config.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),compData:{limitArea:a.value,onRefresh:_},showFooter:!0,area:70})},f=async e=>{await te({title:"".concat(e?"开启":"关闭","地区登录限制"),content:"".concat(e?"开启后，将会对面板登录地区进行限制":"关闭后，设置的地区登录将失效","，是否继续操作？"),icon:"warning-filled"}),await z({loading:"正在设置，请稍候...",request:Pe({limit_area_status:e}),message:!0,success:_})},_=async()=>{const e=await z({request:Te(),data:{limit_area:Object,limit_area_status:String,limit_type:String}});a.value=e};return t((async()=>_())),(e,l)=>{const a=m,t=p;return s(),g(r(Ke),{label:"地区登录限制"},{value:o((()=>[u(a,{modelValue:r(n),"onUpdate:modelValue":l[0]||(l[0]=e=>d(n)?n.value=e:null),onChange:f},null,8,["modelValue"]),u(t,{type:"default",size:"small",class:"!ml-12px",disabled:e.loading,onClick:v},{default:o((()=>l[1]||(l[1]=[i("设置地区登录限制")]))),_:1},8,["disabled"])])),desc:o((()=>l[2]||(l[2]=[c("span",null,"设置面板地区登录策略",-1)]))),_:1})}}}),ea={class:"px-[2rem]"},la={class:"p-[2rem]"},aa=e({__name:"index",setup(e){const{refs:{safeConfig:a}}=L(),_=l(!1),w=l(!1),h=l([]),V=l(!1),b=l(),g=l(!1),k=async()=>{await z({request:qe(),success:({data:e})=>{const{status:l,ua_list:t}=e.msg||e;a.value.uaAstrict=1===Number(l),h.value=t}})},C=async()=>{if(!b.value)return B.error("请输入User-Agent");await z({loading:"正在设置，请稍候...",request:g.value?je({new_name:b.value,id:g.value}):Ie({ua_list:b.value}),message:!0}),k(),g.value=!1,b.value="",V.value=!1},U=[{label:"User-Agent",prop:"name"},Ne([{onClick:e=>{g.value=e.id,b.value=e.name,V.value=!0},title:"编辑"},{onClick:e=>(async e=>{await z({loading:"正在删除，请稍候...",request:Ee({id:e.id}),message:!0}),k()})(e),title:"删除"}])];return t((()=>k())),(e,l)=>{const t=m,g=p,S=Y,A=ze,P=M,T=J,j=v,q=f,I=y("bt-loading");return s(),n("div",null,[u(r(Ke),{label:"User-Agent限制"},{value:o((()=>[u(t,{modelValue:r(a).uaAstrict,"onUpdate:modelValue":l[0]||(l[0]=e=>r(a).uaAstrict=e),onChange:l[1]||(l[1]=e=>(async e=>{await z({loading:"正在设置，请稍候...",request:je({status:e?1:0}),message:!0}),k()})(r(a).uaAstrict))},null,8,["modelValue"]),u(g,{size:"small",class:"!ml-12px",onClick:l[2]||(l[2]=e=>_.value=!0)},{default:o((()=>l[7]||(l[7]=[i("User-Agent限制配置")]))),_:1})])),desc:o((()=>l[8]||(l[8]=[c("span",null,"设置限制访问User-Agent",-1)]))),_:1}),u(P,{modelValue:r(_),"onUpdate:modelValue":l[4]||(l[4]=e=>d(_)?_.value=e:null),area:70,title:"User-Agent限制配置"},{default:o((()=>[c("div",ea,[u(A,{class:"py-20px"},{"header-left":o((()=>[u(g,{onClick:l[3]||(l[3]=e=>V.value=!0),type:"primary"},{default:o((()=>l[9]||(l[9]=[i("添加User-Agent")]))),_:1})])),content:o((()=>[x(u(S,{ref:"uaTable",column:U,data:r(h),description:"User-Agent列表为空","max-height":400},null,8,["data"]),[[I,r(w)],[I,"正在加载User-Agent列表，请稍后...","title"]])])),_:1})])])),_:1},8,["modelValue"]),u(P,{modelValue:r(V),"onUpdate:modelValue":l[6]||(l[6]=e=>d(V)?V.value=e:null),area:50,title:"User-Agent",showFooter:"",onConfirm:C},{default:o((()=>[c("div",la,[u(q,{ref:"uaFormRef",model:r(b),"label-position":"left"},{default:o((()=>[u(j,{label:"User-Agent",prop:"name"},{default:o((()=>[u(T,{modelValue:r(b),"onUpdate:modelValue":l[5]||(l[5]=e=>d(b)?b.value=e:null),type:"textarea",width:"32rem",rows:4},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])])),_:1},8,["modelValue"])])}}}),ta=e({__name:"index",setup(e){const{refs:{settingSearch:l}}=L();return(e,a)=>(s(),n("div",null,[x(u(Le,null,{default:o((()=>a[0]||(a[0]=[i("安全设置")]))),_:1},512),[[j,""===r(l)]]),u(Fe),u(Vl),u(bl),u(kl),u(Cl),u(El),u(Kl),u(zl),u(Ml),u(Rl),u(Ol),u(Gl),u(Xl),u($l),u(Wl),u(aa)]))}});export{ta as _};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
