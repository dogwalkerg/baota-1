import{_ as e}from"./index278.js?v=1734676359";import{_ as s}from"./index90.js?v=1734676359";import{l as a,H as t,o as l,M as r,u as o,am as n,an as i,U as p}from"./utils-lib.js?v=1734676359";import{s as d,r as m,c,k as u,l as h,p as f,J as g,x,q as S,e as _,y as b,M as y,A as v}from"./base-lib.js?v=1734676359";import{e as j,f as w,a as H}from"./useController2.js?v=1734676359";import{L as k}from"./useStore6.js?v=1734676359";import"./validator.js?v=1734676359";import"./index91.js?v=1734676359";import"./column.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index99.js?v=1734676359";import"./index101.js?v=1734676359";import"./index272.js?v=1734676359";const{changeIpRules:I}=j(),{isRefreshList:L}=w(),P=k(),{outDataForm:C,configData:A}=d(P),R=m("ALL"),B=[{label:"全部",value:"ALL"},{label:"登录成功",value:"Accepted"},{label:"登录失败",value:"Failed"}],T={title:"SSH登录日志-功能介绍",ps:"保障SSH服务器的安全性，发现和应对安全威胁。",source:130,desc:["SSH安全审计","SSH登录溯源","SSH暴破记录","SSH入侵分析"],tabImgs:[{title:"SSH登录日志",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/ssh_login_log.png"}]},V=()=>{C.value.type=P.getType("ssh"),A.value={type:"ssh"},a({title:"导出日志",area:44,component:()=>t((()=>import("./index273.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),showFooter:!0})},q={class:"flex items-center"},D=c({__name:"index",setup(a){const{payment:t,mainHeight:m}=o(),c=j(),{isRefreshList:w}=d(c),{getLogs:k}=c,P=()=>{J.value.p=1,E()},{BtTable:C,BtPage:A,BtRefresh:D,BtSearch:F,refresh:E,param:J}=n({request:e=>k({...e,select:R.value}),columns:[{label:"IP地址:端口",render:e=>_("div",{class:e.deny_status?"line-through text-[#ccc]":""},[_("span",{onClick:()=>(async e=>{const s=e.deny_status;await l({title:"提示",content:s?"解封该IP后，将恢复此IP对服务器的访问，是否继续操作？":"封禁该IP后，将不再允许此IP访问服务器，是否继续操作？",icon:"warning-filled"});let a={address:e.address};s||(a={address:e.address,types:"drop",brief:"SSH登录日志页面点击IP手动封禁",domain:"",choose:"address"}),a={data:JSON.stringify(a)};const t=await I(a,s);return r.request(t),L.value=!0,t})(e),class:"cursor-pointer ".concat(e.deny_status?"":"text-[#20a53a] hover:text-[#1d9534]")},[e.address]),":"+e.port])},{label:"归属地",prop:"area.info"},{label:"用户",prop:"user"},{label:"状态",prop:"status",render:function(e){return e.status?_("span",{class:"text-primary"},[b("登录成功")]):_("span",{class:"text-danger"},[b("登录失败")])}},{label:"操作时间",prop:"time",align:"right"}],extension:[i(w)]});return(a,l)=>{const r=v,o=p,n=s,i=e;return u(),h("div",null,["ltd"==f(t).authType?(u(),g(n,{key:0},{"header-left":x((()=>[S("div",q,[_(r,{onClick:f(V)},{default:x((()=>l[2]||(l[2]=[b("导出日志")]))),_:1},8,["onClick"]),S("div",{class:"flex items-center ml-[16px]",onClick:l[0]||(l[0]=e=>f(H)())},l[3]||(l[3]=[S("i",{class:"svgtofont-desired text-[1.6rem]"},null,-1),S("span",{class:"bt-link"},"需求反馈",-1)]))])])),"header-right":x((()=>[_(o,{type:"button",modelValue:f(R),"onUpdate:modelValue":l[1]||(l[1]=e=>y(R)?R.value=e:null),options:f(B),onChange:P,class:"mr-[1rem] !flex-nowrap"},null,8,["modelValue","options"]),_(f(F),{class:"mr-[1rem] !w-[28rem]",placeholder:"请输入登录ip/用户名"}),_(f(D))])),content:x((()=>[_(f(C),{"max-height":f(m)-222},null,8,["max-height"])])),"footer-right":x((()=>[_(f(A),{type:"unknown"})])),_:1})):(u(),g(i,{key:1,data:f(T),class:"px-[20%] my-[8rem]"},null,8,["data"]))])}}});export{D as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
