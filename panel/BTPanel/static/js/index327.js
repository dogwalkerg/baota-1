import{c as e,h as a,r as s,o as t,k as r,l,e as o,x as m,p as i,I as d,aX as n,N as p,ah as u,a7 as c,a4 as f,J as N,q as b,v,ag as _}from"./base-lib.js?v=1734676359";import{verifyTrustAsiaCret as O}from"./site.js?v=1734676359";import{b as h}from"./utils-lib.js?v=1734676359";import{g as j}from"./useStore10.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";const w={class:"p-[16px]"},y={style:{float:"left"}},D=e({__name:"index",props:{compData:{type:Object,default:()=>{}}},setup(e,{expose:D}){const I=h(),{refs:{isRefreshCertificateList:g}}=j(),x=e,C=a({siteName:"",partnerOrderId:""}),S=s([]),V=()=>{C.siteName="",C.partnerOrderId=""};return t((()=>{(async()=>{var e;S.value=x.compData.row.domainName,C.partnerOrderId=x.compData.row.partnerOrderId,(null==(e=x.compData.row.domainName)?void 0:e.length)&&(C.siteName=x.compData.row.domainName[0])})()})),D({onConfirm:async e=>{if(!C.siteName)return void I.error("请选择验证域名");let a;try{a=I.load("正在验证证书申请状态，请稍后...");const{data:s,msg:t,status:r}=await O({partnerOrderId:C.partnerOrderId,siteName:C.siteName});I.request({status:r,msg:t}),r&&(V(),e(),"COMPLETED"===s.stateCode?(I.success("验证成功"),g.value=!0):I.success("等待CA验证中，若长时间未能成功验证，请登录官网使用DNS方式重新申请..."))}catch(s){}finally{a&&a.close()}}}),(e,a)=>{const s=_,t=u,O=c,h=f;return r(),l("div",w,[o(h,{model:i(C),class:"relative w-full","label-position":"right",size:"small",onSubmit:a[1]||(a[1]=p((()=>{}),["prevent"]))},{default:m((()=>[o(O,{label:"验证域名",prop:"dns_name"},{default:m((()=>[o(t,{modelValue:i(C).siteName,"onUpdate:modelValue":a[0]||(a[0]=e=>i(C).siteName=e),class:"!w-[33rem]",filterable:"","default-first-option":"",size:"default",placeholder:"请选择验证域名"},{default:m((()=>[(r(!0),l(d,null,n(i(S),(e=>(r(),N(s,{key:e,label:e,value:e},{default:m((()=>[b("span",y,v(e),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])}}});export{D as default};
