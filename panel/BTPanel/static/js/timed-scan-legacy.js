System.register(["./base-lib-legacy.js?v=1734676359","./validator-legacy.js?v=1734676359","./utils-lib-legacy.js?v=1734676359","./index-legacy257.js?v=1734676359","./__commonjsHelpers__-legacy.js?v=1734676359","./index-legacy91.js?v=1734676359","./column-legacy.js?v=1734676359","./useStore-legacy5.js?v=1734676359"],(function(e,l){"use strict";var n,u,t,o,a,r,i,d,s,c,f,m,p,_,y,v,V,g,b,h,k,U,j,x,C,F,w,D,I,L,S,A,z,P,q,B,H,J;return{setters:[function(e){n=e.c,u=e.o,t=e.B,o=e.k,a=e.l,r=e.C,i=e.p,d=e.J,s=e.x,c=e.e,f=e.z,m=e.q,p=e.Q,_=e.b5,y=e.y,v=e.v,V=e.I,g=e.D,b=e.N,h=e.aj,k=e.a7,U=e.b2,j=e.b3,x=e.P,C=e.a4},function(e){F=e.ay},function(e){w=e.U,D=e.j,I=e.a4,L=e.e},function(e){S=e.u,A=e.b,z=e.c,P=e.d,q=e.f,B=e.h,H=e.j,J=e.t},null,null,null,null],execute:function(){var l={class:"px-[2rem] py-[2.4rem]"},M={class:"condition-risk"},N={class:"flex items-center"},O={class:"tip"},Q={key:0},T=n({__name:"timed-scan",setup:function(e,n){var L=n.expose,T=S(),E=T.isAutoScan,G=T.ruleForm,K=T.userOptions,R=T.isLoading,W=T.addFtpInfo;return u(A),L({onConfirm:z}),function(e,n){var u=h,L=k,S=w,A=D,z=I,T=U,X=j,Y=x,Z=F,$=C,ee=t("bt-loading");return o(),a("div",l,[r((o(),d($,{ref_key:"addFtpInfo",ref:W,model:i(G),class:"btCustomForm p-0","label-width":"4rem",rules:i(J),onSubmit:n[13]||(n[13]=b((function(){}),["prevent"]))},{default:s((function(){return[i(E)?(o(),d(L,{key:0,label:"告警状态"},{default:s((function(){return[c(u,{modelValue:i(G).status,"onUpdate:modelValue":n[0]||(n[0]=function(e){return i(G).status=e}),"active-color":"#20A53A","inactive-color":"#cdcdcd"},null,8,["modelValue"])]})),_:1})):f("",!0),c(L,{label:"安全风险项",prop:"risk"},{default:s((function(){return[m("div",M,[c(i(p),{modelValue:i(G).login_error,"onUpdate:modelValue":n[1]||(n[1]=function(e){return i(G).login_error=e})},{default:s((function(){return[n[14]||(n[14]=m("span",null,"多次登录失败",-1)),c(i(_),{type:"info",class:"risk-tag",title:i(G).config.login_error_des},{default:s((function(){return[y(v(i(G).config.login_error_des),1)]})),_:1},8,["title"])]})),_:1},8,["modelValue"]),c(i(p),{modelValue:i(G).time,"onUpdate:modelValue":n[2]||(n[2]=function(e){return i(G).time=e})},{default:s((function(){var e;return[n[15]||(n[15]=m("span",null,"登录时间异常",-1)),c(i(_),{type:"info",class:"risk-tag",title:null===(e=i(G).config)||void 0===e?void 0:e.time_des},{default:s((function(){var e;return[y(v(null===(e=i(G).config)||void 0===e?void 0:e.time_des),1)]})),_:1},8,["title"])]})),_:1},8,["modelValue"]),c(i(p),{modelValue:i(G).area,"onUpdate:modelValue":n[3]||(n[3]=function(e){return i(G).area=e})},{default:s((function(){var e;return[n[16]||(n[16]=m("span",null,"登录地区异常",-1)),c(i(_),{type:"info",class:"risk-tag",title:null===(e=i(G).config)||void 0===e?void 0:e.area_des},{default:s((function(){var e,l;return[y(v(null!==(e=i(G).config)&&void 0!==e&&null!==(e=e.area)&&void 0!==e&&e.country.length?null===(l=i(G).config)||void 0===l?void 0:l.area_des:"未配置"),1)]})),_:1},8,["title"])]})),_:1},8,["modelValue"]),c(i(p),{modelValue:i(G).anonymous,"onUpdate:modelValue":n[4]||(n[4]=function(e){return i(G).anonymous=e}),disabled:"other"===i(G).user&&!i(E)},{default:s((function(){return n[17]||(n[17]=[m("span",null,"匿名用户登录",-1)])})),_:1},8,["modelValue","disabled"]),c(i(p),{modelValue:i(G).upload_shell,"onUpdate:modelValue":n[5]||(n[5]=function(e){return i(G).upload_shell=e})},{default:s((function(){var e;return[n[18]||(n[18]=m("span",null,"上传脚本文件",-1)),c(i(_),{type:"info",class:"risk-tag",title:null===(e=i(G).config)||void 0===e?void 0:e.upload_shell_des},{default:s((function(){var e,l;return[y(v(null!==(e=i(G).config)&&void 0!==e&&null!==(e=e.upload_shell)&&void 0!==e&&e.length?null===(l=i(G).config)||void 0===l?void 0:l.upload_shell_des:"未配置"),1)]})),_:1},8,["title"])]})),_:1},8,["modelValue"]),m("span",{class:"bt-link",onClick:n[6]||(n[6]=function(){return i(P)&&i(P).apply(void 0,arguments)})}," 【设置扫描触发条件】 ")])]})),_:1}),i(E)?(o(),a(V,{key:2},[r(c(L,{label:"周期",prop:"cycle"},{default:s((function(){return[c(Y,{class:"max-w-[16rem]",modelValue:i(G).cycle,"onUpdate:modelValue":n[11]||(n[11]=function(e){return i(G).cycle=e}),min:1,type:"number"},{append:s((function(){return[c(X,{type:"flex"},{default:s((function(){return[c(T,null,{default:s((function(){return n[19]||(n[19]=[m("span",null,"天",-1)])})),_:1})]})),_:1})]})),_:1},8,["modelValue"])]})),_:1},512),[[g,!1]]),c(L,{label:"告警方式",prop:"value"},{default:s((function(){return[c(Z,{modelValue:i(G).channel,"onUpdate:modelValue":n[12]||(n[12]=function(e){return i(G).channel=e}),multiple:!0,class:"!w-30rem"},null,8,["modelValue"])]})),_:1})],64)):(o(),a(V,{key:1},[c(L,{label:"扫描日志天数",prop:"otherDay"},{default:s((function(){return[c(S,{type:"button",size:"small",modelValue:i(G).day,"onUpdate:modelValue":n[7]||(n[7]=function(e){return i(G).day=e}),options:i(q)},null,8,["modelValue","options"]),"other"===i(G).day?(o(),d(A,{key:0,type:"number",modelValue:i(G).otherDay,"onUpdate:modelValue":n[8]||(n[8]=function(e){return i(G).otherDay=e}),modelModifiers:{number:!0},class:"!inline-block ml-[1rem]"},null,8,["modelValue"])):f("",!0)]})),_:1}),c(L,{label:"FTP用户",prop:"userList"},{default:s((function(){return[m("div",N,[c(z,{class:"!w-[16rem]",modelValue:i(G).user,"onUpdate:modelValue":n[9]||(n[9]=function(e){return i(G).user=e}),options:i(B),onChange:i(H)},null,8,["modelValue","options","onChange"]),"other"===i(G).user?(o(),d(z,{key:0,class:"ml-[1rem]",multiple:"","collapse-tags":"",filterable:"",modelValue:i(G).userList,"onUpdate:modelValue":n[10]||(n[10]=function(e){return i(G).userList=e}),options:i(K)},null,8,["modelValue","options"])):f("",!0)])]})),_:1})],64))]})),_:1},8,["model","rules"])),[[ee,i(R)]]),m("div",O,[m("ul",null,[i(E)?(o(),a("li",Q,"默认扫描全部用户30天的日志")):f("",!0),n[20]||(n[20]=m("li",null,"【多次登录失败】检测时间为：5分钟",-1))])])])}}});e("default",L(T,[["__scopeId","data-v-284fa37a"]]))}}}));
