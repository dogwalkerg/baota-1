import{u as a,G as e,M as t,l as s,H as o,k as l,O as r}from"./utils-lib.js?v=1734676359";import{_ as n}from"./index90.js?v=1734676359";import{u as i}from"./column.js?v=1734676359";import{c as m,ax as p,M as d,r as u,e as c,az as _,aj as g,w as x,B as f,k as b,l as w,x as h,C as j,p as y}from"./base-lib.js?v=1734676359";import{O,P as k,M as q}from"./firewall.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";const v=m({__name:"index",setup(m){const{mainHeight:v}=a(),C=p("infoData"),z=p("getIntrusionInfo",(()=>{})),D=d(!1),H=u(),I=[{content:"开启防提权，系统会针对该用户操作命令进行限制，并记录跟踪"},{content:"不开启防提权，系统只针对该用户操作过的命令做记录跟踪"},{content:"目前防提权默认只针对www,redis,mysql操作引起的提权问题进行处理"},{class:"text-[#FF6500]",content:"消息推送需要更新至最新面板的版本(2020-06-17日之后安装的版本|或者2020-06-17日之后点击过修复面板)"}],M=[{label:"用户",prop:"0"},{label:"总次数",prop:"4",render:a=>c("span",{class:a[4].totla>0?"!text-danger":""},[a[4].totla])},{label:"当日次数",prop:"4",render:a=>c("span",{class:a[4].day_totla>0?"!text-danger":""},[a[4].day_totla])},{label:"防入侵",prop:"3",render:a=>_(g,{modelValue:a[3],size:"small",onChange:t=>(async(a,t)=>{await e({loading:"正在"+(t?"开启":"关闭")+"防入侵，请稍后...",request:O(!a[3],{user:a[0]}),message:!0}),z()})(a,t)})},{label:"日志状态",prop:"5",render:(a,t)=>_(g,{modelValue:a[5],size:"small",onChange:t=>(async(a,t,s)=>{await e({loading:"正在"+(s?"开启":"关闭")+"日志状态，请稍后...",request:k(!a[5],{uid:a[1]}),message:!0}),z()})(a,0,t)})},{label:"描述",prop:"6",showOverflowTooltip:!0},i([{onClick:async a=>{const l=await e({loading:"正在获取日志，请稍后...",request:q({user:a[0]}),data:Array});if(!l.length)return t.error("当前暂无日志");s({title:"命令日志",area:72,component:()=>o((()=>import("./index372.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),compData:{user:a[0],dateTime:l[0],dateOptions:l.map((a=>({title:a,key:a})))}})},title:"命令日志",width:70}])];return x((()=>C.value),(a=>{a&&(H.value=a.system_user)}),{immediate:!0,deep:!0}),(a,e)=>{const t=l,s=n,o=r,i=f("bt-loading");return b(),w("div",null,[c(s,null,{content:h((()=>[j(c(t,{ref:"table",column:M,data:y(H),"max-height":y(v)-390,description:"概览列表为空"},null,8,["data","max-height"]),[[i,y(D)],[i,"正在加载概览列表，请稍后...","title"]])])),popup:h((()=>e[0]||(e[0]=[]))),_:1}),c(o,{options:I,class:"mx-[1.6rem]"})])}}});export{v as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
