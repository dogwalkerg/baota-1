import{G as a,k as e,V as t,O as s,b as l,o as r}from"./utils-lib.js?v=1734676359";import{_ as o}from"./index90.js?v=1734676359";import{c as i,r as n,R as p,h as c,o as m,B as d,k as h,l as f,e as u,x as y,p as b,y as g,C as w,A as _}from"./base-lib.js?v=1734676359";import{_ as j}from"./index88.js?v=1734676359";import{aV as v,aW as x,aX as k}from"./firewall.js?v=1734676359";import{a as C,c as V}from"./column.js?v=1734676359";import{f as T}from"./validator.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";const q={class:"p-[2rem]"},A=i({__name:"index",setup(i){const A=l(),O=n(),W=p([]),B=[{content:'注意：添加白名单目录要以"/"结尾'}],G=[{label:"删除",value:"delete",event:async(a,e,t,s)=>{const{label:l,value:r}=s,o=async(a,e)=>{const{path:t,type:s}=a;if("delete"===r)return await k({path:t,type:s})};await a({title:"批量".concat(l,"白名单目录"),content:"批量".concat(l,"已选的白名单目录，是否继续操作！"),column:[{label:"路径",prop:"path"},V()],onConfirm:async()=>(await e(o),I(),!1)})}}],H=c({path:"",type:"dir"}),I=async()=>{a({request:v(),success:a=>{Array.isArray(a.data)||(W.value=[...a.data.dir.map((a=>({path:a,type:"dir",typeTitle:"目录"}))),...a.data.file.map((a=>({path:a,type:"file",typeTitle:"文件"})))])}})},L=async()=>{try{if(!H.path)return void A.error("请输入白名单目录");await a({request:x({path:H.path}),message:!0,loading:"正在添加白名单目录，请稍后...",success:I}),H.path=""}catch(e){}},P=[C(),{label:"路径",prop:"path",showOverflowTooltip:!0},{label:"类型",prop:"typeTitle"},{label:"操作",align:"right",fixed:"right",render:e=>u("span",{class:"bt-link",onClick:()=>(async e=>{await r({icon:"warning-filled",title:"删除白名单目录",width:"34rem",content:"删除白名单目录【"+e.path+"】，是否继续操作？"}),a({request:k({path:e.path,type:e.type}),message:!0,loading:"正在删除白名单目录，请稍后...",success:I})})(e)},[g("删除")])}];return m((()=>{I()})),(a,l)=>{const r=j,i=_,n=e,p=t,c=o,m=s,v=d("bt-loading");return h(),f("div",q,[u(c,null,{"header-left":y((()=>[u(r,{modelValue:b(H).path,"onUpdate:modelValue":l[0]||(l[0]=a=>b(H).path=a),name:"path",placeholder:"选择目录/文件全路径",icon:"icon-file_mode",onIconClick:l[1]||(l[1]=a=>{T({type:"all",change(a,e){H.path=a,H.type=e,"dir"!==e||a.endsWith("/")||(H.path+="/")}})}),onChangePassive:l[2]||(l[2]=a=>{var e;H[e="path"]=H[e].replace(/\s+/g,"")}),width:"32rem"},null,8,["modelValue"]),u(i,{class:"!ml-[.8rem]",type:"primary",onClick:L},{default:y((()=>l[3]||(l[3]=[g(" 添加 ")]))),_:1})])),content:y((()=>[w(u(n,{ref_key:"whiteList",ref:O,column:P,data:b(W),description:"白名单列表为空"},null,8,["data"]),[[v,"正在加载白名单列表，请稍后...","title"]])])),"footer-left":y((()=>[u(p,{"table-ref":b(O),options:G},null,8,["table-ref"])])),_:1}),u(m,{options:B,class:"mx-[1.6rem] my-[0.6rem]"})])}}});export{A as default};
