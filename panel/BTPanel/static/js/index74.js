import{_ as a}from"./index90.js?v=1734676359";import{D as e,ch as t,ci as l,b as i,j as m,c4 as s,aM as d,l as r,o as n,cj as _,u,bJ as o,t as p,R as c,bY as h,E as b}from"./utils-lib.js?v=1734676359";import{s as x,g as k,r as g,c as v,i as y,k as w,l as f,e as q,x as V,p as P,Q as j,a7 as B,w as C,aJ as H,J as U,y as D,q as E}from"./base-lib.js?v=1734676359";import{u as W}from"./column.js?v=1734676359";import{e as T}from"./validator.js?v=1734676359";import{b as F,f as J}from"./form-item.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";const L=k("VHOST-PACKAGE-STORE",(()=>{const a=g(!1),e=g({package_name:"",remark:"",disk_space_quota:{value:0,unlimited:!0},monthly_bandwidth_limit:{value:0,unlimited:!0},max_site_limit:{value:0,unlimited:!0},php_start_children:1,php_max_children:3,max_database:{value:0,unlimited:!0}}),t=g(0);return{isEdit:a,formData:e,refreshInfo:t,refreshList:()=>{t.value=(new Date).getTime()},resetFormData:()=>{e.value={package_name:"",remark:"",disk_space_quota:{value:0,unlimited:!0},monthly_bandwidth_limit:{value:0,unlimited:!0},max_site_limit:{value:0,unlimited:!0},php_start_children:1,php_max_children:3,max_database:{value:0,unlimited:!0}},a.value=!1}}})),M=()=>{const a=L(),e=x(a);return{...a,...e}},O={class:"p-[2rem]"},R=v({__name:"index",setup(a,{expose:s}){const{isEdit:d,formData:r,refreshList:n,resetFormData:_}=M(),{request:u,load:o}=i(),{BtForm:p,submit:c}=e({data:r.value,options:a=>y((()=>[F("资源包名称","package_name",{attrs:{class:"!w-[22rem]",clearable:!0,placeholder:"请输入资源包名称"},rules:[{required:!0,message:"资源包名称不能为空！",trigger:"blur"},{min:2,max:20,message:"资源包名称在 2 到 20 个字符",trigger:"blur"}]}),{type:"slots",key:"disk_space_quota",rules:{"disk_space_quota.value":[{required:!0,message:"磁盘配额空间不能为空！",trigger:"blur"}]}},{type:"slots",key:"monthly_bandwidth_limit",rules:{"monthly_bandwidth_limit.value":[{required:!0,message:"每月带宽限制不能为空！",trigger:"blur"}]}},{type:"slots",key:"max_site_limit",rules:{"max_site_limit.value":[{required:!0,message:"最大网站数不能为空！",trigger:"blur"}]}},{type:"slots",key:"max_database",rules:{"max_database.value":[{required:!0,message:"最大数据库数不能为空！",trigger:"blur"}]}},F("PHP起始子进程","php_start_children",{attrs:{class:"!w-[22rem]",type:"number",clearable:!0,placeholder:"请输入最大子进程数"},rules:[{required:!0,message:"PHP起始子进程不能为空！",trigger:"blur"}]}),F("PHP最大子进程","php_max_children",{attrs:{class:"!w-[22rem]",type:"number",clearable:!0,placeholder:"请输入最大子进程数"},rules:[{required:!0,message:"PHP最大子进程不能为空！",trigger:"blur"}]}),F("备注","remark",{attrs:{class:"!w-[22rem]",clearable:!0,placeholder:"请输入备注内容，可为空"}}),J("备注",[{content:"PHP起始子进程数量：此值越大网站响应性能越好，同时内存占用越高"},{content:"PHP最大子进程数量：此值越大网站并发性能越好，同时峰值内存占用越高"}])])),submit:async(a,e,i)=>{await e();let m=z(a.value,!0),s={};const r=o("正在提交表单，请稍候...");d.value||delete m.package_id;try{if(s=d.value?await t(m):await l(m),_(),u(s),n(),!s.status)return!1}catch(p){}finally{r.close()}return s}});return s({onConfirm:c,onCancel:_}),(a,e)=>{const t=m,l=j,i=B;return w(),f("div",O,[q(P(p),{"label-width":"120px"},{disk_space_quota:V((()=>[q(i,{prop:"disk_space_quota.value",label:"磁盘配额空间(MB)"},{default:V((()=>[q(t,{type:"number",modelValue:P(r).disk_space_quota.value,"onUpdate:modelValue":e[0]||(e[0]=a=>P(r).disk_space_quota.value=a),width:"22rem",disabled:P(r).disk_space_quota.unlimited,clearable:"",class:"mr-[10px]"},null,8,["modelValue","disabled"]),q(l,{modelValue:P(r).disk_space_quota.unlimited,"onUpdate:modelValue":e[1]||(e[1]=a=>P(r).disk_space_quota.unlimited=a),label:"无限制"},null,8,["modelValue"])])),_:1})])),monthly_bandwidth_limit:V((()=>[q(i,{prop:"monthly_bandwidth_limit.value",label:"每月带宽限制(MB)"},{default:V((()=>[q(t,{type:"number",modelValue:P(r).monthly_bandwidth_limit.value,"onUpdate:modelValue":e[2]||(e[2]=a=>P(r).monthly_bandwidth_limit.value=a),disabled:P(r).monthly_bandwidth_limit.unlimited,width:"22rem",class:"mr-[10px]"},null,8,["modelValue","disabled"]),q(l,{modelValue:P(r).monthly_bandwidth_limit.unlimited,"onUpdate:modelValue":e[3]||(e[3]=a=>P(r).monthly_bandwidth_limit.unlimited=a),label:"无限制"},null,8,["modelValue"])])),_:1})])),max_site_limit:V((()=>[q(i,{prop:"max_site_limit.value",label:"最大网站数"},{default:V((()=>[q(t,{type:"number",modelValue:P(r).max_site_limit.value,"onUpdate:modelValue":e[4]||(e[4]=a=>P(r).max_site_limit.value=a),disabled:P(r).max_site_limit.unlimited,width:"22rem",class:"mr-[10px]"},null,8,["modelValue","disabled"]),q(l,{modelValue:P(r).max_site_limit.unlimited,"onUpdate:modelValue":e[5]||(e[5]=a=>P(r).max_site_limit.unlimited=a),label:"无限制"},null,8,["modelValue"])])),_:1})])),max_database:V((()=>[q(i,{prop:"max_database.value",label:"最大数据库数"},{default:V((()=>[q(t,{type:"number",modelValue:P(r).max_database.value,"onUpdate:modelValue":e[6]||(e[6]=a=>P(r).max_database.value=a),disabled:P(r).max_database.unlimited,width:"22rem",class:"mr-[10px]"},null,8,["modelValue","disabled"]),q(l,{modelValue:P(r).max_database.unlimited,"onUpdate:modelValue":e[7]||(e[7]=a=>P(r).max_database.unlimited=a),label:"无限制"},null,8,["modelValue"])])),_:1})])),_:1})])}}}),{error:S,request:A}=i(),{isEdit:I,refreshList:G,formData:K}=M(),Q=async a=>{n({title:"删除资源包".concat(a.package_name),content:"删除".concat(a.package_name,"资源包，是否继续？"),onConfirm:async()=>{if(1===a.status)return S("资源包正在使用中，无法删除");const e=await _({package_id:a.package_id});await A(e),G()}})},Y=async(a=!1)=>{a&&(I.value=!0,K.value=z(a,!1)),r({title:"".concat(a?"编辑":"添加","资源包"),area:50,showFooter:!0,component:R})},z=(a,e)=>e?{package_id:null==a?void 0:a.package_id,package_name:a.package_name,remark:a.remark,disk_space_quota:a.disk_space_quota.unlimited?0:1024*a.disk_space_quota.value*1024,monthly_bandwidth_limit:a.monthly_bandwidth_limit.unlimited?0:1024*a.monthly_bandwidth_limit.value*1024,max_site_limit:a.max_site_limit.unlimited?0:a.max_site_limit.value,php_start_children:a.php_start_children,php_max_children:a.php_max_children,max_email_account:0,max_database:a.max_database.unlimited?0:a.max_database.value}:{package_id:null==a?void 0:a.package_id,package_name:a.package_name,remark:a.remark,disk_space_quota:{value:a.disk_space_quota?a.disk_space_quota/1024/1024:0,unlimited:0===a.disk_space_quota},monthly_bandwidth_limit:{value:a.monthly_bandwidth_limit?a.monthly_bandwidth_limit/1024/1024:0,unlimited:0===a.monthly_bandwidth_limit},max_site_limit:{value:a.max_site_limit,unlimited:0===a.max_site_limit},php_start_children:a.php_start_children,php_max_children:a.php_max_children,max_email_account:0,max_database:{value:a.max_database,unlimited:0===a.max_database}},N=v({__name:"index",setup(e){const{mainHeight:t}=u(),{refreshInfo:l}=M(),{BtTable:i,BtSearch:m,BtRefresh:r,BtPage:n,refresh:_}=o({request:a=>(async a=>{const{data:e}=await s({p:a.p,search_value:a.search,rows:a.limit});return d(e)?{data:e.list,total:e.page.count}:{data:[],total:0}})(a),columns:[{label:"资源包名称",prop:"package_name",minWidth:84},{label:"网站",prop:"php_start_children",minWidth:80,render:a=>q("div",null,[0===a.max_site_limit?"无限制":a.max_site_limit])},{label:"磁盘配额",prop:"disk_space_quota",minWidth:100,render:a=>q("div",null,[0===a.disk_space_quota?"无限制":p(a.disk_space_quota,!0,0)])},{label:"月带宽限制",prop:"monthly_bandwidth_limit",minWidth:100,render:a=>q("div",null,[0===a.monthly_bandwidth_limit?"无限制":p(a.monthly_bandwidth_limit,!0,0)])},{label:"备注",prop:"remark",minWidth:80,render:a=>a.remark?a.remark:"--"},{label:"创建时间",prop:"create_time",minWidth:140,render:a=>c(a.create_time)},W([{onClick:Y,title:"编辑"},{onClick:Q,title:"删除"}])],extension:[h()]});return C((()=>l.value),_),(e,l)=>{const s=H("BtOperation"),d=b,_=H("BtTableCategory"),u=H("BtBatch"),o=a;return w(),U(o,null,{"header-left":V((()=>[q(s),q(d,{type:"primary",onClick:l[0]||(l[0]=a=>P(Y)())},{default:V((()=>l[2]||(l[2]=[D("添加资源包")]))),_:1}),E("div",{class:"flex items-center ml-1rem",onClick:l[1]||(l[1]=a=>P(T)({name:"用户管理",type:35,id:62}))},l[3]||(l[3]=[E("i",{class:"svgtofont-desired text-[1.6rem] mr-[4px]"},null,-1),E("span",{class:"bt-link"},"需求反馈",-1)]))])),"header-right":V((()=>[q(_,{class:"!w-[140px] mr-[10px]"}),q(P(m),{placeholder:"请输入资源包名称",class:"!w-[270px] mr-[10px]"}),q(P(r))])),content:V((()=>[q(P(i),{"min-height":P(t)},null,8,["min-height"])])),"footer-left":V((()=>[q(u)])),"footer-right":V((()=>[q(P(n))])),_:1})}}});export{N as default};
