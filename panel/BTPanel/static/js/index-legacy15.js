!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function r(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?e(Object(o),!0).forEach((function(e){n(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function n(e,r,n){return(r=function(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,r||"default");if("object"!=t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function o(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */o=function(){return r};var e,r={},n=Object.prototype,a=n.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},c="function"==typeof Symbol?Symbol:{},u=c.iterator||"@@iterator",s=c.asyncIterator||"@@asyncIterator",l=c.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(e){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var o=e&&e.prototype instanceof b?e:b,a=Object.create(o.prototype),c=new D(n||[]);return i(a,"_invoke",{value:E(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}r.wrap=p;var d="suspendedStart",y="suspendedYield",g="executing",m="completed",v={};function b(){}function w(){}function _(){}var x={};f(x,u,(function(){return this}));var O=Object.getPrototypeOf,j=O&&O(O(F([])));j&&j!==n&&a.call(j,u)&&(x=j);var S=_.prototype=b.prototype=Object.create(x);function k(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function L(e,r){function n(o,i,c,u){var s=h(e[o],e,i);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==t(f)&&a.call(f,"__await")?r.resolve(f.__await).then((function(t){n("next",t,c,u)}),(function(t){n("throw",t,c,u)})):r.resolve(f).then((function(t){l.value=t,c(l)}),(function(t){return n("throw",t,c,u)}))}u(s.arg)}var o;i(this,"_invoke",{value:function(t,e){function a(){return new r((function(r,o){n(t,e,r,o)}))}return o=o?o.then(a,a):a()}})}function E(t,r,n){var o=d;return function(a,i){if(o===g)throw Error("Generator is already running");if(o===m){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=P(c,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=g;var s=h(t,r,n);if("normal"===s.type){if(o=n.done?m:y,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=m,n.method="throw",n.arg=s.arg)}}}function P(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,P(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=h(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function D(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function F(r){if(r||""===r){var n=r[u];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function t(){for(;++o<r.length;)if(a.call(r,o))return t.value=r[o],t.done=!1,t;return t.value=e,t.done=!0,t};return i.next=i}}throw new TypeError(t(r)+" is not iterable")}return w.prototype=_,i(S,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:w,configurable:!0}),w.displayName=f(_,l,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,f(t,l,"GeneratorFunction")),t.prototype=Object.create(S),t},r.awrap=function(t){return{__await:t}},k(L.prototype),f(L.prototype,s,(function(){return this})),r.AsyncIterator=L,r.async=function(t,e,n,o,a){void 0===a&&(a=Promise);var i=new L(p(t,e,n,o),a);return r.isGeneratorFunction(e)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},k(S),f(S,l,"Generator"),f(S,u,(function(){return this})),f(S,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=F,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return c.type="throw",c.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=a.call(i,"catchLoc"),s=a.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:F(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},r}function a(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function i(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function c(t){a(i,n,o,c,u,"next",t)}function u(t){a(i,n,o,c,u,"throw",t)}c(void 0)}))}}System.register(["./index-legacy90.js?v=1734676359","./index-legacy97.js?v=1734676359","./utils-lib-legacy.js?v=1734676359","./base-lib-legacy.js?v=1734676359","./useMethod-legacy2.js?v=1734676359","./column-legacy.js?v=1734676359","./useStore-legacy2.js?v=1734676359"],(function(t,e){"use strict";var n,a,c,u,s,l,f,p,h,d,y,g,m,v,b,w,_,x,O,j,S,k,L,E,P,C,T,D,F,N,R,A,q,G,V,I,M,B,H,J,U,Y,$,z,K,X,Q,W;return{setters:[function(t){n=t._},function(t){a=t._},function(t){c=t.u,u=t.R,s=t.l,l=t.H,f=t.o,p=t.M,h=t.G,d=t.S,y=t.aa,g=t.F,m=t.k,v=t.V,b=t.e},function(t){w=t.g,_=t.s,x=t.h,O=t.r,j=t.e,S=t.c,k=t.o,L=t.a1,E=t.B,P=t.C,C=t.p,T=t.k,D=t.l,F=t.x,N=t.I,R=t.aX,A=t.q,q=t.y,G=t.A,V=t.J,I=t.ay},function(t){M=t.J,B=t.K,H=t.L,J=t.H,U=t.M,Y=t.N,$=t.O,z=t.p},function(t){K=t.a,X=t.u,Q=t.c},function(t){W=t.C}],execute:function(){var Z=t("C",w("CRONTAB-SCRIPT-LIBRARY-STORE",(function(){var t,n=c().mainHeight,a=W(),y=_(a).logCompData,g=x({p:1,rows:20,search:"",type_id:""}),m=O(),v=O(!1),b=O(0),w=O([]),S=O(!1),k=O([]),L=function(){var t=i(o().mark((function t(r,n){var a,c,u,f,p;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r.is_args,c=r.args_title,u=r.name,f=r.args_ps,p=r.script_id,Object.assign(A,{script_id:p,name:u,form:{args:"",placeholder:"端口检测"===u?"127.0.0.1:433":f},title:c}),!a){t.next=7;break}return s({title:"执行脚本参数",component:function(){return l((function(){return e.import("./index-legacy112.js?v=1734676359")}),void 0,e.meta.url)},showFooter:!0,area:42,onConfirm:function(){var t=i(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R.value.validate();case 2:return t.abrupt("return",E());case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}),t.abrupt("return");case 7:E();case 8:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),E=function(){var t=i(o().mark((function t(){var e,r,n,a,i,c,u;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=A.name,r=A.script_id,n=A.form,a={script_id:r,args:n.args},t.next=4,f({title:"执行脚本",icon:"warning-filled",content:"立即执行【".concat(e,"】脚本任务，执行过程可能等待时间较长，请耐心等待。是否继续？")});case 4:return i=p.load("正在执行脚本,请稍后..."),t.prev=5,t.next=8,M({data:JSON.stringify(a)});case 8:return c=t.sent,u=c.data,i.close(),u.status&&tt(),s({title:"执行结果",area:[60,40],component:{render:function(t){return j("pre",{class:"h-full w-full bg-[#333] !overflow-auto whitespace-pre-line text-white break-all p-12px"},[u.msg])}}}),t.abrupt("return",u.status);case 16:return t.prev=16,t.t0=t.catch(5),i.close(),t.abrupt("return",!1);case 21:case"end":return t.stop()}}),t,null,[[5,16]])})));return function(){return t.apply(this,arguments)}}(),P=function(){var t=i(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f({title:"删除脚本",icon:"warning-filled",content:"删除后脚本信息不可恢复,是否继续操作？"});case 2:return t.next=4,h({loading:"正在删除脚本,请稍后...",request:H(e),message:!0,success:T});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),C=function(){var t=i(o().mark((function t(){var e;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,J();case 2:e=t.sent,k.value=e,k.value.length&&(g.type_id=String(k.value[0].type_id));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),T=function(){var t=i(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h({loading:S,request:U(g),data:{data:[Array,w],page:d(b)}});case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),D=function(t,r){if(tt(),I.type_id=g.type_id,t){var n=r.script_id,o=r.name,a=r.return_type,i=r.is_args,c=r.ps,u=r.script,f=r.args_title,p=r.args_ps,h=r.type_id;Object.assign(I,{name:o,return_type:a,is_args:String(i),ps:c,script:u,type_id:h,script_id:n}),"1"==i&&Object.assign(V,{args_title:f,args_ps:p})}s({title:(t?"编辑":"创建")+"脚本",area:57,component:function(){return l((function(){return e.import("./index-legacy113.js?v=1734676359")}),void 0,e.meta.url)},onConfirm:function(){return Z(!!t)},showFooter:!0})},F=O([K(),{label:"名称",prop:"name"},{label:"类型",prop:"script_type"},{label:"返回类型",prop:"return_type"},{label:"备注",prop:"ps",showOverflowTooltip:!0},{label:"创建时间",render:function(t){return u(t.create_time)}},{label:"上次执行时间",render:function(t){return Array.isArray(t.last_exec_time)?"--":u(t.last_exec_time)}},X([{onClick:function(t){return L(t)},title:"执行"},{onClick:function(t){return D(!0,t)},title:"编辑"},{onClick:function(t){y.value={request:B,data:{script_id:t.script_id}},s({title:"执行日志",area:86,compData:{request:B,data:{script_id:t.script_id}},component:function(){return l((function(){return e.import("./index-legacy110.js?v=1734676359")}),void 0,e.meta.url)}})},title:"日志"},{onClick:P,title:"删除"}])]),N=O([{label:"删除脚本",value:"delete",event:(t=i(o().mark((function t(e,r){var n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=function(){var t=i(o().mark((function t(e){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,H({script_id:e.script_id});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),t.next=3,e({title:"批量删除",content:"即将删除所选中的数据，是否继续操作?",column:[{prop:"name",label:"脚本名称"},Q()],onConfirm:function(){var t=i(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r(n);case 2:return T(),t.abrupt("return",!1);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()});case 3:case"end":return t.stop()}}),t)}))),function(e,r){return t.apply(this,arguments)})}]),R=O(),A=x({title:"脚本参数",form:{args:"",placeholder:"请输入脚本参数"},name:"",script_id:""}),q=x({args:[{required:!0,message:"请输入脚本参数",trigger:"blur"},{validator:function(t,e,r){if("端口检测"===A.name){/^(\d{1,3}\.){3}\d{1,3}:\d{1,5}$/.test(e)?r():r(new Error("请输入正确的IP:端口格式"))}else r()}}]}),G=O(),V=x({args_title:"",args_ps:""}),I=x({name:"",return_type:"string",is_args:"0",ps:"",script:"",type_id:"",script_id:""}),z=x({name:[{required:!0,message:"请输入脚本名称",trigger:"blur"}],script:[{required:!0,message:"请输入脚本内容",trigger:"blur"}]}),Z=function(){var t=i(o().mark((function t(e){var n,a,i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,G.value.validate();case 2:return n=r({},I),"1"==I.is_args&&(n=r(r({},I),V)),e||delete n.type_id,n={data:JSON.stringify(n)},a=e?Y:$,t.next=9,h({loading:"正在".concat(e?"编辑":"创建","脚本，请稍后..."),request:a(n),message:!0,success:function(t){t.status&&tt(),T()}});case 9:return i=t.sent,t.abrupt("return",i.status);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),tt=function(){Object.assign(I,{name:"",return_type:"string",is_args:"0",ps:"",script:"",type_id:"",script_id:""}),Object.assign(V,{args_title:"",args_ps:""}),Object.assign(A,{title:"脚本参数",form:{args:"",placeholder:"请输入脚本参数"},name:"",script_id:""})};return{mainHeight:n,tableParam:g,scriptTableRef:m,tabLoading:v,total:b,tableData:w,tableLoad:S,scriptMenuData:k,TableBatchOptions:N,tableColumns:F,getScriptTabData:C,getScriptData:T,openAddScriptView:D,handleChangeTab:function(t){g.type_id=t.props.name,T()},$reset:function(){w.value=[],k.value=[]},argsFormRef:R,argsForm:A,rules:q,addScriptFormRef:G,addArgsForm:V,addScriptForm:I,helpList:[{content:"当前仅支持Python和Shell脚本"},{content:"请根据返回类型在脚本执行结束时输出符合预期的值"},{content:"如果选择需要脚本参数，使用当前脚本时需传递一个参数，在脚本中的第一个参数中接收"},{content:"Python 脚本需指定编码（如 #coding: utf-8）；Shell 脚本可以用 #!/bin/bash 或 #!/bin/sh 开头，未指定类型时默认按 Shell 脚本执行。"}],addScriptRules:z}}))),tt={class:"flex items-center"},et={class:"flex items-center"},rt=S({__name:"index",setup:function(t){var e=Z(),r=_(e),c=r.mainHeight,u=r.tableParam,s=r.scriptTableRef,l=r.tabLoading,f=r.total,p=r.tableData,h=r.tableLoad,d=r.scriptMenuData,b=r.TableBatchOptions,w=r.tableColumns,x=e.getScriptTabData,O=e.getScriptData,S=e.openAddScriptView,M=e.handleChangeTab;return k(i(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x();case 2:O();case 3:case"end":return t.stop()}}),t)})))),L((function(){e.$reset()})),function(t,e){var r=I,o=y,i=G,_=g,x=m,k=v,L=a,B=n,H=E("bt-loading");return P((T(),D("div",null,[j(o,{modelValue:C(u).type_id,"onUpdate:modelValue":e[0]||(e[0]=function(t){return C(u).type_id=t}),type:"card",onTabClick:C(M)},{default:F((function(){return[(T(!0),D(N,null,R(C(d),(function(t,e){return T(),V(r,{class:"h-0",key:e,label:t.name,name:String(t.type_id)},null,8,["label","name"])})),128))]})),_:1},8,["modelValue","onTabClick"]),j(B,null,{"header-left":F((function(){return[A("div",tt,[j(i,{onClick:e[1]||(e[1]=function(t){return C(S)()}),type:"primary"},{default:F((function(){return e[6]||(e[6]=[q("创建脚本")])})),_:1}),A("div",{class:"flex items-center ml-4px",onClick:e[2]||(e[2]=function(t){return C(z)()})},e[7]||(e[7]=[A("i",{class:"svgtofont-desired text-[1.6rem]"},null,-1),A("span",{class:"bt-link"},"需求反馈",-1)]))])]})),"header-right":F((function(){return[A("div",et,[j(_,{modelValue:C(u).search,"onUpdate:modelValue":e[3]||(e[3]=function(t){return C(u).search=t}),class:"ml-12px !w-[32rem]",placeholder:"请输入搜索关键字",onSearch:C(O)},null,8,["modelValue","onSearch"])])]})),content:F((function(){return[P(j(x,{ref_key:"scriptTableRef",ref:s,"max-height":C(c)-300,column:C(w),data:C(p)},null,8,["max-height","column","data"]),[[H,C(h)],[H,"正在加载中，请稍后...","title"]])]})),"footer-left":F((function(){return[j(k,{"table-ref":C(s),options:C(b)},null,8,["table-ref","options"])]})),"footer-right":F((function(){return[j(L,{total:C(f),page:C(u).p,"onUpdate:page":e[4]||(e[4]=function(t){return C(u).p=t}),row:C(u).rows,"onUpdate:row":e[5]||(e[5]=function(t){return C(u).rows=t}),onChange:C(O)},null,8,["total","page","row","onChange"])]})),_:1})])),[[H,C(l)]])}}}),nt=b(rt,[["__scopeId","data-v-d95e0058"]]),ot=Object.freeze(Object.defineProperty({__proto__:null,default:nt},Symbol.toStringTag,{value:"Module"}));t("i",ot)}}}))}();
