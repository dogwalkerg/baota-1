import{_ as a}from"./index90.js?v=1734676359";import{_ as e}from"./index97.js?v=1734676359";import{M as t,aj as r,a7 as l,ah as o,R as s,l as n,H as i,o as c,G as d,k as p}from"./utils-lib.js?v=1734676359";import{r as m,h as u,R as f,e as g,c as h,o as _,B as v,k as w,l as b,x as y,C as j,p as C}from"./base-lib.js?v=1734676359";import{u as k}from"./column.js?v=1734676359";import{u as A}from"./useStore7.js?v=1734676359";import{getPhpSiteSafeLog as B,addPhpSiteIpWhite as I,addPhpSiteSafeWhite as O}from"./site.js?v=1734676359";const{siteInfo:P}=A();m();const R=m(),x=m(),T=u({list:[],p:1,limit:10,total:100,load:!1}),L=async a=>{await c({title:"加入IP白名单",width:"35rem",icon:"warning-filled",content:"是否将【".concat(a.address,"】添加到IP白名单？")}),d({loading:"正在加入IP白名单，请稍后...",request:I({start_ip:a.address,end_ip:a.address}),message:!0})},U=async a=>{await c({title:"加入URL白名单",width:"35rem",icon:"warning-filled",content:"加入URL白名单后此URL将不再进行防御，是否继续操作？"}),d({loading:"正在加入URL白名单，请稍后...",request:O({url_rule:a.url}),message:!0})},E=async()=>{T.load=!1;try{T.load=!0;const a=await B({siteName:P.value.name,page:T.p,limit:T.limit});a.status||t.error(a.msg),T.list=r(a.data.data,"array",[]),T.total=l(a.data.page)}catch(a){o(a)}finally{T.load=!1}},S=f([{label:"时间",prop:"addtime",render:a=>g("div",{class:"flex !items-center inline-block truncate"},[s(a.addtime)])},{label:"用户IP",prop:"address",render:a=>g("div",{class:"bt-link truncate",onClick:()=>{L(a)}},[a.address])},{label:"恶意类型",prop:"intercept"},{label:"url地址",prop:"url",width:270},k([{onClick:a=>{U(a)},title:"URL加白",width:80},{onClick:async a=>{x.value={data:a},n({title:"【".concat(a.address,"】详情"),area:60,isAsync:!0,component:()=>i((()=>import("./log-detail4.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),showFooter:!1})},title:"详情"},{onClick:async a=>{x.value={data:a},n({title:"【".concat(a.address,"】HTTP详情"),area:80,isAsync:!0,component:()=>i((()=>import("./http-detail.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),showFooter:!1})},title:"HTTP"}])]),$=m(""),D=()=>{$.value=((a,e)=>{let t=null,r="",l=0;return(e=e||{}).newlineAfterColonIfBeforeBraceOrBracket=!0===e.newlineAfterColonIfBeforeBraceOrBracket,e.spaceAfterColon=!1!==e.spaceAfterColon,"string"!=typeof a||(a=JSON.parse(a)),t=/([\{\}])/g,a=(a=JSON.stringify(a)).replace(t,"\r\n$1\r\n"),t=/([\[\]])/g,a=a.replace(t,"\r\n$1\r\n"),t=/(\,)/g,a=a.replace(t,"$1\r\n"),t=/(\r\n\r\n)/g,a=a.replace(t,"\r\n"),t=/\r\n\,/g,a=a.replace(t,","),e.newlineAfterColonIfBeforeBraceOrBracket||(t=/\:\r\n\{/g,a=a.replace(t,":{"),t=/\:\r\n\[/g,a=a.replace(t,":[")),e.spaceAfterColon&&(t=/\:/g,a=a.replace(t,": ")),a.split("\r\n").forEach((function(a,e){var t=0,o=0,s="";for(a.match(/\{$/)||a.match(/\[$/)?o=1:a.match(/\}/)||a.match(/\]/)?0!==l&&(l-=1):o=0,t=0;t<l;t++)s+="  ";r+=s+a+"\r\n",l+=o})),r})(x.value.data)},H=m({}),N=()=>{H.value=x.value.data},q={class:"relative p-[16px]"},F=h({__name:"index",props:{compData:{default:()=>({})}},setup(t){const r=t;return _((()=>{var a,e;a=r.compData,R.value=a,T.list=(null==(e=R.value)?void 0:e.data)||[],T.total=l(R.value.page)})),(t,r)=>{const l=p,o=e,s=a,n=v("bt-loading");return w(),b("div",q,[g(s,null,{"header-left":y((()=>r[3]||(r[3]=[]))),"header-right":y((()=>r[4]||(r[4]=[]))),content:y((()=>[j(g(l,{ref:"ftpTable",column:C(S),"max-height":360,data:C(T).list,description:"暂无数据"},null,8,["column","data"]),[[n,C(T).load],[n,"正在加载中，请稍后...","title"]])])),"footer-right":y((()=>[g(o,{page:C(T).p,"onUpdate:page":r[0]||(r[0]=a=>C(T).p=a),row:C(T).limit,"onUpdate:row":r[1]||(r[1]=a=>C(T).limit=a),total:C(T).total,onChange:r[2]||(r[2]=a=>C(E)())},null,8,["page","row","total"])])),_:1})])}}}),J=Object.freeze(Object.defineProperty({__proto__:null,default:F},Symbol.toStringTag,{value:"Module"}));export{L as a,x as b,U as c,D as d,$ as e,J as f,N as i,H as l};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
