import{c as e,r as a,h as l,o as t,k as s,J as r,x as o,C as i,q as n,e as c,v as d,F as u,p as m,L as p,l as v,y as f,z as w,D as g,G as b,aw as h,a7 as x,P as y,A as k,aY as _,a4 as D}from"./base-lib.js?v=1734676359";import{_ as V}from"./index91.js?v=1734676359";import{M as j,s as q,aV as C,p as z,aY as E,aW as H,q as I,c as U,e as K}from"./utils-lib.js?v=1734676359";import{_ as M}from"./bt_logo_new.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";const B={class:"flex !justify-center !w-full items-center"},J={class:"text-[2rem] text-dark inline-block mr-2 font-bold mt-12x"},O={key:0,class:"absolute el-form-item__error"},T={class:"flex justify-end items-centertext-[1.2rem] mt-[1rem]"},Y={key:0,class:"view-con",style:{background:"#fff"}},$={class:"w-[100%] mt-[1.2rem] flex items-center justify-center text-[#20a53a]",size:"default"},A={key:1,class:"flex justify-end items-centertext-[1.2rem] mt-[1rem] h-[1.68rem]"},F={key:0},G={class:"more-bind"},L=K(e({__name:"ali-bind-user",props:{compData:{default:null}},emits:["close"],setup(e,{expose:K,emit:L}){const N=e,P=L,S=a(!1),W=a("获取验证码"),Q=l({username:"",password:"",code:""}),R=l({username:!1,password:!1,code:!1}),X=a(""),Z=a(0),ee=a(),ae=a(!1),le=a(1),te=a(N.compData.authData),se=a({username:[{validator:(e,a,l)=>{var t,s;if((null==(t=N.compData)?void 0:t.title)&&(ae.value=!1),/^1[3456789]\d{9}$/.test(a))l();else if(""===a)l(new Error("请输入宝塔官网账号"));else{if(null==(s=N.compData)?void 0:s.title)return ae.value=!0,void l(new Error(" "));l(new Error(" 请输入正确的手机号 "))}},trigger:["blur","change"]}],password:[{required:!0,message:"请输入密码",trigger:["blur","change"]},{validator:(e,a,l)=>{a.length>=8?l():l(new Error("请输入至少8位密码"))},trigger:["blur","change"]}],token:[{required:!1,message:"请输入验证码",trigger:["blur","change"]},{validator:(e,a,l)=>{S.value||l(),6===a.length?l():l(new Error("请输入6位验证码，不可为空"))},trigger:["blur","change"]}]}),re=async()=>{await ee.value.validate();const e={...Q};if(S.value){if(!Q.code)return j.error("请输入验证码");e.token=X.value,delete e.password}else delete e.code;const a=j.load("绑定堡塔账号，请稍候 ...");try{e.username=q(e.username),e.password=q(e.password);const a=await C({...e});if(j.request(a),a.status)return window.location.reload(),void P("close");if(z(a.data))return!1;if(!a.status&&"[]"===JSON.stringify(a.data))return j.request(a);-1===a.data.code&&(X.value=a.data.token,S.value=!0)}catch(l){}finally{a.close()}},oe=async()=>{let e;try{e=j.load("正在绑定中......");const{data:a}=await E({client:2});a.status||a.success?window.location.href="/":(e.close(),j.error(a.msg||a.res))}catch(a){null==e||e.close()}},ie=async()=>{if(!Q.username||!Q.password)return j.error("请先输入手机号和密码");R.username=!0,R.password=!0,(e=>{Z.value&&clearInterval(Z.value);const a=()=>{if(--e<=0)return clearInterval(Z.value),W.value="获取验证码",void(R.code=!1);W.value="重新获取验证码(".concat(e,"s)")};a(),Z.value=setInterval(a,1e3),R.code=!0})(60);const e=await H({username:Q.username,token:X.value});j.request(e)},ne=a(!1),ce=e=>{var a;le.value=e,(null==(a=N.compData)?void 0:a.onChangeType)&&N.compData.onChangeType(1===e?"bind":"other")};return K({onOpen:()=>{I(ee.value.$el,"username")},onCancel:()=>{ee.value.clearValidate()}}),t((()=>{var e;(async()=>{try{ne.value=2===te.value.client&&1===te.value.login,2===te.value.client&&1===te.value.login?ce(2):ce(1)}catch(e){ce(1)}})(),null==(e=ee.value)||e.clearValidate()})),(e,a)=>{var l;const t=h,j=x,q=y,C=U,z=k,E=U,H=V,I=_,K=D;return s(),r(K,{ref_key:"bindUserInfo",ref:ee,size:"medium",rules:m(se),model:m(Q),autocomplete:"off",class:u(["bind-user-info",{"bind-form":!!(null==(l=e.compData)?void 0:l.title)}])},{default:o((()=>{var l,h,x,y,k,_,D,V,U,K,L,N,P;return[i(n("div",null,[c(j,{class:"text-center !mb-5 flex justify-center"},{default:o((()=>{var l;return[n("div",B,[n("h3",J,d((null==(l=e.compData)?void 0:l.title)||"切换宝塔官网账号"),1),c(t,{placement:"top-start",width:"200",trigger:"hover",content:"宝塔面板许多功能都依赖于官网，绑定仅限于为您提供更好的面板服务体验，不涉及您服务器任何敏感信息，请放心使用。",class:"inline-block relative -top-1.5"},{reference:o((()=>a[9]||(a[9]=[n("a",{class:"bt-ico-ask align-middle",href:"javascript:;"},"?",-1)]))),_:1})])]})),_:1}),(s(),r(j,{prop:"username",key:1,class:u({"!mb-[3rem]":!!(null==(l=e.compData)?void 0:l.title)})},{default:o((()=>{var l;return[c(q,{modelValue:m(Q).username,"onUpdate:modelValue":a[0]||(a[0]=e=>m(Q).username=e),clearable:"",required:"",name:"username",autocomplete:"off",class:"!leading-[4rem] !h-[4rem]",placeholder:"宝塔官网账号",disabled:m(R).username,onKeyup:a[1]||(a[1]=p((e=>re()),["enter"]))},null,8,["modelValue","disabled"]),(null==(l=e.compData)?void 0:l.title)&&m(ae)?(s(),v("span",O,[a[11]||(a[11]=n("span",null,"请使用宝塔官网登录账号进行登录，若未有账号，可进行",-1)),c(C,{class:"!text-[12px]",href:"https://www.bt.cn/register"},{default:o((()=>a[10]||(a[10]=[f(" 免费注册 ")]))),_:1})])):w("",!0)]})),_:1},8,["class"])),(s(),r(j,{prop:"password",key:2},{default:o((()=>[c(q,{modelValue:m(Q).password,"onUpdate:modelValue":a[2]||(a[2]=e=>m(Q).password=e),clearable:"",required:"",type:"password",name:"password",class:"!leading-[4rem] !h-[4rem]",autocomplete:"off",placeholder:"密码","show-password":!0,disabled:m(R).password,onKeyup:a[3]||(a[3]=p((e=>re()),["enter","native"]))},null,8,["modelValue","disabled"])])),_:1})),i(c(j,{prop:"code"},{default:o((()=>[c(q,{modelValue:m(Q).code,"onUpdate:modelValue":a[4]||(a[4]=e=>m(Q).code=e),clearable:"",autocomplete:"off",placeholder:"验证码",onKeyup:a[5]||(a[5]=p((e=>re()),["enter","native"])),type:"text"},{append:o((()=>[c(z,{class:"relative top-0 rounded-none rounded-r-[3px]",type:"primary",size:"default",disabled:m(R).code,plain:"",onClick:ie},{default:o((()=>[f(d(m(W)),1)])),_:1},8,["disabled"])])),_:1},8,["modelValue"])])),_:1},512),[[g,m(S)]]),c(z,{type:"primary",class:"w-[100%] mt-[1.2rem]",size:"default",onClick:a[6]||(a[6]=e=>re())},{default:o((()=>{var a,l;return[f(d((null==(a=e.compData)?void 0:a.btn)||((null==(l=e.compData)?void 0:l.title)?"绑定账号":"切换账号")),1)]})),_:1}),n("div",T,[c(E,{href:"https://www.bt.cn/register"},{default:o((()=>a[12]||(a[12]=[f("注册账号")]))),_:1}),c(H),c(E,{href:"https://www.bt.cn/login.html?page=reset"},{default:o((()=>a[13]||(a[13]=[f("忘记密码")]))),_:1}),c(H),c(E,{href:"https://www.bt.cn/bbs"},{default:o((()=>a[14]||(a[14]=[f("问题反馈")]))),_:1})])],512),[[g,1===m(le)]]),i(n("div",null,[(null==(h=e.compData)?void 0:h.title)?w("",!0):(s(),v("div",{key:0,class:"view-con",style:b((null==(x=e.compData)?void 0:x.title)?"":"background:#fff;")},[n("div",{class:"app-box",style:b((null==(y=e.compData)?void 0:y.title)?"":"background:#fff;")},a[15]||(a[15]=[n("img",{alt:"",src:M},null,-1)]),4),a[17]||(a[17]=n("div",{class:"change-icon"},[n("svg",{t:"1729493717851",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"19919",width:"200",height:"200"},[n("path",{d:"M914.618182 477.090909H546.909091V109.381818c0-18.618182-16.290909-34.909091-34.909091-34.909091s-34.909091 16.290909-34.909091 34.909091v367.709091H109.381818c-18.618182 0-34.909091 16.290909-34.909091 34.909091s16.290909 34.909091 34.909091 34.909091h367.709091v367.709091c0 18.618182 16.290909 34.909091 34.909091 34.909091s34.909091-16.290909 34.909091-34.909091V546.909091h367.709091c18.618182 0 34.909091-16.290909 34.909091-34.909091s-16.290909-34.909091-34.909091-34.909091z",fill:"#999999","p-id":"19920"})])],-1)),n("div",{class:"app-box",style:b((null==(k=e.compData)?void 0:k.title)?"":"background:#fff;")},a[16]||(a[16]=[n("div",{class:"ali-icon"},null,-1)]),4)],4)),n("div",{class:u({"bg-white":null==(_=e.compData)?void 0:_.title,"rounded-[4px]":null==(D=e.compData)?void 0:D.title}),style:b({border:(null==(V=e.compData)?void 0:V.title)?"1px solid #ddd":"none","padding-top":(null==(U=e.compData)?void 0:U.title)?"2rem":"0"})},[(null==(K=e.compData)?void 0:K.title)?(s(),v("div",Y,a[18]||(a[18]=[n("div",{class:"app-box",style:{background:"#fff"}},[n("img",{alt:"",src:M})],-1),n("div",{class:"change-icon"},[n("svg",{t:"1729493717851",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"19919",width:"200",height:"200"},[n("path",{d:"M914.618182 477.090909H546.909091V109.381818c0-18.618182-16.290909-34.909091-34.909091-34.909091s-34.909091 16.290909-34.909091 34.909091v367.709091H109.381818c-18.618182 0-34.909091 16.290909-34.909091 34.909091s16.290909 34.909091 34.909091 34.909091h367.709091v367.709091c0 18.618182 16.290909 34.909091 34.909091 34.909091s34.909091-16.290909 34.909091-34.909091V546.909091h367.709091c18.618182 0 34.909091-16.290909 34.909091-34.909091s-16.290909-34.909091-34.909091-34.909091z",fill:"#999999","p-id":"19920"})])],-1),n("div",{class:"app-box",style:{background:"#fff"}},[n("div",{class:"ali-icon"})],-1)]))):w("",!0),c(j,{class:u(["!mb-5 flex justify-center",{"p-[2.5rem]":null==(L=e.compData)?void 0:L.title,"!pt-0":null==(N=e.compData)?void 0:N.title}])},{default:o((()=>[c(I),a[19]||(a[19]=n("h3",{class:"text-[1.4rem] w-full text-[#666] inline-block font-bold"},"阿里云用户专享特权：",-1)),a[20]||(a[20]=n("h3",{class:"text-[1.2rem] leading-[1] w-full text-[#999] inline-block mt-[1rem] flex items-center"},[n("span",{class:"svgtofont-el-check text-[#1d9534] font-bold mr-[.5rem]"}),f(" 免费使用原本需要付费的功能： ")],-1)),a[21]||(a[21]=n("h3",{class:"text-[1.2rem] leading-[1] w-full text-[#999] inline-block mt-[1rem] ml-[1.9rem] flex items-center"},[n("img",{src:"/static/img/soft_ico/ico-msg_push.png",class:"w-[2rem] mr-[1rem]"}),f(" 异常监控推送 ")],-1)),a[22]||(a[22]=n("h3",{class:"text-[1.2rem] leading-[1] w-full text-[#999] inline-block mt-[1rem] ml-[1.9rem] flex items-center"},[n("img",{src:"/static/img/soft_ico/ico-btapp.png",class:"w-[2rem] mr-[1rem]"}),f(" 堡塔app ")],-1)),a[23]||(a[23]=n("h3",{class:"text-[1.2rem] leading-[1] w-full text-[#999] inline-block mt-[1.5rem] flex items-center"},[n("span",{class:"svgtofont-el-check text-[#1d9534] font-bold mr-[.5rem]"}),f(" 宝塔官方付费软件均享额外折扣 ")],-1))])),_:1},8,["class"]),c(z,{type:"primary",class:"w-[85%] mt-[4rem] relative left-[7.5%]",style:{margin:"1rem auto 0"},size:"default",onClick:oe},{default:o((()=>a[24]||(a[24]=[f("一键激活专享特权")]))),_:1}),n("div",$,[n("span",{class:"cursor-pointer hover:text-[#1d9534]",onClick:a[7]||(a[7]=e=>ce(1))},"已有宝塔账号登录")]),(null==(P=e.compData)?void 0:P.title)?(s(),v("div",A)):w("",!0)],6)],512),[[g,2===m(le)]]),1===m(le)&&m(ne)?(s(),v("div",F,[a[26]||(a[26]=n("div",{class:"more-title"},[n("span",null,"更多绑定方式")],-1)),n("div",G,[i(n("div",{class:"bind-box",onClick:a[8]||(a[8]=e=>ce(2))},a[25]||(a[25]=[n("i",{class:"tencent_ico"},null,-1),f(" 阿里云账号 ")]),512),[[g,1===m(le)]])])])):w("",!0)]})),_:1},8,["rules","model","class"])}}}),[["__scopeId","data-v-319fa9f9"]]);export{L as default};
