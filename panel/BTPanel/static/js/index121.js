import{c as e,r as a,o as l,k as t,l as d,e as s,x as o,p as r,I as m,aX as i,q as u,ah as p,a7 as n,a4 as c,J as b,ag as f}from"./base-lib.js?v=1734676359";import{G as v,j as _}from"./utils-lib.js?v=1734676359";import{setRedisValue as g}from"./database.js?v=1734676359";import{g as x}from"./useMethod3.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./column.js?v=1734676359";import"./index91.js?v=1734676359";import"./validator.js?v=1734676359";const w={class:"p-[20px]"},h=e({__name:"index",props:{compData:{default:()=>({options:[],sid:0})}},setup(e,{expose:h}){const{refreshTableList:V}=x(),j=e,y=a(),D=a(),q=a({db_idx:Number(j.compData.keyId),name:"",val:"",endtime:""}),k={db_idx:[{required:!0,message:"请选择数据库",trigger:"change"}],name:[{required:!0,message:"请输入键",trigger:["blur","input"]}],val:[{required:!0,message:"请输入值",trigger:["blur","input"]}]};return l((async()=>{var e;D.value=await(null==(e=j.compData)?void 0:e.refresh()),j.compData.row&&(q.value=j.compData.row)})),h({onConfirm:async e=>{await y.value.validate();let a={...q.value,sid:j.compData.sid};q.value.endtime&&"0"!==q.value.endtime||delete a.endtime,await v({loading:"正在".concat(j.compData.row?"编辑":"添加","数据库，请稍后..."),request:g({data:JSON.stringify(a)}),message:!0}),V(),e()}}),(e,a)=>{const l=f,v=p,g=n,x=_,h=c;return t(),d("div",w,[s(h,{"label-position":"right","label-width":"80px",model:r(q),ref_key:"redisFormRef",ref:y,rules:k},{default:o((()=>[s(g,{label:"数据库",prop:"db_idx"},{default:o((()=>[s(v,{class:"!w-[24rem]",modelValue:r(q).db_idx,"onUpdate:modelValue":a[0]||(a[0]=e=>r(q).db_idx=e),disabled:e.compData.row},{default:o((()=>[(t(!0),d(m,null,i(r(D),((e,a)=>(t(),b(l,{key:a,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1}),s(g,{label:"键",prop:"name"},{default:o((()=>[s(x,{width:"24rem",placeholder:"请输入键名",modelValue:r(q).name,"onUpdate:modelValue":a[1]||(a[1]=e=>r(q).name=e),disabled:e.compData.row},null,8,["modelValue","disabled"])])),_:1}),s(g,{label:"值",prop:"val"},{default:o((()=>[s(x,{width:"24rem",placeholder:"请输入值",modelValue:r(q).val,"onUpdate:modelValue":a[2]||(a[2]=e=>r(q).val=e),rows:6,type:"textarea"},null,8,["modelValue"])])),_:1}),s(g,{label:"有效期"},{default:o((()=>[s(x,{width:"24rem",placeholder:"为空则永不过期",modelValue:r(q).endtime,"onUpdate:modelValue":a[3]||(a[3]=e=>r(q).endtime=e),"text-type":"秒",min:0,type:"number"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"]),a[4]||(a[4]=u("ul",{class:"mt-[20px] leading-8 text-[1.2rem] list-disc ml-[36px]"},[u("li",null,"有效期为0表示永久")],-1))])}}});export{h as default};
