import{_ as t}from"./index90.js?v=1734676359";import{l as a,H as e,M as s,ah as o,o as r,G as n,k as i,O as l}from"./utils-lib.js?v=1734676359";import{_ as p}from"./index99.js?v=1734676359";import{r as m,h as c,R as h,e as d,c as f,o as u,B as j,k as _,l as y,x as b,p as g,y as w,C as x,A as k}from"./base-lib.js?v=1734676359";import{o as C,u as v}from"./column.js?v=1734676359";import{u as I}from"./useStore7.js?v=1734676359";import{getPhpSiteSafe as A,delPhpSiteSafe as O}from"./site.js?v=1734676359";import{r as R}from"./useController14.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";import"./validator.js?v=1734676359";import"./useStore9.js?v=1734676359";import"./useMethod5.js?v=1734676359";import"./useController13.js?v=1734676359";import"./useStore12.js?v=1734676359";import"./useController3.js?v=1734676359";const{siteInfo:H}=I();m();const S=c({list:[],load:!1}),B=[{content:"安全告警默认会监视当前网站访问非当前网站文件的行为(例：你的站点A.com访问了站点B.com的文件或者目录)，通过添加监视器路径，当路径被访问时发送告警"},{content:"告警频率：60秒某一个告警行为只会发送一次告警"},{isHtml:!0,content:'<a class="bt-link"  href="https://www.bt.cn/bbs/thread-112442-1-1.html" target="_blank">使用教程</a>'}],D=async t=>{await r({title:"删除监视器",width:"35rem",icon:"warning-filled",content:"您真的要删除路径【".concat(t.path,"】的监视器吗？")});(await n({loading:"正在删除监视器，请稍后...",request:O({domain:H.value.name,type:t.type,path:t.path}),message:!0})).status&&M()},E=async t=>{let s={name:H.value.name,path:t?t.path:R.path,refresh:M};t&&(s.row=t),a({title:"".concat(t?"编辑":"添加","文件监视器"),area:47,isAsync:!0,component:()=>e((()=>import("./add-file-monitor.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),compData:s,showFooter:!0})},M=async()=>{try{S.load=!0;const t=await A();t.status||s.error(t.msg);const a=t.data.sites.find((t=>t.path===R.path&&t.site_name===H.value.name));if(a){const t=[];for(const e in a.config.file_info)Object.prototype.hasOwnProperty.call(a.config.file_info,e)&&t.push({...a.config.file_info[e],path:e});S.list=t}}catch(t){o(t)}finally{S.load=!1}},P=h([{label:"路径",prop:"path",render:t=>d("div",{class:"truncate bt-link",onClick:()=>{"dir"===t.type&&C({path:t.path})}},[t.path])},{label:"类型",prop:"type",render:t=>"".concat("dir"===t.type?"文件夹":"文件")},{label:"告警操作",prop:"type",render:t=>{const a=[];return parseInt(t.read)&&a.push("读取"),parseInt(t.del)&&a.push("删除"),parseInt(t.reit)&&(a.push("修改"),a.push("增加")),a.join(" / ")}},v([{onClick:E,title:"编辑"},{onClick:D,title:"删除"}])]),T={class:"relative p-[16px]"},q=f({__name:"index",setup:a=>(u((()=>{M()})),(a,e)=>{const s=k,o=p,r=i,n=l,m=t,c=j("bt-loading");return _(),y("div",T,[d(m,null,{"header-left":b((()=>[d(s,{type:"primary",onClick:e[0]||(e[0]=t=>g(E)())},{default:b((()=>e[1]||(e[1]=[w("添加监视器")]))),_:1})])),"header-right":b((()=>[d(o,{onRefresh:g(M)},null,8,["onRefresh"])])),content:b((()=>[x(d(r,{ref:"ftpTable",column:g(P),"max-height":360,data:g(S).list,description:"暂无数据"},null,8,["column","data"]),[[c,g(S).load],[c,"正在加载中，请稍后...","title"]])])),"footer-left":b((()=>[d(n,{options:g(B),class:"ml-[20px] mt-[20px]"},null,8,["options"])])),_:1})])})});export{q as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
