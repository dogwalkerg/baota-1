import{c as a,r as s,w as t,o as e,a1 as o,k as l,l as r,e as i,x as n,y as c,q as p,p as u,n as m,A as d}from"./base-lib.js?v=1734676359";import{o as f,G as y,ah as g,b as v}from"./utils-lib.js?v=1734676359";import{clearCrontabLog as x,getCrontabLog as _}from"./site.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";const b={class:"p-[20px]"},w={class:"pre-box bg-[#333] mt-[12px] text-white h-[48rem] overflow-auto p-[20px]"},h=["innerHTML"],j=a({__name:"log-detail",props:{compData:{default:{}}},setup(a){const j=v(),q=a,{id:H}=q.compData,k=s("正在获取中...."),D=s(null),T=async()=>{await f({title:"提示",content:"确定清空日志吗？",icon:"warning-filled"}),y({loading:"正在清空日志，请稍后...",request:x({id:H}),message:!0,success:C})},C=async a=>{try{const s=await _({id:H});k.value=s.msg,I(),a&&j.request({status:s.status,msg:s.status?"刷新成功":"刷新失败"})}catch(s){g(s)}},I=()=>{m((()=>{const a=document.querySelector(".pre-box");a.scrollTop=a.scrollHeight}))};return t((()=>q.compData),(()=>{C()}),{immediate:!0}),e((()=>{D.value=setInterval((async()=>{await C()}),2e3)})),o((()=>{clearInterval(D.value)})),(a,s)=>{const t=d;return l(),r("div",b,[i(t,{type:"primary",onClick:s[0]||(s[0]=a=>C(!0))},{default:n((()=>s[1]||(s[1]=[c("刷新日志")]))),_:1}),i(t,{onClick:T,type:"default"},{default:n((()=>s[2]||(s[2]=[c("清空日志")]))),_:1}),p("div",w,[p("pre",{innerHTML:u(k)},null,8,h)])])}}});export{j as default};
