import{c as a,ax as e,h as s,r,o as l,B as o,C as t,p as m,k as d,l as i,e as n,x as p,q as u,N as c,P as f,a7 as b,a4 as g}from"./base-lib.js?v=1734676359";import{B as w}from"./index185.js?v=1734676359";import{g as _,a7 as v,a8 as h,a9 as k}from"./useStore3.js?v=1734676359";import{G as x,b as V,e as y}from"./utils-lib.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./ace.js?v=1734676359";const S={class:"flex flex-col lib-box p-2rem"},j={class:"max-h-[30rem] h-[30rem] !w-[43rem]"},D=y(a({__name:"add-compose-template",props:{compData:{default:()=>({})}},emits:["close","complate"],setup(a,{expose:y,emit:D}){e("popupLoading");const O=V(),{refs:{isRefreshTemplateList:N}}=_(),q=a,z=D,E=s({name:"",remark:"",data:""}),J=r(),U={mode:"ace/mode/nginx",theme:"ace/theme/chrome",wrap:!0,showInvisibles:!1,showFoldWidgets:!1,useSoftTabs:!0,tabSize:2,showPrintMargin:!1,readOnly:!1,fontSize:"12px"},B=r(),C=r(!1),F=r(!1),I={name:[{validator:(a,e,s)=>{""===e?s(new Error("请输入模板名")):s()},trigger:["blur"]}]};l((async()=>{var a;(null==(a=q.compData.row)?void 0:a.id)&&(E.name=q.compData.row.name,E.remark=q.compData.row.remark,x({request:v({data:JSON.stringify({template_id:q.compData.row.id})}),loading:F,success:a=>{a.status?E.data=a.msg:O.error(a.msg)}}))}));return y({onConfirm:()=>{B.value.validate((async a=>{var e;a&&x({request:(null==(e=q.compData.row)?void 0:e.id)?h({data:JSON.stringify({id:q.compData.row.id,name:E.name,remark:E.remark,data:E.data})}):k({data:JSON.stringify({name:E.name,remark:E.remark,data:E.data})}),loading:"提交中...",message:!0,success:a=>{a.status&&(z("complate",a),N.value=!0,z("close"))}})}))}}),(a,e)=>{const s=f,r=b,l=w,_=g,v=o("bt-loading");return t((d(),i("div",S,[n(_,{ref_key:"cmdFormRef",ref:B,size:"small",model:m(E),rules:I,disabled:m(C),class:"relative w-full","label-position":"right",onSubmit:e[3]||(e[3]=c((()=>{}),["prevent"]))},{default:p((()=>[n(r,{prop:"name",label:"创建模板"},{default:p((()=>[n(s,{class:"!w-[35rem]",modelValue:m(E).name,"onUpdate:modelValue":e[0]||(e[0]=a=>m(E).name=a),placeholder:"请输入模板名"},null,8,["modelValue"])])),_:1}),n(r,{prop:"remark",label:"备注"},{default:p((()=>[n(s,{class:"!w-[35rem]",modelValue:m(E).remark,"onUpdate:modelValue":e[1]||(e[1]=a=>m(E).remark=a),placeholder:"备注"},null,8,["modelValue"])])),_:1}),n(r,{prop:"data",label:"内容"},{default:p((()=>[u("div",j,[n(l,{ref_key:"aceEditor",ref:J,id:"templateEditor",modelValue:m(E).data,"onUpdate:modelValue":e[2]||(e[2]=a=>m(E).data=a),editorOption:U},null,8,["modelValue"])])])),_:1})])),_:1},8,["model","disabled"])])),[[v,m(F)],[v,"正在获取模板消息，请稍候...","title"]])}}}),[["__scopeId","data-v-f362ad3f"]]);export{D as default};
