import{l as e,H as t,o as a,G as s,k as n,V as l,e as o}from"./utils-lib.js?v=1734676359";import{_ as r}from"./index90.js?v=1734676359";import{c as i,r as p,R as c,w as u,e as m,o as d,B as _,k as f,l as h,x as v,q as b,F as g,p as x,v as y,M as w,C as j,A as O,aj as q}from"./base-lib.js?v=1734676359";import{_ as V}from"./index182.js?v=1734676359";import{U as k,V as D,W as E,X as C,Y as A,Z as R,_ as S}from"./firewall.js?v=1734676359";import{a as F,b as I,u as T,c as L}from"./column.js?v=1734676359";import{getFirewallStore as M}from"./useStore4.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";const P={class:"flex items-center"},B=o(i({__name:"index",setup(o){const{refs:{isRefreshSpywares:i}}=M(),B=p(0),H=p(),N=p(!1),J=c([]),U=p(!1),W=[{active:!0,content:"添加目录",event:()=>e({title:"开启SSH密钥登录",area:50,component:()=>t((()=>import("./index374.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),showFooter:!0})},{content:"白名单",event:()=>e({title:"白名单",area:[70,55],component:()=>t((()=>import("./index375.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),showFooter:!1})}],G=async(e,t,a,s)=>{const{value:n}=s;let l=[];switch(n){case"startOpen":l=["开启监听","开启后目录将会对自动的进行木马查杀并进行隔离"];break;case"stopOpen":l=["关闭监听","关闭后目录将不会对自动的进行木马查杀并进行隔离"];break;case"deleteMonitorDir":l=["删除监听","该目录将不在自动进行木马查杀和病毒文件隔离"]}const o=async(e,t)=>{const{path:a}=e;switch(n){case"startOpen":case"stopOpen":return await C("startOpen"!==n,{data:JSON.stringify({path:a})});case"deleteMonitorDir":return await k({path:a})}};await e({title:"批量".concat(l[0],"目录"),content:"批量".concat(l[0],"目录，").concat(l[1],"，是否继续操作！"),column:[{label:"目录",prop:"path"},L()],onConfirm:async()=>(await t(o),K(),!1)})},X=[{label:"开启监听目录",value:"startOpen",event:G},{label:"关闭监听目录",value:"stopOpen",event:G},{label:"删除监听目录",value:"deleteMonitorDir",event:G}];u((()=>i.value),(e=>{e&&K()}));const Y=async e=>{s({request:E(!e),message:!0,loading:"正在"+(e?"开启":"关闭")+"动态查杀开关，请稍后..."})},Z=()=>e({title:"隔离文件",area:70,component:()=>t((()=>import("./index377.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)}),z=[F(),{label:"目录",prop:"path"},I({prop:"open",event:async e=>{s({request:C(e.open,{data:JSON.stringify({path:e.path})}),message:!0,loading:"正在切换监控状态，请稍后...",success:K})},data:["已停止","运行中"]}),{label:"备注",prop:"ps",minWidth:200,isCustom:!0,render:e=>{var t;const a={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"'};return e.ps=null==(t=e.ps)?void 0:t.replace(/&(lt|gt|nbsp|amp|quot);/gi,(function(e,t){return a[t]})),m("input",{type:"text",value:e.ps,class:"bt-table-input w-full",placeholder:"点击编辑备注",onBlur:t=>{if(e.ps===t.target.value)return!1;e.ps=t.target.value,(async e=>{s({request:D({path:e.path,ps:e.ps}),message:!0,loading:"正在设置监控状态，请稍后..."})})(e)}},null)}},T([{onClick:async a=>e({title:"木马扫描【".concat(a.path,"】"),area:[84,60],compData:{row:a},component:()=>t((()=>import("./index376.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)}),title:"扫描"},{onClick:async e=>{await a({icon:"question-filled",title:"删除监控【"+e.path+"】",width:"34rem",content:"删除后无法继续监控该网站，是否继续？"}),s({request:k({path:e.path}),message:!0,loading:"正在删除监控，请稍后...",success:K})},title:"删除"}])],K=async()=>{i.value=!1,s({request:R(),data:[Array,J],loading:U})};return d((()=>{K(),(async()=>{s({request:S(),data:[Number,B]})})(),(async()=>{s({request:A(),data:{status:[Boolean,N]}})})()})),(e,t)=>{const a=V,s=O,o=q,i=n,p=l,c=r,u=_("bt-loading");return f(),h("div",null,[m(c,null,{"header-left":v((()=>[b("div",P,[m(a,{options:W}),m(s,{type:"default",class:"!ml-[1.2rem]",onClick:Z},{default:v((()=>[t[1]||(t[1]=b("span",null,"隔离文件",-1)),b("span",{class:g((x(B)>0?"bg-[red]":"bg-[#f0ad4e]")+" ml-[.4rem] py-[.1rem] px-[.4rem] text-white text-center font-bold")},y(x(B)),3)])),_:1}),t[2]||(t[2]=b("div",{class:"bg-[#ccc] w-[1px] h-2rem mx-8"},null,-1)),t[3]||(t[3]=b("div",{class:"mr-4"},"动态查杀开关",-1)),b("div",null,[m(o,{modelValue:x(N),"onUpdate:modelValue":t[0]||(t[0]=e=>w(N)?N.value=e:null),width:36,onChange:Y},null,8,["modelValue"])])])])),content:v((()=>[j(m(i,{ref_key:"portTable",ref:H,column:z,data:x(J),description:"木马查杀列表为空"},null,8,["data"]),[[u,x(U)],[u,"正在加载木马查杀列表，请稍后...","title"]])])),"footer-left":v((()=>[m(p,{"table-ref":x(H),options:X},null,8,["table-ref"])])),_:1}),t[4]||(t[4]=b("ul",{class:"mt-8px leading-8 text-[1.2rem] list-disc ml-20px"},[b("li",null,"注意：隔离文件后的数字表示隔离文件总数"),b("li",{class:"text-[#FF6500]"},"动态查杀开启后，当查杀目录中的文件发生修改就会自动的进行木马查杀并进行隔离")],-1))])}}}),[["__scopeId","data-v-43957144"]]);export{B as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
