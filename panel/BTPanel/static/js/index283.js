import{_ as a}from"./index90.js?v=1734676359";import{o as e,ah as t,G as l,k as s,h as n,j as o,O as i}from"./utils-lib.js?v=1734676359";import{c as r,r as d,h as p,o as u,aB as c,B as m,k as v,l as f,e as y,x as g,p as h,M as x,y as w,C as _,q as D,D as b,aY as k,af as V,ad as j,A as C,a7 as q,a4 as M}from"./base-lib.js?v=1734676359";import{m as U}from"./validator.js?v=1734676359";import{getPyVersion as H,getVersionList as O,setGoEnvironment as z,installPyVersionNew as B,installPyVersion as J,installVersion as L,uninstallVersion as N}from"./site.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";import"./column.js?v=1734676359";const S={class:"p-[20px]"},T={class:"bg-[#333] p-[12px] h-[36rem] text-white overflow-auto logMsg"},A=["innerHTML"],G={class:"p-2rem"},Y=r({__name:"index",props:{compData:{default:{}}},setup(r){const Y=r,E=d(""),F=d(!1),I=d("正在请求安装..."),K=[{label:"版本号",width:200,render:a=>y("div",null,[a.version.replace(Y.compData.type,""),w(" "),"stable"===a.type&&"go"===Y.compData.type?"(稳定版)":"",a.version===E.value&&a.installed?y("span",{class:"font-bold text-[#333]"},[w("【正在使用】")]):""])},{label:"安装状态",render:a=>("string"==typeof a.installed&&(a.installed="1"===a.installed),y("div",null,[!0===a.is_install?y("span",{class:"text-gray-400"},[w("安装中")]):a.installed?y("span",{class:"text-primary"},[w("已安装")]):y("span",{class:"text-danger"},[w("未安装")])]))},{label:"操作",align:"right",render:a=>(a.version.replace(Y.compData.type,""),y("div",null,[_(y("div",{class:"inline-block"},[a.installed&&a.version!==E.value&&"go"===Y.compData.type?y("span",{class:"cursor-pointer bt-link",onClick:()=>{aa(a.version)}},[w("设置默认")]):y("span",null,[w("--")]),y(k,{direction:"vertical"},null)]),[[b,"go"===Y.compData.type]]),a.installed?y("span",{class:"cursor-pointer text-[#ef0808]",onClick:()=>{ta(a.version)}},[w("卸载")]):!0===a.is_install?y("span",{class:"cursor-pointer text-gray-400",onClick:()=>{U()}},[w("安装中...")]):y("span",{class:"cursor-pointer bt-link",onClick:()=>{ea(a.version)}},[w("安装")])]))}],P=d([]),Q=d(!1);d("");const R=d([]),W=d("所有版本"),X=p({version:"",extended:"",status:!1}),Z=d([{content:"填写时请勿添加换行符等特殊符号，这可能会导致参数不生效"},{content:"多个参数时以空格隔开"},{content:'"--prefix"参数已被使用'},{content:"验证参数是否生效，可查看安装日志并搜索对应名称"}]),$=async a=>{var l;let s="all";"常用版本"===W.value&&(s="streamline");try{let t;if("py"===Y.compData.type){!0===a&&await e({title:"提示",width:"35rem",icon:"warning-filled",content:"将从镜像源获取版本列表，是否继续？"});let n={force:!0===a?"true":"false"};Q.value=!0,t=await H(n),P.value=t.data.sdk[s],E.value=(null==(l=t.data.command_path.find((a=>a.python_path===t.data.used)))?void 0:l.version)||""}else Q.value=!0,t=await O(Y.compData.type),R.value=t.data,t.data.sdk[s].sort(((a,e)=>e.installed-a.installed)),E.value=t.data.used,P.value=t.data.sdk[s]}catch(n){t(n)}finally{Q.value=!1}},aa=async a=>{(await l({loading:"正在设置默认版本，请稍后...",request:z({name:a}),message:!0})).status&&$()},ea=async a=>{var t,s;const n="py"===Y.compData.type;if(n){if(X.status){const a={data:JSON.stringify({version:X.version,extended:X.extended})};await l({request:B(a),message:!0}),X.status=!1,U(),Y.compData&&"function"==typeof(null==(t=Y.compData)?void 0:t.refresh)&&Y.compData.refresh(),$()}else X.version=a,X.status=!0;return}await e({title:"安装",content:"是否安装[".concat(a,"]版本？"),icon:"warning-filled"});(await l({loading:"正在安装，请稍后...",request:n?J({data:JSON.stringify({version:a})}):L({version:a},Y.compData.type),message:!0})).status&&(Y.compData&&"function"==typeof(null==(s=Y.compData)?void 0:s.refresh)&&Y.compData.refresh(),$())},ta=async a=>{await e({title:"卸载sdk",content:"卸载[".concat(a,"]版本后，相关项目将无法启动，是否继续？"),icon:"warning-filled"});(await l({loading:"正在卸载，请稍后...",request:N({version:a},Y.compData.type)})).status&&$()};return u((()=>{$()})),c((()=>{})),(e,t)=>{const l=V,r=j,d=C,p=s,u=n,c=o,b=q,k=M,U=i,H=a,O=m("bt-loading");return v(),f("div",S,[y(H,null,{"header-left":g((()=>[y(r,{modelValue:h(W),"onUpdate:modelValue":t[0]||(t[0]=a=>x(W)?W.value=a:null),size:"default",onChange:$},{default:g((()=>[y(l,{value:"所有版本"},{default:g((()=>t[7]||(t[7]=[w("所有版本")]))),_:1}),y(l,{value:"常用版本"},{default:g((()=>t[8]||(t[8]=[w("常用版本")]))),_:1})])),_:1},8,["modelValue"])])),"header-right":g((()=>[y(d,{type:"default",onClick:t[1]||(t[1]=a=>$(!0))},{default:g((()=>t[9]||(t[9]=[w(" 更新版本列表 ")]))),_:1})])),content:g((()=>[_(y(p,{height:"400",column:K,data:h(P)},null,8,["data"]),[[O,h(Q)]])])),popup:g((()=>[y(u,{title:"安装信息",modelValue:h(F),"onUpdate:modelValue":t[2]||(t[2]=a=>x(F)?F.value=a:null),area:[50,36],onCancel:t[3]||(t[3]=()=>I.value="正在请求安装...")},{default:g((()=>[D("div",T,[D("pre",{innerHTML:h(I),class:"whitespace-pre-wrap"},null,8,A)])])),_:1},8,["modelValue"]),y(u,{title:"安装版本【".concat(h(X).version,"】"),modelValue:h(X).status,"onUpdate:modelValue":t[5]||(t[5]=a=>h(X).status=a),area:50,"show-footer":!0,onConfirm:t[6]||(t[6]=a=>ea(h(X).version))},{default:g((()=>[D("div",G,[y(k,{model:h(X)},{default:g((()=>[y(b,{label:"自定义参数"},{default:g((()=>[y(c,{modelValue:h(X).extended,"onUpdate:modelValue":t[4]||(t[4]=a=>h(X).extended=a),name:"extended",width:"32rem",placeholder:"可为空，实例：--enable-optimizations"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"]),y(U,{class:"pl-4rem mt-1rem",options:h(Z)},null,8,["options"])])])),_:1},8,["title","modelValue"])])),_:1})])}}});export{Y as default};
