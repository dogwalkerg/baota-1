import{G as a,o as e,M as t,j as s,c as l}from"./utils-lib.js?v=1734676359";import{c as i,h as d,r as n,o as r,aJ as o,B as m,C as u,p,k as c,l as _,e as f,x as g,q as y,y as w,aj as b,a7 as h,A as x,a4 as I}from"./base-lib.js?v=1734676359";import{d as k,a1 as P}from"./config.js?v=1734676359";import{g as V}from"./useStore.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";const j={class:"p-[2rem]"},v={class:"w-[32rem]"},A={class:"w-[32rem]"},q={class:"text-medium h-[2.4rem]"},C=i({__name:"api-config",setup(i){const{refs:{panelConfig:C}}=V(),z=d({token:"",limit_addr:""}),S=n(!1),U=n("正在获取API配置，请稍候..."),H=async()=>{await a({loading:S,request:k({t_type:2}),message:!0})},R=async()=>{try{await e({icon:"warning-filled",title:"重置密钥",isHtml:!0,content:'\n\t\t\t<p>您确定要重置当前密钥吗？</p>\n\t\t\t<p class="text-danger">\t重置密钥后，已关联密钥产品，将失效，请重新添加新密钥至产品。</p>'}),U.value="正在重置密钥，请稍候...",await a({loading:S,request:k({t_type:1}),message:!1,success:a=>{a.status?z.token=a.msg:t.error(a.msg)}})}catch(s){}},B=async()=>{U.value="正在设置API配置，请稍候...",await a({loading:S,request:k({t_type:3,limit_addr:z.limit_addr}),message:!0})};return r((()=>{(async()=>{const e=await a({loading:S,request:P(),data:{limit_addr:String,token:String}});z.token=e.token,z.limit_addr=e.limit_addr})()})),(a,e)=>{const t=b,i=h,d=x,n=s,r=I,k=l,P=o("bt-tips"),V=m("bt-loading");return u((c(),_("div",j,[f(r,null,{default:g((()=>[f(i,{label:"API接口"},{default:g((()=>[f(t,{modelValue:p(C).apiInterface,"onUpdate:modelValue":e[0]||(e[0]=a=>p(C).apiInterface=a),onChange:H},null,8,["modelValue"])])),_:1}),f(i,{label:"接口密钥"},{default:g((()=>[y("div",v,[f(n,{modelValue:p(z).token,"onUpdate:modelValue":e[1]||(e[1]=a=>p(z).token=a),type:"text",readOnly:!0},{suffix:g((()=>[f(d,{type:"primary",size:"small",onClick:R},{default:g((()=>e[3]||(e[3]=[w(" 重置 ")]))),_:1})])),_:1},8,["modelValue"])])])),_:1}),f(i,null,{label:g((()=>e[4]||(e[4]=[y("div",{class:"py-8px leading-[1.4]"},[y("div",{class:"pr-6px"},"IP白名单"),y("div",null,"(每行一个)")],-1)]))),default:g((()=>[y("div",A,[f(n,{modelValue:p(z).limit_addr,"onUpdate:modelValue":e[2]||(e[2]=a=>p(z).limit_addr=a),type:"textarea",resize:"none",autosize:{minRows:4,maxRows:4}},null,8,["modelValue"])])])),_:1}),f(i,{label:" "},{default:g((()=>[f(d,{type:"primary",onClick:B},{default:g((()=>e[5]||(e[5]=[w("保存")]))),_:1})])),_:1})])),_:1}),f(P,{class:"my-20px"},{default:g((()=>[e[8]||(e[8]=y("li",{class:"text-medium h-[2.4rem]"},"开启API后，必需在IP白名单列表中的IP才能访问面板API接口",-1)),e[9]||(e[9]=y("li",{class:"text-danger h-[2.4rem]"},"请不要在生产环境开启，这可能增加服务器安全风险；",-1)),y("li",q,[e[7]||(e[7]=w(" API接口文档在这里： ")),f(k,{href:"https://www.bt.cn/bbs/thread-20376-1-1.html"},{default:g((()=>e[6]||(e[6]=[w(" https://www.bt.cn/bbs/thread-20376-1-1.html ")]))),_:1})])])),_:1})])),[[V,p(S)],[V,p(U),"title"]])}}});export{C as default};
