import{_ as e}from"./index100.js?v=1734676359";import{_ as a}from"./index90.js?v=1734676359";import{_ as s}from"./index373.js?v=1734676359";import{u as t,o as l,G as r,M as i,U as n,F as o,k as d}from"./utils-lib.js?v=1734676359";import{c as p,r as u,h as m,w as c,o as h,B as S,k as g,l as y,p as b,J as f,x as _,e as j,y as w,M as x,C as H,A as k}from"./base-lib.js?v=1734676359";import{Q as v,R as I,S as P}from"./firewall.js?v=1734676359";import{getFirewallStore as A}from"./useStore4.js?v=1734676359";import"./validator.js?v=1734676359";import"./index91.js?v=1734676359";import"./column.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";const V=p({__name:"index",setup(p){const{payment:V,mainHeight:C}=t(),{refs:{sshLoginType:L}}=A(),q=u(!1),T=u([]),U=u(0),F={title:"SSH登录日志-功能介绍",ps:"保障SSH服务器的安全性，发现和应对安全威胁。",source:100,desc:["SSH安全审计","SSH登录溯源","SSH暴破记录","SSH入侵分析"],tabImgs:[{title:"SSH登录日志",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/ssh_login_log.png"}]},J=m({p:1,limit:20,search:"",select:"ALL"}),M=[{label:"全部",value:"ALL"},{label:"登录成功",value:"Accepted"},{label:"登录失败",value:"Failed"}],B=[{label:"IP地址:端口",prop:"address",render:e=>j("span",{class:e.deny_status?"!text-[#999] line-through bt-link":"bt-link",onClick:()=>G(e)},[e.address,w(":"),j("span",{class:"text-[#666] cursor-default !no-underline"},[e.port])])},{label:"归属地",prop:"area",render:e=>e.area.info||"--"},{label:"用户",prop:"user"},{label:"状态",prop:"status",render:(e,a)=>j("span",{class:"bt-link !text-".concat(e.status?"primary":"danger")},[e.status?"登录成功":"登录失败"])},{label:"操作时间",prop:"time"}],G=async e=>{await l({title:"提示",content:e.deny_status?"解封该IP后，将恢复此IP对服务器的访问，是否继续操作？":"封禁该IP后，将不再允许此IP访问服务器，是否继续操作？",icon:"warning-filled"});let a={address:e.address,types:"drop",brief:"SSH登录日志页面点击IP手动封禁",domain:"",choose:"address"};const s=await r({loading:"正在"+(e.deny_status?"解封":"封禁")+"IP，请稍后...",request:e.deny_status?v({address:e.address}):I(a),data:Array});i.request({status:s.length>0,msg:s.length>0?"操作成功":"操作失败"}),O()},N=e=>{J.p=e,O()},O=async(e={p:J.p,limit:J.limit,search:J.search,select:L.value})=>{await r({loading:q,request:P({data:JSON.stringify(e)}),data:[Array,T]}),U.value=T.value.length};return c(L,(()=>{O()})),h((()=>{setTimeout((()=>{O()}),0)})),(t,l)=>{const r=k,i=n,p=o,u=d,m=s,c=a,h=e,v=S("bt-loading");return g(),y("div",null,["ltd"===b(V).authType?(g(),f(c,{key:0},{"header-left":_((()=>[j(r,{type:"primary",onClick:l[0]||(l[0]=e=>O())},{default:_((()=>l[5]||(l[5]=[w("刷新")]))),_:1})])),"header-right":_((()=>[j(i,{type:"button",modelValue:b(L),"onUpdate:modelValue":l[1]||(l[1]=e=>x(L)?L.value=e:null),options:M,class:"mr-8px",onChange:l[2]||(l[2]=e=>N(1))},null,8,["modelValue"]),j(p,{class:"!w-[26rem]",modelValue:b(J).search,"onUpdate:modelValue":l[3]||(l[3]=e=>b(J).search=e),onSearch:l[4]||(l[4]=e=>O()),placeholder:"请输入登录IP/用户名"},null,8,["modelValue"])])),content:_((()=>[H(j(u,{column:B,data:b(T),height:b(C)-360,description:"SSH登录日志列表为空"},null,8,["data","height"]),[[v,b(q)],[v,"正在加载SSH登录日志列表，请稍后...","title"]])])),"footer-right":_((()=>[j(m,{limit:b(J).limit,p:b(J).p,num:b(U),onClick:N},null,8,["limit","p","num"])])),popup:_((()=>l[6]||(l[6]=[]))),_:1})):(g(),f(h,{key:1,data:F,class:"px-[20%] py-[2rem]"}))])}}});export{V as default};
