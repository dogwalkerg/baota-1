import{c as s,T as a,r as t,U as e,i as n,w as l,o as i,B as o,k as u,J as c,x as r,C as p,p as d,l as v,q as m,e as f,v as g,F as b,z as y,bc as w,bd as h,A as x,aw as _}from"./base-lib.js?v=1734676359";import{af as k,o as I,G as j,b0 as C,d as q,_ as z,ak as B,N,e as R}from"./utils-lib.js?v=1734676359";import{_ as A}from"./index91.js?v=1734676359";import{i as F}from"./validator.js?v=1734676359";const G={class:"flex items-center justify-between"},J={class:"h-[2.2rem] w-[2.2rem] flex overflow-hidden justify-center items-center status-icon <2xl:hidden"},M={class:"<2xl:hidden"};var T=(s=>(s.stop="停止",s.start="启动",s.restart="重启",s.reload="重载",s))(T||{});const U=R(s({__name:"index",props:a({pluginInfo:{default:()=>({title:"",name:"defalut",status:!0,version:"",admin:!1,setup:!1,s_version:""})},isRequest:{type:Boolean,default:!0}},{pluginInfo:{default:{title:"",name:"",status:!0,version:"",admin:!1,s_version:""}},pluginInfoModifiers:{}}),emits:["update:pluginInfo"],setup(s){const a=s,R=t(!1),U=t(!1),W=t(0),$=e(s,"pluginInfo"),D=n((()=>T[$.value.status?"stop":"start"]));l((()=>a.pluginInfo),(s=>{R.value=!1,s&&($.value=s,N(s,"s_status")&&($.value.status=s.s_status&&s.setup),R.value=!0)}),{immediate:!0,deep:!0});const E=()=>{F({name:$.value.name})},H=async s=>{try{const t=T[s],e=a.pluginInfo.s_version;await I({title:t+e,icon:"warning-filled",content:"你确定要".concat(t).concat(e,"服务，是否继续？")}),await j({loading:U,request:C({name:e,type:s}),message:!0,success:async s=>{await(async()=>{try{const{data:s}=await B({name:["nginx","apache","openlitespeed"].includes($.value.name)?"web":$.value.name});$.value.s_status=s.s_status}catch(s){}})()}})}catch(t){}},K=()=>{W.value=document.body.clientWidth};return i((()=>{a.pluginInfo.title&&a.isRequest&&(async()=>{try{U.value=!0;const{data:s}=await k({sName:a.pluginInfo.name});$.value=s}catch(s){}finally{U.value=!1}})(),K(),window.onresize=K})),(a,t)=>{const e=A,n=q,l=z,i=x,k=_,I=o("bt-loading");return u(),c(k,{placement:"top-start",width:"200",class:"","popper-class":"white-tips-popover",trigger:"hover"},{reference:r((()=>[p((u(),v("div",w(h(a.$attrs)),[d(R)?p((u(),c(i,{key:0,type:$.value.status?"default":"danger",class:"plugin-status-btn",plain:"",onClick:E},{default:r((()=>[m("div",{class:b(["h-full inline-block flex items-center",$.value.status?"hover:text-primary":"hover:text-danger"])},[m("span",J,[f(n,{src:"/static/icons/soft/ico-".concat(s.pluginInfo.name||"defalut",".svg"),class:"inline-block",all:!0},null,8,["src"])]),m("span",null,g($.value.title),1),m("span",M,g($.value.version),1),f(l,{icon:"icon-"+($.value.status?"start":"stop"),class:b(["ml-[4px]",$.value.status?"!text-primary":"!text-danger"])},null,8,["icon","class"])],2)])),_:1},8,["type"])),[[I,d(U)]]):y("",!0)],16)),[[I,d(U)],[I,"small","size"]])])),default:r((()=>[m("div",G,[m("span",{class:"bt-link",onClick:t[0]||(t[0]=s=>H($.value.status?"stop":"start"))},g(d(D)),1),f(e),m("span",{class:"bt-link",onClick:t[1]||(t[1]=s=>H("restart"))},"重启"),f(e),m("span",{class:"bt-link",onClick:t[2]||(t[2]=s=>H("reload"))},"重载"),f(e),m("span",{class:"bt-link",onClick:t[3]||(t[3]=s=>d(F)($.value))},"告警设置")])])),_:1})}}}),[["__scopeId","data-v-f28dc1be"]]);export{U as B};
