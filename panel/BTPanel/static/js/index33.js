import{u as a,b2 as e,l as t,H as o,G as s,a8 as l,k as i,V as n,o as r,e as m}from"./utils-lib.js?v=1734676359";import{_ as c}from"./index90.js?v=1734676359";import{_ as u}from"./index97.js?v=1734676359";import{_ as d}from"./index182.js?v=1734676359";import{g as p,P as f,Q as g}from"./useStore3.js?v=1734676359";import{c as h,r as v,h as _,w as b,o as w,B as j,k as y,l as k,e as x,x as S,q as T,p as C,C as E}from"./base-lib.js?v=1734676359";import{h as I,N as D,d as N}from"./useMethods.js?v=1734676359";import{c as O}from"./column.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";const R={class:"relative p-[1.6rem]"},L={class:"flex items-center"},q=m(h({__name:"index",setup(m){const h=v(),{refs:{customLimit:q,isRefreshWarehouseList:A}}=p(),{mainHeight:H}=a(),J=_({loading:!1,total:0,p:1,limit:Number(localStorage.getItem("dockerwarehouselimit"))||20}),P=v([]),V=v([]),U=[{label:"删除",value:"delete",event:async(a,e,t,o)=>{const{label:s,value:l}=o,i=async(a,e)=>{const{id:t}=a;if("delete"===l){const a={id:t};return await g({data:JSON.stringify(a)})}};await a({title:"批量".concat(s,"仓库"),content:"批量".concat(s,"已选的仓库，是否继续操作！"),column:[{label:"仓库名",prop:"name"},O()],onConfirm:async()=>(await e(i),W(),!1)})}}],B=[{active:!0,content:"添加仓库",event:()=>{t({component:()=>o((()=>import("./add-stash-dialog.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),title:"添加仓库",area:54,btn:"添加"})}}];b((()=>A.value),(a=>{a&&W()}));const G=a=>{q.value.warehouse=!0,localStorage.setItem("dockerwarehouselimit",J.limit.toString()),W(!1)},M=I({editDataEvent:a=>{t({component:()=>o((()=>import("./add-stash-dialog.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),title:"编辑仓库【".concat(a.name,"】"),area:54,btn:"编辑",compData:{row:a}})},deleteDataEvent:async a=>{await r({title:"删除仓库【".concat(a.name,"】"),type:"calc",width:"35rem",content:"您真的要删除仓库【".concat(a.name,"】吗？")});const e={id:a.id};s({request:g({data:JSON.stringify(e)}),message:!0,loading:"正在删除...",success:()=>{W()}})}});let Q=!0;const W=async a=>{A.value=!1;try{if(!1===a)return void(V.value=N({p:J.p,limit:J.limit,list:P.value})||[]);Q&&(J.loading=!0),Q=!1,await s({request:f(),data:Array,success:a=>{P.value=a,J.total=a.length,V.value=N({p:J.p,limit:J.limit,list:P.value})||[]}}),J.loading=!1}catch(e){}};return w((async()=>{W(),M.value=e(JSON.parse(localStorage.getItem("dockerStashTableColumn")||"[]"),M.value),q.value.warehouse||setTimeout((()=>{H.value>900?J.limit=20:J.limit=10}),0)})),(a,e)=>{const t=d,o=l,s=i,r=n,m=u,p=c,f=j("bt-loading");return y(),k("div",R,[x(p,null,{"header-left":S((()=>[T("div",L,[x(t,{options:B}),T("a",{class:"ml-[1rem] bt-link",onClick:e[0]||(e[0]=a=>C(D)())},"需求反馈")])])),"header-right":S((()=>[x(o,{name:"dockerStashTableColumn",column:C(M),tableRef:C(h)},null,8,["column","tableRef"])])),content:S((()=>[E(x(s,{ref_key:"wareTable",ref:h,key:"wareTable",column:C(M),"max-height":C(H)-220,data:C(V),description:"仓库列表为空"},null,8,["column","max-height","data"]),[[f,C(J).loading],[f,"正在加载仓库列表，请稍后...","title"]])])),"footer-left":S((()=>[x(r,{"table-ref":C(h),options:U},null,8,["table-ref"])])),"footer-right":S((()=>[x(m,{page:C(J).p,"onUpdate:page":e[1]||(e[1]=a=>C(J).p=a),row:C(J).limit,"onUpdate:row":e[2]||(e[2]=a=>C(J).limit=a),total:C(J).total,onChange:G},null,8,["page","row","total"])])),popup:S((()=>e[3]||(e[3]=[]))),_:1})])}}}),[["__scopeId","data-v-f7b55939"]]);export{q as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
