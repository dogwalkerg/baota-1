import{_ as a}from"./index90.js?v=1734676359";import{G as e,ah as t,j as l,k as s,V as o,b as c,e as n}from"./utils-lib.js?v=1734676359";import{c as p,r as i,o as u,B as d,C as r,p as v,k as m,l as f,e as b,x as h,q as x,M as y,y as g,v as j,I as _,bH as w,A as k}from"./base-lib.js?v=1734676359";import{a as C,u as E,c as H}from"./column.js?v=1734676359";import{f as N}from"./validator.js?v=1734676359";import{u as P}from"./useStore7.js?v=1734676359";import{removeProtectExt as V,removeExcloud as q,getProofFind as I,addProtectExt as D,addExcloud as T}from"./site.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";const z={class:"pb-2rem"},A={class:"flex gap-col-1rem"},B={class:"flex flex-col justify-between"},G={class:"mt-8px leading-8 text-[1.2rem] list-disc ml-20px tamper-help-info"},M={key:0,class:"text-danger"},R=n(p({__name:"exclude-protect-ext",props:{compData:{default:{}}},setup(n,{expose:p}){const R=n,S=c(),{siteInfo:U}=P(),F=i(),J=i(!1),K=i(!1),L=i([]),O=i("");i([]);const Q=i(0),W=async a=>{const t={siteName:U.value.name,[Q.value?"protectExt":"excludePath"]:a.path},l=Q.value?V:q;(await e({loading:"正在删除".concat(Q.value?"保护文件名":"排除路径","，请稍后..."),request:l(t),message:!0})).status&&Y()},X=()=>{N({type:"all",path:U.value.path,change:a=>{let e=O.value?O.value.split("\n"):[];e.includes(a)||e.push(a),O.value=e.join("\n")}})},Y=async()=>{J.value=!0;try{const{data:a}=await I({siteName:U.value.name});a&&(L.value=(Q.value?a.protectExt:a.excludePath).map((a=>({path:a}))))}catch(a){t(a)}finally{J.value=!1}},Z=async()=>{if(""===O.value)return S.error("".concat(Q.value?"保护文件":"排除路径","不能为空"));let a={siteName:U.value.name};Q.value?a.protectExt=O.value:a.excludePath=O.value;(await e({loading:"正在添加".concat(Q.value?"保护":"排除","，请稍后..."),request:Q.value?D(a):T(a),message:!0})).status&&(O.value="",Y())},$=()=>{Q.value="protect"===R.compData.childType?1:0,Y()},aa=[{label:"删除",value:"delete",event:async(a,e,t,l)=>{const s=async a=>{let e={siteName:U.value.name,[Q.value?"protectExt":"excludePath"]:a.path};return Q.value?await V(e):await q(e)};await a({title:"批量删除",content:"批量删除选中的名称或路径，防篡改开启时该路径将受保护，是否继续操作？",column:[{label:"".concat(Q.value?"扩展名/文件名":"名称或路径"),prop:"path"},H()],onConfirm:async()=>(await e(s),Y(),!1)})}}],ea=i([C(),{label:"".concat(Q.value?"扩展名/文件名":"名称或路径"),prop:"path"},E([{title:"删除",onClick:W}])]);return u($),p({init:$}),(e,t)=>{const c=l,n=k,p=s,i=o,u=a,C=d("bt-loading");return r((m(),f("div",z,[b(u,null,{"header-left":h((()=>[x("div",A,[b(c,{modelValue:v(O),"onUpdate:modelValue":t[0]||(t[0]=a=>y(O)?O.value=a:null),type:"textarea",rows:4,resize:"none",width:"38rem",placeholder:"".concat(v(Q)?"受保护的文件或扩展名":"排除文件或目录","，每行一条")},null,8,["modelValue","placeholder"]),x("div",B,[x("span",null,[b(n,{type:"default",onClick:X},{default:h((()=>t[1]||(t[1]=[x("i",{class:"svgtofont-el-folder"},null,-1)]))),_:1})]),b(n,{type:"default",onClick:Z},{default:h((()=>[g(" 添加"+j(v(Q)?"保护":"排除"),1)])),_:1})])])])),"header-right":h((()=>t[2]||(t[2]=[]))),content:h((()=>[r(b(p,{ref_key:"excludeTableRef",ref:F,column:v(ea),maxHeight:v(Q)?380:420,data:v(L)},null,8,["column","maxHeight","data"]),[[C,v(K)]])])),"footer-left":h((()=>[b(i,{"table-ref":v(F),options:aa},null,8,["table-ref"])])),"footer-right":h((()=>t[3]||(t[3]=[]))),_:1}),x("ul",G,[v(Q)?(m(),f(_,{key:1},[t[4]||(t[4]=w('<li class="leading-2rem" data-v-bcba5f59><div data-v-bcba5f59>支持以下4种方式</div><div data-v-bcba5f59><span data-v-bcba5f59> 1. 文件扩展名，如： <code data-v-bcba5f59>php jsp</code></span><span data-v-bcba5f59> 2. 文件名，如： <code data-v-bcba5f59>bt.php、 index.php</code></span></div><div data-v-bcba5f59><span data-v-bcba5f59> 3. 文件全路径，如： <code data-v-bcba5f59>/bt.cn/1.txt</code></span><span data-v-bcba5f59> 4. 文件相对路径，如： <code data-v-bcba5f59>app/test.php</code></span></div></li><li data-v-bcba5f59>一般添加常见容易被篡改的扩展名即可，如html,php,js等</li>',2))],64)):(m(),f("li",M,"排除规则具备最高优先级，在此列表中的目录或文件名将不受保护"))])])),[[C,v(J)],[C,"正在获取防篡改配置信息，请稍侯","title"]])}}}),[["__scopeId","data-v-bcba5f59"]]);export{R as default};
