import{c as e,r as s,W as t,o,k as a,l as r,C as n,D as i,p as l,e as u,z as m,I as p}from"./base-lib.js?v=1734676359";import{X as c,b as d}from"./utils-lib.js?v=1734676359";import{u as _}from"./use-socket-request.js?v=1734676359";import{u as j}from"./useStore7.js?v=1734676359";import{n as v,g as x}from"./index55.js?v=1734676359";import{_ as y,a as b,b as g}from"./traditional-project.vue_vue_type_script_setup_true_lang.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./site.js?v=1734676359";import"./index90.js?v=1734676359";import"./index116.js?v=1734676359";import"./index91.js?v=1734676359";import"./validator.js?v=1734676359";import"./column.js?v=1734676359";import"./index.vue_vue_type_style_index_0_scoped_03ce946a_lang.js?v=1734676359";import"./useController3.js?v=1734676359";import"./index124.js?v=1734676359";import"./index107.js?v=1734676359";import"./index.vue_vue_type_script_setup_true_lang13.js?v=1734676359";import"./index88.js?v=1734676359";import"./index185.js?v=1734676359";import"./ace.js?v=1734676359";const f=["innerHTML"],w=e({__name:"index",emits:["showFooterFun"],setup(e,{expose:w,emit:k}){const h=d(),D=k,{isRefreshList:F}=j(),P=s("nodeProject"),M=s(null),R=s(!1),q=s("正在执行添加脚本...");t("nodeData",v);const{BtTabs:z,tabsRefs:C}=c({type:"card",value:P,options:[{label:"默认项目",name:"nodeProject",lazy:!0,render:y},{label:"PM2项目",name:"pmProject",lazy:!0,render:b},{label:"传统项目",name:"traditionalProject",lazy:!0,render:g}]}),H=async(e=!1)=>{v.value=await x(),e&&h.success("Node版本，刷新成功")};return t("getNodeData",H),o((()=>H)),w({onConfirm:async e=>{const s=await C()[P.value].submit();if(s){let t={...s,mod_name:"nodejs",sub_mod_name:"com",def_name:"create",ws_callback:"create"};(async()=>{var e;null==(e=M.value)||e.socketDestroy();const{socketRequest:s,socketDestroy:t}=_("/ws_modsoc",!1);M.value={socketRequest:s,socketDestroy:t},new Promise(((e,s)=>{e(M.value)}))})(),M.value.socketRequest({params:t,onMessage:s=>(async(e,s)=>{e.msg&&(q.value=q.value+"\n"+e.msg),-1===e.code&&e.status?(h.success("添加成功"),s(),F.value=!0):[2,3,4,5].includes(e.code)&&!e.status&&(h.msg({message:e.msg,type:"error",duration:0,dangerouslyUseHTMLString:!0,showClose:!0}),5===e.code?(R.value=!1,s(),F.value=!0):(R.value=!1,D("showFooterFun",!0)))})(s,e)}),R.value=!0,D("showFooterFun",!1)}}}),(e,s)=>(a(),r(p,null,[n(u(l(z),{class:"p-2rem"},null,512),[[i,!l(R)]]),l(R)?(a(),r("pre",{key:0,class:"whitespace-pre-wrap h-[40rem] overflow-auto mt-12px bg-[#333] p-12px text-white rounded-4px",innerHTML:l(q)},null,8,f)):m("",!0)],64))}});export{w as default};
