import{c as e,h as a,r as s,o as t,k as r,l,e as i,x as o,p as d,I as n,aX as m,N as p,ah as c,a7 as u,a4 as f,J as h,q as _,v as b,ag as w}from"./base-lib.js?v=1734676359";import{m as x,y,z as N,A as v}from"./ssl.js?v=1734676359";import{b as j}from"./utils-lib.js?v=1734676359";import{g as I}from"./useStore10.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";const O={class:"p-[16px]"},k={style:{float:"left"}},D=e({__name:"index",props:{compData:{type:Object,default:()=>{}}},setup(e,{expose:D}){const{refs:{isRefreshCertificateList:g}}=I(),z=j(),V=e,q=a({siteName:"",ssl_hash:"",oid:"",partnerOrderId:"",index:""}),C=s([]),S=async e=>{let a;try{switch(e){case"1":a=await v({siteName:q.siteName,oid:q.oid});break;case"2":a=await N({siteName:q.siteName,partnerOrderId:q.partnerOrderId});break;case"3":let e={siteName:q.siteName,ssl_hash:q.ssl_hash,index:q.index};V.compData.row.order_status?delete e.ssl_hash:delete e.index,a=await y(e)}}catch(s){}return a},A=()=>{q.siteName="",q.ssl_hash="",q.oid="",q.partnerOrderId="",q.index=""};return t((()=>{(async()=>{const{data:e}=await x();C.value=e})(),(e=>{switch(e.type){case"1":q.oid=e.oid;break;case"2":q.partnerOrderId=e.partnerOrderId;break;case"3":q.ssl_hash=e.hash,q.index=e.index}})(V.compData.row)})),D({onConfirm:async e=>{if(!q.siteName)return void z.error("请选择部署网站");let a;try{a=z.load("正在部署证书,请稍后...");const s=await S(V.compData.row.type);z.request(s),s.status&&(A(),g.value=!0,e&&e())}catch(s){}finally{a&&a.close()}}}),(e,a)=>{const s=w,t=c,x=u,y=f;return r(),l("div",O,[i(y,{model:d(q),class:"relative w-full","label-position":"right",size:"small",onSubmit:a[1]||(a[1]=p((()=>{}),["prevent"]))},{default:o((()=>[i(x,{label:"部署网站",prop:"dns_name"},{default:o((()=>[i(t,{modelValue:d(q).siteName,"onUpdate:modelValue":a[0]||(a[0]=e=>d(q).siteName=e),class:"!w-[33rem]",filterable:"","default-first-option":"",size:"default",placeholder:"请选择部署网站"},{default:o((()=>[(r(!0),l(n,null,m(d(C),(e=>(r(),h(s,{key:e.id,label:e.name,value:e.name},{default:o((()=>[_("span",k,b(e.name),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])}}});export{D as default};
