import{u as a,G as e,M as s,l as o,H as t,k as r,O as n}from"./utils-lib.js?v=1734676359";import{_ as l}from"./index90.js?v=1734676359";import{c as i,r as m,e as p,aj as c,w as u,o as _,B as d,k as f,l as j,x as y,C as g,p as h}from"./base-lib.js?v=1734676359";import{az as x,aA as S}from"./firewall.js?v=1734676359";import{u as b}from"./column.js?v=1734676359";import{getFirewallStore as k}from"./useStore4.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";const w={class:"py-[.8rem]"},E=i({__name:"index",setup(i){const{refs:{reinforceStatus:E}}=k(),{mainHeight:H}=a(),A=m(!1),v=m([]),D=[{content:"【异常进程监控】与【SSH服务加固】会占用一定服务器开销"},{content:"开启系统加固功能后，一些如软件安装等敏感操作将被禁止"},{content:"开启【SSH服务加固】之后，用户登录SSH的行为将受到监控，若连续多次登录失败，将采取封IP措施"},{class:"text-[#FF6500]",content:"【注意】如果您需要安装软件或插件，请先将系统加固关闭！"}],I=async()=>{await e({loading:A,request:x(),data:{list:[Array,v],open:[Boolean,E]}})},O=[{label:"名称",prop:"name"},{label:"描述",prop:"ps"},{label:"状态",render:a=>p(c,{modelValue:a.open,size:"small",onChange:o=>(async(a,o)=>{if(!E.value)return s.error("请先开启系统加固功能");await e({loading:"正在"+(o?"开启":"关闭")+"防护配置，请稍后...",request:S({s_key:a.key}),message:!0}),I()})(a,o)},null)},b([{onClick:async a=>{o({title:"配置【".concat(a.name,"】"),component:()=>"ssh"===a.key?t((()=>import("./row-ssh-config.js?v=1734676359")),__vite__mapDeps([]),import.meta.url):"process"===a.key?t((()=>import("./row-process.js?v=1734676359")),__vite__mapDeps([]),import.meta.url):t((()=>import("./row-reinforce.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),compData:a,area:72})},title:"配置"}])];return u((()=>E.value),(a=>{a||v.value.forEach((a=>a.open=!1))})),_(I),(a,e)=>{const s=r,o=l,t=n,i=d("bt-loading");return f(),j("div",w,[p(o,null,{content:y((()=>[g(p(s,{column:O,data:h(v),"max-height":h(H)-400,description:"防护配置列表为空"},null,8,["data","max-height"]),[[i,h(A)],[i,"正在加载防护配置列表，请稍后...","title"]])])),_:1}),p(t,{options:D,class:"mx-[1.6rem] my-[0.6rem]"})])}}});export{E as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
