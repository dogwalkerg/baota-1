import{_ as e}from"./index101.js?v=1734676359";import{c as a,r as l,k as t,l as o,e as s,x as r,I as n,aX as u,p as d,J as i,y as m,v as c,M as p,F as v,A as y,a$ as f,b0 as h,c0 as g,h as w,ax as _,R as b,i as V,w as x,aB as k,o as C,B as D,C as j,q as U,z as N,n as q,ag as M,ah as T,aw as R,aT as A,aj as O,aY as E,a7 as $,a4 as F}from"./base-lib.js?v=1734676359";import{_ as I}from"./validator.js?v=1734676359";import{R as S,e as Y,u as L,c as P,G as H,ah as J,o as z,a7 as B,aa as G,k as W,O as X,j as K,h as Q,b as Z}from"./utils-lib.js?v=1734676359";import{_ as ee}from"./index90.js?v=1734676359";import{_ as ae}from"./index97.js?v=1734676359";import{_ as le}from"./index99.js?v=1734676359";import{t as te}from"./useController3.js?v=1734676359";import{u as oe}from"./useStore7.js?v=1734676359";import{addExcloud as se,setSiteStatusProof as re,modifyPathConfig as ne,multiCreate as ue,setPushStatus as de,setPushConfig as ie,getGlabalTotal as me,getTamperRuleByPath as ce,delTempClose as pe,setTempClose as ve,modifyGlobalConfig as ye,getTamperCoreLogs as fe,getPushList as he,delLogs as ge,getProofIndex as we,getProofLog as _e}from"./site.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";import"./column.js?v=1734676359";const be={class:"time flex"},Ve=Y(a({__name:"day-cut",props:{days:{default:""}},emits:["cut-day","cut-day-click"],setup(e,{emit:a}){const g=a,w=l(""),_=l(1),b=l(),V=l([{content:"昨天",active:!1,event:()=>{_.value=0;const e=S(new Date((new Date).getTime()-864e5),"yyyy-MM-dd");g("cut-day",0,e),x.value=""}},{content:"今天",active:!0,event:e=>{_.value=1;const a=S(new Date,"yyyy-MM-dd");g("cut-day",1,a),x.value=""}}]),x=l(""),k=e=>e.getTime()>Date.now(),C=e=>{w.value="自定义时间",_.value=2,g("cut-day",2,S(e,"yyyy-MM-dd"))};return(e,a)=>{const l=y,g=f,w=h;return t(),o("div",be,[s(g,{class:"control-btn"},{default:r((()=>[(t(!0),o(n,null,u(d(V),((e,a)=>(t(),i(l,{key:a,type:d(_)===a?"primary":"",onClick:e.event},{default:r((()=>[m(c(e.content),1)])),_:2},1032,["type","onClick"])))),128))])),_:1}),s(w,{align:"right",type:"date",modelValue:d(x),"onUpdate:modelValue":a[0]||(a[0]=e=>p(x)?x.value=e:null),placeholder:"自定义时间",ref_key:"player",ref:b,class:v(["auto-time !w-[13rem]","".concat(2===d(_)?"active":"")]),onChange:C,"disabled-date":k},null,8,["modelValue","class"])])}}}),[["__scopeId","data-v-2839b599"]]),xe={key:0,class:"flex justify-between mb-[1.6rem]"},ke={class:"flex items-center"},Ce={class:"flex items-center"},De={class:"bt-danger"},je={key:1,class:"flex items-center justify-center mb-[1.6rem]"},Ue={class:"flex items-center flex-1 mr-1rem"},Ne={key:0,class:"flex-1"},qe={class:"flex items-center"},Me={class:"current-box"},Te={class:"current-box-item"},Re=["title"],Ae={class:"current-box-item"},Oe=["title"],Ee={key:0,class:"flex justify-between"},$e={class:"flex items-center"},Fe={class:"flex items-center"},Ie={class:"flex items-center"},Se={class:"flex items-center"},Ye={class:"flex items-center"},Le={class:"mt-8 leading-10 list-disc pl-2rem"},Pe={class:"flex-wrap"},He=Y(a({__name:"overview",props:{compData:{default:{}}},setup(a,{expose:v}){const f=a,Y=Z(),{getSenderAlarmListInfo:be}=L(),{siteInfo:He}=oe(),Je=l(!1),ze=g(),Be=l(!1),Ge=l(1),We=l(S(new Date,"yyyy-MM-dd")),Xe=l({}),Ke=w({p:1,rows:10,total:0}),Qe=l(!1),Ze=l([]),ea=l([]),aa=l({logContent:"",logDialog:!1,name:""}),la=[{content:"如果需要频繁修改当前文件，确认提交即可。"},{content:"如果需要频繁修改该文件同级文件内容，请删除路径尾部文件名，确认提交即可。"},{content:s(n,null,[m("若大量临时缓存文件被拦截，可参考："),s("code",null,[m("/www/wwwroot/bt.cn/cache/bt_1234.php")]),m("，直接添加"),s("code",null,[m("/www/wwwroot/bt.cn/cache/bt*.php")]),m("即可")])},{content:"注意：以上操作会解除对文件或目录的限制，请确保你信任这些内容，以防止安全问题。"}],ta=l(!1),oa=l(),sa=l(!1),ra=w({path:""}),na=w({path:[{required:!0,message:"请输入目录/文件",trigger:"blur"}]}),ua=_("kernelModuleStatus",b(!0)),da=l({}),ia=l(!1),ma=l(!1),ca=l(),pa=w({expire:30,unit:"minute"}),va=l(),ya=l(!1),fa=w({name:He.value.path+"/"+He.value.name,cycle:30,count:3,interval:600,push_count:1,module:""}),ha=V((()=>"tamper_proof_refactored"===f.compData.type?[{content:"如果开启防篡改后您的网站出现异常，请尝试排除网站日志、缓存、临时文件、上传等目录后重试，或直接关闭异常网站防篡改功能"}]:[{content:"开启防篡改后，部分项目【无法更新，文件无法上传，无法操作等】，需要关闭防篡改或添加白名单"}])),ga=w({cycle:[{required:!0,message:"请输入时间",trigger:"blur"},{validator:(e,a,l)=>{/^[1-9]\d*$/.test(a)?l():l(new Error("必须为大于0的整数"))},trigger:["blur","change"]}],count:[{required:!0,message:"请输入次数",trigger:"blur"},{validator:(e,a,l)=>{/^[1-9]\d*$/.test(a)?l():l(new Error("必须为大于0的整数"))},trigger:["blur","change"]}],push_count:[{required:!0,message:"请输入次数",trigger:"blur"},{validator:(e,a,l)=>{/^[1-9]\d*$/.test(a)?l():l(new Error("必须为大于0的整数"))},trigger:["blur","change"]}],interval:[{required:!0,message:"请输入时间",trigger:"blur"},{validator:(e,a,l)=>{/^[1-9]\d*$/.test(a)?l():l(new Error("必须为大于0的整数"))},trigger:["blur","change"]}],module:[{validator:(e,a,l)=>{""===fa.module?l(new Error("请选择告警方式")):l()},trigger:["change"]}]}),wa=l("log"),_a=l([{label:"日志",name:"log",lazy:!0,render:()=>{}}]),ba=w({expire:[{required:!0,message:"请输入时间",trigger:"blur"},{validator:(e,a,l)=>{/^[1-9]\d*$/.test(a)?l():l(new Error("时间必须为大于0的整数"))},trigger:["blur","change"]}]}),Va=l(),xa=l(!1),ka=w({date:""}),Ca=w({date:[{required:!0,message:"请选择日期",trigger:"blur"}]}),Da=e=>e.getTime()>Date.now(),ja=[{label:"关闭防护",value:0},{label:"拦截模式",value:1},{label:"观察模式",value:2}],Ua=w({create:"创建",delete:"删除",modify:"修改",move:"移动",rename:"重命名",chmod:"权限变更"}),Na=w({0:"关闭",1:"拦截",2:"观察"}),qa=l([{label:"时间",prop:"time",width:150,render:e=>S(e[0])},{label:"模式",prop:"mode",width:60,render:e=>s("span",{class:"text-[".concat(1===e[1]?"#20a53a":"#f0ad4e","]")},[Na[e[1]]])},{label:"类型",prop:"type",width:70,render:e=>Ua[e[2]]},{label:"文件",prop:"type",showOverflowTooltip:!0,render:e=>s("div",{class:"truncate"},[e[3]])},{label:"溯源日志",prop:"ip",width:78,render:e=>s("span",{class:"bt-link cursor-pointer",onClick:()=>{aa.value.logContent=e[4]&&e[4].length?e[4].join("\n"):"当前日志为空",aa.value.name=e[3],aa.value.logDialog=!0}},[m("溯源日志")])},{label:"状态",prop:"action",width:75,render:e=>"防护成功"},{label:"操作",align:"right",width:90,render:e=>s(P,{onClick:()=>{ra.path=e[3],ta.value=!0}},{default:()=>[m("加入白名单")]})}]),Ma=l([{label:"时间",prop:"date",width:150},{label:"目录",prop:"content"},{label:"类型",prop:"type",width:100,render:e=>s("span",null,[te[e.type]])},{label:"用户",prop:"user",width:90},{label:"进程",prop:"process",width:90}]),Ta=async()=>{await oa.value.validate();(await H({loading:sa,request:se({siteName:He.value.name,excludePath:ra.path}),message:!0})).status&&(ta.value=!1)},Ra=async e=>{var a,l;try{Be.value=!0;const{data:t}=await we({day:e});Xe.value=null==(a=t.sites)?void 0:a.find((e=>e.siteName==He.value.name)),Xe.value.totalNum=Xe.value.total.site.total,Xe.value.theNum=Xe.value.total.day.total,Xe.value.open=Xe.value.open,ea.value=null==(l=t.sites)?void 0:l.map((e=>({siteName:e.siteName,path:e.path})))}catch(t){J(t)}finally{Be.value=!1}},Aa=async e=>{H({loading:Qe,request:_e({day:e,siteName:He.value.name}),data:{logs:[Array,Ze]}})},Oa=async e=>{var a;Xe.value.open=e;try{const l=await re({siteName:He.value.name,status:e});(null==(a=l.data)?void 0:a.length)?(Y.request(l.data[0]),l.status&&Ra(We.value)):Y.request(l)}catch(l){J(l)}},Ea=()=>{pa.expire=30,pa.unit="minute",ma.value=!0},$a=async e=>{var a;try{if(await z({title:"".concat(e?"开启":"关闭","保护目录配置【").concat(He.value.name,"】"),content:e?"启用该保护目录配置后，目录将受到保护，是否继续操作？":"关闭该保护目录配置后，目录将失去保护，是否继续操作？",icon:"warning"}),null==(a=Xe.value)?void 0:a.path){(await H({loading:"正在设置防篡改，请稍侯...",request:ne({path_id:Xe.value.pid,key:"status",value:e?1:0}),message:!0})).status&&Ha()}else{const{data:e}=await ue({paths:JSON.stringify([{path:He.value.path+"/",ps:He.value.name}])});e.length&&e[0].status?(Y.success("开启防篡改成功"),Ha()):Y.error("开启防篡改失败")}}catch(l){"cancel"===l&&q((()=>{Xe.value={...Xe.value,open:!e}}))}},Fa=async e=>{var a;if(!(null==(a=Xe.value)?void 0:a.path))return Y.warn("请先开启防篡改开关再进行告警设置"),void q((()=>{ia.value=!1}));if(e)ya.value=!0;else{await z({title:"关闭保护目录告警【".concat(He.value.name,"】"),content:"关闭该保护目录告警后，该配置将无法发送告警，是否继续操作？",icon:"warning"});(await H({loading:"正在关闭告警任务，请稍侯...",request:de({id:Xe.value.pid,name:"tamper_push",status:0}),message:!0})).status&&Ha()}},Ia=async()=>{await be(),Y.success("刷新成功")},Sa=()=>{ya.value=!1,ia.value=!1},Ya=async()=>{await va.value.validate();(await H({loading:"正在设置告警任务，请稍侯...",request:ie({id:Xe.value.pid,name:"tamper_push",data:JSON.stringify({cycle:Number(fa.cycle),count:Number(fa.count),interval:Number(fa.interval),push_count:Number(fa.push_count),module:fa.module,type:"",title:"【".concat(He.value.path,"】篡改告警")})}),message:!0})).status&&(ya.value=!1,Ga())},La=async(e,a)=>{Ge.value=e,We.value=a,"tamper_proof_refactored"===f.compData.type?(await Ra(a),await Aa(a)):(Ke.p=1,await Ba(a))},Pa=async()=>{try{Be.value=!0;const{data:e}=await me();da.value=e,ua.value=e.glabal_status.kernel_module_status}catch(e){J(e)}finally{Be.value=!1}},Ha=async()=>{try{const{data:e}=await ce({path:He.value.path});if(Xe.value=e,e.hasOwnProperty("status")){Xe.value.open=!!e.status;let a=0,l=0,t=[],o=[];for(let s in e.total.all)a+=e.total.all[s],t.push("".concat(te[s],": ").concat(e.total.all[s]));for(let s in e.total.today)l+=e.total.today[s],o.push("".concat(te[s],": ").concat(e.total.today[s]));Xe.value.totalNum=a,Xe.value.totalTitle=t.join("\n"),Xe.value.theNum=l,Xe.value.theTitle=o.join("\n"),Ba(We.value)}else Xe.value.open=!1,Xe.value.totalNum="--",Xe.value.theNum="--"}catch(e){J(e)}},Ja=async(e=!1)=>{e&&await ca.value.validate();(await H({loading:"正在设置临时关闭防护，请稍侯...",request:e?ve(pa):pe(),message:!0})).status&&(ma.value=!1,Pa(),Ha())},za=async()=>{await z({title:"开启全局开关",content:"开启后，站点目录对应的防篡改配置将生效，是否继续操作？",icon:"warning"});(await H({loading:"正在开启全局开关，请稍侯...",request:ye({value:1,key:"status"}),message:!0})).status&&Pa()},Ba=async e=>{var a,l;try{const t=await fe({path_id:Xe.value.pid,date:e||We.value,rows:Ke.rows,p:Ke.p});Array.isArray(t.data)?(Ze.value=t.data,Ke.total=t.hasOwnProperty("page")?B(t.page):t.data.length):Array.isArray(null==(a=null==t?void 0:t.data)?void 0:a.data)?(Ze.value=t.data.data,Ke.total=t.data.hasOwnProperty("page")?B(t.data.page):(null==(l=t.data)?void 0:l.total)||t.data.data.length):(Ze.value=[],Ke.total=0)}catch(t){}},Ga=async()=>{try{const{data:a}=await he();var e=a.tamper_push&&a.tamper_push[Xe.value.pid]||{};ia.value=!!(null==e?void 0:e.status)}catch(a){J(a)}},Wa=()=>{ka.date="",xa.value=!0},Xa=async()=>{try{await Va.value.validate();const e=await ge({path_id:Xe.value.pid,date:ka.date});Y.request(e),e.status&&(xa.value=!1,Ba())}catch(e){}};x([()=>da.value.temp_close_time,()=>ze.value],(([e,a])=>{!Je.value&&0!==e&&1e3*e+3e3<a&&(da.value.temp_close_time=0,Pa(),Ha())}));const Ka=async()=>{var e;if(f.compData.maskLayer)if(We.value=S(new Date,"yyyy-MM-dd"),"tamper_proof_refactored"===f.compData.type)await Ra(We.value),await Aa(We.value);else{if(!f.compData.isVersion)return;await Pa(),await Ha(),(null==(e=Xe.value)?void 0:e.path)&&await Ga()}};return k((()=>{Je.value=!0})),C(Ka),v({sitesList:ea,init:Ka}),(a,l)=>{var v,f,g,w,_,b;const V=M,x=T,k=R,C=P,q=A,Y=O,L=E,H=y,J=G,z=le,B=W,Z=ae,te=ee,oe=X,se=K,re=$,ne=F,ue=Q,de=I,ie=h,me=e,ce=D("bt-loading");return j((t(),o("div",null,["tamper_proof_refactored"===a.compData.type?(t(),o("div",xe,[U("div",ke,[l[26]||(l[26]=U("span",{class:"mr-1rem"},"防篡改状态",-1)),s(x,{class:"!w-[16rem]",modelValue:d(Xe).open,"onUpdate:modelValue":l[0]||(l[0]=e=>d(Xe).open=e),onChange:Oa},{default:r((()=>[(t(),o(n,null,u(ja,(e=>s(V,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"]),s(k,{placement:"top-start",width:"200","popper-class":"green-tips-popover",trigger:"hover",content:""},{reference:r((()=>l[24]||(l[24]=[U("i",{class:"svgtofont-el-question-filled text-warning ml-[12px] text-[16px]"},null,-1)]))),default:r((()=>[l[25]||(l[25]=U("ul",{class:"list-disc pl-1.6rem"},[U("li",null,"拦截模式：拦截，并记录"),U("li",null,"观察模式：不拦截，只记录")],-1))])),_:1})]),s(Ve,{days:d(Ge),onCutDay:La},null,8,["days"])])):(t(),o(n,{key:1},[(null==(v=d(da))?void 0:v.temp_close_time)?(t(),i(q,{key:0,type:"warning",class:"!mb-[1.6rem] !p-[1.2rem]",closable:!1,"show-icon":""},{title:r((()=>[U("div",Ce,[l[28]||(l[28]=m(" 当前已临时关闭全局防篡改，将在 ")),U("span",De,c(d(S)(d(da).temp_close_time)),1),l[29]||(l[29]=m(" 恢复防护 ")),s(C,{class:"bt-link ml-1rem",onClick:l[1]||(l[1]=e=>Ja(!1))},{default:r((()=>l[27]||(l[27]=[m(" 点击立即恢复 ")]))),_:1})])])),_:1})):(t(),o("div",je,[U("div",Ue,[l[32]||(l[32]=U("span",{class:"mr-1rem"},"防篡改开关",-1)),s(Y,{modelValue:d(Xe).open,"onUpdate:modelValue":l[2]||(l[2]=e=>d(Xe).open=e),width:36,onChange:$a},null,8,["modelValue"]),s(L,{direction:"vertical",class:"!h-2rem !mx-1.6rem"}),l[33]||(l[33]=U("span",{class:"mr-1rem"},"告警设置",-1)),s(Y,{class:"mr-[1.6rem]",modelValue:d(ia),"onUpdate:modelValue":l[3]||(l[3]=e=>p(ia)?ia.value=e:null),width:36,onChange:Fa},null,8,["modelValue"]),(null==(g=null==(f=d(da))?void 0:f.glabal_status)?void 0:g.settings_status)?N("",!0):(t(),o("div",Ne,[s(q,{type:"warning",class:"h-3.2rem",closable:!1,"show-icon":""},{title:r((()=>[U("div",qe,[l[31]||(l[31]=m(" 未启用企业级防篡改，请先开启 ")),s(C,{class:"underline",type:"danger",onClick:za},{default:r((()=>l[30]||(l[30]=[m(" 全局开关 ")]))),_:1})])])),_:1})]))]),s(H,{type:"primary",onClick:Ea},{default:r((()=>l[34]||(l[34]=[m(" 全局临时开关 ")]))),_:1})]))],64)),U("div",Me,[U("div",Te,[l[35]||(l[35]=U("div",null,"总拦截次数",-1)),U("div",{title:null==(w=d(Xe))?void 0:w.totalTitle},c(d(Xe).totalNum),9,Re)]),U("div",Ae,[l[36]||(l[36]=U("div",null,"当日拦截次数",-1)),U("div",{title:null==(_=d(Xe))?void 0:_.theTitle},c(d(Xe).theNum),9,Oe)])]),"tamper_core"===a.compData.type?(t(),o(n,{key:2},[s(J,{ref:"tamperRef",type:"",class:"mt-1rem",modelValue:d(wa),"onUpdate:modelValue":l[4]||(l[4]=e=>p(wa)?wa.value=e:null),options:d(_a)},null,8,["modelValue","options"]),(null==(b=d(Xe))?void 0:b.path)?(t(),o("div",Ee,[s(H,{type:"default",onClick:Wa},{default:r((()=>l[37]||(l[37]=[m("清理日志")]))),_:1}),U("div",$e,[s(Ve,{days:d(Ge),onCutDay:La},null,8,["days"]),s(z,{onRefresh:Ba,class:"ml-1rem"})])])):N("",!0)],64)):N("",!0),s(te,null,{"header-left":r((()=>l[38]||(l[38]=[]))),"header-right":r((()=>l[39]||(l[39]=[]))),content:r((()=>["tamper_core"==a.compData.type?j((t(),i(B,{key:0,column:d(Ma),maxHeight:320,data:d(Ze)},null,8,["column","data"])),[[ce,d(Qe)]]):j((t(),i(B,{key:1,column:d(qa),maxHeight:400,data:d(Ze)},null,8,["column","data"])),[[ce,d(Qe)]])])),"footer-left":r((()=>l[40]||(l[40]=[]))),"footer-right":r((()=>["tamper_core"===a.compData.type?(t(),i(Z,{key:0,class:"mb-1rem",page:d(Ke).p,"onUpdate:page":l[5]||(l[5]=e=>d(Ke).p=e),row:d(Ke).rows,"onUpdate:row":l[6]||(l[6]=e=>d(Ke).rows=e),total:d(Ke).total,"pager-count":4,onChange:l[7]||(l[7]=e=>Ba())},null,8,["page","row","total"])):N("",!0)])),_:1}),s(oe,{options:d(ha),"list-style":"disc",class:"ml-2rem"},null,8,["options"]),s(ue,{title:"临时关闭防篡改",modelValue:d(ma),"onUpdate:modelValue":l[10]||(l[10]=e=>p(ma)?ma.value=e:null),area:58,onConfirm:l[11]||(l[11]=e=>Ja(!0)),"show-footer":""},{default:r((()=>[s(ne,{class:"p-[2rem]",ref_key:"tempFormRef",ref:ca,model:d(pa),rules:d(ba)},{default:r((()=>[s(re,{label:"临时关闭",prop:"expire"},{default:r((()=>[U("div",Fe,[s(se,{type:"number",modelValue:d(pa).expire,"onUpdate:modelValue":l[8]||(l[8]=e=>d(pa).expire=e),width:"14rem",class:"!w-14rem",placeholder:"请输入时间"},null,8,["modelValue"]),s(x,{class:"ml-1rem !w-[10rem]",modelValue:d(pa).unit,"onUpdate:modelValue":l[9]||(l[9]=e=>d(pa).unit=e)},{default:r((()=>[s(V,{label:"分钟",value:"minute"}),s(V,{label:"小时",value:"hour"}),s(V,{label:"天",value:"day"})])),_:1},8,["modelValue"]),l[41]||(l[41]=U("span",{class:"text-[#666] ml-[4px]"},"，到期后自动恢复防护",-1))])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"]),s(ue,{title:"设置告警任务",modelValue:d(ya),"onUpdate:modelValue":l[18]||(l[18]=e=>p(ya)?ya.value=e:null),area:54,onConfirm:Ya,onCancel:Sa,"show-footer":""},{default:r((()=>[s(ne,{class:"p-[2rem]",ref_key:"alarmFormRef",ref:va,model:d(fa),rules:d(ga)},{default:r((()=>[s(re,{label:"保护列表"},{default:r((()=>[s(se,{modelValue:d(fa).name,"onUpdate:modelValue":l[12]||(l[12]=e=>d(fa).name=e),disabled:"",width:"35rem"},null,8,["modelValue"])])),_:1}),s(re,{label:"触发条件"},{default:r((()=>[U("div",Ie,[s(re,{prop:"cycle"},{default:r((()=>[s(se,{modelValue:d(fa).cycle,"onUpdate:modelValue":l[13]||(l[13]=e=>d(fa).cycle=e),type:"number",width:"12rem"},null,8,["modelValue"])])),_:1}),l[42]||(l[42]=U("span",{class:"text-[#666] mx-[.6rem]"},"分钟内，篡改",-1)),s(re,{prop:"count"},{default:r((()=>[s(se,{modelValue:d(fa).count,"onUpdate:modelValue":l[14]||(l[14]=e=>d(fa).count=e),type:"number",width:"12rem"},null,8,["modelValue"])])),_:1}),l[43]||(l[43]=U("span",{class:"text-[#666] mx-[.6rem]"},"次",-1))])])),_:1}),s(re,{label:"间隔时间",prop:"interval"},{default:r((()=>[U("div",Se,[s(se,{modelValue:d(fa).interval,"onUpdate:modelValue":l[15]||(l[15]=e=>d(fa).interval=e),type:"number",width:"12rem",class:"!w-12rem"},null,8,["modelValue"]),l[44]||(l[44]=U("span",{class:"text-[#666] mx-[.6rem]"},"秒后再次监控触发条件",-1))])])),_:1}),s(re,{label:"推送次数",prop:"push_count"},{default:r((()=>[U("div",Ye,[s(se,{modelValue:d(fa).push_count,"onUpdate:modelValue":l[16]||(l[16]=e=>d(fa).push_count=e),type:"number",width:"12rem",class:"!w-12rem"},null,8,["modelValue"]),l[45]||(l[45]=U("span",{class:"text-[#666] mx-[.6rem]"}," 次后停止推送，次日再次监控 ",-1))])])),_:1}),s(re,{label:"告警方式",prop:"module"},{default:r((()=>[s(de,{modelValue:d(fa).module,"onUpdate:modelValue":l[17]||(l[17]=e=>d(fa).module=e),multiple:!1,class:"!w-35rem",limit:["sms"]},null,8,["modelValue"])])),_:1}),U("ul",Le,[U("li",null,[l[47]||(l[47]=m(" 点击配置后状态未更新，尝试点击【 ")),s(C,{class:"!inline-block",onClick:Ia},{default:r((()=>l[46]||(l[46]=[m("手动刷新")]))),_:1}),l[48]||(l[48]=m(" 】 "))])])])),_:1},8,["model","rules"])])),_:1},8,["modelValue"]),s(ue,{title:"清理日志",modelValue:d(xa),"onUpdate:modelValue":l[20]||(l[20]=e=>p(xa)?xa.value=e:null),area:38,onConfirm:Xa,"show-footer":""},{default:r((()=>[s(ne,{class:"p-[2rem]",ref_key:"clearFormRef",ref:Va,model:d(ka),rules:d(Ca)},{default:r((()=>[s(re,{label:"需要清理的日期",prop:"date"},{default:r((()=>[s(ie,{modelValue:d(ka).date,"onUpdate:modelValue":l[19]||(l[19]=e=>d(ka).date=e),type:"date",class:"date",placeholder:"选择日期","value-format":"YYYY-MM-DD","disabled-date":Da},null,8,["modelValue"])])),_:1}),s(oe,{class:"pl-2rem",options:[{content:"当前仅支持按日期清理日志"}]})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"]),s(ue,{title:"溯源日志[".concat(d(aa).name,"]"),modelValue:d(aa).logDialog,"onUpdate:modelValue":l[21]||(l[21]=e=>d(aa).logDialog=e),area:[60]},{default:r((()=>[U("div",Pe,[s(me,{class:"h-[40rem] !rounded-none",content:d(aa).logContent},null,8,["content"])])])),_:1},8,["title","modelValue"]),s(ue,{title:"清理日志",modelValue:d(ta),"onUpdate:modelValue":l[23]||(l[23]=e=>p(ta)?ta.value=e:null),area:56,onConfirm:Ta,"show-footer":""},{default:r((()=>[s(ne,{class:"p-[2rem]",ref_key:"addWhiteListFormRef",ref:oa,model:d(ra),rules:d(na),disabled:d(sa)},{default:r((()=>[s(re,{label:"目录/文件",prop:"path"},{default:r((()=>[s(se,{modelValue:d(ra).path,"onUpdate:modelValue":l[22]||(l[22]=e=>d(ra).path=e),width:"35rem",placeholder:"请输入目录/文件"},null,8,["modelValue"])])),_:1}),s(re,null,{default:r((()=>[s(oe,{options:la,class:"pl-1rem leading-2rem","list-style":"disc"})])),_:1})])),_:1},8,["model","rules","disabled"])])),_:1},8,["modelValue"])])),[[ce,d(Be)],[ce,"正在获取站点防篡改信息，请稍侯","title"]])}}}),[["__scopeId","data-v-75f12539"]]);export{He as default};
