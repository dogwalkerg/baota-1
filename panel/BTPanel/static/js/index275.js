import{D as e,bX as a,h as s,c as l,di as t,Q as r,e as o}from"./utils-lib.js?v=1734676359";import{_ as i}from"./index90.js?v=1734676359";import{c as m,s as u,i as n,r as p,w as d,o as c,k as v,l as g,e as b,x as f,y as h,p as w,q as x,M as j,A as _}from"./base-lib.js?v=1734676359";import{b as y,i as S}from"./form-item.js?v=1734676359";import{u as C}from"./column.js?v=1734676359";import{s as F,a as V,b as q,d as L}from"./index48.js?v=1734676359";import{L as k}from"./useController2.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";import"./useStore6.js?v=1734676359";import"./index276.js?v=1734676359";import"./index277.js?v=1734676359";import"./index99.js?v=1734676359";import"./index101.js?v=1734676359";import"./validator.js?v=1734676359";import"./index272.js?v=1734676359";const D={class:"p-[20px]"},B={class:"p-[2rem]"},I={class:"p-[2rem]"},E={class:"list-disc mt-[20px] pl-[28px]"},P={class:"h-[2.4rem]"},T=o(m({__name:"index",setup(o){const m=k(),{sForm:T,sendSource:U,logSystemDialog:A,logSystemForm:H,sourceForm:M,logSystemData:O,logSystemLoad:Q,logSysForm:X,logSystemList:z}=u(m),{getLogSystemData:G,getLogSystemSite:J,sendSourceConfirm:K}=m,{BtForm:N,submit:R}=e({data:H.value,options:e=>n((()=>[y("IP","ip",{attrs:{placeholder:"日志服务系统的ip",clearable:!0,class:"!w-22rem"},rules:[{required:!0,validator:(e,a,s)=>{t(a)||s(new Error("请输入正确的IP")),s()},trigger:["blur","change"]}]}),y("端口","port",{attrs:{placeholder:"请输入端口号",clearable:!0,"controls-position":"right",class:"!w-22rem",type:"number"},rules:[{required:!0,validator:(e,a,s)=>{r(a)&&a||s(new Error("请输入正确的端口(范围为1-65535)")),s()},trigger:["blur","change"]}]})])),submit:async(e,a,s)=>(await a(),await F(e.value))}),W=p({site:[],ip:H.value.port?H.value.ip+":"+H.value.port:"未配置"});d(H,(e=>{z.value[0].ip,W.value.ip=e.port?e.ip+":"+e.port:"未配置"}),{deep:!0});const{BtForm:Y,submit:Z}=e({data:W.value,options:e=>n((()=>[S("网站","site",V.value,{attrs:{multiple:!0,collapseTags:!0,class:"!w-22rem"},rules:[{required:!0,message:"请选择网站",trigger:"change"}]}),y("日志系统","ip",{attrs:{disabled:!0,class:"!w-22rem"}})])),submit:async(e,a,s)=>(await a(),await q({...e.value,server_id:z.value.length?z.value[0].id:""}))}),{BtTable:$}=a({request:G,columns:[{label:"已设置站点",prop:"site_name"},C([{onClick:L,title:"删除"}])]});return c((()=>{J()})),(e,a)=>{const t=_,r=i,o=s,m=l;return v(),g("div",D,[b(r,null,{"header-left":f((()=>[b(t,{onClick:a[0]||(a[0]=e=>U.value=!0),type:"primary"},{default:f((()=>a[5]||(a[5]=[h(" 设置发送源 ")]))),_:1}),b(t,{onClick:a[1]||(a[1]=e=>A.value=!0)},{default:f((()=>a[6]||(a[6]=[h("日志服务系统配置")]))),_:1})])),content:f((()=>[b(w($),{"max-height":"360"}),a[7]||(a[7]=x("ul",{class:"list-disc w-[50rem] pl-[1rem] mt-[12px] text-[#777]"},[x("li",null,"注意：网站被访问后才会在日志服务系统中显示")],-1))])),_:1}),b(o,{title:"设置发送源",modelValue:w(U),"onUpdate:modelValue":a[2]||(a[2]=e=>j(U)?U.value=e:null),"show-footer":!0,area:[40],onConfirm:w(Z)},{default:f((()=>[x("div",B,[b(w(Y),{"label-width":"80px"})])])),_:1},8,["modelValue","onConfirm"]),b(o,{title:"日志服务系统配置",modelValue:w(A),"onUpdate:modelValue":a[3]||(a[3]=e=>j(A)?A.value=e:null),"show-footer":!0,area:[40],onConfirm:w(R),onCancel:a[4]||(a[4]=e=>(A.value=!1,Q.value=!1,void(z.value.length>0&&Object.assign(H.value,z.value[0]))))},{default:f((()=>[x("div",I,[b(w(N),{"label-width":"80px"}),x("ul",E,[x("li",P,[b(m,{href:"https://www.bt.cn/bbs/thread-120054-1-1.html"},{default:f((()=>a[8]||(a[8]=[h(" 如何配置日志服务系统 ")]))),_:1})]),a[9]||(a[9]=x("li",null,"端口：日志服务收集端口，请在安装“日志服务系统”的机器通过 btlogs 8 获取",-1))])])])),_:1},8,["modelValue","onConfirm"])])}}}),[["__scopeId","data-v-c5e8c8d5"]]);export{T as default};
