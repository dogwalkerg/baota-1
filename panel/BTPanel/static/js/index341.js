import{c as a,s as e,k as s,l as t,e as l,g as o,r as i,h as n,q as r,p as u,x as d,y as m,v as c,aj as v,b5 as p}from"./base-lib.js?v=1734676359";import{k as f,u as g,af as h,G as _,aM as y,e as b}from"./utils-lib.js?v=1734676359";import{u as w}from"./useStore9.js?v=1734676359";import{F as x,G as L,H as j,I as k,J as C,K as q,L as I,M as T}from"./useMethod5.js?v=1734676359";import{p as E,h as N}from"./validator.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";import"./column.js?v=1734676359";const P={class:"p-[2rem]"},R=a({__name:"basic-setting",setup:a=>(e(B()),(a,e)=>{const o=f;return s(),t("div",P,[l(o)])})}),B=o("WP-PROTECTION-STORE",(()=>{const a=i(!1);return{file:n({status:!1,number:0,pid:-1}),fileLoad:i(!1),firewall:n({status:!1,number:0}),firewallLoad:i(!1),hotlink:i(!1),hotlinkLoad:i(!1),pid:i(-1),tabActive:i("basic"),tabComponent:[{name:"basic",label:"基本设置",component:R}],isRefreshBasicList:a}})),{file:M,fileLoad:O,firewall:z,firewallLoad:A,hotlink:F,hotlinkLoad:G,pid:H}=e(B()),{localRow:S}=e(w()),{payment:W}=g(),J=async a=>{try{if(O.value=!0,"ltd"!==W.value.authType)return void E({disablePro:!0,sourceId:334});const{data:e}=await h({sName:"tamper_core"});if(!e.setup)return N({type:"i",name:"tamper_core"});a?await _({request:x({paths:[{path:S.value.path,ps:S.value.ps}]}),loading:"正在开启文件保护...",message:!0}):await _({request:L({path_id:M.value.pid}),loading:"正在关闭文件保护...",message:!0}),U()}finally{O.value=!1}},K=async a=>{try{if(A.value=!0,"ltd"!==W.value.authType)return void E({disablePro:!0,sourceId:334});const{data:e}=await h({sName:"btwaf"});if(!e.setup)return N({type:"i",name:"btwaf"});a?await _({request:j({site_name:S.value.name}),loading:"正在开启防火墙设置...",message:!0}):await _({request:k({site_name:S.value.name}),loading:"正在关闭防火墙设置...",message:!0}),U()}finally{A.value=!1}},D=async a=>{try{G.value=!0;const{data:e}=await C({id:S.value.id,name:S.value.name});if(y(e)){const s={id:S.value.id,name:S.value.name,fix:e.fix,domains:e.domains,return_rule:e.return_rule,status:a,http_status:"true"===e.http_status};await q(s),F.value=!!a}}finally{G.value=!1}},Q=a=>{O.value=a,A.value=a,G.value=a},U=async()=>{try{Q(!0);const{data:{msg:a}}=await I({id:S.value.id,path:S.value.path,site_name:S.value.name});if(y(a)&&(M.value.status=1===a.file_status,M.value.number=a.file_count,z.value.status=1===a.firewall_status,z.value.number=a.firewall_count,F.value=1===a.hotlink_status,1===a.file_status)){const{data:{msg:a}}=await T({path:S.value.path});y(a)&&(M.value.pid=a.pid)}}finally{Q(!1)}},V={class:"p-[2rem]"},X={class:"tools-card"},Y={class:"tools-desc flex items-center"},Z={class:"tools-card"},$={class:"tools-desc"},aa={class:"tools-card"},ea=b(a({__name:"index",setup(a){const{file:o,fileLoad:i,firewall:n,firewallLoad:f,hotlink:g,hotlinkLoad:h}=e(B());return U(),(a,e)=>{const _=v,y=p;return s(),t("div",V,[r("div",X,[e[1]||(e[1]=r("div",{class:"tools-img"},[r("span",{class:"svgtofont-tamper-pro !text-[2rem]",style:{color:"#20a50a"}})],-1)),e[2]||(e[2]=r("div",{class:"tools-name"},"防篡改",-1)),l(_,{"model-value":u(o).status,loading:u(i),onChange:u(J)},null,8,["model-value","loading","onChange"]),e[3]||(e[3]=r("i",{class:"svgtofont-icon-ltd !text-[2rem] text-[#9B7E48]"},null,-1)),r("div",Y,[l(y,{type:"danger",size:"small",bordered:!1},{default:d((()=>[m(c(u(o).number),1)])),_:1}),e[0]||(e[0]=r("span",{class:"ml-[.5rem]"}," 今天的修改被阻止 ",-1))])]),r("div",Z,[e[5]||(e[5]=r("div",{class:"tools-img"},[r("span",{class:"svgtofont-left-waf !text-[2.4rem] text-primary"})],-1)),e[6]||(e[6]=r("div",{class:"tools-name"},"Nginx WAF",-1)),l(_,{"model-value":u(n).status,loading:u(f),onChange:u(K)},null,8,["model-value","loading","onChange"]),e[7]||(e[7]=r("i",{class:"svgtofont-icon-ltd !text-[2rem] text-[#9B7E48]"},null,-1)),r("div",$,[l(y,{type:"danger",size:"small",bordered:!1},{default:d((()=>[m(c(u(n).number),1)])),_:1}),e[4]||(e[4]=r("span",{class:"ml-[.5rem]"}," 恶意请求今天被阻止 ",-1))])]),r("div",aa,[e[8]||(e[8]=r("div",{class:"tools-img"},[r("span",{class:"svgtofont-el-link !text-[2.4rem]",style:{color:"#20a50a"}})],-1)),e[9]||(e[9]=r("div",{class:"tools-name"},"防盗链",-1)),l(_,{"model-value":u(g),loading:u(h),onChange:u(D)},null,8,["model-value","loading","onChange"])])])}}}),[["__scopeId","data-v-fa249063"]]);export{ea as default};
