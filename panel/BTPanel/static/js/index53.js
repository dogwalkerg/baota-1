import{u as e,al as t,am as a,p as s,t as l,an as o,bf as n,bg as i,H as r,ao as p,h as u}from"./utils-lib.js?v=1734676359";import{_ as c}from"./index90.js?v=1734676359";import{_ as d}from"./index100.js?v=1734676359";import{_ as m}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1734676359";import{delSorted as _,addSiteTypes as h,modifySiteTypes as f,removeSiteType as v}from"./site.js?v=1734676359";import{B as b}from"./index117.js?v=1734676359";import{u as g}from"./index124.js?v=1734676359";import{c as x,t as k,s as C,w as y,e as j,y as w,az as S,o as P,n as B,k as H,l as I,p as L,x as T,q as R,F as W,M as A,A as E}from"./base-lib.js?v=1734676359";import"./validator.js?v=1734676359";import"./index.vue_vue_type_style_index_0_scoped_03ce946a_lang.js?v=1734676359";import{a as O,b as N,h as D,e as V,g as M,u as q}from"./column.js?v=1734676359";import{u as F,a as z,b as J,e as Q,o as U}from"./useController3.js?v=1734676359";import{S as G}from"./useStore7.js?v=1734676359";import{t as K,o as X,a as Y,b as Z,c as $,r as ee,d as te,e as ae,g as se,p as le,f as oe,h as ne,i as ie,j as re,k as pe,l as ue,m as ce,n as de}from"./useController4.js?v=1734676359";import{SITE_PHP_STORE as me}from"./useStore8.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index116.js?v=1734676359";import"./index91.js?v=1734676359";import"./index107.js?v=1734676359";import"./useStore9.js?v=1734676359";import"./useMethod5.js?v=1734676359";const _e={class:"p-[20px] pb-[24px]"},he=x({__name:"index",setup(x){const{payment:he,mainHeight:fe,plugin:ve}=e(),{authType:be}=k(he.value),{activeType:ge,isRefreshList:xe,searchWidth:ke}=C(G()),{getClassList:Ce}=G(),{pluginInfo:ye,scanData:je}=C(me()),{getPhpList:we}=me();y(Q,(e=>{(null==e?void 0:e.pluginInfo)&&(ye.value=e.pluginInfo)}),{immediate:!0,deep:!0});const Se=g({key:"type",name:"PHP分类",options:()=>[{label:"全部分类",value:"all"}],event:{get:async()=>{const{data:e}=await Ce();return ne.value=e,e},add:e=>h(e,ge.value),update:e=>f(e,ge.value),delete:e=>v(e,ge.value)},ignore:["0","-2"],field:"name"}),Pe=p(de),{BtOperation:Be}=t({options:[{type:"button",label:"添加站点",active:!0,onClick:te},{type:"dropdown",label:"高级设置",onClick:ie,options:[{label:"修改默认页面",onClick:ie},{label:"默认站点",onClick:()=>ie("defaultSite")},{label:"PHP命令行版本",onClick:()=>ie("phpCommandLine")},{label:"HTTPS防窜站",onClick:()=>ie("httpsOfficersSite")},{label:"TLS设置",onClick:()=>ie("tlsSetting")},{label:"全局设置",onClick:()=>ie("globalSetting")},{label:"关联数据库",onClick:()=>ie("associatedDatabase")}]},{type:"custom",render:()=>j(E,{onClick:re},{default:()=>{var e,t;return[w("漏洞扫描"),j("span",{class:"ml-4px py-1px px-4px text-white text-center font-bold ".concat((null==(e=je.value)?void 0:e.loophole_num)>0?"bg-[red]":"bg-[#f0ad4e]")},[null==(t=je.value)?void 0:t.loophole_num])]}})},{type:"custom",render:()=>j(E,{onClick:pe},{default:()=>{var e,t;return[w("网站安全"),j("span",{class:"ml-4px py-1px px-4px text-white text-center font-bold ".concat((null==(e=je.value)?void 0:e.web_scaning_times)>0?"bg-[red]":"bg-[#f0ad4e]")},[null==(t=je.value)?void 0:t.web_scaning_times])]}})},{type:"custom",render:()=>j(b,{class:"ml-1rem",isRequest:!1,pluginInfo:ye.value},null)}]}),{BtTable:He,BtPage:Ie,BtRefresh:Le,BtTableCategory:Te,BtRecommendSearch:Re,BtColumn:We,BtBatch:Ae,BtErrorMask:Ee,refresh:Oe,categoryRef:Ne,config:De}=a({request:async e=>{const{type:t,...a}=e,l=await we({type:s(t)||"all"===t?"-1":t,...a,table:"sites",order:De.order||""}),o=JSON.parse(localStorage.getItem("/site/php_column")||"[]");return l.data.forEach((e=>{e.isWaf=!(null==o?void 0:o.length)||o[1].isCustom})),K.value=l.data,l},sort:async({column:e,prop:t,order:a})=>{let s=t;if(a){let e={orderName:s,orderStatus:"ascending"===a?"asc":"desc"};De.order="".concat(e.orderName," ").concat(e.orderStatus)}else s="",await _(),De.order="";Oe()},columns:[O(),{subtitle:"WAF图标",isCustom:!0,isLtd:!0,isHide:!0,showClick:e=>{De.data.forEach((t=>{t.isWaf=e}))}},F({label:"网站名",type:ge.value,openPlugin:X,onClick:Y}),N({width:80,sortable:"custom",event:ue,data:["已停止","运行中"]}),{label:"备份",width:65,isCustom:!0,render:e=>j("span",{onClick:()=>Z(e),class:"".concat(e.backup_count?"text-[#20a53a]":"text-warning"," cursor-pointer")},[e.backup_count?"有(".concat(e.backup_count,")"):"无备份"])},D({prop:"path",labelClassName:"php-table-path",minWidth:140}),{...V({event:e=>Y({...e,tabName:"flowQuota"},"directory")}),isCustom:!1},{label:"日流量",width:80,isCustom:!0,isLtd:!0,render:e=>{var t,a;return"free"===be.value?j("span",{class:"cursor-pointer bt-link",onClick:()=>{$(e)}},[w("查看")]):ve.value.total?(null==(t=null==e?void 0:e.net)?void 0:t.hasOwnProperty("one_day_total_flow"))?l((null==(a=null==e?void 0:e.net)?void 0:a.one_day_total_flow)||0,!0,2):"--":j("span",{class:"cursor-pointer bt-link",onClick:()=>{$(e)}},[w("查看")])}},z(),M({table:"sites",minWidth:110,width:"auto"}),{label:"PHP",isCustom:!0,minWidth:80,width:80,render:e=>{let t=!e.php_version_status;return j("span",{class:"cursor-pointer "+(t&&"静态"!==e.php_version?"bt-warn":"bt-link"),onClick:()=>Y(e,"php")},[t&&"静态"!==e.php_version?e.php_version+"[未安装]":"其它"==e.php_version?"自定义":e.php_version])}},J({onClick:e=>{Y(e,"ssl")}}),{label:"拨测告警",isCustom:!1,width:78,render:e=>S("span",{class:"bt-link",onClick:()=>{var t;Y({...e,otherName:"siteAlarm"},"PHPMOD"===(null==(t=null==e?void 0:e.project_config)?void 0:t.type)?"otherSettings":"siteAlarm")}},"设置")},q([{onClick:e=>{X(e,"monitor-setting")},title:"统计"},{onClick:e=>{X(e,"bt_waf")},title:"WAF"},{title:"设置",onClick:e=>Y(e)},{title:"删除",onClick:e=>ce(e)}])],extension:[Se,Pe,o(xe),n("search",{name:"sites",key:"php",list:ee.value}),i()],empty:()=>j("span",null,[w("您的列表为空，您可以"),j("span",{class:"bt-link",onClick:te},[w("添加一个项目")])])});return P((()=>{B((()=>{ae.value=Ne(),r((()=>import("./index279.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),r((()=>import("./index280.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),se()}))})),(e,t)=>{const a=d,s=u,l=c;return H(),I("div",null,[j(m,{ref_key:"envRef",ref:Q,onInit:L(Oe)},null,8,["onInit"]),j(L(Ee)),j(l,null,{"header-left":T((()=>[j(L(Be)),R("div",{class:"flex items-center ml-1rem",onClick:t[0]||(t[0]=(...e)=>L(U)&&L(U)(...e))},t[2]||(t[2]=[R("i",{class:"svgtofont-desired text-[1.6rem]"},null,-1),R("span",{class:"bt-link"},"需求反馈",-1)]))])),"header-right":T((()=>[j(L(Te),{class:"!w-[140px] mr-[10px]"}),j(L(Re),{type:"php",placeholder:"请输入域名或备注",class:W(["mr-[10px]","!w-[".concat(L(ke),"px]")])},null,8,["class"]),j(L(Le),{class:"mr-[10px]"}),j(L(We))])),content:T((()=>[j(L(He),{"max-height":L(fe)-220},null,8,["max-height"])])),"footer-left":T((()=>[j(L(Ae))])),"footer-right":T((()=>[j(L(Ie))])),popup:T((()=>[j(s,{title:"插件预览",modelValue:L(le),"onUpdate:modelValue":t[1]||(t[1]=e=>A(le)?le.value=e:null),area:66},{default:T((()=>[R("div",_e,[j(a,{data:L(oe)},null,8,["data"])])])),_:1},8,["modelValue"])])),_:1})])}}});export{he as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
