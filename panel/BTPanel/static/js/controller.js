import{u as e,G as t,cB as a,a_ as i,y as s,cC as r,J as n}from"./utils-lib.js?v=1734676359";import"./base-lib.js?v=1734676359";import{g as l}from"./useStore.js?v=1734676359";const{isRefreshMenu:o}=e(),c=async e=>{try{const i={hide_list:JSON.stringify([e.id])};e.parentId&&(i.site_menu=1),await t({request:a(i),message:!0,success:()=>{o.value=!0;const{refs:{panelConfig:t}}=l(),a=t.value.menuHide.indexOf(e.title);t.value.menuHide=a>-1?t.value.menuHide.split("、").filter((t=>t!==e.title)).join("、"):t.value.menuHide?"".concat(t.value.menuHide,"、").concat(e.title):e.title}})}catch(i){}},u=async()=>{try{const e=await t({request:i(),data:Array}),a=e.map((({id:e,title:t,show:a,children:i})=>{const s=r(e);return i=!(!i||!n(i))&&i.map((({id:t,title:a,show:i})=>("proxy"===t&&(t="nginx"),{show:i,parentId:e,id:t,title:a}))),{name:s,title:t,show:a,id:e,children:i}}));return s.value=((e,t)=>e.map(((e,a)=>{var i;const s=(null==(i=e.children)?void 0:i.length)?e.children.map(((e,i)=>Array.isArray(t[a].children)?{...e,show:t[a].children[i].show}:e)):[];return{...e,show:t[a].show,children:s}})))(s.value,a),{data:a,total:a.length,other:{}}}catch(e){return{data:[],total:0,other:{}}}};export{c as h,u};
