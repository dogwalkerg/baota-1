import{ah as e,b as t,G as a,j as l,u as i,H as n,M as s,l as o,b6 as r,o as c,R as u,b7 as p,b8 as d,b3 as f,t as h,J as m,b9 as v,ba as g,bb as y,S as b,x as w,bc as _,v as E,af as S,p as L,b5 as T,bd as C,q as D,ai as x,a7 as k,be as R}from"./utils-lib.js?v=1734676359";import{r as I,n as N,c as F,w as O,aD as A,B as P,C as j,D as M,k as z,l as q,e as V,L as H,N as B,q as G,g as W,d as U,t as J,h as $,R as K,a_ as Y,b1 as X,s as Q,az as Z,y as ee,ah as te,ag as ae,a5 as le,i as ie,j as ne,p as se}from"./base-lib.js?v=1734676359";import{e as oe,f as re,s as ce,h as ue,a as pe,i as de,j as fe,k as he,l as me,m as ve,n as ge,o as ye,p as be,q as we,r as _e,z as Ee,t as Se,u as Le,v as Te,w as Ce,x as De,y as xe,C as ke,A as Re,B as Ie,D as Ne,E as Fe,F as Oe,G as Ae,H as Pe,I as je,J as Me,K as ze,L as qe,M as Ve,N as He,O as Be,P as Ge,Q as We,R as Ue,S as Je,T as $e,U as Ke,V as Ye,W as Xe,X as Qe,Y as Ze,Z as et,b as tt,_ as at,$ as lt,a0 as it,a1 as nt,a2 as st,a3 as ot,a4 as rt,a5 as ct,a6 as ut,a7 as pt,d as dt,a8 as ft,a9 as ht,aa as mt,ab as vt,ac as gt,ad as yt,ae as bt,af as wt,ag as _t,ah as Et,ai as St,aj as Lt}from"./store2.js?v=1734676359";import{i as Tt,f as Ct,j as Dt,h as xt,p as kt}from"./validator.js?v=1734676359";import{g as Rt}from"./__commonjsHelpers__.js?v=1734676359";import{a as It,u as Nt,c as Ft}from"./column.js?v=1734676359";var Ot,At,Pt,jt={exports:{}};function Mt(e){return e&&"object"==typeof e&&!Array.isArray(e)&&null!==e}Ot=jt,Pt=-1,(At=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32}).Diff=function(e,t){return[e,t]},At.prototype.diff_main=function(e,t,a,l){void 0===l&&(l=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var i=l;if(null==e||null==t)throw new Error("Null input. (diff_main)");if(e==t)return e?[new At.Diff(0,e)]:[];void 0===a&&(a=!0);var n=a,s=this.diff_commonPrefix(e,t),o=e.substring(0,s);e=e.substring(s),t=t.substring(s),s=this.diff_commonSuffix(e,t);var r=e.substring(e.length-s);e=e.substring(0,e.length-s),t=t.substring(0,t.length-s);var c=this.diff_compute_(e,t,n,i);return o&&c.unshift(new At.Diff(0,o)),r&&c.push(new At.Diff(0,r)),this.diff_cleanupMerge(c),c},At.prototype.diff_compute_=function(e,t,a,l){var i;if(!e)return[new At.Diff(1,t)];if(!t)return[new At.Diff(Pt,e)];var n=e.length>t.length?e:t,s=e.length>t.length?t:e,o=n.indexOf(s);if(-1!=o)return i=[new At.Diff(1,n.substring(0,o)),new At.Diff(0,s),new At.Diff(1,n.substring(o+s.length))],e.length>t.length&&(i[0][0]=i[2][0]=Pt),i;if(1==s.length)return[new At.Diff(Pt,e),new At.Diff(1,t)];var r=this.diff_halfMatch_(e,t);if(r){var c=r[0],u=r[1],p=r[2],d=r[3],f=r[4],h=this.diff_main(c,p,a,l),m=this.diff_main(u,d,a,l);return h.concat([new At.Diff(0,f)],m)}return a&&e.length>100&&t.length>100?this.diff_lineMode_(e,t,l):this.diff_bisect_(e,t,l)},At.prototype.diff_lineMode_=function(e,t,a){var l=this.diff_linesToChars_(e,t);e=l.chars1,t=l.chars2;var i=l.lineArray,n=this.diff_main(e,t,!1,a);this.diff_charsToLines_(n,i),this.diff_cleanupSemantic(n),n.push(new At.Diff(0,""));for(var s=0,o=0,r=0,c="",u="";s<n.length;){switch(n[s][0]){case 1:r++,u+=n[s][1];break;case Pt:o++,c+=n[s][1];break;case 0:if(o>=1&&r>=1){n.splice(s-o-r,o+r),s=s-o-r;for(var p=this.diff_main(c,u,!1,a),d=p.length-1;d>=0;d--)n.splice(s,0,p[d]);s+=p.length}r=0,o=0,c="",u=""}s++}return n.pop(),n},At.prototype.diff_bisect_=function(e,t,a){for(var l=e.length,i=t.length,n=Math.ceil((l+i)/2),s=n,o=2*n,r=new Array(o),c=new Array(o),u=0;u<o;u++)r[u]=-1,c[u]=-1;r[s+1]=0,c[s+1]=0;for(var p=l-i,d=p%2!=0,f=0,h=0,m=0,v=0,g=0;g<n&&!((new Date).getTime()>a);g++){for(var y=-g+f;y<=g-h;y+=2){for(var b=s+y,w=(T=y==-g||y!=g&&r[b-1]<r[b+1]?r[b+1]:r[b-1]+1)-y;T<l&&w<i&&e.charAt(T)==t.charAt(w);)T++,w++;if(r[b]=T,T>l)h+=2;else if(w>i)f+=2;else if(d&&(S=s+p-y)>=0&&S<o&&-1!=c[S]&&T>=(E=l-c[S]))return this.diff_bisectSplit_(e,t,T,w,a)}for(var _=-g+m;_<=g-v;_+=2){for(var E,S=s+_,L=(E=_==-g||_!=g&&c[S-1]<c[S+1]?c[S+1]:c[S-1]+1)-_;E<l&&L<i&&e.charAt(l-E-1)==t.charAt(i-L-1);)E++,L++;if(c[S]=E,E>l)v+=2;else if(L>i)m+=2;else if(!d){var T;if((b=s+p-_)>=0&&b<o&&-1!=r[b])if(w=s+(T=r[b])-b,T>=(E=l-E))return this.diff_bisectSplit_(e,t,T,w,a)}}}return[new At.Diff(Pt,e),new At.Diff(1,t)]},At.prototype.diff_bisectSplit_=function(e,t,a,l,i){var n=e.substring(0,a),s=t.substring(0,l),o=e.substring(a),r=t.substring(l),c=this.diff_main(n,s,!1,i),u=this.diff_main(o,r,!1,i);return c.concat(u)},At.prototype.diff_linesToChars_=function(e,t){var a=[],l={};function i(e){for(var t="",i=0,s=-1,o=a.length;s<e.length-1;){-1==(s=e.indexOf("\n",i))&&(s=e.length-1);var r=e.substring(i,s+1);(l.hasOwnProperty?l.hasOwnProperty(r):void 0!==l[r])?t+=String.fromCharCode(l[r]):(o==n&&(r=e.substring(i),s=e.length),t+=String.fromCharCode(o),l[r]=o,a[o++]=r),i=s+1}return t}a[0]="";var n=4e4,s=i(e);return n=65535,{chars1:s,chars2:i(t),lineArray:a}},At.prototype.diff_charsToLines_=function(e,t){for(var a=0;a<e.length;a++){for(var l=e[a][1],i=[],n=0;n<l.length;n++)i[n]=t[l.charCodeAt(n)];e[a][1]=i.join("")}},At.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var a=0,l=Math.min(e.length,t.length),i=l,n=0;a<i;)e.substring(n,i)==t.substring(n,i)?n=a=i:l=i,i=Math.floor((l-a)/2+a);return i},At.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var a=0,l=Math.min(e.length,t.length),i=l,n=0;a<i;)e.substring(e.length-i,e.length-n)==t.substring(t.length-i,t.length-n)?n=a=i:l=i,i=Math.floor((l-a)/2+a);return i},At.prototype.diff_commonOverlap_=function(e,t){var a=e.length,l=t.length;if(0==a||0==l)return 0;a>l?e=e.substring(a-l):a<l&&(t=t.substring(0,a));var i=Math.min(a,l);if(e==t)return i;for(var n=0,s=1;;){var o=e.substring(i-s),r=t.indexOf(o);if(-1==r)return n;s+=r,0!=r&&e.substring(i-s)!=t.substring(0,s)||(n=s,s++)}},At.prototype.diff_halfMatch_=function(e,t){if(this.Diff_Timeout<=0)return null;var a=e.length>t.length?e:t,l=e.length>t.length?t:e;if(a.length<4||2*l.length<a.length)return null;var i=this;function n(e,t,a){for(var l,n,s,o,r=e.substring(a,a+Math.floor(e.length/4)),c=-1,u="";-1!=(c=t.indexOf(r,c+1));){var p=i.diff_commonPrefix(e.substring(a),t.substring(c)),d=i.diff_commonSuffix(e.substring(0,a),t.substring(0,c));u.length<d+p&&(u=t.substring(c-d,c)+t.substring(c,c+p),l=e.substring(0,a-d),n=e.substring(a+p),s=t.substring(0,c-d),o=t.substring(c+p))}return 2*u.length>=e.length?[l,n,s,o,u]:null}var s,o,r,c,u,p=n(a,l,Math.ceil(a.length/4)),d=n(a,l,Math.ceil(a.length/2));return p||d?(s=d?p&&p[4].length>d[4].length?p:d:p,e.length>t.length?(o=s[0],r=s[1],c=s[2],u=s[3]):(c=s[0],u=s[1],o=s[2],r=s[3]),[o,r,c,u,s[4]]):null},At.prototype.diff_cleanupSemantic=function(e){for(var t=!1,a=[],l=0,i=null,n=0,s=0,o=0,r=0,c=0;n<e.length;)0==e[n][0]?(a[l++]=n,s=r,o=c,r=0,c=0,i=e[n][1]):(1==e[n][0]?r+=e[n][1].length:c+=e[n][1].length,i&&i.length<=Math.max(s,o)&&i.length<=Math.max(r,c)&&(e.splice(a[l-1],0,new At.Diff(Pt,i)),e[a[l-1]+1][0]=1,l--,n=--l>0?a[l-1]:-1,s=0,o=0,r=0,c=0,i=null,t=!0)),n++;for(t&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),n=1;n<e.length;){if(e[n-1][0]==Pt&&1==e[n][0]){var u=e[n-1][1],p=e[n][1],d=this.diff_commonOverlap_(u,p),f=this.diff_commonOverlap_(p,u);d>=f?(d>=u.length/2||d>=p.length/2)&&(e.splice(n,0,new At.Diff(0,p.substring(0,d))),e[n-1][1]=u.substring(0,u.length-d),e[n+1][1]=p.substring(d),n++):(f>=u.length/2||f>=p.length/2)&&(e.splice(n,0,new At.Diff(0,u.substring(0,f))),e[n-1][0]=1,e[n-1][1]=p.substring(0,p.length-f),e[n+1][0]=Pt,e[n+1][1]=u.substring(f),n++),n++}n++}},At.prototype.diff_cleanupSemanticLossless=function(e){function t(e,t){if(!e||!t)return 6;var a=e.charAt(e.length-1),l=t.charAt(0),i=a.match(At.nonAlphaNumericRegex_),n=l.match(At.nonAlphaNumericRegex_),s=i&&a.match(At.whitespaceRegex_),o=n&&l.match(At.whitespaceRegex_),r=s&&a.match(At.linebreakRegex_),c=o&&l.match(At.linebreakRegex_),u=r&&e.match(At.blanklineEndRegex_),p=c&&t.match(At.blanklineStartRegex_);return u||p?5:r||c?4:i&&!s&&o?3:s||o?2:i||n?1:0}for(var a=1;a<e.length-1;){if(0==e[a-1][0]&&0==e[a+1][0]){var l=e[a-1][1],i=e[a][1],n=e[a+1][1],s=this.diff_commonSuffix(l,i);if(s){var o=i.substring(i.length-s);l=l.substring(0,l.length-s),i=o+i.substring(0,i.length-s),n=o+n}for(var r=l,c=i,u=n,p=t(l,i)+t(i,n);i.charAt(0)===n.charAt(0);){l+=i.charAt(0),i=i.substring(1)+n.charAt(0),n=n.substring(1);var d=t(l,i)+t(i,n);d>=p&&(p=d,r=l,c=i,u=n)}e[a-1][1]!=r&&(r?e[a-1][1]=r:(e.splice(a-1,1),a--),e[a][1]=c,u?e[a+1][1]=u:(e.splice(a+1,1),a--))}a++}},At.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,At.whitespaceRegex_=/\s/,At.linebreakRegex_=/[\r\n]/,At.blanklineEndRegex_=/\n\r?\n$/,At.blanklineStartRegex_=/^\r?\n\r?\n/,At.prototype.diff_cleanupEfficiency=function(e){for(var t=!1,a=[],l=0,i=null,n=0,s=!1,o=!1,r=!1,c=!1;n<e.length;)0==e[n][0]?(e[n][1].length<this.Diff_EditCost&&(r||c)?(a[l++]=n,s=r,o=c,i=e[n][1]):(l=0,i=null),r=c=!1):(e[n][0]==Pt?c=!0:r=!0,i&&(s&&o&&r&&c||i.length<this.Diff_EditCost/2&&s+o+r+c==3)&&(e.splice(a[l-1],0,new At.Diff(Pt,i)),e[a[l-1]+1][0]=1,l--,i=null,s&&o?(r=c=!0,l=0):(n=--l>0?a[l-1]:-1,r=c=!1),t=!0)),n++;t&&this.diff_cleanupMerge(e)},At.prototype.diff_cleanupMerge=function(e){e.push(new At.Diff(0,""));for(var t,a=0,l=0,i=0,n="",s="";a<e.length;)switch(e[a][0]){case 1:i++,s+=e[a][1],a++;break;case Pt:l++,n+=e[a][1],a++;break;case 0:l+i>1?(0!==l&&0!==i&&(0!==(t=this.diff_commonPrefix(s,n))&&(a-l-i>0&&0==e[a-l-i-1][0]?e[a-l-i-1][1]+=s.substring(0,t):(e.splice(0,0,new At.Diff(0,s.substring(0,t))),a++),s=s.substring(t),n=n.substring(t)),0!==(t=this.diff_commonSuffix(s,n))&&(e[a][1]=s.substring(s.length-t)+e[a][1],s=s.substring(0,s.length-t),n=n.substring(0,n.length-t))),a-=l+i,e.splice(a,l+i),n.length&&(e.splice(a,0,new At.Diff(Pt,n)),a++),s.length&&(e.splice(a,0,new At.Diff(1,s)),a++),a++):0!==a&&0==e[a-1][0]?(e[a-1][1]+=e[a][1],e.splice(a,1)):a++,i=0,l=0,n="",s=""}""===e[e.length-1][1]&&e.pop();var o=!1;for(a=1;a<e.length-1;)0==e[a-1][0]&&0==e[a+1][0]&&(e[a][1].substring(e[a][1].length-e[a-1][1].length)==e[a-1][1]?(e[a][1]=e[a-1][1]+e[a][1].substring(0,e[a][1].length-e[a-1][1].length),e[a+1][1]=e[a-1][1]+e[a+1][1],e.splice(a-1,1),o=!0):e[a][1].substring(0,e[a+1][1].length)==e[a+1][1]&&(e[a-1][1]+=e[a+1][1],e[a][1]=e[a][1].substring(e[a+1][1].length)+e[a+1][1],e.splice(a+1,1),o=!0)),a++;o&&this.diff_cleanupMerge(e)},At.prototype.diff_xIndex=function(e,t){var a,l=0,i=0,n=0,s=0;for(a=0;a<e.length&&(1!==e[a][0]&&(l+=e[a][1].length),e[a][0]!==Pt&&(i+=e[a][1].length),!(l>t));a++)n=l,s=i;return e.length!=a&&e[a][0]===Pt?s:s+(t-n)},At.prototype.diff_prettyHtml=function(e){for(var t=[],a=/&/g,l=/</g,i=/>/g,n=/\n/g,s=0;s<e.length;s++){var o=e[s][0],r=e[s][1].replace(a,"&amp;").replace(l,"&lt;").replace(i,"&gt;").replace(n,"&para;<br>");switch(o){case 1:t[s]='<ins style="background:#e6ffe6;">'+r+"</ins>";break;case Pt:t[s]='<del style="background:#ffe6e6;">'+r+"</del>";break;case 0:t[s]="<span>"+r+"</span>"}}return t.join("")},At.prototype.diff_text1=function(e){for(var t=[],a=0;a<e.length;a++)1!==e[a][0]&&(t[a]=e[a][1]);return t.join("")},At.prototype.diff_text2=function(e){for(var t=[],a=0;a<e.length;a++)e[a][0]!==Pt&&(t[a]=e[a][1]);return t.join("")},At.prototype.diff_levenshtein=function(e){for(var t=0,a=0,l=0,i=0;i<e.length;i++){var n=e[i][0],s=e[i][1];switch(n){case 1:a+=s.length;break;case Pt:l+=s.length;break;case 0:t+=Math.max(a,l),a=0,l=0}}return t+=Math.max(a,l)},At.prototype.diff_toDelta=function(e){for(var t=[],a=0;a<e.length;a++)switch(e[a][0]){case 1:t[a]="+"+encodeURI(e[a][1]);break;case Pt:t[a]="-"+e[a][1].length;break;case 0:t[a]="="+e[a][1].length}return t.join("\t").replace(/%20/g," ")},At.prototype.diff_fromDelta=function(e,t){for(var a=[],l=0,i=0,n=t.split(/\t/g),s=0;s<n.length;s++){var o=n[s].substring(1);switch(n[s].charAt(0)){case"+":try{a[l++]=new At.Diff(1,decodeURI(o))}catch(u){throw new Error("Illegal escape in diff_fromDelta: "+o)}break;case"-":case"=":var r=parseInt(o,10);if(isNaN(r)||r<0)throw new Error("Invalid number in diff_fromDelta: "+o);var c=e.substring(i,i+=r);"="==n[s].charAt(0)?a[l++]=new At.Diff(0,c):a[l++]=new At.Diff(Pt,c);break;default:if(n[s])throw new Error("Invalid diff operation in diff_fromDelta: "+n[s])}}if(i!=e.length)throw new Error("Delta length ("+i+") does not equal source text length ("+e.length+").");return a},At.prototype.match_main=function(e,t,a){if(null==e||null==t||null==a)throw new Error("Null input. (match_main)");return a=Math.max(0,Math.min(a,e.length)),e==t?0:e.length?e.substring(a,a+t.length)==t?a:this.match_bitap_(e,t,a):-1},At.prototype.match_bitap_=function(e,t,a){if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var l=this.match_alphabet_(t),i=this;function n(e,l){var n=e/t.length,s=Math.abs(a-l);return i.Match_Distance?n+s/i.Match_Distance:s?1:n}var s=this.Match_Threshold,o=e.indexOf(t,a);-1!=o&&(s=Math.min(n(0,o),s),-1!=(o=e.lastIndexOf(t,a+t.length))&&(s=Math.min(n(0,o),s)));var r,c,u=1<<t.length-1;o=-1;for(var p,d=t.length+e.length,f=0;f<t.length;f++){for(r=0,c=d;r<c;)n(f,a+c)<=s?r=c:d=c,c=Math.floor((d-r)/2+r);d=c;var h=Math.max(1,a-c+1),m=Math.min(a+c,e.length)+t.length,v=Array(m+2);v[m+1]=(1<<f)-1;for(var g=m;g>=h;g--){var y=l[e.charAt(g-1)];if(v[g]=0===f?(v[g+1]<<1|1)&y:(v[g+1]<<1|1)&y|(p[g+1]|p[g])<<1|1|p[g+1],v[g]&u){var b=n(f,g-1);if(b<=s){if(s=b,!((o=g-1)>a))break;h=Math.max(1,2*a-o)}}}if(n(f+1,a)>s)break;p=v}return o},At.prototype.match_alphabet_=function(e){for(var t={},a=0;a<e.length;a++)t[e.charAt(a)]=0;for(a=0;a<e.length;a++)t[e.charAt(a)]|=1<<e.length-a-1;return t},At.prototype.patch_addContext_=function(e,t){if(0!=t.length){if(null===e.start2)throw Error("patch not initialized");for(var a=t.substring(e.start2,e.start2+e.length1),l=0;t.indexOf(a)!=t.lastIndexOf(a)&&a.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)l+=this.Patch_Margin,a=t.substring(e.start2-l,e.start2+e.length1+l);l+=this.Patch_Margin;var i=t.substring(e.start2-l,e.start2);i&&e.diffs.unshift(new At.Diff(0,i));var n=t.substring(e.start2+e.length1,e.start2+e.length1+l);n&&e.diffs.push(new At.Diff(0,n)),e.start1-=i.length,e.start2-=i.length,e.length1+=i.length+n.length,e.length2+=i.length+n.length}},At.prototype.patch_make=function(e,t,a){var l,i;if("string"==typeof e&&"string"==typeof t&&void 0===a)l=e,(i=this.diff_main(l,t,!0)).length>2&&(this.diff_cleanupSemantic(i),this.diff_cleanupEfficiency(i));else if(e&&"object"==typeof e&&void 0===t&&void 0===a)i=e,l=this.diff_text1(i);else if("string"==typeof e&&t&&"object"==typeof t&&void 0===a)l=e,i=t;else{if("string"!=typeof e||"string"!=typeof t||!a||"object"!=typeof a)throw new Error("Unknown call format to patch_make.");l=e,i=a}if(0===i.length)return[];for(var n=[],s=new At.patch_obj,o=0,r=0,c=0,u=l,p=l,d=0;d<i.length;d++){var f=i[d][0],h=i[d][1];switch(o||0===f||(s.start1=r,s.start2=c),f){case 1:s.diffs[o++]=i[d],s.length2+=h.length,p=p.substring(0,c)+h+p.substring(c);break;case Pt:s.length1+=h.length,s.diffs[o++]=i[d],p=p.substring(0,c)+p.substring(c+h.length);break;case 0:h.length<=2*this.Patch_Margin&&o&&i.length!=d+1?(s.diffs[o++]=i[d],s.length1+=h.length,s.length2+=h.length):h.length>=2*this.Patch_Margin&&o&&(this.patch_addContext_(s,u),n.push(s),s=new At.patch_obj,o=0,u=p,r=c)}1!==f&&(r+=h.length),f!==Pt&&(c+=h.length)}return o&&(this.patch_addContext_(s,u),n.push(s)),n},At.prototype.patch_deepCopy=function(e){for(var t=[],a=0;a<e.length;a++){var l=e[a],i=new At.patch_obj;i.diffs=[];for(var n=0;n<l.diffs.length;n++)i.diffs[n]=new At.Diff(l.diffs[n][0],l.diffs[n][1]);i.start1=l.start1,i.start2=l.start2,i.length1=l.length1,i.length2=l.length2,t[a]=i}return t},At.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var a=this.patch_addPadding(e);t=a+t+a,this.patch_splitMax(e);for(var l=0,i=[],n=0;n<e.length;n++){var s,o,r=e[n].start2+l,c=this.diff_text1(e[n].diffs),u=-1;if(c.length>this.Match_MaxBits?-1!=(s=this.match_main(t,c.substring(0,this.Match_MaxBits),r))&&(-1==(u=this.match_main(t,c.substring(c.length-this.Match_MaxBits),r+c.length-this.Match_MaxBits))||s>=u)&&(s=-1):s=this.match_main(t,c,r),-1==s)i[n]=!1,l-=e[n].length2-e[n].length1;else if(i[n]=!0,l=s-r,c==(o=-1==u?t.substring(s,s+c.length):t.substring(s,u+this.Match_MaxBits)))t=t.substring(0,s)+this.diff_text2(e[n].diffs)+t.substring(s+c.length);else{var p=this.diff_main(c,o,!1);if(c.length>this.Match_MaxBits&&this.diff_levenshtein(p)/c.length>this.Patch_DeleteThreshold)i[n]=!1;else{this.diff_cleanupSemanticLossless(p);for(var d,f=0,h=0;h<e[n].diffs.length;h++){var m=e[n].diffs[h];0!==m[0]&&(d=this.diff_xIndex(p,f)),1===m[0]?t=t.substring(0,s+d)+m[1]+t.substring(s+d):m[0]===Pt&&(t=t.substring(0,s+d)+t.substring(s+this.diff_xIndex(p,f+m[1].length))),m[0]!==Pt&&(f+=m[1].length)}}}}return[t=t.substring(a.length,t.length-a.length),i]},At.prototype.patch_addPadding=function(e){for(var t=this.Patch_Margin,a="",l=1;l<=t;l++)a+=String.fromCharCode(l);for(l=0;l<e.length;l++)e[l].start1+=t,e[l].start2+=t;var i=e[0],n=i.diffs;if(0==n.length||0!=n[0][0])n.unshift(new At.Diff(0,a)),i.start1-=t,i.start2-=t,i.length1+=t,i.length2+=t;else if(t>n[0][1].length){var s=t-n[0][1].length;n[0][1]=a.substring(n[0][1].length)+n[0][1],i.start1-=s,i.start2-=s,i.length1+=s,i.length2+=s}return 0==(n=(i=e[e.length-1]).diffs).length||0!=n[n.length-1][0]?(n.push(new At.Diff(0,a)),i.length1+=t,i.length2+=t):t>n[n.length-1][1].length&&(s=t-n[n.length-1][1].length,n[n.length-1][1]+=a.substring(0,s),i.length1+=s,i.length2+=s),a},At.prototype.patch_splitMax=function(e){for(var t=this.Match_MaxBits,a=0;a<e.length;a++)if(!(e[a].length1<=t)){var l=e[a];e.splice(a--,1);for(var i=l.start1,n=l.start2,s="";0!==l.diffs.length;){var o=new At.patch_obj,r=!0;for(o.start1=i-s.length,o.start2=n-s.length,""!==s&&(o.length1=o.length2=s.length,o.diffs.push(new At.Diff(0,s)));0!==l.diffs.length&&o.length1<t-this.Patch_Margin;){var c=l.diffs[0][0],u=l.diffs[0][1];1===c?(o.length2+=u.length,n+=u.length,o.diffs.push(l.diffs.shift()),r=!1):c===Pt&&1==o.diffs.length&&0==o.diffs[0][0]&&u.length>2*t?(o.length1+=u.length,i+=u.length,r=!1,o.diffs.push(new At.Diff(c,u)),l.diffs.shift()):(u=u.substring(0,t-o.length1-this.Patch_Margin),o.length1+=u.length,i+=u.length,0===c?(o.length2+=u.length,n+=u.length):r=!1,o.diffs.push(new At.Diff(c,u)),u==l.diffs[0][1]?l.diffs.shift():l.diffs[0][1]=l.diffs[0][1].substring(u.length))}s=(s=this.diff_text2(o.diffs)).substring(s.length-this.Patch_Margin);var p=this.diff_text1(l.diffs).substring(0,this.Patch_Margin);""!==p&&(o.length1+=p.length,o.length2+=p.length,0!==o.diffs.length&&0===o.diffs[o.diffs.length-1][0]?o.diffs[o.diffs.length-1][1]+=p:o.diffs.push(new At.Diff(0,p))),r||e.splice(++a,0,o)}}},At.prototype.patch_toText=function(e){for(var t=[],a=0;a<e.length;a++)t[a]=e[a];return t.join("")},At.prototype.patch_fromText=function(e){var t=[];if(!e)return t;for(var a=e.split("\n"),l=0,i=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;l<a.length;){var n=a[l].match(i);if(!n)throw new Error("Invalid patch string: "+a[l]);var s=new At.patch_obj;for(t.push(s),s.start1=parseInt(n[1],10),""===n[2]?(s.start1--,s.length1=1):"0"==n[2]?s.length1=0:(s.start1--,s.length1=parseInt(n[2],10)),s.start2=parseInt(n[3],10),""===n[4]?(s.start2--,s.length2=1):"0"==n[4]?s.length2=0:(s.start2--,s.length2=parseInt(n[4],10)),l++;l<a.length;){var o=a[l].charAt(0);try{var r=decodeURI(a[l].substring(1))}catch(c){throw new Error("Illegal escape in patch_fromText: "+r)}if("-"==o)s.diffs.push(new At.Diff(Pt,r));else if("+"==o)s.diffs.push(new At.Diff(1,r));else if(" "==o)s.diffs.push(new At.Diff(0,r));else{if("@"==o)break;if(""!==o)throw new Error('Invalid patch mode "'+o+'" in: '+r)}l++}}return t},(At.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0}).prototype.toString=function(){for(var e,t=["@@ -"+(0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1)+" +"+(0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2)+" @@\n"],a=0;a<this.diffs.length;a++){switch(this.diffs[a][0]){case 1:e="+";break;case Pt:e="-";break;case 0:e=" "}t[a+1]=e+encodeURI(this.diffs[a][1])+"\n"}return t.join("").replace(/%20/g," ")},Ot.exports=At,Ot.exports.diff_match_patch=At,Ot.exports.DIFF_DELETE=Pt,Ot.exports.DIFF_INSERT=1,Ot.exports.DIFF_EQUAL=0;var zt={DIFF_EQUAL:0,DIFF_DELETE:-1,DIFF_INSERT:1,EDITOR_RIGHT:"right",EDITOR_LEFT:"left",RTL:"rtl",LTR:"ltr",SVG_NS:"http://www.w3.org/2000/svg",DIFF_GRANULARITY_SPECIFIC:"specific",DIFF_GRANULARITY_BROAD:"broad"};const qt=zt;const Vt=zt;const Ht=jt.exports,Bt=function e(t,a){return Mt(t)&&Mt(a)&&Object.keys(a).forEach((l=>{Mt(a[l])?(t[l]&&Mt(t[l])||(t[l]=a[l]),e(t[l],a[l])):Object.assign(t,{[l]:a[l]})})),t},Gt=function(e,t,a=!1){let l=null,i=!0;return(...n)=>{const s=()=>{e.apply(this,n),l=null};a&&i&&(i=!1,s()),l||(l=setTimeout(s,t))}},Wt=function(e,t){let a;return(...l)=>{const i=this;clearTimeout(a),a=setTimeout((()=>e.apply(i,l)),t)}},Ut=function(e=""){return e.replace(/\r\n/g,"\n")},Jt=function(e,t,a,l){const i=e+(a-e)/2;return"M ".concat(e," ").concat(t," C ").concat(i,",").concat(t," ").concat(i,",").concat(l," ").concat(a,",").concat(l)},$t=function(e,t){let{mode:a}=e.options;return t===qt.EDITOR_LEFT&&null!==e.options.left.mode&&(a=e.options.left.mode),t===qt.EDITOR_RIGHT&&null!==e.options.right.mode&&(a=e.options.right.mode),a},Kt=function(e,t){let{theme:a}=e.options;return t===Vt.EDITOR_LEFT&&null!==e.options.left.theme&&(a=e.options.left.theme),t===Vt.EDITOR_RIGHT&&null!==e.options.right.theme&&(a=e.options.right.theme),a},Yt=function(e,t){return e.ace.getSession().doc.getLine(t)},Xt=function(e){return document.getElementById(e.options.left.id).offsetHeight},Qt=function(e){const t=document.createElement("div"),a={class:e.className,style:"top:".concat(e.topOffset,"px"),title:e.tooltip,"data-diff-index":e.diffIndex};for(const l in a)t.setAttribute(l,a[l]);return t.innerHTML=e.arrowContent,t},Zt=function(e,t){const a=Math.random().toString(36).substr(2,5),l="js-".concat(t,"-").concat(a),i=e.querySelector(".".concat(t));if(i)return i.id=i.id||l,i.id;const n=document.createElement("div");return e.appendChild(n),n.className=t,n.id=l,n.id},ea={on:function(e,t,a,l){const i="document"===e?document:document.querySelector(e);i.addEventListener(t,(e=>{const t=i.querySelectorAll(a),{target:n}=e;for(let a=0,s=t.length;a<s;a+=1){let s=n;const o=t[a];for(;s&&s!==i;)s===o&&l.call(o,e),s=s.parentNode}}))}},ta=zt;let aa;function la(e={}){if(!(this instanceof la))return new la(e);const t=this;t.options=Bt({ace:window?window.ace:void 0,mode:null,theme:null,element:null,diffGranularity:ta.DIFF_GRANULARITY_BROAD,lockScrolling:!1,showDiffs:!0,showConnectors:!0,maxDiffs:5e3,left:{id:null,content:null,mode:null,theme:null,editable:!0,copyLinkEnabled:!0},right:{id:null,content:null,mode:null,theme:null,editable:!0,copyLinkEnabled:!0},classes:{gutterID:"acediff__gutter",diff:"acediff__diffLine",connector:"acediff__connector",newCodeConnectorLink:"acediff__newCodeConnector",newCodeConnectorLinkContent:"&#8594;",deletedCodeConnectorLink:"acediff__deletedCodeConnector",deletedCodeConnectorLinkContent:"&#8592;",copyRightContainer:"acediff__copy--right",copyLeftContainer:"acediff__copy--left"},connectorYOffset:0},e);const{ace:a}=t.options;if(!a){return new Error("No ace editor found nor supplied - `options.ace` or `window.ace` is missing")}if(aa=function(e){if(e.Range)return e.Range;const t=e.acequire||e.require;return!!t&&t("ace/range")}(a),!aa){return new Error("Could not require Range module for Ace. Depends on your bundling strategy, but it usually comes with Ace itself. See https://ace.c9.io/api/range.html, open an issue on GitHub ace-diff/ace-diff")}if(null===t.options.element){return new Error("You need to specify an element for Ace-diff - `options.element` is missing")}if(t.options.element instanceof HTMLElement?t.el=t.options.element:t.el=document.body.querySelector(t.options.element),!t.el){const e="Can't find the specified element ".concat(t.options.element);return new Error(e)}t.options.left.id=Zt(t.el,"acediff__left"),t.options.classes.gutterID=Zt(t.el,"acediff__gutter"),t.options.right.id=Zt(t.el,"acediff__right"),t.el.innerHTML='<div class="acediff__wrap">'.concat(t.el.innerHTML,"</div>"),t.editors={left:{ace:a.edit(t.options.left.id),markers:[],lineLengths:[]},right:{ace:a.edit(t.options.right.id),markers:[],lineLengths:[]},editorHeight:null},t.editors.left.ace.getSession().setMode($t(t,ta.EDITOR_LEFT)),t.editors.right.ace.getSession().setMode($t(t,ta.EDITOR_RIGHT)),t.editors.left.ace.setReadOnly(!t.options.left.editable),t.editors.right.ace.setReadOnly(!t.options.right.editable),t.editors.left.ace.setTheme(Kt(t,ta.EDITOR_LEFT)),t.editors.right.ace.setTheme(Kt(t,ta.EDITOR_RIGHT)),t.editors.left.ace.setValue(Ut(t.options.left.content),-1),t.editors.right.ace.setValue(Ut(t.options.right.content),-1),t.editors.editorHeight=Xt(t),setTimeout((()=>{t.lineHeight=t.editors.left.ace.renderer.lineHeight,function(e){e.editors.left.ace.getSession().on("changeScrollTop",Gt((()=>{ra(e)}),16)),e.editors.right.ace.getSession().on("changeScrollTop",Gt((()=>{ra(e)}),16));const t=e.diff.bind(e);e.editors.left.ace.on("change",t),e.editors.right.ace.on("change",t),e.options.left.copyLinkEnabled&&ea.on("#".concat(e.options.classes.gutterID),"click",".".concat(e.options.classes.newCodeConnectorLink),(t=>{na(e,t,ta.LTR)}));e.options.right.copyLinkEnabled&&ea.on("#".concat(e.options.classes.gutterID),"click",".".concat(e.options.classes.deletedCodeConnectorLink),(t=>{na(e,t,ta.RTL)}));const a=Wt((()=>{e.editors.availableHeight=document.getElementById(e.options.left.id).offsetHeight,e.diff()}),250);window.addEventListener("resize",a),ia=()=>{window.removeEventListener("resize",a)}}(t),function(e){e.copyRightContainer=document.createElement("div"),e.copyRightContainer.setAttribute("class",e.options.classes.copyRightContainer),e.copyLeftContainer=document.createElement("div"),e.copyLeftContainer.setAttribute("class",e.options.classes.copyLeftContainer),document.getElementById(e.options.classes.gutterID).appendChild(e.copyRightContainer),document.getElementById(e.options.classes.gutterID).appendChild(e.copyLeftContainer)}(t),ma(t),t.diff()}),1)}la.prototype={setOptions(e){Bt(this.options,e),this.diff()},getNumDiffs(){return this.diffs.length},getEditors(){return{left:this.editors.left.ace,right:this.editors.right.ace}},diff(){const e=new Ht,t=this.editors.left.ace.getSession().getValue(),a=this.editors.right.ace.getSession().getValue(),l=e.diff_main(a,t);e.diff_cleanupSemantic(l),this.editors.left.lineLengths=sa(this.editors.left),this.editors.right.lineLengths=sa(this.editors.right);const i=[],n={left:0,right:0};l.forEach(((e,t,a)=>{const s=e[0];let o=e[1];a[t+1]&&o.endsWith("\n")&&a[t+1][1].startsWith("\n")&&(o+="\n",l[t][1]=o,l[t+1][1]=l[t+1][1].replace(/^\n/,"")),0!==o.length&&(s===ta.DIFF_EQUAL?(n.left+=o.length,n.right+=o.length):s===ta.DIFF_DELETE?(i.push(ua(this,ta.DIFF_DELETE,n.left,n.right,o)),n.right+=o.length):s===ta.DIFF_INSERT&&(i.push(ua(this,ta.DIFF_INSERT,n.left,n.right,o)),n.left+=o.length))}),this),this.diffs=function(e,t){const a=[];function l(t){return e.options.diffGranularity===ta.DIFF_GRANULARITY_SPECIFIC?t<1:t<=1}t.forEach(((e,t)=>{if(0===t)return void a.push(e);let i=!1;for(let n=0;n<a.length;n+=1)if(l(Math.abs(e.leftStartLine-a[n].leftEndLine))&&l(Math.abs(e.rightStartLine-a[n].rightEndLine))){a[n].leftStartLine=Math.min(e.leftStartLine,a[n].leftStartLine),a[n].rightStartLine=Math.min(e.rightStartLine,a[n].rightStartLine),a[n].leftEndLine=Math.max(e.leftEndLine,a[n].leftEndLine),a[n].rightEndLine=Math.max(e.rightEndLine,a[n].rightEndLine),i=!0;break}i||a.push(e)}));const i=[];return a.forEach((e=>{e.leftStartLine===e.leftEndLine&&e.rightStartLine===e.rightEndLine||i.push(e)})),i}(this,i),this.diffs.length>this.options.maxDiffs||(ca(this),ga(this))},destroy(){const e=this.editors.left.ace.getValue();this.editors.left.ace.destroy();let t=this.editors.left.ace.container,a=t.cloneNode(!1);a.textContent=e,t.parentNode.replaceChild(a,t);const l=this.editors.right.ace.getValue();this.editors.right.ace.destroy(),t=this.editors.right.ace.container,a=t.cloneNode(!1),a.textContent=l,t.parentNode.replaceChild(a,t),document.getElementById(this.options.classes.gutterID).innerHTML="",ia()}};let ia=()=>{};function na(e,t,a){const l=parseInt(t.target.getAttribute("data-diff-index"),10),i=e.diffs[l];let n,s,o,r,c,u;a===ta.LTR?(n=e.editors.left,s=e.editors.right,o=i.leftStartLine,r=i.leftEndLine,c=i.rightStartLine,u=i.rightEndLine):(n=e.editors.right,s=e.editors.left,o=i.rightStartLine,r=i.rightEndLine,c=i.leftStartLine,u=i.leftEndLine);let p="";for(let f=o;f<r;f+=1)p+="".concat(Yt(n,f),"\n");const d=s.ace.getSession().getScrollTop();s.ace.getSession().replace(new aa(c,0,u,0),p),s.ace.getSession().setScrollTop(parseInt(d,10)),e.diff()}function sa(e){const t=e.ace.getSession().doc.getAllLines(),a=[];return t.forEach((e=>{a.push(e.length+1)})),a}function oa(e,t,a,l,i){const n=e.editors[t];l<a&&(l=a);const s="".concat(i," ").concat(l>a?"lines":"targetOnly");n.markers.push(n.ace.session.addMarker(new aa(a,0,l-1,1),s,"fullLine"))}function ra(e){ca(e),ga(e),function(e){const t=e.editors.left.ace.getSession().getScrollTop(),a=e.editors.right.ace.getSession().getScrollTop();e.copyRightContainer.style.cssText="top: ".concat(-t,"px"),e.copyLeftContainer.style.cssText="top: ".concat(-a,"px")}(e)}function ca(e){e.editors.left.markers.forEach((t=>{e.editors.left.ace.getSession().removeMarker(t)}),e),e.editors.right.markers.forEach((t=>{e.editors.right.ace.getSession().removeMarker(t)}),e)}function ua(e,t,a,l,i){let n={},s=/^\n/.test(i);if(t===ta.DIFF_INSERT){var o=pa(e.editors.left,a,i),r=fa(e.editors.right,l),c=da(e.editors.right,r);const t=da(e.editors.left,o.startLine);let d=r;0===da(e.editors.left,o.startLine)&&s&&(s=!1),0===o.startChar&&ha(e.editors.right,l,s)&&(d=r+1);var u=o.startLine===o.endLine,p=0;(o.startChar>0||u&&i.length<t)&&c>0&&o.startChar<t&&p++,n={leftStartLine:o.startLine,leftEndLine:o.endLine+1,rightStartLine:d,rightEndLine:d+p}}else{o=pa(e.editors.right,l,i),r=fa(e.editors.left,a),c=da(e.editors.left,r);const t=da(e.editors.right,o.startLine);let d=r;0===da(e.editors.right,o.startLine)&&s&&(s=!1),0===o.startChar&&ha(e.editors.left,a,s)&&(d=r+1);u=o.startLine===o.endLine,p=0;(o.startChar>0||u&&i.length<t)&&c>0&&o.startChar<t&&p++,n={leftStartLine:d,leftEndLine:d+p,rightStartLine:o.startLine,rightEndLine:o.endLine+1}}return n}function pa(e,t,a){const l={startLine:0,startChar:0,endLine:0,endChar:0},i=t+a.length;let n=0,s=!1,o=!1;e.lineLengths.forEach(((e,a)=>{n+=e,!s&&t<n&&(l.startLine=a,l.startChar=t-n+e,s=!0),!o&&i<=n&&(l.endLine=a,l.endChar=i-n+e,o=!0)})),l.startChar>0&&da(e,l.startLine)===l.startChar&&(l.startLine++,l.startChar=0),0===l.endChar&&l.endLine--;const r=/\n$/.test(a);return l.startChar>0&&r&&l.endLine++,l}function da(e,t){return Yt(e,t).length}function fa(e,t){const a=e.ace.getSession().doc.getAllLines();let l=0,i=0;for(let n=0;n<a.length;n+=1)if(i+=a[n].length+1,t<=i){l=n;break}return l}function ha(e,t,a){const l=e.ace.getSession().doc.getAllLines();let i=0;for(let n=0;n<l.length;n+=1){i+=l[n].length+1;let e=i;if(a&&(e-=1),t===e)break}return ha}function ma(e){e.gutterHeight=document.getElementById(e.options.classes.gutterID).clientHeight,e.gutterWidth=document.getElementById(e.options.classes.gutterID).clientWidth;const t=va(e,ta.EDITOR_LEFT),a=va(e,ta.EDITOR_RIGHT),l=Math.max(t,a,e.gutterHeight);e.gutterSVG=document.createElementNS(ta.SVG_NS,"svg"),e.gutterSVG.setAttribute("width",e.gutterWidth),e.gutterSVG.setAttribute("height",l),document.getElementById(e.options.classes.gutterID).appendChild(e.gutterSVG)}function va(e,t){return(t===ta.EDITOR_LEFT?e.editors.left:e.editors.right).ace.getSession().getLength()*e.lineHeight}function ga(e){!function(e){document.getElementById(e.options.classes.gutterID).removeChild(e.gutterSVG),ma(e)}(e),function(e){e.copyLeftContainer.innerHTML="",e.copyRightContainer.innerHTML=""}(e),e.diffs.forEach(((t,a)=>{e.options.showDiffs&&(oa(e,ta.EDITOR_LEFT,t.leftStartLine,t.leftEndLine,e.options.classes.diff),oa(e,ta.EDITOR_RIGHT,t.rightStartLine,t.rightEndLine,e.options.classes.diff),e.options.showConnectors&&function(e,t,a,l,i){const n=e.editors.left.ace.getSession().getScrollTop(),s=e.editors.right.ace.getSession().getScrollTop();e.connectorYOffset=1;const o=t*e.lineHeight-n+.5,r=e.gutterWidth+1,c=l*e.lineHeight-s+.5,u=a*e.lineHeight-n+e.connectorYOffset+.5,p=e.gutterWidth+1,d=i*e.lineHeight-s+e.connectorYOffset+.5,f=Jt(-1,o,r,c),h=Jt(p,d,-1,u),m="L".concat(r,",").concat(c," ").concat(p,",").concat(d),v="L".concat(-1,",").concat(u," ").concat(-1,",").concat(o),g="".concat(f," ").concat(m," ").concat(h," ").concat(v),y=document.createElementNS(ta.SVG_NS,"path");y.setAttribute("d",g),y.setAttribute("class",e.options.classes.connector),e.gutterSVG.appendChild(y)}(e,t.leftStartLine,t.leftEndLine,t.rightStartLine,t.rightEndLine),function(e,t,a){if(t.leftEndLine>t.leftStartLine&&e.options.left.copyLinkEnabled){const l=Qt({className:e.options.classes.newCodeConnectorLink,topOffset:t.leftStartLine*e.lineHeight,tooltip:"Copy to right",diffIndex:a,arrowContent:e.options.classes.newCodeConnectorLinkContent});e.copyRightContainer.appendChild(l)}if(t.rightEndLine>t.rightStartLine&&e.options.right.copyLinkEnabled){const l=Qt({className:e.options.classes.deletedCodeConnectorLink,topOffset:t.rightStartLine*e.lineHeight,tooltip:"Copy to left",diffIndex:a,arrowContent:e.options.classes.deletedCodeConnectorLinkContent});e.copyLeftContainer.appendChild(l)}}(e,t,a))}),e)}const ya=Rt(la),ba=t(),wa=I("");let _a=I([]);const Ea=I(null),Sa=I(null),La=I([]),Ta=I(!1),Ca=I(!0),Da=I(null),xa=I(null),ka=I(null),Ra=()=>{Ea.value=null,Sa.value=null,Ta.value=!1},Ia=async(e,t,a)=>{let l={p:1,showRow:500,sort:"name",reverse:"False",path:e,search:t||""};a&&(l.all=a);try{const{data:e}=await oe(l),t=[],a=[];return e.dir.forEach((a=>{t.push(Zn("dir",a,void 0,e.path))})),e.files.forEach((t=>{a.push(Zn("file",t,void 0,e.path))})),[...t,...a]}catch(i){return[]}},Na=async(e,t,a)=>{if(e.data.isNew)return t([]);const l=Tl(Xa.id||"");if(La.value=La.value.filter((e=>".Recycle_bin"!==e)),".Recycle_bin"===e.data.fileName)return ba.error("此为回收站目录，请在右上角按【回收站】按钮打开"),void t([]);if(0===e.level){const e=((null==l?void 0:l.path)||a.path).split("/");e.pop();const i=await Ia(e.join("/")||"/www");return _a.value=i,t(i)}if(e.level>0){return t(await Ia(e.data.path))}return e.upper?t(e.upper):void 0},Fa=async()=>{La.value.length=0;const e=wa.value;if("/"===e)return void ba.error("已经是根目录了");const t=e.split("/");t.pop();let a=t.join("/");a||(a="/"),wa.value=a;const l=await Ia(a);_a.value=l,Ra()},Oa=async(e,t,a)=>{var l,i;Sa.value||(Ea.value=t),e.isFile&&((null==(l=null==e?void 0:e.path)?void 0:l.includes("/dev/pts"))?ba.error("系统目录文件不支持编辑"):"text"===Cn(null==(i=e.fileName)?void 0:i.split(".").pop())?Rn(e):ba.error("暂不支持该类型文件编辑"))},Aa=(e,t,a)=>{e.preventDefault(),e.stopPropagation(),Sa.value=t||null,a.value.show(e),Ta.value=!1},Pa=async e=>{const t=await Ia(wa.value,null!=e?e:"");_a.value=t,Ra()},ja=(e,t,a)=>{const l=a.value.getNode(t);if(l)if(l.childNodes&&l.childNodes.length>0){const t=l.childNodes[0];a.value.insertBefore(e,t.data)}else a.value.append(e,l.data);else a.value.data.unshift(e),a.value.updateKeyChildren(null,a.value.data);N((()=>{setTimeout((()=>{var e,t,a,l;null==(t=null==(e=ka.value)?void 0:e.$el)||t.focus(),a=ka,l=xa,N((()=>{var e;const t=null==(e=a.value)?void 0:e.$el,i=l.value;if(t&&i){const e=t.getBoundingClientRect(),a=i.getBoundingClientRect();(e.top<a.top||e.bottom>a.bottom)&&(i.scrollTop+=e.top-a.top-(i.clientHeight/2-e.height/2))}}))}),100)})),Ra()},Ma=async()=>{try{La.value.length=0,Ra(),await Pa(),ba.success("刷新成功")}catch(t){e(t)}},za=({data:{path:e,isFile:t}})=>t?e.replace(/\/[^\/]*$/,""):e,qa=e=>{const t=Ea.value,a=Sa.value?Sa.value.path:t?za(t):wa.value,l=t?(e=>e.data.isFile?za(e):e.data.path)(t):null,i={icon:"icon-".concat(e),ext:"",fileName:"",time:"",ps:"",size:0,type:e,user:"root",rootLevel:"0",isLink:"",isShare:!1,isTop:!1,isFav:!1,isOsPs:!1,isSearch:!1,isReName:!0,isNew:!0,isSync:"",isLock:!1,path:"".concat(a,"/"),tamperProofId:0,isFile:"dir"!==e};return Ta.value=!0,{newFile:i,dataPathFileName:l}},Va=()=>{La.value.length=0},Ha=F({__name:"index",props:{rowData:{type:Object,default:()=>({})},refreshData:{type:Function,default:()=>{}},value:{type:Object,default:()=>({})}},emits:["update:value"],setup(e,{expose:i,emit:n}){const s=t(),o=e,r=n,c=I(o.rowData);let u="";const p=(e,t)=>{const a=e.match(/^(.*\/)/),l=a?a[1]:"";return"".concat(l).concat(t)},d=e=>{e.stopPropagation(),e.preventDefault(),c.value.fileName=e.target.value,m({row:c.value})},f=()=>{m({row:c.value})},h=()=>{var e;if(c.value.isReName=!1,c.value.isNew){const t=Da.value.getNode(null==(e=c.value)?void 0:e.path);Da.value.remove(t.data)}Ta.value=!1},m=async({row:e})=>{if(""!==e.fileName)if(rn(e.fileName))s.error('文件名不能包含以下字符：\\ / : * ? " < > |');else if(e.isNew){const t="".concat(e.path,"/").concat(e.fileName);await a({loading:"正在新建文件，请稍候...",request:re({path:t.replace(/\/\//g,"/"),type:e.type}),message:!0,success:t=>{t.status&&(e.isReName=!1,Ta.value=!1,o.refreshData())}})}else{if(e.fileName===u)return void s.error("文件名没有变化");await a({loading:"正在重命名，请稍候...",request:ce({sfile:p(e.path,u),dfile:p(e.path,e.fileName),rename:!0}),message:!0,success:t=>{t.status&&(e.isReName=!1,Ta.value=!1,o.refreshData())}})}else s.error("文件名不能为空")};return O((()=>o.rowData),(()=>{o.rowData&&(c.value=o.rowData,r("update:value",c.value))}),{immediate:!0}),A((()=>{c.value.isReName&&N((()=>{u=c.value.fileName})),Ta.value=c.value.isReName})),i({reNameInputRef:ka}),(e,t)=>{const a=l,i=P("focus");return j((z(),q("div",{class:"flex items-center !w-[100%] pr-[.5rem]",onClick:t[2]||(t[2]=B((()=>{}),["stop"]))},[j(V(a,{ref_key:"reNameInputRef",ref:ka,class:"rename-input h-[20px] ml-2px",width:"auto",modelValue:c.value.fileName,"onUpdate:modelValue":t[0]||(t[0]=e=>c.value.fileName=e),onKeydown:t[1]||(t[1]=H(B((()=>{}),["stop"]),["native"])),onKeyup:H(d,["enter","native"])},null,8,["modelValue"]),[[i]]),G("span",{class:"svgtofont-el-select ml-[.5rem] !text-[2rem] font-800",style:{color:"#20a53a"},onClick:B(f,["stop"])}),G("span",{class:"svgtofont-el-close-bold ml-[.5rem] !text-[2rem] font-800",style:{color:"#f34a4a"},onClick:B(h,["stop"])})],512)),[[M,c.value.isReName]])}}}),Ba=W("FILES-ACE-STORE",(()=>{const{routerActive:e,mainHeight:t}=i(),l=ss(),{bindKeydown:r}=l,c=I(),u=I(),p=I(!0),d=I(!0),f=async()=>{Va(),ul();const e=await u.value;null==e||e.unmount()},h=I([{title:"保存",icon:"svgtofont-el-select",click:()=>{m()&&Gl(Xa)}},{title:"全部保存",icon:"svgtofont-icon-minmax-black",click:()=>{m()&&Jl()}},{title:"刷新",icon:"svgtofont-el-refresh-right",click:async()=>{m()&&Al(Xa,!0)}},{title:"搜索",icon:"svgtofont-el-search",click:()=>{m()&&Ka.value.execCommand("find")}},{title:"替换",icon:"svgtofont-icon-log",click:()=>{m()&&Ka.value.execCommand("replace")}},{title:"跳转行",icon:"svgtofont-icon-login-address",click:()=>{m()&&P("jump")}},{title:"字体大小",icon:"svgtofont-left-xterm",click:()=>{m()&&P("font")}},{title:"主题",icon:"svgtofont-icon-drag",click:()=>{m()&&P("theme")}},{title:"设置",icon:"svgtofont-left-config",click:()=>{m()&&P("set")}},{title:"文件足迹",icon:"svgtofont-left-crontab",click:()=>{$i()}},{title:"快捷键",icon:"svgtofont-el-question-filled",click:()=>{const e=el.value.find((e=>"快捷键"===e.title));if(e)return Ml(e.id),void P("shortcutKey");Ol({type:"custom",title:"快捷键",component:U((()=>n((()=>import("./index189.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)))})}}]),m=()=>!(!Dl()||"custom"===Xa.type)||(s.error("当前页面不支持该操作"),!1),v=I(0),g=I(!1),y=I(null),b=I(""),w=I("btn"),_=I(!1),E=I(""),S=I([]),L=I(""),T=I(null),C=I(null);let D=I();const x=e=>{const t=Da.value.getNode(e);t&&e.isNew&&Da.value.remove(t),t&&e.isReName&&(e.isReName=!1),Ta.value=!1},k=(e,t)=>{x(D.value),Aa(e,t,C)},R=e=>el.value.some((t=>t.path===e.path))?"text-[#cca700]":"",F=I(),O=I(),A=I(!1),P=e=>{Qa.value=e,A.value=""!==e,e&&window.addEventListener("click",j)},j=()=>{Qa.value="",window.removeEventListener("click",j)},M=I(null),z=I(null),q=I({}),H=(e,t)=>{if(Ml(e),t){const e=t.currentTarget||t.currentTarget,a=M.value,l=a.offsetWidth,i=e.offsetLeft-l/2+e.offsetWidth/2;a.scroll({left:i,behavior:"smooth"})}},B=e=>{e.preventDefault();const{deltaY:t}=e;M.value.scrollLeft+=t},{fontSize:G,tabSize:W,editorTheme:K,useSoftTabs:Y}=J(Ja.aceEditor),X=I(Xa.encoding),Q=I(0),Z=$({line:123,column:321,historys:[],tabsData:{type:"nbsp",number:4},encoding:"utf-8",only_read:!1,mode:"text"}),ee=e=>{e&&(Z.tabsData.number=e.tabSize,Z.tabsData.type=e.useSoftTabs?"tab":"nbsp")},te=I(),ae=e=>{el.value=el.value.filter((t=>t.id===e)),$a.value=$a.value.filter((t=>t.id===e)),Fl(e);const t=_l(e);Ka.value.setSession(t),Il(Ka.value),kl(te.value.item.isReadOnly),Rl()},le=()=>{el.value.forEach((e=>{const t=_l(e.id);t&&t.destroy()})),el.value=[],$a.value=[],Ka.value.setSession(null)};return{instance:u,fileItem:c,routerActive:e,btnShow:p,catalogueShow:d,onLeave:()=>{p.value=!1,setTimeout((()=>{p.value=!0}),500)},close:f,onCancel:async()=>(await $l()?nn(f):(localStorage.removeItem("aceEditor"),Vl(),f()),!1),column:h,openPopup:e=>{Dl?e.click():s.error("当前页面不支持该操作")},mainHeight:t,operSize:v,changeOpertion:e=>{v.value="search"===e?76:0},isShow:g,inputRef:y,inputFocus:()=>{g.value=!0,N((()=>{var e;null==(e=y.value)||e.focus()}))},originalPath:b,changeCurrentPath:async()=>{try{if(g.value=!1,wa.value!==b.value){b.value=wa.value;const{data:e}=await a({request:oe({p:1,showRow:500,sort:"name",reverse:"False",path:wa.value})}),t=e.dir.map((t=>Zn("dir",t,void 0,e.path))),l=e.files.map((t=>Zn("file",t,void 0,e.path)));_a.value=[...t,...l],wa.value=e.path}}catch(e){}},type:w,isCheck:_,searchValue:E,changeValue:e=>{La.value.length=0,E.value="","search"===e?(S.value=_a.value,L.value=wa.value,_a.value=[],Ca.value=!0):(_a.value=S.value,""===wa.value&&(b.value=L.value),wa.value=L.value)},searchFile:async()=>{const e=await Ia(wa.value,E.value,_.value?"True":void 0);Ca.value=!1,e&&(_a.value=e,Ra())},handleCommand:e=>{var t,a;const{newFile:l,dataPathFileName:i}=qa(e),n=i||((null==(t=Sa.value)?void 0:t.isFile)||null==(a=Sa.value)?void 0:a.path);if(n){const e=Da.value.getNode(n);e&&(e.expanded=!0)}ja(l,n,Da)},closeSearch:()=>{w.value="btn",Ra()},contextRef:C,treeProps:{label:"fileName",key:"path",isLeaf:"isFile"},initSidebarList:()=>{N((()=>{const e=(c.value.path||"/www").split("/");e.pop(),""===wa.value&&(b.value=e.join("/")),wa.value=e.join("/")}))},loadNode:async(e,t,...a)=>{Na(e,t,c.value)},renderTree:(e,{node:t,data:a,store:l})=>{const{mode:i}=Ll(a.fileName);return V("span",{class:"flex flex-1 items-center w-full ".concat(a.isReName?"newFiles":"defaultFiles"),onContextmenu:e=>{e.preventDefault(),k(e,a)}},[V("span",{class:"icon-editor-left ".concat(a.isFile?"ace-".concat(i,"-icon ace-text-icon"):"ace-folder-icon")},null),a.isReName?V(Ha,{class:"el-tree-node__label",title:a.fileName,rowData:a,refreshData:Pa,modelValue:D,"onUpdate:modelValue":e=>D=e,ref:T},null):V("span",{class:"el-tree-node__label ".concat(R(a)),title:a.fileName},[a.fileName])])},handleExpandChange:e=>{(null==e?void 0:e.path)&&!La.value.includes(e.path)&&La.value.push(e.path)},handleCollapseChange:e=>{const t=La.value.indexOf(null==e?void 0:e.path);-1!==t&&La.value.splice(t,1),x(D.value)},editorRef:F,editorDiffRef:O,showToolbar:A,watchEditorCustomToolbar:P,closeToolbar:j,initContent:async()=>{await(async e=>{await dl(),Ka.value=await ml(e),ee(Ja.aceEditor)})(F.value),c.value&&await Ol({title:c.value.fileName,type:c.value.type||"editor",path:c.value.path,size:c.value.size}),(async e=>{vl(e)})(O.value),await ue({name:c.value.fileName,path:c.value.path}),await cl()},resizeEditor:()=>{Ka.value&&N((()=>{Ka.value.resize()}))},tabsElement:M,contextmenu:z,headerRightRow:q,changeTab:H,getDataChangeTab:()=>{N((()=>{const e=el.value[el.value.length-1],t=M.value.children[el.value.length-1];H(e.id,{currentTarget:t})}))},closeTab:async e=>{Pl(e)},openContextMenu:e=>{z.value.show(e),q.value=Xa},initContentHeader:()=>{N((()=>{M.value.addEventListener("wheel",B)}))},$resetContentHeader:()=>{M.value&&M.value.removeEventListener("wheel",B)},fontSize:G,tabSize:W,editorTheme:K,useSoftTabs:Y,encodingData:X,line:Q,tool:[{title:"跳转到指定行",type:"jump"},{title:"设置编辑器字体大小",type:"font"},{title:"设置编辑器主题",type:"theme"},{title:"编辑器设置",type:"set"},{title:"设置文件保存编码格式",type:"encode"},{title:"设置文件保存空格设置",type:"encode"}],set:[{title:"自动换行",type:"wrap"},{title:"代码自动完成",type:"enableLiveAutocompletion"},{title:"启用代码段",type:"enableSnippets"},{title:"显示隐藏字符",type:"showInvisibles"},{title:"显示行号",type:"showLineNumbers"}],tabData:[{title:"使用空格缩进",type:"nbsp"},{title:"使用制表符缩进",type:"tab"}],unTitleArr:["shortcutKey","","tab"],saveFont:()=>{Ja.aceEditor.fontSize>45||Ja.aceEditor.fontSize<12?s.error("字体设置范围超过12-45"):(Ka.value.setFontSize(Ja.aceEditor.fontSize),fl())},jumpLine:()=>{Q.value%1==0?Ka.value.gotoLine(Q.value):s.error("请输入整数")},setCode:async e=>{Xa.state=1,Xa.encoding=e,await fl(),await Gl(Xa),X.value=e},setTabType:e=>{"string"==typeof e?(Y.value="tab"===e,Ja.aceEditor.useSoftTabs="tab"===e):(W.value=e,Ja.aceEditor.tabSize=e),fl()},setTheme:e=>{K.value=e,Ka.value.setTheme("ace/theme/"+e),Ja.aceEditor.editorTheme=e,fl()},seting:e=>{Ja.aceEditor[e]=!Ja.aceEditor[e],Ka.value.setOption(e,Ja.aceEditor[e]),fl(),ee(Ja.aceEditor)},fileInfo:Z,openHistory:()=>{o({title:"文件历史版本",area:55,component:()=>n((()=>import("./index190.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),compData:{editorTabsActive:Xa,callback:()=>{Al(Xa,!0)}}})},watchAceEditor:ee,diffReHistory:async()=>{await sl(ll.value),await Al(ll.value,!0),ll.value={}},onConfirmCheckFile:async e=>{await Jl(),localStorage.removeItem("aceEditor"),Vl(),e&&e()},onCancelCheckFile:e=>{localStorage.removeItem("aceEditor"),Vl(),e&&e.onUnmount&&e.onUnmount()},compDataClose:te,onConfirmClose:async()=>{try{switch(te.value.type){case"close":await Gl(te.value.item),Pl(te.value.item);break;case"other":const e=te.value.item.id,t=el.value.filter((t=>t.id!==e&&1===t.state));t.length>0&&await Promise.all(t.map((e=>Gl(e)))),ae(e);break;case"all":await Jl(),le()}}catch(e){}return!0},onCancelClose:e=>{switch(te.value.type){case"close":te.value.item.state=0,Pl(te.value.item);break;case"other":ae(te.value.item.id);break;case"all":le()}e&&e.onUnmount&&e.onUnmount()},init:()=>{window.addEventListener("keydown",nl)},$reset:()=>{window.removeEventListener("keydown",nl),r()}}})),Ga=W("FILES-ACE-MOBILE-STORE",(()=>{const{mainHeight:e}=i(),t=I(),a=I();let l;const n=I(null),o=(e,t)=>{if(Ml(e),t){const e=t.currentTarget||t.currentTarget,a=n.value,l=a.offsetWidth,i=e.offsetLeft-l/2+e.offsetWidth/2;a.scroll({left:i,behavior:"smooth"})}},r=e=>{e.preventDefault();const{deltaY:t}=e;n.value.scrollLeft+=t},c=I(),u=async e=>{await dl(),Ka.value=await ml(e)},p=I(!1),d=I(null),f=I(!1),h=I(null),m=I([{title:"保存",icon:"svgtofont-el-select",click:()=>{y()&&Gl(Xa)}},{title:"全部保存",icon:"svgtofont-icon-minmax-black",click:()=>{y()&&Jl()}},{title:"刷新",icon:"svgtofont-el-refresh-right",click:async()=>{y()&&Al(Xa,!0)}},{title:"搜索",icon:"svgtofont-el-search",click:()=>{y()&&Ka.value.execCommand("find")}},{title:"替换",icon:"svgtofont-icon-log",click:()=>{y()&&Ka.value.execCommand("replace")}},{title:"文件足迹",icon:"svgtofont-left-crontab",click:()=>{$i()}},{title:"退出",icon:"svgtofont-el-close",click:()=>{g()}}]),v=async()=>{Va(),ul(),k()},g=async()=>(await $l()?nn(v):(localStorage.removeItem("aceEditor"),Vl(),v()),!1),y=()=>!(!Dl()||"custom"===Xa.type)||(s.error("当前页面不支持该操作"),!1),b=I(null),w=I({}),_=e=>{const t=Da.value.getNode(e);t&&e.isNew&&Da.value.remove(t),t&&e.isReName&&(e.isReName=!1),Ta.value=!1},E=(e,t)=>{_(w.value),Aa(e,t,b)},S=e=>el.value.some((t=>t.path===e.path))?"text-[#cca700]":"",L=I("btn"),T=I(!1),C=I(""),D=I([]),x=I(""),k=async()=>{const e=await a.value;null==e||e.unmount()};return{fileItem:t,instance:a,tabsElement:n,changeTab:o,getDataChangeTab:()=>{N((()=>{const e=el.value[el.value.length-1],t=n.value.children[el.value.length-1];o(e.id,{currentTarget:t})}))},closeTab:async e=>{Pl(e)},initHeader:()=>{N((()=>{n.value.addEventListener("wheel",r)}))},$resetHeader:()=>{n.value&&n.value.removeEventListener("wheel",r)},editorRef:c,mainHeight:e,createEditorView:u,initContent:async()=>{await u(c.value),t&&await Ol({title:t.value.fileName,type:"editor",path:t.value.path,size:t.value.size}),await ue({name:t.value.fileName,path:t.value.path}),await cl()},isShow:p,dropdownMenu:d,handleClickOutside:e=>{d.value&&!d.value.contains(e.target)&&(p.value=!1)},isShowTool:f,dropdownMenuRef:h,column:m,checkOperationAvailable:y,handleClickOutsideEvent:e=>{h.value&&!h.value.contains(e.target)&&(f.value=!1)},openPopup:e=>{Dl?(f.value=!1,e.click()):s.error("当前页面不支持该操作")},treeProps:{label:"fileName",key:"path",isLeaf:"isFile"},loadNode:async(e,a,...l)=>{Na(e,a,t.value)},renderTree:(e,{node:t,data:a,store:l})=>{const{mode:i}=Ll(a.fileName),n=[e("span",{class:(a.isFile?"ace-".concat(i,"-icon ace-text-icon"):"ace-folder-icon")+" icon-editor-left",style:{"font-size":"4rem"}}),a.isReName?e():e("span",{class:"el-tree-node__label "+S(a),attrs:{title:a.fileName}},a.fileName)];return e("span",{class:"flex items-center ".concat(a.isReName?"newFiles":"defaultFiles"),on:{contextmenu:e=>{e.preventDefault(),E(e,a)}}},n)},handleExpandChange:e=>{(null==e?void 0:e.path)&&!La.value.includes(e.path)&&La.value.push(e.path)},handleCollapseChange:e=>{const t=La.value.indexOf(null==e?void 0:e.path);-1!==t&&La.value.splice(t,1),_(w.value)},initList:async()=>{N((()=>{const e=(t.value.path||"/www").split("/");e.pop(),wa.value=e.join("/")}))},type:L,isCheck:T,searchValue:C,changeValue:e=>{La.value.length=0,C.value="","search"===e?(D.value=_a.value,x.value=wa.value,_a.value=[],Ca.value=!0):(_a.value=D.value,wa.value=x.value)},searchFile:async()=>{const e=await Ia(wa.value,C.value,T.value?"True":void 0);Ca.value=!1,e&&(_a.value=e,Ra())},closeSearch:()=>{L.value="btn",Ra()},close:k,init:()=>{N((()=>{l=setInterval((()=>{const e=document.querySelector(".el-overlay-dialog"),t=null==e?void 0:e.querySelector(".el-dialog__body");t&&(e&&(e.style.alignItems="flex-start",e.style.paddingTop="1vh",e.style.paddingBottom="1vh"),t.style.maxHeight="90vh",t.style.height="auto",t.style.overflowY="auto",t.style.WebkitOverflowScrolling="touch")}),1e3)}))},$reset:()=>{clearInterval(l)}}})),Wa=t(),Ua="/www/server/panel/BTPanel/static/editor/ace.editor.config.json",Ja=$({supportedModes:{},nameOverrides:{},encodingList:[],themeList:[],aceEditor:{fontFamily:"Monaco, Menlo, 'Courier New', monospace",editorTheme:"monokai",fontSize:14,softLabel:!0,useSoftTabs:!0,tabSize:4,wrap:!0,enableSnippets:!0,enableLiveAutocompletion:!0,highlightActiveLine:!0,highlightSelectedWord:!0,animatedScroll:!0,showInvisibles:!1,showFoldWidgets:!0,showLineNumbers:!0,showGutter:!0,displayIndentGuides:!0}}),$a=K([]),Ka=K(null),Ya=K(null),Xa=Y({id:"",type:"editor",title:"",path:"",mode:"",modeText:"",isReadOnly:!1,stTime:0,state:0,encoding:"UTF-8",historys:[]}),Qa=K(""),Za=Y({row:1,column:0,count:1}),el=I([]),tl=()=>window.ace,al=()=>ya,ll=I(),il=I(null),nl=e=>{if("F5"===e.key||"r"===e.key&&(e.metaKey||e.ctrlKey))return e.preventDefault(),void Wa.msg({customClass:"no-icon",message:"编辑器模式下无法刷新网页，请关闭后重试",type:"info",duration:3e3})},sl=async e=>{try{await c({title:"恢复历史文件",width:"35rem",content:"是否恢复历史文件 ".concat(u(Number(e.st_mtime)),"?恢复历史文件后，当前文件内容将会被替换！")});const t=await p({filename:e.path,history:e.st_mtime});if(t.status){Wa.success("恢复成功");const t=Cl(Xa.id);el.value.splice(t,1),Al(e)}else Wa.request(t)}catch(t){}},ol=async e=>{var t;if(document.querySelector("#dialogMinimize"))return null==(t=document.querySelector("#dialogMinimize .svgtofont-el-fullscreen-expand"))||t.click(),void(e&&Ol(e))},rl=async()=>{il.value=await Wa.load("正在获取文件内容，请稍候...")},cl=async()=>{il.value&&il.value.close()},ul=()=>{el.value.some((e=>1===e.state))||(window.onbeforeunload=null)},pl=async(e,t)=>{let a=Wa.load("正在加载，请稍候...");try{const{data:a}=await Hl(e,"reverse",t);return a}catch(l){}finally{a&&a.close()}},dl=async()=>{const e=sessionStorage.getItem("aceConfig");let t={};e&&(t=JSON.parse(e));const{data:a}=await Hl(Ua);a.data&&(t=JSON.parse(a.data),sessionStorage.setItem("aceConfig",JSON.stringify(t))),Ja.supportedModes=t.supportedModes,Ja.nameOverrides=t.nameOverrides,Ja.encodingList=t.encodingList,Ja.themeList=t.themeList,Ja.aceEditor=t.aceEditor,Ja.aceEditor.fontFamily="12px/normal 'Consolas', 'Menlo', 'Monaco', 'Ubuntu Mono', 'source-code-pro', 'Courier New', monospace"},fl=async()=>{const e=JSON.stringify(Ja);return await Bl({data:e,path:Ua,force:1})},hl=()=>Ja.aceEditor,ml=async e=>{const t=tl(),{editorTheme:a,fontSize:l,fontFamily:i,showInvisibles:n,useSoftTabs:s,tabSize:o,keyboardHandler:r,enableLiveAutocompletion:c,enableSnippets:u,enableBasicAutocompletion:p}=hl();t.config.set("basePath","/static/editor"),t.require("/ace/ext/language_tools");const f=t.edit(e,{theme:"ace/theme/".concat(a),fontSize:l,fontFamily:i,showInvisibles:n,useSoftTabs:s,tabSize:o,showPrintMargin:!1,keyboardHandler:r,enableLiveAutocompletion:c,enableSnippets:u,enableBasicAutocompletion:p});return d()&&f.setOptions({fontSize:30,wrap:!0,enableLiveAutocompletion:!1,enableBasicAutocompletion:!1,enableSnippets:!1}),ql(f),f},vl=e=>{Ya.value=e},gl=async e=>{const{editorTheme:t}=hl(),{theme:a="ace/theme/".concat(t),mode:l="",left:i={},right:n={}}=e,s={element:Ya.value,theme:a,mode:l,left:{content:"",editable:!1,copyLinkEnabled:!1,...i},right:{content:"",editable:!1,copyLinkEnabled:!1,...n}};return yl(s),s},yl=e=>new(al())(e),bl=(e,t)=>{const a=tl(),{wrap:l}=hl(),i=a.createEditSession(t,"ace/mode/".concat(e));return i.setOptions({wrap:l,readOnly:!1}),zl(i),i},wl=e=>{Ka.value.setSession(e)},_l=e=>{var t;return e?null==(t=$a.value.find((t=>t.id===e)))?void 0:t.session:Ka.value.getSession()},El=e=>e?$a.value.find((t=>t.id===e)):Ka.value.getSession(),Sl=e=>e?$a.value.findIndex((t=>t.id===e)):-1,Ll=e=>{let t=e.match(/\.([0-9A-z]*)$/);t=Array.isArray(t)?t[1]:"text";for(let n in Ja.supportedModes)for(var a=Ja.supportedModes[n][0].split("|"),l=n.toLowerCase(),i=0;i<a.length;i++)if(t.toLowerCase()==a[i].toLowerCase())return{name:n,mode:l};return{name:"Text",mode:"text"}},Tl=e=>el.value.find((t=>t.id===e)),Cl=e=>el.value.findIndex((t=>t.id===e)),Dl=()=>el.value.length>0,xl=(e,t)=>{const{getDataChangeTab:a}=d()?Ga():Ba();delete e.session;const l={id:"",type:"editor",title:"",path:"",mode:"",modeText:"",isReadOnly:!1,stTime:0,state:0,...e};return el.value.push(l),a(),"editor"===e.type&&t&&$a.value.push({id:l.id,session:t}),l},kl=(e=!1)=>{Ka.value.setReadOnly(e)},Rl=()=>{Ka.value.focus()},Il=e=>{Za.count=e.session.getLength()},Nl=e=>el.value.filter((t=>t.path===e)),Fl=async e=>{const t=Tl(e);t&&(Xa.id=e,Xa.type=t.type,Xa.title=t.title,"editor"===t.type?(Xa.path=t.path,Xa.mode=t.mode,Xa.modeText=t.modeText,Xa.isReadOnly=t.isReadOnly,Xa.stTime=t.stTime,Xa.state=t.state,Xa.encoding=t.encoding,Xa.historys=t.historys,Xa.next=t.next,Xa.pagination=t.pagination):Xa.component=t.component)},Ol=async e=>{var t;try{let a={};if("editor"===e.type){const l=Nl(e.path);if(l.length)return Ml(l[0].id);const i=await Hl(e.path),{data:n,status:s,msg:o}=i;let c=n;if(s){o&&"success"!==o&&Wa.warn(o),e.size>3145728&&Wa.warn("抱歉！文件大小超过3M，暂不支持在线编辑！");const l=e.filename||(null==(t=e.path)?void 0:t.split("/").pop());let i="";const{mode:n,name:s}=Ll(l);i=n,e.mode&&(i=e.mode);const u=bl(i,c.data);a=xl({id:r(10),path:e.path,type:"editor",title:l,mode:i,modeText:s,state:0,encoding:c.encoding,stTime:Number(c.st_mtime),isReadOnly:c.only_read,historys:c.historys||[],next:(null==c?void 0:c.next)||!1,pagination:1},u),wl(u),kl(c.only_read)}else Wa.error(o)}else a=xl({...e,id:r(10),state:0});Fl(a.id)}catch(a){}},Al=async(e,t=!1)=>{if("editor"!==e.type)return;const a=Wa.load("获取文件内容中，请稍候...");try{const a=Tl(e.id||""),{data:l}=await Hl(e.path);t&&Ka.value.session.setValue(l.data),a.stTime=Number(l.st_mtime),a.encoding=l.encoding,a.state=0,Xa.state=0,a.isReadOnly=l.only_read,a.historys=l.historys||[],Wa.msg({message:"文件内容已更新！",type:"success"}),Fl(a.id)}catch(l){}finally{a&&a.close()}},Pl=e=>{const{id:t}=e,a=Cl(t),l=el.value[a]||null,i=_l(t),n=Sl(t);if(e.state)return jl(e);l&&"editor"===l.type&&(null==i||i.destroy());if(el.value.length>1){const e=el.value[a+1]?a+1:a-1,t=el.value[e].id;Ml(t,!0)}el.value.splice(a,1),"editor"===l.type&&i&&$a.value.splice(n,1)},jl=async e=>{try{sn("close",e)}catch(t){}},Ml=(e,t=!1)=>{var a;const l=Cl(Xa.id||""),i=Cl(e),n=el.value[i],s=El(e);"editor"===n.type&&(Xa.id===e&&t&&(null==(a=$a.value[l])?void 0:a.session)&&($a.value[l].session=_l()),s&&(wl(s.session),Il(s)),kl(n.isReadOnly),Rl()),Fl(e)},zl=e=>{Za.count=e.getLength(),e.on("change",(()=>{const e=Tl(Xa.id||"");0===e.state&&(e.state=1,Xa.state=1,window.onbeforeunload=function(){return"您有未保存的更改，确定要离开吗？"})})),e.selection.on("changeCursor",(()=>{const t=Ka.value.getCursorPosition();Za.count=e.getLength(),Za.row=t.row+1,Za.column=t.column})),e.on("changeScrollTop",X((async function(t){var a;const l=e.selection.session,i=l.getScrollTop(),n=l.getScreenLength()*Ka.value.renderer.lineHeight;if(i+Ka.value.renderer.$size.scrollerHeight>=n-100){const e=Tl(Xa.id);if(e.next){const t=await pl(e.path,e.pagination);if(e.next=t.next,null==t?void 0:t.next){e.pagination&&e.pagination++;const l=null==(a=_l(e.id))?void 0:a.getValue();Ka.value.session.setValue(l+t.data)}}}})),500)},ql=e=>{const{watchEditorCustomToolbar:t}=Ba();e.commands.addCommand({name:"saveFile",bindKey:{win:"Ctrl-S",mac:"Command-S"},exec:()=>{const e=Tl(Xa.id||"");Gl(e)}}),e.commands.addCommand({name:"saveAllFile",bindKey:{win:"Ctrl-Shift-S",mac:"Command-Shift-S"},exec:()=>{Jl()}}),e.commands.addCommand({name:"closeFile",bindKey:{win:"Ctrl-W",mac:"Command-W"},exec:()=>{Pl(Xa.id)}}),e.commands.addCommand({name:"closeAllFile",bindKey:{win:"Ctrl-Shift-W",mac:"Command-Shift-W"},exec:()=>{el.value.forEach((e=>{Pl(e.id)}))}}),e.commands.addCommand({name:"goToLine",bindKey:{win:"Ctrl-I",mac:"Command-I"},exec:()=>{Dl()&&"custom"!==Xa.type?t("jump"):Wa.error("当前页面不支持该操作")},readonly:!1}),e.commands.addCommand({name:"undo",bindKey:{win:"Ctrl-Z",mac:"Command-Z"},exec:()=>{e.undo()}})},Vl=()=>{Ka.value=null,Xa.id="",Xa.title="",Xa.path="",Xa.mode="",Xa.modeText="",Xa.isReadOnly=!1,Xa.stTime=0,Xa.state=0,Xa.encoding="UTF-8",Xa.historys=[],el.value=[],$a.value=[]},Hl=async(e,t,a)=>{let l={path:e,mode:t,p:a};return t||delete l.mode,a||delete l.p,await pe(l)},Bl=async e=>{let t={path:e.path,data:e.data,encoding:e.encoding||"UTF-8",st_mtime:e.st_mtime,force:e.force||0,skip_conf_check:e.skip_conf_check||!1};return e.skip_conf_check||delete t.skip_conf_check,await f(t)},Gl=async(e,t=0,a=!1)=>{if(0===e.state)return Wa.msg({customClass:"no-icon",message:"文件未修改,无需保存！",type:"info"});const l=Wa.load("保存中，请稍候...");try{const l=_l(e.id).getValue(),{path:i,encoding:n,stTime:s}=e,o={path:i,data:l,st_mtime:s,encoding:n,force:t};a&&(o.skip_conf_check=!0),e.state=3;const r=await Bl(o);if(!r.status)return(null==r?void 0:r.conf_check)?Ul(e,r.msg):Wl(e,r.msg);Wa.request(r),ul(),await Al(e,!1)}catch(i){}finally{l&&l.close()}},Wl=async(e,t)=>{const a=t.substr(0,t.length-1)+"，或选择强制保存。";e.state=1,await c({title:"提示",width:"35rem",icon:"warning",content:a}),await c({title:"是否强制保存",width:"35rem",icon:"warning",isHtml:!0,content:'<span style="color:#333">检测到文件已被修改，强制保存将会<span style="color:red">覆盖文件内容</span>，请谨慎操作!</span>'}),await Gl(e,1)},Ul=async(e,t)=>{const a=t.substr(0,t.length-1)+"，或选择强制保存。";e.state=1,await c({title:"提示",width:60,isHtml:!0,content:'<div class="custom-message-error-html">\n\t\t\t\t\t'.concat(a,'\n\t\t\t\t\t<div class="leading-[1.6rem] mt-1rem">请确认您要保存的配置文件内容无误与提示信息无关，注本次保存不会重载nginx/apache配置</div>\n\t\t\t\t</div>'),confirmText:"继续保存"}),await Gl(e,0,!0)},Jl=async()=>{const e=Wa.load("保存中，请稍候...");try{const e=[];for(let t=0;t<el.value.length;t++){const a=el.value[t];1===a.state&&e.push(Gl(a,0))}await Promise.all(e),ul()}catch(t){}finally{e&&e.close()}},$l=async()=>{let e=!1;return el.value.length>0&&(e=el.value.some((e=>1===e.state))),e},Kl=async e=>{const t=e.id;if(el.value.filter((e=>e.id!==t&&1===e.state)).length>0)sn("other",e);else{el.value=el.value.filter((e=>e.id===t)),$a.value=$a.value.filter((e=>e.id===t)),Fl(t);const a=_l(t);Ka.value.setSession(a),Il(Ka.value),kl(e.isReadOnly),Rl()}},Yl=async()=>{if(await $l())try{sn("all")}catch(e){}else el.value.forEach((e=>{const t=_l(e.id);t&&t.destroy()})),el.value=[],$a.value=[],Ka.value.setSession(null)},Xl=Object.freeze(Object.defineProperty({__proto__:null,editorCustomToolbar:Qa,editorDiffExample:Ya,editorExample:Ka,editorOption:Ja,editorRowColumnCount:Za,editorSeesion:$a,editorTabs:el,editorTabsActive:Xa,enableRefresh:ul,handleKeyDown:nl,handleScroll:pl,minimizeEvent:ol,reHistoryRow:ll,recoverEvent:sl,useAce:tl,useCheckFileChange:$l,useCheckFileCompatibility:e=>{const{mode:t}=Ll(e);return Ja.supportedModes[t]},useCheckTabsEmpty:Dl,useCloseAllTabs:Yl,useCloseOtherTabs:Kl,useCreateAceEditorExample:ml,useCreateAceEditorSession:bl,useCreateDiffEditorExample:vl,useCreateDiffEditorView:yl,useCreateEditorTabs:Ol,useCreateTabsItem:xl,useCutEditorTabs:Ml,useDestroyEditorData:Vl,useDiffAce:al,useEditorLoading:rl,useEditorPathFilter:Nl,useEditorUnLoading:cl,useEventMount:ql,useFindIndexTabs:Cl,useFindTabsData:Tl,useGetAceEditorSession:_l,useGetAceEditorSessionData:El,useGetAceEditorSessionIndex:Sl,useGetAceOptions:hl,useGetEditorOptions:dl,useGetEditorTabsLineCount:Il,useGetFileBody:Hl,useGetFileMode:Ll,useInsertAceEditorSession:wl,useMonitorMount:zl,useRandomId:()=>r(10),useRefreshFileContent:Al,useRemoveEditorCheckTabs:jl,useRemoveEditorTabs:Pl,useSaveAllFiles:Jl,useSaveEditorOptions:fl,useSaveFileBody:Bl,useSaveFiles:Gl,useSetDiffEditorOptions:gl,useSetEditorTabsActive:Fl,useSetEditorTabsFocus:Rl,useSetEditorTabsReadOnly:kl,useforcedSaveConfig:Ul},Symbol.toStringTag,{value:"Module"})),Ql=W("FILES-BATCH-SET-AUTH-STORE",(()=>{const e=ss(),{fileTabActiveData:t}=Q(e),{refreshFilesList:l}=e,i=I([]),n=$({owner:[],group:[],public:[],auth:0,user:"root",isDir:!0,checkNumber:""}),o=e=>{256&(e=parseInt(e.toString(),8))?n.owner.push("r"):n.owner=n.owner.filter((e=>"r"!==e)),128&e?n.owner.push("w"):n.owner=n.owner.filter((e=>"w"!==e)),64&e?n.owner.push("x"):n.owner=n.owner.filter((e=>"x"!==e)),32&e?n.group.push("r"):n.group=n.group.filter((e=>"r"!==e)),16&e?n.group.push("w"):n.group=n.group.filter((e=>"w"!==e)),8&e?n.group.push("x"):n.group=n.group.filter((e=>"x"!==e)),4&e?n.public.push("r"):n.public=n.public.filter((e=>"r"!==e)),2&e?n.public.push("w"):n.public=n.public.filter((e=>"w"!==e)),1&e?n.public.push("x"):n.public=n.public.filter((e=>"x"!==e)),n.owner=Array.from(new Set(n.owner)),n.group=Array.from(new Set(n.group)),n.public=Array.from(new Set(n.public))};return{checkList:n,fileList:i,ownerOptions:[{label:"root",value:"root"},{label:"www",value:"www"},{label:"mysql",value:"mysql"}],reversePermission:()=>{let e=0;const t=(t,a,l,i)=>{t.includes("r")&&(e|=a),t.includes("w")&&(e|=l),t.includes("x")&&(e|=i)};for(t(n.owner,256,128,64),t(n.group,32,16,8),t(n.public,4,2,1),n.auth=e.toString(8);n.auth.length<3;)n.auth="0"+n.auth},checkNumber:e=>{n.checkNumber=e;const t=String(e).replace(/[^\d]/g,"").slice(0,3);n.auth=t,o(Number(n.auth))},changeUser:e=>{n.user=e},setFileAuths:async e=>{let o=n.auth.toString();if(o.length>3)s.error("请输入正确权限");else if(n.checkNumber.match(/\D/g))s.error("请输入正确权限");else if(o.match(/\D/g))s.error("请输入正确权限");else{for(;o.length<3;)o="0"+o;await a({loading:"正在设置文件权限，请稍后...",request:fe({user:n.user,access:o,all:n.isDir?"True":"False",type:"3",path:t.value.param.path,data:JSON.stringify(i.value)}),message:!0,success:t=>{t.status&&(l(),e&&e())}})}},getFileAuths:async()=>{await a({request:de({filename:"".concat(t.value.param.path)}),success:e=>{if(e.status){const t=e.data;n.auth=t.chmod,n.user=t.chown,o(Number(t.chmod))}else s.error(e.msg)}})},$reset:()=>{Object.assign(n,{owner:[],group:[],public:[],auth:0,user:"root",isDir:!0,checkNumber:""}),i.value=[]}}})),Zl=W("FILES-CLOUD-STORAGE-STORE",(()=>{const e=ss(),{fileTabActiveData:t}=Q(e),{refreshFilesList:l,getRealTask:i}=e,n=I(),o=I(),r=I(),c=I(!1),p=I([]),d=I(!0),f=I(""),m=I([]),v=I(""),g=I([]),y=I([]),b=I([It(),{label:"文件名",prop:"name",width:"300",render:e=>V("span",{class:[null===e.type?"bt-open-dir folder-open-icon":"bt-open-dir file-text-icon"]},[V("i",{class:"icon"},null),V("span",{onClick:t=>{null===e.type&&w((""===v.value?"":v.value+"/")+e.name)}},[e.name])])},{label:"大小",prop:"size",render:e=>{let t=null!==e.size?h(e.size):"-";return null===e.type&&(t="-"),Z("span",t)}},{label:"更新时间",prop:"time",render:e=>""===e.type?"<span>"+u(e.time)+"</span>":"-"}]),w=e=>{v.value!==e&&(v.value=e,_())},_=async()=>{var e,t;try{c.value=!0;const a=await he({path:v.value,pname:n.value.pname});if(c.value=!1,!a.status)return L(),s.msg({message:"请先配置云存储",type:"warning"}),void Tt({name:n.value.pname});p.value=(null==(t=null==(e=a.data)?void 0:e.list)?void 0:t.sort(((e,t)=>null===e.type?-1:null===t.type?1:0)))||[],S(p.value),a.data.hasOwnProperty("path")&&E(a.data.path)}catch(a){}},E=e=>{let t="";v.value=e,g.value=[{title:"根目录",path:"",type:"dir"}],""!==e?(e&&"/"===e[e.length-1]&&(e=e.slice(0,-1)),e.split("/").forEach(((e,a)=>{t+="".concat(1===a?"":"/").concat(e),g.value.push({title:""===e&&0==a?"根目录":e,path:t,type:"dir"})})),m.value=g.value):m.value=g.value};I(!1);const S=e=>{N((()=>{const t=document.querySelectorAll(".oss-table .el-table__body-wrapper .el-checkbox");"down"===n.value.type?t.forEach(((t,a)=>{null===e[a].type?t.style.display="none":t.style.display="block"})):t.forEach(((e,t)=>{e.style.display="none"}))}))},L=async()=>{const e=await o.value;null==e||e.unmount()};return{compData:n,instance:o,ossTable:r,isTagMode:d,temporaryPath:f,showPathList:m,tableColumns:b,tableData:p,loading:c,handleSelectionChange:e=>{e.length>1?(r.value.getTable().clearSelection(),r.value.getTable().toggleRowSelection(e.pop())):y.value=e},temporaryBlur:()=>{d.value=!0,f.value=""},temporaryFocus:()=>{d.value=!1,f.value=v.value},temporaryEnter:e=>{var t;let a=null==(t=e.target)?void 0:t.value;a=a.replace(/\/+/g,"/"),"/"!==a&&(a=a.replace(/\/+$/g,"")),a!==f.value&&(v.value=a,_()),e.target.blur()},goBack:()=>{var e;1!==g.value.length&&(v.value=(null==(e=g.value[g.value.length-2])?void 0:e.path)||"/",_())},watchTableData:S,getDirList:_,filePathJump:w,onConfirm:async()=>{const{pname:e,type:o}=n.value;let r={};if("down"==o){if(0===y.value.length)return void s.error("请选择勾选需要下载的文件");r={name:e,url:y.value[0].download,path:t.value.param.path,filename:y.value[0].name}}else r={name:e,filename:n.value.rowData.path,object_name:v.value};return(await a({loading:"正在执行中，请稍后...",request:me(r,o),message:!0,success:e=>{e.status&&(i(),l())}})).status},$reset:()=>{d.value=!0,f.value="",v.value="",p.value=[],m.value=[],g.value=[],y.value=[]}}})),ei=W("FILES-COMPRESS-PREVIEW-STORE",(()=>{const e=ss(),{fileTabActiveData:t}=Q(e),{refreshFilesList:l}=e,i=I(""),n=I(),o=I();let r;const u=$({file:{data:{},path:"当前压缩包"},isDblclick:!1,addList:[]}),p=I(!1),d=I(!0),f=$({visible:!1,form:{filename:"",path:"/"}}),m=I(!1),v=I(!1),g=I(!1),y=$({tableBatchData:[{label:"批量解压",value:"decompress",isRefBatch:!0,event:()=>{}},{label:"批量删除",value:"delete",isRefBatch:!0,event:()=>{}}],batchConfig:{isRecurrence:!1,describe:{title:"",th:"",message:"",propsValue:"name"},tableDisplayConfig:{label:"状态",prop:"status",render:e=>Z("span",{})}},decompressTableColumn:[{label:"文件名",prop:"filename"},{label:"大小",prop:"file_size",width:70,render:e=>Z("span",{},e.file_size?h(e.file_size):"--")}],selectList:[]}),b=I(),w=e=>{u.isDblclick=!0,e.date_time||(u.file.path="".concat(u.file.path,"/").concat(e.filename),setTimeout((()=>{u.isDblclick=!1}),200))},_=e=>(e.shift(),e.join("/")),E=e=>{if(0===y.selectList.length){const t=e.findIndex((e=>e.filename===f.form.filename));return[e[t].uploadName]}return y.selectList.map((e=>e.uploadName))},S=e=>{let t=[];return Object.entries(e).forEach((([e,a])=>{if("object"==typeof a)if(a.is_dir)t.push("".concat(a.filename,"/"));else if(a.hasOwnProperty("fullpath"))t.push("".concat(a.fullpath));else{const e=S(a);t=t.concat(e)}})),t},L=async(e,t)=>{const l=u.file.path.split("/").filter((e=>""!==e));l.join("/").replace("当前压缩包/","").replace("当前压缩包","");const i=l.length>1?l.join("/").replace("当前压缩包/","")+"/":"";0===y.selectList.length&&await c({title:"删除文件【".concat(e.filename,"】"),content:"您真的要删除文件【".concat(e.filename,"】吗？")});let s=[],o=[];0!==e.is_dir&&0===y.selectList.length&&(s=S(e)),o=y.selectList.length>0?(()=>{let e=[];return y.selectList.forEach((t=>{if(t.uploadName.includes("/dddir")){const a=S(t);e=e.concat(a)}else t.is_dir?e.push("".concat(t.filename,"/")):e.push("".concat(t.fullpath))})),e})():[...s,"".concat(i).concat(e.filename).concat(0!==e.is_dir?"/":"")];const p={data:JSON.stringify({sfile:n.value.path,filenames:o})},d="zip"===n.value.ext?Ee:Se;v.value=!0;const f=await a({loading:"正在删除文件，请稍后...",request:d(p),message:!0,success:e=>{y.selectList=[],e.status&&(C(),g.value=!1)}});return r&&r(),v.value=!1,f.status},T=I([It(),{label:"名称",prop:"filename",render:e=>V("div",{class:"flex items-center cursor-pointer",onClick:t=>{e.date_time||(t.stopPropagation(),w(e))}},[V("img",{class:"mr-[.5rem] w-[2.5rem] h-[2.5rem]",src:"/static/images/file_icon/".concat(e.date_time?"file":"folder_win10",".png")},null),V("span",{class:"hover:text-[#20a53a]"},[e.filename])])},{label:"大小",prop:"file_size",width:100,render:e=>Z("span",{class:"cursor-pointer"},e.file_size?h(e.file_size):"--")},{label:"修改时间",prop:"date_time",width:270,render:e=>Z("span",{class:"cursor-pointer"},e.date_time?e.date_time:"--")},Nt([{onClick:async(e,t,l)=>{var i;if(l.stopPropagation(),l.preventDefault(),"text"!==Cn(null==(i=e.fileName)?void 0:i.split(".").pop()))return void s.error("暂不支持该类型文件编辑");const o=u.file.path.split("/").filter((e=>""!==e)),r={data:JSON.stringify({sfile:n.value.path,filename:(o.length>1?o.join("/").replace("当前压缩包/","")+"/":"")+e.filename})},c="zip"===n.value.ext?we:_e,p=await a({loading:"正在获取文件，请稍后...",request:c(r)});p.status?Xi(p.data,n.value,e.filename,o.length>1?o.join("/").replace("当前压缩包",""):""):s.request(p)},isHide:e=>{const t=e.filename.split(".").pop()||"file";return"text"!==Cn(t)||0!==e.is_dir},title:"编辑"},{onClick:async(e,t,a)=>{a.stopPropagation(),a.preventDefault(),Object.assign(f,{visible:!0,form:{filename:e.filename,path:"/"}})},title:"解压"},{onClick:L,title:"删除"}])]),C=async()=>{const e="zip"===n.value.ext?Le:Te;await a({loading:p,request:e({data:JSON.stringify({sfile:n.value.path})}),success:async e=>{if(!e.status){s.request(e);const t=await o.value;null==t||t.unmount()}u.file.data=e.data,d.value&&(N((()=>{b.value.getTable().toggleAllSelection()})),d.value=!1)}})},D=[{label:"解压",value:"decompress",event:async(e,t,a,l,i)=>{y.selectList=a.value,Object.assign(f,{visible:!0,form:{filename:"",path:"/"}}),r=i}},{label:"删除",value:"delete",event:async(e,t,a,l,i)=>{y.selectList=a.value,g.value=!0,r=i}}];return{instance:o,compressData:u,deCompressPopupData:f,fileItem:n,tableColumn:T,loading:p,fileTableRef:b,batch:y,batchOptions:D,deCompressPopupDisable:m,batchDeletePopup:g,delEvent:L,confirmDeCompress:async(e,t)=>{m.value=!0;const i=JSON.parse(JSON.stringify(t)),o={data:JSON.stringify({zip_path:_(i),sfile:n.value.path,extract_path:f.form.path+"/",filenames:E(e)})},c="zip"===n.value.ext?ye:be,u=await a({loading:"正在解压文件，请稍后...",request:c(o)});if(u.status){if(u.type)return tn(u.data,o,"zip"===n.value.ext?ye:be),void(f.visible=!1);s.success("解压成功"),l()}else s.request(u);r&&r(),f.visible=!1},openPathDialog:()=>{Ct({type:"dir",path:f.form.path,change:e=>{f.form.path=e}})},cellDblclick:w,goPath:e=>{const t=u.file.path.split("/").filter((e=>""!==e));let a="";for(let l=0;l<=e;l++)a+="/".concat(t[l]);u.file.path=a,"/当前压缩包"===a&&b.value.getTable().toggleAllSelection()},addFile:async()=>{Ct({type:"file",path:f.form.path,change:async e=>{const t=u.file.path.split("/").slice(1).join("/").replace("当前压缩包","");p.value=!0,u.addList=[e];const l="zip"===n.value.ext?ve:ge;await a({loading:"正在添加文件，请稍后...",request:l({data:JSON.stringify({sfile:n.value.path,r_path:t?"/".concat(t):"",f_list:u.addList})}),message:!0,success:C}),p.value=!1}})},init:()=>{i.value=n.value.path||"",C(),f.form.path=t.value.param.path||"/"},$reset:()=>{d.value=!0,m.value=!1,v.value=!1,g.value=!1,Object.assign(u,{file:{data:{},path:"当前压缩包"},isDblclick:!1,addList:[]})}}})),ti=W("FILES-CREATE-SYMBOLIC-LINK-STORE",(()=>{const e=ss(),{refreshFilesList:t}=e,l=$({path:"",filename:"",disable:!1}),i=I(),n=$({path:[{validator:(e,t,a)=>{""===t?a(new Error("请选择正确的文件地址!")):a()},trigger:["blur","change"]}],filename:[{validator:(e,t,a)=>{""===t?a(new Error("请输入新文件名!")):rn(t)?a(new Error('文件名不能包含 /\\:*?"<>|符号!')):a()},trigger:["blur"]}]});return{quickFormRef:i,quickForm:l,quickRules:n,openFile:()=>{Ct({type:"all",change:e=>{l.path=e}})},onConfirm:async e=>{try{const n={sfile:l.path,dfile:cn(l.filename)};await i.value.validate(),l.disable=!0,await a({loading:"正在创建软链接...",request:Ce(n),message:!0,success:a=>{a.status&&(t(),e())}})}catch(n){}finally{l.disable=!1}},$reset:()=>{Object.assign(l,{path:"",filename:"",disable:!1})}}})),ai=W("FILES-FAVORITES-MANAGE-STORE",(()=>{const e=ss(),{favoriteList:t}=Q(e),{refreshFilesList:l}=e,i=I(),n=I(t.value),s=$({loading:!1,data:[]}),o=I([{label:"路径",prop:"path"},Nt([{onClick:async e=>{if("dir"===e.type)pn(e.path);else{const t={...e,fileName:e.name,ext:e.ext||e.name.split(".").pop()};Fn(t)}const t=await i.value;null==t||t.unmount()},title:"打开"},{onClick:async e=>{await c({title:"删除收藏",content:"即将删除收藏路径【".concat(e.name,"】")}),a({loading:"正在删除收藏路径，请稍后...",request:De({path:e.path}),message:!0,success:e=>{e.status&&Kn()}})},title:"删除"}])]);return{instance:i,tableColumn:o,favoriteList:t,favTableData:s,onCancel:()=>{n.value.length!==t.value.length&&l()},$reset:()=>{Object.assign(s,{loading:!1,data:[]})}}}));function li(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!le(e)}const ii=W("FILES-FORMAT-CONVERSION-STORE",(()=>{const e=ss(),{fileTabActiveData:t}=Q(e),{refreshFilesList:l}=e,i=I(),n=I(),o=I("conver"),r=I("执行转换"),c=I(!1),p=$({fileList:[],selectList:[],path:"",del:!1,allKey:""}),d=I(!1),f=$({all:[],audio:[],image:[],video:[]}),h=I([It(),{label:"文件名",prop:"fileName"},{label:"格式类型",prop:"ext",width:80},{label:"转换为",prop:"status",width:190,renderHeader:()=>{var e;let t;return V("div",{class:"items-center inline-flex !w-[190px]"},[V("span",null,[ee("转换为")]),V(te,{class:"!w-[8rem] ml-4px",modelValue:p.allKey||(null==(e=f.all[0])?void 0:e.value),onChange:e=>{p.allKey=e,p.fileList=p.fileList.map((t=>({...t,format:e})))}},li(t=f.all.map((e=>V(ae,{key:e.value,label:e.label,value:e.value},null))))?t:{default:()=>[t]})])},render:(e,t)=>{let a=null;return["audio","image","video"].forEach((t=>{var l,i;if(f[t].map((e=>e.value)).includes(e.ext)){let n;e.format=e.format||(null==(l=f[t].at(0))?void 0:l.value),a=V("div",null,[V(te,{class:"!w-[12rem]",style:{display:e.isCustom?"none":"block"},modelValue:e.format||(null==(i=f[t].at(0))?void 0:i.value),onChange:t=>{e.format=t}},li(n=f[t].map((e=>V(ae,{key:e.value,label:e.label,value:e.value},null))))?n:{default:()=>[n]})])}})),a||(a=Z("span",{class:"text-[red]"},"不支持转换")),a}},{label:"执行状态",prop:"status",width:90,render:(e,t)=>{const a=["待转换","转换中","转换成功","转换失败"];let l=null;return f.all.map((e=>e.value)).includes(e.ext)&&(l=Z("span",{},a[e.status])),l||(l=Z("span",{class:"text-[red]"},"无法转换")),l}},Nt([{onClick:e=>{p.fileList=p.fileList.filter((t=>t.path!==e.path))},title:"取消"}])]),v=async()=>{await a({loading:d,request:Ie(),data:{all:[Array,e=>e.map((e=>({key:e,label:e})))],audio:[Array,e=>e.map((e=>({key:e,label:e})))],image:[Array,e=>e.map((e=>({key:e,label:e})))],video:[Array,e=>e.map((e=>({key:e,label:e})))]},success:e=>{Object.keys(e).forEach((t=>{e[t]=e[t].map((e=>({value:e.key,label:e.label})))})),f.all=e.all,f.audio=e.audio,f.image=e.image,f.video=e.video}})},g=$({fileList:[],p:1,limit:10}),y=I([{label:"操作时间",prop:"time",width:160,render:e=>Z("span",{},u(e.time))},{label:"操作类型",prop:"type",width:80},{label:"操作日志",prop:"operation"},{label:"操作结果",prop:"status",width:160}]),b=async()=>{await a({request:Re({p:g.p,limit:g.limit}),success:e=>{e.status?"string"==typeof e.msg?g.fileList=[]:g.fileList=e.data:s.error(e.msg)}})},w=async()=>{const e=await n.value;null==e||e.unmount()};return{instance:n,fileItem:i,activeName:o,tableColumn:h,loading:d,formatData:p,subLoad:c,btnText:r,addFile:()=>{Ct({type:"file",change:async e=>{const t=await xe({filename:e});t.status?p.fileList.push({status:0,ext:t.data.st_type,...t.data,path:e,fileName:t.data.name}):s.error(t.msg)}})},openFile:e=>{Ct({type:"dir",change:e=>{p.path=e}})},goConversion:async()=>{const e=[];if(p.selectList.forEach((t=>{if(0===t.status){const a=t.name.split(".");a.pop(),e.push({input_file:t.path,output_file:"".concat(p.path,"/").concat(a,".").concat(t.format)})}})),!e.length)return s.error("没有需要转换的文件");r.value="转换中",c.value=!0,await a({loading:"正在转换中，请稍后...",request:ke({is_save:p.del?1:0,pdata:JSON.stringify(e)}),success:e=>{m(e.data)?(e.data.forEach((e=>{e.msg=e.msg||(e.status?"转换成功":"转换失败")})),l(),w(),as({title:"转换结果",resultData:e.data})):(r.value="执行转换",c.value=!1,s.error(e.msg))}})},handleSelectionChange:e=>{p.selectList=e},logTableColumn:y,tableData:g,getData:b,handleTabEvent:e=>{"conver"===e?v():b()},init:()=>{var e,a;v(),p.fileList=Array.isArray(i.value)?null==(e=i.value)?void 0:e.map((e=>({status:0,...e,name:e.fileName}))):[{status:0,...i.value,name:null==(a=i.value)?void 0:a.fileName}],p.path=t.value.param.path},$reset:()=>{c.value=!1,d.value=!1,Object.assign(p,{fileList:[],selectList:[],path:"",del:!1,allKey:""}),Object.assign(g,{fileList:[],p:1,limit:10}),Object.assign(f,{all:[],audio:[],image:[],video:[]})}}})),ni=W("FILES-OVERLAY-TIPS-STORE",(()=>{const{getGlobalInfo:e}=i(),t=ss(),{fileTabActiveData:l,copyFilesData:n}=Q(t),{refreshFilesList:o,getRealTask:r}=t,p=I(),d=I(""),f=I(),m=I([{type:"selection",width:40},{prop:"filename",label:"文件名"},{prop:"size",label:"大小",render:e=>V("span",null,[h(e.size)])},{prop:"mtime",width:136,label:"最后修改时间",render:e=>u(Number(e.mtime))}]),v=$({addend1:0,addend2:0,sum:0}),g=I(!1),y=I(),b=I([]),w=I([]),_=e=>{if(e.endsWith(".tar.gz")){const t=e.substring(0,e.length-7);return"".concat(t,"-副本.tar.gz")}{const t=e.lastIndexOf(".");if(-1===t)return"".concat(e,"-副本");{const a=e.substring(0,t),l=e.substring(t);return"".concat(a,"-副本").concat(l)}}},E=$({type:"",size:0,filename:"",mtime:0}),S=$({name:[{validator:(e,t,a)=>{"rename"===E.type&&t===p.value.fileData[0].filename&&a(new Error("名称重复，请输入新文件名!")),""===t?a(new Error("请输入新文件名!")):a()},trigger:["blur"]}]});return{compData:p,fileTabActiveData:l,sitesPath:d,overlayFormRef:y,overlayForm:E,tableLoading:g,quickRules:S,calcData:v,tableColumns:m,tableData:w,handleSelectionChange:e=>{b.value=e},watchType:e=>{"single"===p.value.type&&(E.filename="over"===e?p.value.fileData[0].filename:_(p.value.fileData[0].filename))},fileFormat:_,onConfirm:async e=>{if("single"!==p.value.type)if(v.sum===v.addend1+v.addend2){let t=[b.value.map((e=>e.filename))];await a({loading:"正在处理文件，请稍后...",request:Ae({type:"copy"===n.value.type?1:2,path:l.value.param.path,skip:t}),message:!0,success:t=>{t.status&&(o(),En()),r(),e()}})}else s.error("请输入正确的计算结果");else{const t={path:l.value.param.path,name:E.filename},{data:i}=await Ne(t);i.length>0&&await c({title:"覆盖文件",content:"检测到同名文件，您确定要覆盖当前【".concat(E.filename,"】文件？")});const u={sfile:n.value.files[0].path,dfile:l.value.param.path+"/"+E.filename};"rename"===E.type&&(u.rename=!0);const p="copy"===n.value.type?Fe:Oe;await a({loading:"正在处理文件，请稍后...",request:p(u),success:t=>{t.status&&(t.msg="文件覆盖成功!",o(),En()),s.request(t),r(),e()}})}},init:async()=>{w.value="batch"==p.value.type?p.value.fileData:[],await(async()=>{const t=await e();d.value=(null==t?void 0:t.sites_path)||""})(),v.sum=void 0,v.addend1=Math.round(9*Math.random()+1),v.addend2=Math.round(9*Math.random()+1),"batch"==p.value.type?(w.value=p.value.fileData,f.value.getTable().toggleAllSelection()):(E.type="rename",E.size=p.value.fileData[0].size,E.filename=_(p.value.fileData[0].filename),E.mtime=p.value.fileData[0].mtime)},$reset:()=>{w.value=[],b.value=[]}}})),si=W("FILES-TAMPER-STORE",(()=>{const{refreshFilesList:e}=ss(),t=I(),l=I("关闭"),i=I("文件"),n=I(""),o=$({fileName:!0,ext:!1});return{isStart:l,isFile:i,compData:t,checkList:o,onConfirm:async()=>{var l,i;if(!o.ext&&!o.fileName)return void s.error("请至少选择一项");const r={pid:t.value.data.tamperProofId,settings:[]},c=t.value.data.path;if("create"===n.value&&0==t.value.data.tamperProofId)return void(async l=>{let i=t.value.data.path,n=[];if(t.value.data.isFile){const e=i.lastIndexOf("/");if(-1!==e&&(i=i.substring(0,e)),o.fileName){let e=t.value.data.path.split("/"),a=e.length>=2?e[e.length-2]:"";n.push("".concat(a,"/").concat(t.value.data.fileName))}o.ext&&n.push("."+t.value.data.fileName.split(".").pop())}await a({loading:"正在创建目录保护，请稍后...",request:je({path:i,exts:JSON.stringify(n)}),message:!0,success:t=>{t.status&&(e(),l&&l())}})})(close);if(t.value.data.isFile)(null==(l=t.value.data)?void 0:l.isLock)?(o.fileName&&(r.settings.push({key:"remove_bf",values:[c]}),r.settings.push({key:"add_wf",values:[c]})),o.ext&&r.settings.push({key:"remove_bf",values:["."+t.value.data.fileName.split(".").pop()]})):(o.fileName&&(r.settings.push({key:"add_bf",values:[c]}),r.settings.push({key:"remove_wf",values:[c]})),o.ext&&r.settings.push({key:"add_bf",values:["."+t.value.data.fileName.split(".").pop()]}));else if(null==(i=t.value.data)?void 0:i.isLock){var u=n.value;-1!=t.value.data.path.indexOf("/www/server/panel/class")&&(u="add_wd"),r.settings.push({key:u,values:[t.value.data.path]})}else r.settings.push({key:n.value,values:[c]});r.settings=JSON.stringify(r.settings);return(await a({loading:"正在执行中，请稍后...",request:Pe(r),message:!0,success:t=>{t.status&&e()}})).status},init:()=>{var e;l.value=(null==(e=t.value.data)?void 0:e.isLock)?"关闭":"开启",i.value="file"===t.value.data.type?"文件":"目录",(async()=>{await a({request:Me({path:t.value.data.path}),success:e=>{n.value=e.data.data.action[0]}})})()},$reset:()=>{n.value="",Object.assign(o,{fileName:!0,ext:!1})}}})),oi=W("FILES-TASK-STORE",(()=>{const{refreshFilesList:t}=ss(),l=I();let i=null;const n=I([]),s=async()=>{try{const e=await v({status:-3});if(0===e.data.length)return clearInterval(i),t(),void o();n.value=e.data,i=setTimeout(s,2e3)}catch(a){e(a)}},o=async()=>{const e=await l.value;null==e||e.unmount()};return{instance:l,taskData:n,getLog:s,cancel:async e=>{await c({title:"删除任务",content:"您真的要删除当前任务【".concat(e.name,":").concat(e.shell,"】吗？")}),a({loading:"正在删除，请稍后...",request:g({id:e.id}),message:!0,success:s})},$reset:()=>{n.value=[],clearInterval(i)}}})),ri=W("FILES-IMAGE-PREVIEW-STORE",(()=>{const{fileTabActiveData:e,imageList:t}=Q(ss()),a=I(),l=window.location.protocol+"//"+window.location.host+"/download?filename=",i=I(""),n=I([]);return{fileItem:a,image:i,imagesArr:n,init:()=>{i.value="".concat(l).concat(a.value.path),(async()=>{n.value=t.value.map((t=>"".concat(l).concat(e.value.param.path,"/").concat(t[0])))})()},$reset:()=>{n.value=[]}}})),ci=W("FILES-IMPORT-DATABASE-STORE",(()=>{const e=I(),t=$({name:""}),l=I(!1),i=I(),n=$({name:[{validator:(e,t,a)=>{""===t?a(new Error("请选择压缩路径")):a()},trigger:["blur"]}]}),s=I([]);return{fileItem:e,quickFormRef:i,quickForm:t,quickRules:n,disable:l,databaseOptions:s,onConfirm:async()=>{await c({title:"导入数据库",content:"是否将【".concat(e.value.fileName,"】文件，导入【").concat(s.value.find((e=>e.value==t.name)).label,"】数据库中，是否继续？")});const l={name:s.value.find((e=>e.value==t.name)).label,file:e.value.path};await i.value.validate();return(await a({loading:"正在导入数据库，请稍后...",request:ze(l),message:!0})).status},toggleName:e=>{t.name=e},getOptions:async()=>{await a({request:y({table:"databases"}),success:e=>{e.status&&(s.value=e.data.data.map((e=>({label:e.name,value:e.id}))),s.value.length>0&&(t.name=s.value[0].value))}})},$reset:()=>{Object.assign(t,{name:""}),l.value=!1,s.value=[]}}})),ui=W("FILES-VIDEO-STORE",(()=>{const{fileTabActiveData:e}=Q(ss()),t=I(""),l=I([]),i=e.value.param.path;return{currentPath:i,videoList:l,videoUrl:t,playVideo:e=>{t.value=i+"/"+e},getList:async()=>{await a({request:qe({path:i}),data:[Array,l]})},$reset:()=>{t.value="",l.value=[]}}})),pi=W("FILES-SHARE-LIST-STORE",(()=>{const e=I({}),{refreshFilesList:t}=ss(),l=I(!1),i=I([]),n=$({total:0,p:1,limit:12,file_name:""}),s=async()=>{a({loading:l,request:Ve({p:n.p,filename:n.file_name||""}),data:{data:[Array,i],page:b(n)}})},o=I([{label:"分享名称",prop:"ps"},{label:"文件地址",prop:"filename"},{label:"过期时间",prop:"expire"},Nt([{onClick:e=>{Pi(e,!0)},title:"详情"},{onClick:async e=>{await c({title:"取消分享",content:"是否取消分享该文件【".concat(e.ps,"】，是否继续？")}),a({loading:"正在取消文件分享，请稍后...",request:He({id:e.id}),message:!0,success:e=>{e.status&&(s(),t())}})},title:"关闭"}])]);return{compData:e,isLoading:l,tableData:i,shareTableData:n,tableColumn:o,getShareData:s,searchSubmit:e=>{n.file_name=e,s()},$reset:()=>{l.value=!1,i.value=[],Object.assign(n,{total:0,p:1,limit:12,file_name:""})}}})),di=W("FILES-SHARE-STORE",(()=>{const{refreshFilesList:e}=ss(),t=I(),l=$({ps:"",expire:24,password:""}),i=I(!1),n=I(),o=$({ps:[{validator:(e,t,a)=>{""===t?a(new Error("请输入分享名称")):a()},trigger:["blur"]}]}),r=I(),u=$({name:"",link:"",code:"",time:""}),p=I({}),d=I(!1),f=I(!1),h=I(),m=$({});return{fileItem:t,quickFormRef:n,quickForm:l,quickRules:o,disable:i,help:[{isHtml:!0,content:'<span class="text-[#ef0808]">注意：生成的外链分享链接具有一定的风险，请仅与可信任的人分享链接，避免敏感信息泄露</span>'}],compData:r,detail:p,detailFormRef:h,detailForm:u,detailRules:m,isDisabled:f,helpList:[{content:'<span class="text-[#ef0808]">注意：生成的外链分享链接具有一定的风险，请仅与可信任的人分享链接，避免敏感信息泄露</span>',isHtml:!0}],showQrcode:d,copyAll:e=>{w({value:"链接：".concat(u.link," 提取码：").concat(u.code)})},copyLink:e=>{w({value:u.link})},onConfirm:async o=>{const r={filename:cn(t.value.fileName),ps:l.ps,password:l.password,expire:l.expire};await n.value.validate(),await a({loading:i,request:Be(r),success:t=>(t.status?(s.success("分享成功"),o.unmount()):s.error(t.message),e(),Pi(t.data))})},onConfirmDetail:async()=>{try{await h.value.validate(),await c({title:"取消分享【".concat(p.value.ps,"】"),content:"您真的要取消分享【".concat(p.value.ps,"】吗？")});const t={id:p.value.id};return(await a({loading:"正在取消文件分享，请稍后...",request:He(t),message:!0,success:t=>{if(t.status){const{getShareData:t}=pi();t(),e()}}})).status}catch(t){}},initDetail:()=>{d.value=!1,Object.assign(u,{name:"",link:location.origin+"/down/"+r.value.token,code:"",time:r.value.expire}),(async()=>{if(r.value.isShareList)return p.value=r.value,u.name=r.value.ps,u.link=location.origin+"/down/"+r.value.token,u.code=r.value.password||"",u.time=r.value.expire,void(u.qrcode=location.origin+"/down/"+r.value.token+"?fname="+r.value.ps+"&down=true");await a({loading:"正在获取分享详情，请稍后...",request:Ge({id:Number(r.value.isShare|r.value.id)}),success:e=>{p.value=e.data,u.name=e.data.ps,u.link=location.origin+"/down/"+e.data.token,u.code=e.data.password||"",u.time=e.data.expire,u.qrcode=location.origin+"/down/"+e.data.token+"?fname="+e.data.ps+"&down=true"}})})()},init:()=>{i.value=!1,Object.assign(l,{ps:t.value.fileName,expire:24,password:""})}}})),fi=W("FILES-SEND-EMAIL-STORE",(()=>{const e=I(),t=$({email:"",msg:""}),l=I(!1),i=I(),r=$({email:[{validator:(e,t,a)=>{if(""===t)a(new Error("请输入接受者邮箱"));else{const e=t.trim().split(",").filter((e=>""!==e));let l=!1;e.forEach((e=>{_(e)||(l=!0)})),l?a(new Error("请输入正确的邮箱")):a()}},trigger:["blur"]}],fileName:[{validator:(t,a,l)=>{e.value.size>52428800?l(new Error("请选择小于50M的附件")):l()}}]}),c=e=>0===Object.keys(e).length;return{fileItem:e,quickFormRef:i,quickForm:t,quickRules:r,disable:l,getDetail:async()=>{const{data:e}=await We();c(e)&&Dt({title:"发送者配置",type:"mail",callback:()=>{}})},onConfirm:async()=>{const r={to_email:t.email,msg:t.msg,flist:[cn(e.value.fileName)]};await i.value.validate();return(await a({loading:l,request:Ue({data:JSON.stringify(r)}),success:e=>{const{data:t}=e;if(t.msg&&""!=t.msg)return s.error(t.msg),null;let a=[];Object.keys(t.list).forEach((e=>{const l=c(t.list[e].error);let i=[];l||Object.keys(t.list[e].error).forEach((a=>{i.push(a+"："+t.list[e].error[a])})),a.push({name:e,msg:l?"发送成功":i.join("<br>"),status:!!l})})),o({title:"发送至邮箱-结果",area:50,component:()=>n((()=>import("./index102.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),compData:{resultData:a,resultTitle:"发送至邮箱",resultColumn:[{label:"邮箱",prop:"name"},{label:"结果",width:80,render:e=>Z("span",{class:e.status?"text-primary":"text-danger"},e.status?"操作成功":"操作失败")},{label:"信息",render:e=>Z("span",{class:e.status?"":"text-danger"},e.msg)}]}})}})).data.status},$reset:()=>{l.value=!1,Object.assign(t,{email:"",msg:""})}}})),hi=W("FILES-SPLIT-STORE",(()=>{var e;const t=ss(),{fileTabActiveData:l}=Q(t),{refreshFilesList:i}=t,n=I(),o=$({type:"size",size:1024,num:5,path:(null==(e=l.value)?void 0:e.param.path)||""}),r=I(!1),c=I(),u=$({size:[{validator:(e,t,a)=>{"size"===o.type?""===t?a(new Error("请输入拆分大小")):1024*Number(t)*1024>=n.value.size/2?a(new Error("拆分大小不能大于文件大小一半")):a():a()},trigger:["blur"]}],num:[{validator:(e,t,a)=>{"num"===o.type&&(""===t||Number(t)<2)?a(new Error("拆分数量不能小于2个")):a()},trigger:["blur"]}],path:[{validator:(e,t,a)=>{""===t?a(new Error("请选择存放目录")):a()},trigger:["blur"]}]});return{fileItem:n,quickFormRef:c,quickForm:o,quickRules:u,disable:r,help:[{content:"拆分后会在存放目录(默认当前目录)下创建一个xxx_split文件夹,存放配置文件以及拆分文件"}],openFile:()=>{Ct({type:"dir",change:e=>{o.path=e}})},onConfirm:async e=>{const t={file_path:cn(n.value.fileName),save_path:o.path};"size"===o.type?t.split_size=Number(o.size):t.split_num=Number(o.num),await c.value.validate();return(await a({loading:"正在拆分文件，请稍后...",request:Je(t),message:!0,success:e=>{s.request({status:e.status,msg:e.status?"拆分成功":"拆分失败"}),i()}})).status},init:()=>{var e;r.value=!1,Object.assign(o,{type:"size",size:1024,num:5,path:(null==(e=l.value)?void 0:e.param.path)||""})}}})),mi=W("FILES-TERMINAL-STORE",(()=>{const{fileTabActiveData:e}=Q(ss()),t=I(),a=I(),l=()=>a.value,i=async()=>{const e=l(),t=null==e?void 0:e.socketInfo();try{await c({title:"确定要关闭SSH会话吗？",content:"关闭SSH会话后，当前命令行会话正在执行的命令可能被中止，确定关闭吗？"}),n(),t.close()}catch(a){}},n=async()=>{const e=await t.value;null==e||e.unmount()};return{instance:t,filesTerminalRef:a,init:()=>{N((()=>{const t=l(),a=null==t?void 0:t.socketInfo(),i=null==t?void 0:t.terminal;a.send("\r\nclear\r"),a.send("cd ".concat(e.value.param.path,"\r")),null==i||i.focus()}))},onCancel:()=>(i(),!1)}})),vi=W("FILES-MERGE-STORE",(()=>{var e;const t=ss(),{fileTabActiveData:l}=Q(t),{refreshFilesList:i}=t,n=I(),s=$({path:(null==(e=l.value)?void 0:e.param.path)||"",disable:!1,file:{}}),o=I(!1),r=I(),c=$({path:[{validator:(e,t,a)=>{""===t?a(new Error("请选择存放目录")):a()},trigger:["blur"]}]});return{fileItem:n,loading:o,quickFormRef:r,quickForm:s,quickRules:c,openFile:()=>{Ct({type:"dir",change:e=>{s.path=e}})},getFile:async()=>{await a({loading:o,request:$e({file_path:n.value.path}),success:e=>{var t;Object.assign(s,{path:(null==(t=l.value)?void 0:t.param.path)||"",disable:!1,file:e.data})}})},onConfirm:async e=>{const t={file_path:cn(n.value.fileName),save_path:s.path};await r.value.validate(),await a({loading:o,request:Ke(t),message:!0,success:t=>{i(),t.status&&e&&e()}})}}})),gi=W("FILES-EDIT-STORE",(()=>{const e=I(),t=I(!1),l=$({data:""});return{compData:e,config:{mode:"ace/mode/nginx"},load:t,cmdForm:l,onConfirm:async t=>{const i={sfile:e.value.fileItem.path,filename:(""!=e.value.path?e.value.path+"/":"")+e.value.name,data:l.data},n="zip"===e.value.fileItem.ext?Ye:Xe;await a({loading:"正在保存，请稍后...",request:n({data:JSON.stringify(i)}),message:!0,success:e=>{e.status&&t&&t()}})},init:()=>{l.data=e.value.data.data}}})),yi=W("FILES-DECOMPRESSION-STORE",(()=>{const e=ss(),{fileTabActiveData:t}=Q(e),{refreshFilesList:l,getRealTask:i}=e,n=ei(),{instance:s}=Q(n),o=I(),r=$({fileName:"",path:t.value.param.path||"",coding:"UTF-8",password:"",auth:"755"}),c=I(!1),u=I(),p=$({path:[{validator:(e,t,a)=>{""===t?a(new Error("请选择解压路径")):a()},trigger:["blur"]}],auth:[{validator:(e,t,a)=>{""===t||isNaN(Number(t))||t.length>3?a(new Error("请输入正确的权限")):a()},trigger:["blur"]}]});return{fileItem:o,quickFormRef:u,quickForm:r,quickRules:p,codeOptions:[{label:"UTF-8",value:"UTF-8"},{label:"GBK",value:"GBK"}],disable:c,openFile:()=>{Ct({type:"dir",change:e=>{r.path=e}})},toggleCode:e=>{r.coding=e},init:()=>{Object.assign(r,{fileName:o.value.fileName,path:t.value.param.path||"",coding:"UTF-8",password:"",auth:"755"})},onConfirm:async()=>{const e={sfile:o.value.path,dfile:r.path,type:"tar.gz"===o.value.ext?"tar":"zip",coding:r.coding,password:r.password,power:r.auth};await u.value.validate(),c.value=!0;const t=await a({loading:"正在解压文件，请稍后...",request:Qe(e),message:!0,success:async e=>{l(),i();const t=await s.value;null==t||t.unmount()}});return c.value=!1,t.status}}})),bi=W("FILES-COMPRESS-STORE",(()=>{const t=ss(),{fileTabActiveData:l}=Q(t),{refreshFilesList:i,getRealTask:n}=t,o=I(),r=$({type:"tar.gz",path:"",download:!1}),c=I(!1),u=I(),p=$({path:[{validator:(e,t,a)=>{""===t?a(new Error("请选择压缩路径")):a()},trigger:["blur"]}]}),d=I(),f=I(),m=I([]),v=I(null),g=async e=>{try{const t=f.value.params;(await Qe({...t,...e})).status&&v.value.tableSelectList.forEach((e=>{m.value.forEach(((t,a)=>{if(e.zip_file_path===t.zip_file_path){const e={...t,status:"执行成功"};m.value.splice(a,1,e)}}))})),m.value.find((e=>void 0===e.status))||(w(),s.success("解压成功"),i())}catch(t){}},y=async t=>{try{const e=f.value.params;(await f.value.callback({...e,...t})).status&&v.value.tableSelectList.forEach((e=>{m.value.forEach(((t,a)=>{if(e.zip_file_path===t.zip_file_path){const e={...t,status:"执行成功"};m.value.splice(a,1,e)}}))})),m.value.find((e=>void 0===e.status))||(w(),s.success("解压成功"),i())}catch(a){e(a)}},b=K([It(),{label:"文件名",prop:"name",minWidth:150},{label:"大小",prop:"size",width:150,render:e=>e.file_size===e.zip_file_size?V("span",{class:"text-primary"},[ee("无变化")]):V("div",null,[V("div",{class:"text-blue-500"},[ee("解压文件： "),V("span",{class:"text-danger"},[h(e.zip_file_size)])]),V("div",{class:"text-blue-500"},[ee("目标文件： "),V("span",{class:"text-danger"},[h(e.file_size)])])])},{label:"修改时间",prop:"time",width:200,render:e=>e.file_mtime===e.zip_file_mtime?V("span",{class:"text-primary"},[ee("无变化")]):V("div",null,[V("div",{class:"text-blue-500"},[ee("解压文件： "),V("span",{class:"text-danger"},[e.zip_file_mtime])]),V("div",{class:"text-blue-500"},[ee("目标文件： "),V("span",{class:"text-danger"},[e.file_mtime])])])},{label:"执行结果",prop:"action",fixed:"right",render:e=>e.status?V("span",{class:"text-primary"},[e.status]):V("span",{class:"text-blue-500"},[ee("-")])}]),w=async()=>{const e=await d.value;null==e||e.unmount()};return{fileItem:o,quickFormRef:u,quickForm:r,quickRules:p,disable:c,compressOptions:[{label:"tar.gz (推荐)",value:"tar.gz"},{label:"zip (通用格式)",value:"zip"},{label:"rar (WinRAR对中文兼容较好)",value:"rar"},{label:"7z (压缩率极高的压缩格式)",value:"7z"}],openFile:()=>{Ct({type:"dir",change:e=>{r.path=e+"/"+o.value.fileName+"_"+E(5)+"."+r.type}})},toggleType:e=>{r.type=e,r.path=l.value.param.path+"/"+(Array.isArray(o.value)?l.value.label:o.value.fileName)+"_"+E(5)+"."+r.type},onConfirm:async()=>{const e={sfile:Array.isArray(o.value)?o.value.map((e=>e.fileName)):o.value.fileName,dfile:r.path,z_type:r.type,path:l.value.param.path+"/"};await u.value.validate();const t=r.download?Ze:et;await a({loading:"正在压缩文件，请稍后...",request:t(e),success:e=>{e.status?(r.download?window.open(e.data.msg):s.success("压缩成功"),n(),setTimeout((()=>{i()}),1e3)):s.error(e.msg)}})},init:()=>{Object.assign(r,{type:"tar.gz",path:("/"==l.value.param.path?"":l.value.param.path)+"/"+(Array.isArray(o.value)?l.value.label:o.value.fileName)+"_"+E(5)+".tar.gz"||"",download:!1})},instance:d,compData:f,tableColumn:b,tableList:m,jump:()=>{if(0===v.value.tableSelectList.length)return void s.error("请选择文件");const e=v.value.tableSelectList.map((e=>({zip_file_path:e.zip_file_path,file_path:e.file_path})));if(f.value.callback){const t=f.value.params,a=JSON.parse(t.data).extract_path.split("/");return a.pop(),void y({data:JSON.stringify({...JSON.parse(t.data),extract_path:a.join("/"),filenames:e,type:0})})}g({filenames:JSON.stringify(e),type1:0})},cover:()=>{if(0===v.value.tableSelectList.length)return void s.error("请选择文件");const e=v.value.tableSelectList.map((e=>({zip_file_path:e.zip_file_path,file_path:e.file_path})));if(f.value.callback){const t=f.value.params,a=JSON.parse(t.data).extract_path.split("/");return a.pop(),void y({data:JSON.stringify({...JSON.parse(t.data),extract_path:a.join("/"),filenames:e,type:1})})}g({filenames:JSON.stringify(e),type1:1})},rename:()=>{if(0===v.value.tableSelectList.length)return void s.error("请选择文件");const e=v.value.tableSelectList.map((e=>({zip_file_path:e.zip_file_path,file_path:e.file_path})));if(f.value.callback){const t=f.value.params,a=JSON.parse(t.data).extract_path.split("/");return a.pop(),void y({data:JSON.stringify({...JSON.parse(t.data),extract_path:a.join("/"),filenames:e,type:2})})}g({filenames:JSON.stringify(e),type1:2})},initCover:()=>{m.value=f.value.data},$reset:()=>{m.value=[]}}})),wi=W("FILES-DETAIL-STORE",(()=>{const e=ss(),{fileTabActiveData:t}=Q(e),{refreshFilesList:l}=e,i=I(),n=I("routine"),o=I(!1),r=I([]),p=()=>{r.value=[{title:"文件名",value:i.value.name},{title:"类型",value:i.value.st_type||"未知文件"},{title:"文件路径",value:"".concat(i.value.path,"/").concat(i.value.name)},{title:"文件大小",value:"".concat(i.value.st_size)},{title:"访问时间",value:u(i.value.st_atime)},{title:"修改时间",value:u(i.value.st_mtime)},{title:"元数据修改时间",value:u(i.value.st_ctime)},{title:"文件MD5",value:i.value.md5},{title:"文件sha1",value:i.value.sha1},{title:"所属用户",value:i.value.user},{title:"所属组",value:i.value.group},{title:"文件权限",value:i.value.mode},{title:"特殊权限",value:i.value.lsattr||"无"},{title:"用户id",value:i.value.st_uid},{title:"用户组id",value:i.value.st_gid},{title:"inode的链接数",value:i.value.st_nlink},{title:"inode的节点号",value:i.value.st_ino},{title:"inode保护模式",value:i.value.st_mode},{title:"inode驻留设备",value:i.value.st_dev}]},d=$({owner:[],group:[],public:[],auth:0,user:"root",isDir:!0,checkNumber:""}),f=e=>{256&(e=parseInt(e.toString(),8))?d.owner.push("r"):d.owner=d.owner.filter((e=>"r"!==e)),128&e?d.owner.push("w"):d.owner=d.owner.filter((e=>"w"!==e)),64&e?d.owner.push("x"):d.owner=d.owner.filter((e=>"x"!==e)),32&e?d.group.push("r"):d.group=d.group.filter((e=>"r"!==e)),16&e?d.group.push("w"):d.group=d.group.filter((e=>"w"!==e)),8&e?d.group.push("x"):d.group=d.group.filter((e=>"x"!==e)),4&e?d.public.push("r"):d.public=d.public.filter((e=>"r"!==e)),2&e?d.public.push("w"):d.public=d.public.filter((e=>"w"!==e)),1&e?d.public.push("x"):d.public=d.public.filter((e=>"x"!==e)),d.owner=Array.from(new Set(d.owner)),d.group=Array.from(new Set(d.group)),d.public=Array.from(new Set(d.public))};return{activeName:n,fileItem:i,load:o,getFileItem:async()=>{o.value=!0;const e=await xe({filename:i.value.path});e.status?(i.value={...i.value,...e.data},o.value=!1):s.error(e.msg);const a=await tt({path:t.value.param.path+"/"+i.value.fileName});i.value.st_size=a.data,p()},$reset:()=>{r.value=[],Object.assign(d,{owner:[],group:[],public:[],auth:0,user:"root",isDir:!0,checkNumber:""})},attrList:r,watchFileItem:p,showHistory:e=>{},recoverHistory:async e=>{await c({title:"恢复历史文件",content:"是否恢复历史文件 ".concat(u(i.value.st_mtime),"?恢复历史文件后，当前文件内容将会被替换！")}),a({loading:"正在恢复历史文件，请稍后...",request:at({filename:"".concat(i.value.path,"/").concat(i.value.name),history:e.st_mtime}),success:e=>{e.data.status?(s.success("恢复成功"),l()):s.error("恢复失败")}})},checkList:d,ownerOptions:[{label:"root",value:"root"},{label:"www",value:"www"},{label:"mysql",value:"mysql"}],checkNumber:e=>{d.checkNumber=e;const t=String(e).replace(/[^\d]/g,"").slice(0,3);d.auth=t,f(Number(d.auth))},changeUser:e=>{d.user=e},setFileAuths:async()=>{let e=d.auth.toString();if(e.length>3)s.error("请输入正确权限");else if(d.checkNumber.match(/\D/g))s.error("请输入正确权限");else if(e.match(/\D/g))s.error("请输入正确权限");else{for(;e.length<3;)e="0"+e;await a({loading:"正在设置文件权限，请稍后...",request:lt({filename:"".concat(i.value.path,"/").concat(i.value.name),user:d.user,access:e,all:d.isDir?"True":"False"}),message:!0,success:l})}},reversePermission:()=>{let e=0;const t=(t,a,l,i)=>{t.includes("r")&&(e|=a),t.includes("w")&&(e|=l),t.includes("x")&&(e|=i)};for(t(d.owner,256,128,64),t(d.group,32,16,8),t(d.public,4,2,1),d.auth=e.toString(8);d.auth.length<3;)d.auth="0"+d.auth},getFileAuths:async()=>{const e=await de({filename:"".concat(i.value.path)});if(e.status){const t=e.data;d.auth=t.chmod,d.user=t.chown,f(Number(t.chmod))}else s.error(e.msg)}}})),_i=W("FILES-RECYCLE-BIN-STORE",(()=>{const e=ss(),{recyclingBinStatus:t}=Q(e),{getRealTask:l}=e,i=I("all"),r=I(!1),p=I(null),d=I(null),f=$({data:{},status:!1,statusDB:!1,type:"all",p:1,limit:10,search:"",time:[]}),m=I(),v=async(e,t)=>{i.value=e,w.value=[],E.value="",f.type=i.value,f.time=[],f.search="","db"===e?(j.value="all",await k({type:"db"})):(j.value=e,await k({type:e}))},g=()=>{var e,t,a,l,n;const s="db"===i.value;m.value={list:(null==(e=f.data)?void 0:e.list)||[],type:s||"db"!==f.type?f.type||"db":j.value,num:void 0===(null==(t=f.data)?void 0:t.search_num)?null==(a=f.data)?void 0:a[s?i.value:j.value]:null==(l=f.data)?void 0:l.search_num,size:(null==(n=f.data)?void 0:n.all_size)||0},b.value=s?f.statusDB:f.status,"db"!==m.value.type&&"all"!==m.value.type&&(x.p=1)},y=async(e,a=!0)=>{e&&e.time_search&&(f.time=e.time_search),e&&e.search?f.search=e.search:e&&""===e.search&&(f.search=""),e&&e.type&&(f.type=e.type);const l={type:f.type,p:f.p,limit:f.limit,search:f.search,time_search:f.time,...e};a&&(r.value=!0);const i=await ct(l);r.value=!1,f.data=i.data,f.status=i.data.status,t.value=i.data.status,f.statusDB=i.data.status_db,g()},b=I(!1),w=I([]),_=I(""),E=I(""),S=I(!1),L=$({resultData:[],resultColumn:[{label:"数据库",prop:"file"}],resultTitle:""}),T=I(),C=$({disabledDate:e=>{const t=new Date;t.setHours(23,59,59,999);const a=t.getTime();return e.getTime()>a}}),D=I(),x=$({loading:!1,p:1,limit:10}),k=async(e,t=!0)=>{let a="";"db"===i.value?(j.value="all",a="db"):a=j.value,await y({p:x.p,limit:x.limit,type:a,...e},t)},R=async e=>{"db"===m.value.type?(await c({title:"恢复数据库".concat(e.name),content:"您确定要恢复数据库【".concat(e.name,"】，是否继续？")}),await a({loading:"正在恢复数据库，请稍后...",request:st({path:e.rname}),message:!0,success:e=>{e.status&&k()}})):(M.value=e,o({title:"恢复文件".concat(e.name),area:41,btn:"确定",component:()=>n((()=>import("./index191.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),onConfirm:G}))},N=async e=>{const t="db"===m.value.type?"数据库":"文件";await c({title:"删除".concat(t).concat(e.name),type:"input",input:{content:"删除".concat(t)},content:"风险操作，删除后，".concat(t,"将彻底消失，无法恢复，是否继续操作？")}),await a({loading:"正在删除，请稍后...",request:ot({path:e.rname}),success:t=>{1===t.tag?(L.resultData=[{file:e.rname}],L.resultTitle=t.msg,S.value=!0):(s.request(t),k())}})},F=async e=>{const{data:t}=await rt({name:e.name,rname:e.rname});t.status?window.open("/download?filename=".concat(t.msg.path)):s.error(t.msg)},O=async e=>{const{data:t}=await rt({name:e.name,rname:e.rname});if("string"==typeof t.msg&&t.msg.includes("找不到文件"))return void s.error("当前文件不可预览");const a=t.msg.file.nm.split(".").pop();if("images"===Cn(a)){const e={path:t.msg.path};Yi(e)}else Nn(t.msg)},A=I([It(),{label:"文件名",prop:"fileName",minWidth:150,render:e=>V("span",{class:"flex items-center"},[V("span",{class:["icon-bg",e.is_dir?"folder-icon":Object.keys(xi).includes(Tn(e.name,"file"))?xi[Tn(e.name,"file")]+"-icon":"file-icon"]},null),V("span",{class:"truncate w-[26rem]"},[e.name])])},{label:"原位置",prop:"dname",showOverflowTooltip:!0,render:e=>V("span",{class:"truncate"},[e.dname])},{label:"大小",width:90,render:e=>h(e.size)},{label:"删除时间",width:145,render:e=>u(e.time)},Nt([{title:"下载",isHide:e=>e.is_dir,onClick:F},{title:"查看",isHide:e=>e.is_dir,onClick:O},{title:"恢复",onClick:R},{title:"删除",onClick:N}])]),P=[{label:"恢复",value:"recover",event:async(e,t,a,l,i)=>{const n=async e=>await st({path:e.rname});await e({title:"批量恢复",content:"批量恢复选中后，被删除将会恢复，是否继续操作？",column:[{prop:"rname",label:"名称"},Ft()],onConfirm:async()=>(await t(n),k(),!1)})}},{label:"删除",value:"delete",event:async(e,t,l,i,n)=>{(async(e,t)=>{const l="db"===m.value.type?"数据库":"文件";await c({title:"删除".concat(l),type:"input",input:{content:"删除".concat(l)},isHtml:!0,content:"风险操作，删除后，".concat(l,"将彻底消失，无法恢复，是否继续操作？")}),await a({loading:"正在批量删除，请稍后...",request:ut({path_list:e.map((e=>e.rname))}),success:e=>{let a=[];e.success.forEach((e=>{a.push({name:e,msg:"删除成功",status:!0})})),Object.keys(e.error).forEach((t=>{a.push({name:t,msg:e.error[t],status:!1})})),as({resultData:a,resultTitle:"删除"}),t(),k()}})})(l.value,n)}}],j=I("all"),M=I(),z=$({type:"before",path:""}),q=I(!1),H=I(),B=$({path:[{validator:(e,t,a)=>{""===t&&"path"===z.type?a(new Error("请选择恢复目录")):a()},trigger:["blur"]}]}),G=async()=>{await H.value.validate();return(await a({loading:q,request:st({path:M.value.rname,rpath:"path"===z.type?"".concat(z.path,"/").concat(M.value.name):M.value.dname}),message:!0,success:e=>{e.status&&k()}})).status};return{activeName:i,loading:r,binData:f,compData:m,watchBinData:g,handleTabChange:v,statusSwitch:b,time:w,popupData:L,showPopup:S,searchName:E,pickerOptions:C,formatDate:_,onCancel:()=>{S.value=!1},showPlayer:()=>{T.value.focus()},cleanBin:async()=>{let e=null;try{await c({title:"清空回收站",type:"input",input:{content:"清空回收站"},isHtml:!0,content:'<span class="text-[red]">清空回收站后，回收站'.concat("db"===i.value?"【所有数据库】":"【所有暂存文件】","将彻底消失，无法恢复，是否继续操作？</span>")}),e=s.load("正在清空回收站，请稍候...");const t=await nt({type:"db"===i.value?"db":"files"}),{fail_list:a}=t;if(a&&(null==a?void 0:a.length)>0&&"db"===i.value){const e=a.map((e=>({file:e})));L.resultData=e,L.resultTitle=t.msg,S.value=!0}else s.request(t);l(),k()}catch(t){}finally{e&&e.close()}},clearTime:()=>{w.value=[]},setStatus:async e=>{let t={};e&&(t.db=1);const a=await it(t);s.request(a.data),y()},goSearch:()=>{y({search:E.value})},changeClearCheck:async()=>{const e=await nt({type:"db",force:1});s.request(e),l(),y(),S.value=!1},watchTime:()=>{var e;const t={time_search:[]};2===(null==(e=w.value)?void 0:e.length)?(w.value[0]=new Date(w.value[0]).setHours(0,0,0,0),w.value[1]=new Date(w.value[1]).setHours(23,59,59,0),t.time_search=JSON.stringify([w.value[0]/1e3,w.value[1]/1e3])):(_.value="",t.time_search=JSON.stringify([])),y(t,!1)},dbTableRef:p,tableRef:D,fileTableRef:d,tableData:x,tableColumn:A,tableBatchOptions:P,deleteClearCheck:async()=>{const e=await ot({path:L.resultData[0].file,force:1});s.request(e),S.value=!1,k()},refresh:k,tabActive:j,config:[{type:"all",label:"全部",icon:"svgtofont-left-soft"},{type:"dir",label:"文件夹",icon:"svgtofont-left-files"},{type:"file",label:"文件",icon:"svgtofont-file-text"},{type:"image",label:"图片",icon:"svgtofont-icon-term"},{type:"ont_text",label:"文档",icon:"svgtofont-el-document"}],toggleType:e=>{j.value=e,k({type:e},!1)},rowData:M,isCmdLoading:q,cmdForm:z,cmdFormRef:H,cmdRules:B,openFile:()=>{Ct({type:"dir",change:e=>{z.path=e}})},clearSpace:e=>{z.path=z.path.replace(/\s+/g,"")},init:()=>{f.type=i.value,v(i.value)},$reset:()=>{i.value="all",r.value=!1,Object.assign(f,{data:{},status:!1,statusDB:!1,type:"all",p:1,limit:10,search:"",time:[]}),b.value=!1,w.value=[],_.value="",E.value="",S.value=!1,Object.assign(L,{resultData:[],resultColumn:[{label:"数据库",prop:"file"}],resultTitle:""}),Object.assign(x,{loading:!1,p:1,limit:10}),j.value="all"},$resetCmdForm:()=>{q.value=!1,Object.assign(z,{type:"before",path:""})}}})),Ei=W("FILES-LIST-VIEW-STORE",(()=>{const e=ss(),{mainHeight:t,authType:a,fileTabActiveData:l,navBtnHeight:i,imageList:n,imgPathItem:o,isNoCreteItem:r,createListType:u,globalTamperStatus:p,dataList:f,fileBatchNum:h,diskAnalysis:m}=Q(e),{refreshFilesList:v,watchCreateListType:g,watchDeleteFileData:y}=e,b=window.location.protocol+"//"+window.location.host+"/download?filename=",w=I([{label:"文件名称",id:"fileName",width:"42",sort:"",sortable:!0,class:"cursor-pointer"},{label:"企业级防篡改",width:"12"},{label:"权限/所有者",width:"10"},{label:"大小",width:"10",id:"size",sort:"",sortable:!0,class:"cursor-pointer"},{width:"16",label:"修改时间",id:"time",sort:"",sortable:!0,class:"cursor-pointer"},{label:"备注",width:"20"},{label:"操作",type:"operation",style:"justify-content:flex-end;padding-right: 2.8rem;flex:1;display:flex;"}]),_=I(null),E=I(!1),T=I(null);K([]);const C=I([]),D=I(!1),x=I([]),k=I(0),R=I(!0),F=I(null),O=I(0),A=I(0),P=e=>{(async e=>{if(rn(e.fileName))return s.error('文件名不能包含以下字符：\\ / : * ? " < > |'),e.isReName=!0,void(r.value=!0);if(r.value=!1,e.isNew){if(u.value="",g(""),""===e.fileName)return void y(e);const t=await re({path:cn(e.fileName),type:e.type});t.status&&(await v(),e.isReName=!1,"file"===e.type&&setTimeout((()=>{const t=f.value.find((t=>t.fileName===e.fileName));t&&Fn(t)}),100)),y(e),s.request(t)}else{if(e.fileName===e.oldName)return void(e.isReName=!1);let t=s.load("正在重命名，请稍候...");const a=await ce({sfile:cn(e.oldName),dfile:cn(e.fileName),rename:!0});t.close(),a.status?(e.isReName=!1,s.success(a.msg)):s.error(a.msg),v()}})(e)};let j=null;const M=e=>{const t=Array.from(e.target.classList);return!(t.includes("checkbox--icon")||t.includes("size-link")||t.includes("svgtofont-el-loading")||t.includes("el-input__inner"))};let z=null,q={top:0,left:0},V={top:0,left:0},H=0;const B=e=>{if(2===e.button||e.target.closest(".el-input__inner"))return;const t=document.getElementById("drugBox");if(t&&t.remove(),z){const t=z.getBoundingClientRect().top,a=z.getBoundingClientRect().left;q={top:e.clientY-t,left:e.clientX-a}}document.addEventListener("mousemove",G),document.addEventListener("mouseup",W)},G=e=>{const t=document.getElementById("drugBox");if(t&&t.remove(),z){const t=z.getBoundingClientRect().top,a=z.getBoundingClientRect().left;V={top:e.clientY-t>0&&e.clientY-t<z.offsetHeight?e.clientY-t:e.clientY-(t+z.offsetHeight)>1?z.offsetHeight:0,left:e.clientX-a>0&&e.clientX-a<z.offsetWidth?e.clientX-a:e.clientX-(a+z.offsetWidth)>1?z.offsetWidth:0};const l=(null==z?void 0:z.scrollTop)||0,i={top:V.top>q.top?q.top+l:V.top+l,left:V.left>q.left?q.left:V.left};let n=Math.min(Math.abs(V.left-q.left),a+z.offsetWidth-i.left),s=Math.min(Math.abs(V.top-q.top),t+z.offsetHeight-i.top+l);if(e.clientY-t<0){const a=Math.abs(e.clientY-t);z.scrollTop-=a,0!=z.scrollTop&&(H+=a),s+=H}if(e.clientY-(t+z.offsetHeight)>1){const a=e.clientY-(t+z.offsetHeight);z.scrollTop+=a,z.scrollHeight-z.scrollTop!=z.clientHeight&&(H+=a),s+=H,i.top-=H}if(q.top==V.top||q.left==V.left)return!0;const o=document.createElement("div");o.classList.add("absolute","border","top-0","border-[#072246]","bg-[#cce8ff]","opacity-[0.15]","overflow-hidden"),o.id="drugBox",z.appendChild(o),o.style.left=i.left+"px",o.style.top=i.top+"px",o.style.width=n+"px",o.style.height=s+"px";const r=document.getElementById("drugBox");if(z&&r){const e=r.offsetTop,t=r.offsetTop+r.offsetHeight;let a=[];J.value.forEach(((l,i)=>{const n=l.offsetTop,s=l.offsetTop+l.offsetHeight,o=f.value[i];s>=e&&n<=t&&a.push(o.path)}));const l=new Set(a),i=new Set(C.value);l.size===i.size&&[...l].every((e=>i.has(e)))||(C.value=[...l],ie()),C.value.length>0&&C.value.length===f.value.length?X.value=!0:X.value=!1}}},W=e=>{e.preventDefault(),e.stopPropagation(),document.removeEventListener("mousemove",G),document.removeEventListener("mouseup",W);const t=document.getElementById("drugBox");t&&t.remove()},U=e=>{C.value=e.map((e=>e.path)),ie()},J=I([]),$=()=>{J.value=[];for(let e=0;e<f.value.length;e++)J.value.push({offsetTop:36*e,offsetHeight:36});J.value.length&&(A.value=J.value[J.value.length-1].offsetTop,A.value<=t.value-(i.value||64)-266?R.value=!1:R.value=!0)},Y=()=>{N((()=>{for(let e=0;e<n.value.length;e++){const t=n.value[e];f.value.forEach((e=>{e.fileName===t[0]&&t[1]&&(e.isSmallImage=t[1])}))}x.value=f.value.filter((e=>void 0!==e.isSmallImage)).map((e=>"".concat(b).concat(e.path)))}))},X=I(!1),Z=e=>{var t;2===e.button&&"INPUT"===e.target.tagName&&e.preventDefault(),e.target.closest(".scrollTable")||e.target.closest(".v-contextmenu")||null==(t=_.value)||t.hide()},ee=I(0),te=I(null),ae=I(null),le=async()=>{try{const e=await S({sName:"disk_analysis"});(e.data.status||"ltd"===a.value)&&xt({name:e.data.name,type:"i",pluginInfo:e.data,softData:e.data})}catch(e){}},ie=()=>{let e=f.value.filter((e=>C.value.includes(e.path)));h.value=e},ne=()=>{N((()=>{z=document.querySelector(".scrollTable"),null==z||z.addEventListener("mousedown",B)}))};return{mainHeight:t,authType:a,diskAnalysis:m,headData:w,dataList:f,selectList:C,fileBatchNum:h,checkedAll:X,imgPathItem:o,imgIndex:k,showViewer:D,imgList:x,scrollHeight:O,scrollHeightBottom:A,isShowShadow:R,context:_,contextRow:T,isBatch:E,scrollRef:F,imageList:n,navBtnHeight:i,fileTabActiveData:l,bindMouseDown:ne,buyPlugin:()=>{m.value.isBuy||"ltd"===a.value?le():kt({sourceId:140,disablePro:!0})},clickName:e=>{if("dir"===e.type)pn(e.path);else{const t={"查看图片":["jpg","png","gif","jpeg"],"播放视频":["mp4","avi","mov","rmvb","rm","flv","3gp","wmv","mkv","mpeg","mpg","ts","webm","vob","swf"],"解压文件":["zip","rar","gz","war","tgz","7z","tar.gz","tar"],"播放音频":["mp3","wav","wma","ogg","ape","flac","aac","m4a"]},a=e.ext;let l="查看文档";for(const e in t)if(t[e].includes(a)){l=e;break}j&&j.close(),j=s.msg({customClass:"no-icon !z-10",message:"双击".concat(l),type:"info"})}},handleBlurCheck:()=>{const e=f.value.find((e=>e.isReName));P(e)},handleEvent:(e,t)=>{if(d()&&e instanceof MouseEvent)return;const a=(new Date).getTime(),l=a-ee.value;var i,n;l<300&&l>0&&ae.value===t?(null!==te.value&&clearTimeout(te.value),i=e,n=t,j&&j.close(),M(i)&&(n.isPs||n.isReName||Fn(n))):(ae.value=t,te.value=window.setTimeout((()=>{((e,t)=>{const a=Array.from(e.target.classList);M(e)&&(a.includes("fileName")||(C.value=[t.path],ie()))})(e,t)}),300)),ee.value=a},handleRightClick:(e,t)=>{var a,l;e.preventDefault(),e.stopPropagation();const i=t?t.path:null;var n;if((t&&(n=i,!C.value.find((e=>e===n)))||0===e.button)&&(C.value=[],C.value.push(i),ie()),C.value.length>1&&t&&2===e.button){E.value=!0;let t=[];return f.value.forEach((e=>{C.value.includes(e.path)&&t.push(e)})),T.value=t,void(null==(a=_.value)||a.show(e))}E.value=!1,T.value=t||null,t||(C.value=[],ie()),null==(l=_.value)||l.show(e)},handleCheckFile:e=>{new Set(C.value).has(e.path)?C.value=C.value.filter((t=>t!==e.path)):C.value.push(e.path),X.value=C.value.length===f.value.length,ie()},handleCheckAll:e=>{U(e?f.value:[]),X.value=e},handleFileLock:async e=>{if("ltd"===a.value)if(p.value.status)Qi(e);else{const{data:e}=await S({sName:"tamper_core"});e.setup?L(p.value.tip)?s.error("企业级防篡改未安装或版本较低，请检查插件状态。"):s.error("“".concat(p.value.tip,"”请前往【企业级防篡改】启动服务。")):await xt({name:e.name,type:"i",pluginInfo:e})}else kt({sourceId:71})},handleEnPsView:e=>{e.isOsPs||(e.oldPs=e.ps,e.isPsEdit=!0)},handleLvPsView:async(e,t)=>{t.isOsPs||e.target.children[1].contains(document.activeElement)||(t.isPsEdit=!1)},handleSetPs:async e=>{if(e.ps!==e.oldPs){let t=s.load("正在设置备注，请稍候...");const a=await pt({filename:e.path,ps_type:0,ps_body:e.ps});a.status?(e.isPsEdit=!1,s.success(a.msg)):s.error(a.msg),t.close()}else e.isPsEdit=!1},handleReName:e=>{e.oldName=e.fileName,e.isReName=!0},openImgView:e=>{k.value=x.value.findIndex((t=>t==="".concat(b).concat(e.path))),D.value=!0},opearationIconClick:async(e,t)=>{const a={top:"置顶",favorite:"收藏",share:"分享"};try{switch("share"!=t&&await c({title:"提示",isHtml:!0,content:"取消【".concat(e.fileName,"】的").concat(a[t],"，是否继续？")}),t){case"top":wn(e,e.isTop?"unset":"set");break;case"favorite":bn(e,(()=>e.isFav=!1));break;case"share":Pi(e)}}catch(l){}},onReNameKeyup:P,sortTable:e=>{e.sortable&&(w.value.forEach((t=>{t.id!==e.id&&(t.sort="")})),"asc"===e.sort?e.sort="desc":"desc"===e.sort?e.sort="":e.sort="asc",l.value.param.sort=""!=e.sort?e.id:"",l.value.param.reverse="asc"==e.sort?"False":"True",v())},calcFileListHeightFn:$,setSmallImage:Y,closeImgPreView:()=>{D.value=!1},findCurrentImgIndex:e=>{k.value=x.value.findIndex((t=>t===e)),D.value=!0},watchDataList:e=>{C.value=[],X.value=!1,e.length&&($(),Y()),ie(),N((()=>{var e;null==(e=F.value)||e.scrollToPosition(0)}))},init:()=>{$(),ne(),F.value.$el.addEventListener("scroll",(()=>{O.value=F.value.$el.scrollTop+(t.value-(i.value||64)-266),0===F.value.$el.scrollTop&&(O.value=0)})),(()=>{const e=w.value.find((e=>e.id===l.value.param.sort));e&&(e.sort="False"==l.value.param.reverse?"asc":"desc")})(),document.addEventListener("mousedown",Z)},$reset:()=>{null==z||z.removeEventListener("mousemove",G),document.removeEventListener("mousedown",Z)}}})),Si=t(),Li=new Map([["/etc","PS: 系统主要配置文件目录"],["/home","PS: 用户主目录"],["/tmp","PS: 公共的临时文件存储点"],["/root","PS: 系统管理员的主目录"],["/home","PS: 用户主目录"],["/usr","PS: 系统应用程序目录"],["/boot","PS: 系统启动核心目录"],["/lib","PS: 系统资源文件类库目录"],["/mnt","PS: 存放临时的映射文件系统"],["/www","PS: 宝塔面板程序目录"],["/bin","PS: 存放二进制可执行文件目录"],["/dev","PS: 存放设备文件目录"],["/www/wwwlogs","PS: 默认网站日志目录"],["/www/server","PS: 宝塔软件安装目录"],["/www/wwwlogs","PS: 网站日志目录"],["/www/Recycle_bin","PS: 回收站目录,勿动"],["/www/server/panel","PS: 宝塔主程序目录，勿动"],["/www/server/panel/plugin","PS: 宝塔插件安装目录"],["/www/server/panel/BTPanel","PS: 宝塔面板前端文件"],["/www/server/panel/BTPanel/static","PS: 宝塔面板前端静态文件"],["/www/server/panel/BTPanel/templates","PS: 宝塔面板前端模板文件"],[T("backup_path"),"PS: 默认备份目录"],[T("sites_path"),"PS: 默认建站目录"]]),Ti=I([{name:"收藏夹",ename:"favorite",callback:()=>Ci("favorite")},{name:"文件分享",ename:"fileShare",callback:()=>Ci("fileShare")},{name:"文件同步",ename:"fileSync",callback:()=>Ci("fileSync")},{name:"企业级防篡改",ename:"tamperProof",callback:()=>Ci("tamperProof")},{name:"文件内容搜索",ename:"fileSearch",callback:()=>Ci("fileSearch")}]),Ci=e=>{const{openPlugin:t}=ss();switch(e){case"favorite":Fi();break;case"fileShare":Oi();break;case"fileSync":t("rsync",70);break;case"tamperProof":t("tamper_core",75);break;case"fileSearch":Ii()}},Di=["folder","folder-unempty","sql","c","cpp","cs","flv","css","js","htm","html","java","log","mht","php","url","xml","ai","bmp","cdr","gif","ico","jpeg","jpg","JPG","png","psd","webp","ape","avi","mkv","mov","mp3","mp4","mpeg","mpg","rm","rmvb","swf","wav","webm","wma","wmv","rtf","docx","fdf","potm","pptx","txt","xlsb","xlsx","7z","cab","iso","rar","zip","gz","war","bt","tgz","file","apk","bookfolder","folder-empty","fromchromefolder","documentfolder","fromphonefolder","mix","musicfolder","picturefolder","videofolder","sefolder","access","mdb","accdb","fla","doc","docm","dotx","dotm","dot","pdf","ppt","pptm","pot","xls","csv","xlsm","py","sh","json","lua","bt_split","bt_split_json"],xi={sql:"sql",css:"css",js:"js",html:"html",java:"java",php:"php",xml:"xml",bmp:"bmp",cdr:"cdr",gif:"gif",ico:"ico",jpeg:"jpeg",jpg:"jpg",JPG:"jpg",png:"png",webp:"webp",avi:"avi",mkv:"mkv",mov:"mov",mp3:"mp4",mp4:"mp4",mpeg:"mpeg",mpg:"mpg",rm:"rm",rmvb:"rmvb",swf:"swf",webm:"webm",wma:"wma",wmv:"wmv","7z":"compress",rar:"compress",zip:"compress",gz:"compress",war:"compress",tgz:"compress","tar.gz":"compress",iso:"iso",apk:"apk",access:"access",doc:"doc",pdf:"pdf",ppt:"ppt",xls:"xls",bt_split:"split",bt_split_json:"join",javascript:"js",json:"json",log:"log",lua:"lua",py:"py",python:"py",recycle:"recycle",flac:"flac",sh:"sh"},ki={images:["jpg","jpeg","png","bmp","gif","tiff","ico","JPG","webp"],compress:["zip","rar","gz","war","tgz","7z","tar.gz","tar"],video:["mp4","mp3","mpeg","mpg","mov","avi","webm","mkv","mkv","mp3","rmvb","wma","wmv","flac","mov"],ont_text:["iso","xlsx","xls","doc","docx","tiff","exe","so","bz","dmg","apk","pptx","ppt","xlsb","pdf"]},Ri=()=>{const{instance:e}=Q(oi());return e.value=o({title:"实时任务队列",area:51,component:()=>n((()=>import("./index192.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),modal:!1}),e.value},Ii=()=>o({title:"文件内容搜索",area:105,component:()=>n((()=>import("./index193.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)}),Ni=()=>{const e=ti(),{onConfirm:t}=e;return o({title:"创建软链接",area:50,btn:["确认","关闭"],component:()=>n((()=>import("./index194.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),onConfirm:t})},Fi=()=>{const e=ai(),{instance:t}=Q(e);return t.value=o({title:"管理收藏夹",area:85,component:()=>n((()=>import("./index195.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)}),t.value},Oi=()=>o({title:"分享列表",area:85,component:()=>n((()=>import("./index196.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)}),Ai=e=>{const t=di(),{fileItem:a}=Q(t),{onConfirm:l}=t;return a.value=e,o({title:"设置分享文件[ ".concat(e.fileName," ]"),area:45,btn:"生成外链",component:()=>n((()=>import("./index197.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),onConfirm:l})},Pi=(e,t)=>{const a=di(),{compData:l}=Q(a),{onConfirmDetail:i}=a;return l.value={...e,isShareList:t},o({title:"外链分享-[".concat(e.path?e.path:e.filename,"]"),btn:"关闭分享外链",confirmBtnType:"danger",area:55,component:()=>n((()=>import("./detail.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),onConfirm:i})},ji=e=>{const t=vt(),{compData:a}=Q(t);return a.value={row:e},o({title:"【".concat(e.path,"】设置数据同步"),area:56,component:()=>n((()=>import("./index198.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),compData:{row:e}})},Mi=()=>o({title:"文件操作记录",area:80,component:()=>n((()=>import("./index199.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),compData:{}}),zi=(e,t)=>{const{activeName:a,fileItem:l}=Q(wi());return a.value=t,l.value=e,o({title:"[ ".concat(e.fileName," ] - 文件属性"),area:58,component:()=>n((()=>import("./index200.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)})},qi=e=>{const t=bi(),{fileItem:a}=Q(t),{onConfirm:l}=t;return a.value=e,o({title:"压缩文件",area:48,btn:"压缩",component:()=>n((()=>import("./index201.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),onConfirm:l})},Vi=e=>{const t=yi(),{fileItem:a}=Q(t),{onConfirm:l}=t;return a.value=e,o({title:"解压文件[ ".concat(e.fileName," ]"),area:48,btn:"解压",component:()=>n((()=>import("./index202.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),onConfirm:l})},Hi=e=>{const t=hi(),{fileItem:a}=Q(t),{onConfirm:l}=t;return a.value=e,o({title:"【".concat(e.fileName,"】文件拆分"),area:55,btn:"确定",component:()=>n((()=>import("./index203.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),onConfirm:l})},Bi=e=>{const t=vi(),{fileItem:a}=Q(t),{onConfirm:l}=t;return a.value=e,o({title:"合并【".concat(e.fileName,"】文件"),area:44,btn:"确定",component:()=>n((()=>import("./index204.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),onConfirm:l})},Gi=e=>{const t=fi(),{fileItem:a}=Q(t),{onConfirm:l}=t;return a.value=e,o({title:"发送至邮箱",area:50,btn:"发送",component:()=>n((()=>import("./index205.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),onConfirm:l})},Wi=e=>{const t=ii(),{instance:a}=Q(t);return a.value=o({title:"文件格式转换",area:78,component:()=>n((()=>import("./index206.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)}),a.value},Ui=e=>{const t=ei(),{fileItem:a,instance:l}=Q(t);a.value=e,l.value=o({title:"压缩预览 --【".concat(e.fileName,"】"),area:74,component:()=>n((()=>import("./index207.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)})},Ji=async(e,t)=>{const{mainWidth:a}=Q(ss()),{fileItem:l,instance:i}=Q(Ba()),{fileItem:s,instance:r}=Q(Ga());l.value=e,s.value=e;const c=o({title:"在线文本编辑器",area:d()||a.value<1280?["100vw"]:143,component:()=>d()?n((()=>import("./index208.js?v=1734676359")),__vite__mapDeps([]),import.meta.url):n((()=>import("./index209.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),isFullScreen:!0,closeBtn:2,modal:!1,autoClose:!1,compData:{data:e,callback:t}});i.value=c,r.value=c},$i=()=>o({title:"文件历史版本",area:75,component:()=>n((()=>import("./index210.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)}),Ki=e=>{const t=ci(),{fileItem:a}=Q(t),{onConfirm:l}=t;return a.value=e,o({title:"导入数据库",area:40,btn:"确定",component:()=>n((()=>import("./index211.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),onConfirm:l})},Yi=e=>{const{fileItem:t}=Q(ri());return t.value=e,o({area:75,component:()=>n((()=>import("./index212.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)})},Xi=(e,t,a,l)=>{const i=gi(),{compData:s}=Q(i),{onConfirm:r}=i;return s.value={data:e,fileItem:t,name:a,path:l},o({title:"在线编辑",area:65,btn:"保存",component:()=>n((()=>import("./index213.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),onConfirm:r})},Qi=(e,t)=>{const a=si(),{compData:l}=Q(a),{onConfirm:i}=a;return l.value={data:e,temp_data:t},o({title:"【".concat(e.path,"】配置"),area:40,btn:!0,component:()=>n((()=>import("./index214.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),onConfirm:i})},Zi=e=>{const{videoUrl:t}=Q(ui());return t.value=e.path,o({title:"视频播放",area:89,component:()=>n((()=>import("./index215.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)})},en=()=>{const{instance:e}=Q(mi());return e.value=o({title:"宝塔终端",area:[80,50],component:()=>n((()=>import("./index216.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)}),e.value},tn=(e,t,a)=>{const l=bi(),{compData:i,instance:s}=Q(l);return i.value={data:e,params:t,callback:a},s.value=o({area:70,component:()=>n((()=>import("./index217.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)}),s.value},an=e=>{const t=Zl(),{compData:a,instance:l}=Q(t),{onConfirm:i}=t;return a.value=e,l.value=o({title:"".concat("upload"===e.type?"上传到"+e.zName:"从"+e.zName+"下载【勾选需要下载的文件】"),area:70,btn:["upload"===e.type?"上传":"下载","取消"],component:()=>n((()=>import("./index218.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),onConfirm:i}),l.value},ln=e=>{const t=Ql(),{fileList:a}=Q(t),{setFileAuths:l}=t;return a.value=e.map((e=>e.fileName)),o({title:"设置权限【批量】",area:45,component:()=>n((()=>import("./index219.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),btn:!0,onConfirm:l})},nn=e=>{const{onConfirmCheckFile:t,onCancelCheckFile:a}=Ba();return o({title:"温馨提示",area:[35,9],btn:["保存","不保存"],component:()=>n((()=>import("./index220.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),separationCancelClose:!0,onConfirm:a=>{t(),e()},onCancel:t=>{a(t),e()}})},sn=(e,t)=>{const a=Ba(),{compDataClose:l}=Q(a),{onConfirmClose:i,onCancelClose:s}=a;return l.value={type:e,item:t},o({title:"温馨提示",area:[35,9],btn:["保存","不保存"],component:()=>n((()=>import("./index221.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),separationCancelClose:!0,onConfirm:i,onCancel:s})},on=({path:e,name:t},a)=>{const l=ss(),{fileTabList:i,fileTabActive:n,disabledCutTab:s,fileTabActiveData:o}=Q(l);if(!e)return;if(s.value)return;let r=e,c=e;"/"===r?r="根目录":("/"===c[c.length-1]&&(c=c.slice(0,c.length-1)),r=e.split("/").pop()),t&&(r=t);const u={id:E(),label:r,type:"list",loading:!1,total:0,list:[],param:{p:1,showRow:500,path:c}};s.value=!0,i.value.push(u),n.value=i.value.length-1,N((()=>{l.updateTabActiveData(),l.refreshFilesList(),a&&a(u)}))},rn=e=>RegExp(/[\*\|\:\\\"\/\<\>\?]+/).test(e),cn=e=>{const{fileTabActiveData:t}=Q(ss());return un(t.value.param.path+"/"+e)},un=e=>e.replace("//","/"),pn=async e=>{const t=e.replace(/\/+$/,"")||"/",a=dn(t);if("/.Recycle_bin"===e||"/www/.Recycle_bin"===e)return Si.error("此为回收站目录，请在右上角按【回收站】按钮打开"),!1;const l=ss(),{fileTabActiveData:i,searchVal:n}=Q(l);return i.value.param.p=1,l.updateTabActiveData({param:{path:a,search:""}}),l.refreshFilesList(),a},dn=e=>"/"===(e=(e=e.replace(/\\/g,"/")).replace("//","/"))?e:e=e.replace(/\/+$/g,""),fn=e=>"dir"===e?"文件夹":"文件",hn=(e,t)=>{e.isReName=!0,t&&t(e)},mn=async(e,t)=>{const l=ss(),{recyclingBinStatus:i}=Q(l),{watchDeleteFileData:n}=l;if(null===i.value){const{data:e}=await ct({type:"all",search:"",time_search:JSON.stringify([])});i.value=e.status}const s=i.value?"删除【".concat(e.fileName,"】").concat("file"===e.type?"文件":"文件夹","后，该文件将迁移至文件回收站，如需彻底删除请前往文件回收站，是否继续操作？"):"风险操作，当前未开启文件回收站，删除的【".concat(e.fileName,"】").concat("file"===e.type?"文件":"文件夹","将彻底删除，无法恢复，是否继续操作？");await c({title:"删除".concat(fn(e.type),"【").concat(e.fileName,"】"),isHtml:!0,type:i.value?"default":"calc",content:s+(e.isShare?'<br/><span class="text-danger">当前文件已开启【外链分享】，请谨慎操作！</span>':"")}),await a({loading:"正在删除，请稍后...",request:dt({path:cn(e.fileName),type:e.type}),message:!0,success:a=>{a.status&&n(e),t&&t()}})},vn=async(e,t)=>{const a=await gt({path:cn(e.fileName)});a.status?(Si.success(a.msg),t&&t()):Si.error(a.msg),Kn()},gn=I(null),yn=()=>{const{fileTabActiveData:e}=Q(ss());"/"!==e.value.param.path?gn.value=o({title:"上传文件到【".concat(e.value.param.path,"】 --支持断点续传"),area:"72",component:()=>n((()=>import("./index188.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),compData:{path:e.value.param.path},onCancel:()=>{gn.value=null}}):Si.error("不能直接上传文件到系统根目录!")},bn=async(e,t)=>{const a=await De({path:cn(e.fileName)});a.status?(Si.success(a.msg),t&&t()):Si.error(a.msg),Kn()},wn=async(e,t)=>{const a=ss(),l=await yt({path:cn(e.fileName),type:t});l.status?Si.success(l.msg):Si.error(l.msg),a.refreshFilesList()},_n=async e=>{const t=ss(),a=await ft({path:cn(e.fileName)});a.status?Si.success(a.msg):Si.error(a.msg),t.refreshFilesList()},En=()=>{const{copyFilesData:e}=Q(ss());e.value={files:[],type:""}},Sn=(e,t)=>{const a=ni(),{compData:l}=Q(a),{onConfirm:i}=a;l.value={fileData:e,type:t},o({title:"重复文件提示",area:40,btn:["确认","取消"],component:()=>n((()=>import("./index222.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),onConfirm:i})},Ln=e=>{const{activeName:t,compData:a}=Q(_i());return t.value="database"===e?"db":"all",a.value={type:e},o({title:"回收站",area:110,component:()=>n((()=>import("./index223.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)})},Tn=(e,t)=>{if("dir"===t)return"folder";const a=e.split("."),l=a[a.length-1];for(let i=0;i<Di.length;i++)if(Di[i]==l)return Di[i];return"file"},Cn=e=>{let t="text";return e&&(e=e.toLowerCase()),Object.entries(ki).forEach((([a,l])=>{l.forEach((l=>{l==e&&(t=a)}))})),t},Dn=async()=>{const e=ss(),{fileTabActiveData:t,copyFilesData:a}=Q(e);let l=null;const i=a.value.files[0],n=cn(i.fileName);if("dir"===i.type&&t.value.param.path.indexOf(n+"/")>-1)return Si.error("错误的复制逻辑，从".concat(n,"粘贴到").concat(t.value.param.path,"有包含关系，存在无限循环复制风险!")),!1;const s={path:t.value.param.path};1===a.value.files.length&&(s.name=i.fileName);const{data:o}=await Ne(s);if(o.length>0)return Sn(o,a.value.files.length>1?"batch":"single"),!1;kn();try{if(l=Si.load("正在粘贴，请稍候..."),a.value.files.length>1){const e=await Ae({type:"copy"===a.value.type?1:2,path:t.value.param.path});Si.request(e),a.value.files=[],En()}else{const e={sfile:i.path,dfile:n},t="copy"===a.value.type?await Fe(e):await Oe(e);t.status?("copy"===a.value.type?Si.success(t.msg):Si.success("剪切成功"),a.value.files=[],En()):Si.error(t.msg)}}finally{l&&l.close(),clearTimeout(xn),e.refreshFilesList()}};let xn=null;const kn=()=>{const{getRealTask:e}=ss();xn=setTimeout((()=>{e()}),1500)},Rn=async e=>{await rl(),await Ol({title:e.fileName,type:"editor",path:e.path,size:e.size}),await ue({name:e.fileName,path:e.path}),await cl()},In=(e,t)=>{const{copyFilesData:a}=Q(ss());e.path=cn(e.fileName),a.value.files=[e],a.value.type=t,Si.success("".concat("copy"===t?"复制":"剪切","成功，请在目标目录点击右上角【粘贴】按钮!"))},Nn=async(e,t)=>{var a,l;const{unbindKeydown:i}=ss();i();const n={path:e.path,title:e.path.split("/").pop(),size:e.size,type:"editor"};(null==(a=null==e?void 0:e.path)?void 0:a.includes("/dev/pts"))?Si.error("系统目录文件不支持编辑"):"text"===Cn(null==(l=n.fileName)?void 0:l.split(".").pop())?document.querySelector("#dialogMinimize")?ol(n):Ka.value?Ol(n):(await rl(),Ji(n,t)):Si.error("暂不支持该类型文件编辑")},Fn=e=>{const{createItem:t}=Q(ss()),{findCurrentImgIndex:a}=Ei();if(t.value=[],e.isNew||e.isReName)return!1;if("dir"===e.type)pn(e.path);else switch(Cn(e.ext)){case"images":a(window.location.protocol+"//"+window.location.host+"/download?filename="+e.path);break;case"video":Zi(e);break;case"compress":Vn(e);break;default:Nn(e)}},On=(e,t)=>{window.open("/download?filename="+encodeURIComponent(e.path),"_self"),t&&t()},An=e=>{Hi(e)},Pn=e=>{Bi(e)},jn=e=>{Ai(e)},Mn=e=>{Pi(e)},zn=async e=>{const{authType:t}=Q(ss());"ltd"!==t.value?kt({disablePro:!0,sourceId:70,plugin:!1}):ji(e)},qn=e=>{qi(e)},Vn=e=>{Vi(e)},Hn=e=>{const t=ii(),{fileItem:a}=Q(t);a.value=e,Wi()},Bn=e=>{Gi(e)},Gn=(e,t)=>{t||(t="routine"),zi(e,t)},Wn=()=>{yn()},Un=async(e,t)=>{const{fileTabActiveData:a,copyFilesData:l}=Q(ss()),i={data:JSON.stringify(e.map((e=>e.fileName))),type:0,path:a.value.param.path};switch(t){case"copy":i.type=1;break;case"cut":i.type=2}const n=await fe(i);n.status?(Si.success("".concat("copy"===t?"复制":"剪切","成功，请在目标目录点击右上角【粘贴】按钮!")),l.value.files=e,l.value.type=t):Si.error(n.msg)},Jn=async e=>{const t=ss(),{fileTabActiveData:l,recyclingBinStatus:i}=Q(ss()),n=i.value?"删除后，文件将迁移至文件回收站，如需彻底删除请前往文件回收站，是否继续操作？":"风险操作，当前未开启文件回收站，删除后将彻底删除，无法恢复，是否继续操作？";await c({title:"批量删除文件",type:i.value?"default":"calc",content:n}),await a({loading:"正在删除，请稍后...",request:fe({data:JSON.stringify(e.map((e=>e.fileName))),type:4,path:l.value.param.path}),message:!0,success:e=>{e.status&&t.refreshFilesList()}})},$n=({path:e,name:t},a)=>{const l=ss(),{fileTabList:i,disabledCutTab:n,fileTabActive:s}=Q(l);if(!e)return;if(n.value)return;let o=e,r=e;"/"===o?o="根目录":("/"===r[r.length-1]&&(r=r.slice(0,r.length-1)),o=e.split("/").pop()),t&&(o=t);const c={id:E(),label:o,type:"list",loading:!1,total:0,list:[],param:{p:1,showRow:500,path:r}};n.value=!0,i.value.push(c),s.value=i.value.length-1,N((()=>{l.updateTabActiveData(),l.refreshFilesList(),a&&a(c)}))},Kn=async()=>{const{favoriteList:e}=Q(ss());await a({request:ht(),data:[Array,e]})},Yn=async()=>{const{diskList:e}=Q(ss()),{data:t}=await mt();e.value=t},Xn=e=>{const t=ss(),{fileTabList:a,fileTabActive:l}=Q(t);let i=e;"/"===i[i.length-1]&&"/"!==i&&(i=i.slice(0,i.length-1));const n=a.value.findIndex((e=>e.param.path===i));-1!==n?(l.value=n,t.updateTabActiveData(),t.refreshFilesList()):$n({path:e})},Qn=e=>({icon:"icon-".concat(e),ext:"dir"==e?" folder":"",fileName:"新建".concat("dir"==e?"文件夹":"文本"),time:"",ps:"",size:0,type:e,user:"root",rootLevel:"0",isLink:"",isShare:!1,isTop:!1,isFav:!1,isOsPs:!1,isPsEdit:!1,isSearch:!1,isReName:!0,isNew:!0,isSync:"",isLock:!1,path:"",tamperProofId:0,isFile:"dir"!==e}),Zn=(e,t,a="0;0",l,i=[])=>{const n=((e,t)=>{let a="",l=Li.get("".concat("/"===t?"/":"".concat(t,"/")).concat(e));switch(e){case".htaccess":a="PS: Apache用户配置文件(伪静态)";break;case"swap":a="PS: 宝塔默认设置的SWAP交换分区文件"}return e.includes(".upload.tmp")&&(a="PS: 宝塔文件上传临时文件,重新上传从断点续传,可删除"),e.includes(".user.ini")&&(a="PS: PHP用户配置文件(防跨站)!"),l&&(a=l),l||a})(t.nm,l),s="1"===a.split(";")[0],o=a.split(";")[1],r=Tn(t.nm,e),c=((e,t)=>"".concat(e,"/").concat(t).replace("//","/"))(l,t.nm);return{icon:Cn(r),ext:r,fileName:t.nm,time:u(t.mt),ps:n||t.rmk||"",size:t.sz,type:e,user:t.user,rootLevel:t.acc,isLink:t.lnk,isShare:0!=Number(t.durl)?t.durl:0,isTop:!!t.top,isFav:!!Number(t.fav),isOsPs:!L(n)&&""!==n,isPsEdit:!1,isSearch:!0,isReName:!1,isNew:!1,isSync:es(i,c),isLock:s,path:c,tamperProofId:Number(o),isFile:"dir"!==e}},es=(e,t)=>{if(L(e)||0==e.length)return"";const a=e.find((e=>e.path===t));return a?a.type:""},ts=e=>e.map((e=>({val:e.val,label:e.val}))),as=(e,t)=>{o({title:(null==e?void 0:e.title)||"批量操作结果",area:t||42,component:()=>n((()=>import("./index102.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),compData:e})},ls=(e,t)=>{const a=window.innerWidth,l=window.innerHeight,i=t.offsetWidth,n=t.offsetHeight,s=e.clientX,o=e.clientY;let r=s;s+i>a&&(r=s-i);let c=o-(l-o<n?n:0);c<0&&(c=(l-n)/2),t.style.top=c+"px",t.style.left=r+"px"},is=Object.freeze(Object.defineProperty({__proto__:null,BatchSetAuth:ln,CreateTerminalDialog:en,FileCompressPreview:Ui,FileCompressView:qi,FileDecompressionView:Vi,FileFormatConversionView:Wi,FileImageView:Yi,FileInputDatabaseView:Ki,FileMergeView:Bi,FileOperationRecordView:Mi,FileRecyclingBinView:Ln,FileSearchView:Ii,FileSetShareView:Ai,FileSplitView:Hi,FileStatusDetailView:zi,FilesAceEditor:Ji,FilesCompressCoverView:tn,FilesHistoryRecordView:$i,ManageFavoritesView:Fi,SendEmailView:Gi,ShareDetailView:Pi,ShareListView:Oi,addFavorites:vn,addTab:$n,addTabEvent:on,batchDelFile:Jn,calculateContextMenuPosition:ls,calculatePopoverPosition:(e,t)=>{const a=window.innerWidth,l=window.innerHeight,i=t.offsetWidth,n=t.offsetHeight,s=e.clientX,o=e.clientY;let r=s;s+i>a&&(r=s-i);let c=o;return o+n>l&&(c=o-n),c<0&&(c=0),{top:c,left:r,el:t}},cloudStorageDialog:an,copyFiles:In,createCompress:qn,createCopy:_n,createFile:Qn,deCompressFile:Vn,defaultPS:Li,delFavorites:bn,delFileEvent:mn,determineFileType:Cn,downFile:On,editFilesDialog:Xi,editorCloseDialog:sn,editorLeaveDialog:nn,exts:Di,fileBatchSet:Un,fileMainType:ki,fileReName:hn,fileRsyncView:ji,fileTaskDialog:Ri,fileType:xi,fileUploadDialog:gn,formatFile:Hn,getDataType:fn,getDiskList:Yn,getExtIcon:Tn,getFavoriteList:Kn,getWholePath:cn,isSyncType:es,matchUnqualifiedString:rn,openAceEditor:Nn,openDetail:Gn,openEditorView:Rn,openFile:Fn,openFileAsync:zn,openFileMerge:Pn,openFileShare:Mn,openFileSplit:An,openFilesUpload:yn,openResultDialog:as,pasteFiles:Dn,pathJumpEvent:pn,path_check:dn,recomList:Ti,reconstructionFile:Zn,removeCopyOrCutData:En,renderHistoryList:ts,repetFileView:Sn,sendEmail:Bn,setColumn:(e,t)=>{},setFileListActive:Xn,setFileShare:jn,setToping:wn,symbolicLinkView:Ni,temperDialog:Qi,toRepeatPath:un,uploadFiles:Wn,videoPlayDialog:Zi},Symbol.toStringTag,{value:"Module"})),ns=W("FILES-URL-DOWN-LOAD-STORE",(()=>{const e=ss(),{fileTabActiveData:t}=Q(e),{getRealTask:l}=e,i=$({url:"",path:t.value.param.path,filename:""}),n=I(!1),s=I(),o=$({url:[{validator:(e,t,a)=>{""===t?a(new Error("请输入正确的URL地址!")):C(t)?a():a(new Error("请输入正确的URL地址!"))},trigger:["blur"]}],filename:[{validator:(e,t,a)=>{""===t?a(new Error("请输入新文件名!")):rn(t)?a(new Error('文件名不能包含 /\\:*?"<>|符号!')):a()},trigger:["blur","change"]}]});return{quickForm:i,formDisabled:n,quickFormRef:s,quickRules:o,onConfirm:()=>{const e={...i};s.value.validate((async t=>{t&&await a({loading:n,request:bt(e),message:!0,success:e=>{e.status&&l()}})}))},onPathChange:()=>{Ct({type:"dir",path:i.path,change:e=>{i.path=e}})},setName:e=>{const t=e.split("/");i.filename=t[t.length-1]},init:()=>{n.value=!1,Object.assign(i,{url:"",path:t.value.param.path,filename:""})}}})),ss=W("FILES-STORE",(()=>{const t=i(),{mainHeight:l,mainWidth:r,payment:u}=t,{authType:p}=J(u.value),d={id:"label-1",label:"wwwroot",type:"list",loading:!1,total:0,param:{p:1,showRow:500,path:"/www/wwwroot",sort:"",reverse:"True"}},f=I(0),m=I(0),g=I({...d}),y=I([{...d}]),b=I(0),w=I(!0),_=I(),E=$({index:0,id:""}),C=I(0),F=I(0),O=I(!1),A=I(!1),P=I([]),j=I(0),M=I(g.value.param.path),z=I(),q=I(!0),V=I([]),H=I(0),B=$({showMore:!1,showUl:!1,list:[]}),G=I(""),W=I(),U=I(!1),K=I([]),Y=I([]),X=I({reqEnd:!1,isSetup:!1,isBuy:!1}),Q=I(!1),Z=I(!1),ee=I({isLock:!0,rootLevel:!0,size:!0,time:!0,ps:!0}),te=I(""),ae=I([]),le=I(!1),oe=I([]),ce=ie((()=>oe.value.length||0)),ue=I([]),pe=ie((()=>ue.value.length||0)),de=I([]),fe=I([]),he=I([]),me=I({status:!1,tip:""}),ve=I({}),ge=I({files:[],type:""}),ye=I({}),be=I(""),we=(e={})=>{const t=y.value[m.value];e.param&&(e.param={...t.param,...e.param});const a={...t,...e};y.value.splice(m.value,1,a),Object.assign(g.value,a),G.value=g.value.param.search||"",U.value="True"===g.value.param.all,je.value=!1,M.value!==a.param.path&&(M.value=g.value.param.path,Te(M.value))},_e=()=>{const e=r.value-36;P.value=[],j.value=0,N((()=>{document.querySelectorAll(".tab-item").forEach((e=>{const t=e.getBoundingClientRect();P.value.push(t.width),j.value+=t.width}));const t=j.value-e;F.value=t>0?t:0,Ee(e)}))},Ee=e=>{const t=P.value.reduce(((e,t,a)=>a<=m.value?e+t:e),0);if(t<=e)C.value=-1;else{if(m.value===y.value.length-1)return void(C.value=F.value);let a=t-e+20;A.value=!0,C.value=a}},Se=async()=>{const e=await v({status:-3}),t=document.querySelector(".realTaskDialog");e.data.length>0&&!t&&Ri()},Le=ne((()=>{s.error("不能直接上传文件到系统根目录!")}),2e3),Te=e=>{if(!e)return;const t=e.split("/");if("/"===e)return V.value=[{name:"根目录",path:"/",show:!0,list:[]}];V.value=t.map(((e,a)=>({name:""===e?"根目录":e,path:""===e?"/":t.slice(0,a+1).join("/"),show:!0,showFold:!1,loading:!1,list:[]}))),Ce(),N((()=>{B.list=[],B.showMore=!1;const e=document.querySelectorAll(".path-group-item"),t=document.querySelector(".path-list-group"),a=Array.from(e).reduce(((e,t)=>e+t.clientWidth+4),0);setTimeout((()=>{if(a>((null==t?void 0:t.clientWidth)||400)){let a=20;for(let l=e.length-1;l>=0;l--)a+=e[l].clientWidth,a>((null==t?void 0:t.clientWidth)||0)&&(V.value[l].show=!1,B.showMore=!0,B.list=V.value.slice(l+1));B.showMore&&(V.value[0].show=!1,B.list=V.value.slice(1))}}),100)}))},Ce=()=>{B.showUl=!1,V.value[H.value]&&(V.value=V.value.map((e=>({...e,showFold:!1})))),window.removeEventListener("click",Ce)},De=I([{name:"文件名",key:"name",show:!0,disable:!0},{name:"防篡改",key:"isLock",show:!0,disable:!1,icon:!0},{name:"权限",key:"rootLevel",show:!0,disable:!1},{name:"大小",key:"size",show:!0,disable:!1},{name:"修改时间",key:"time",show:!0,disable:!1},{name:"备注",key:"ps",show:!0,disable:!1},{name:"操作",key:"action",show:!0,disable:!0}]),xe=[{type:"copy",icon:"copy-file-icon",label:"复制",handler:()=>Un(K.value,"copy")},{type:"cut",icon:"cut-file-icon",label:"剪切",hide:1370,handler:()=>Un(K.value,"cut")},{type:"compress",icon:"compress-file-icon",label:"压缩",hide:1446,handler:()=>qn(K.value)},{type:"auth",icon:"authority-file-icon",label:"权限",hide:1610,handler:()=>ln(K.value)},{type:"delete",icon:"delete-file-icon",label:"删除",hide:1620,handler:()=>Jn(K.value)}],ke=()=>{const{onConfirm:e}=ns();o({title:"URL链接下载",area:50,btn:!0,component:()=>n((()=>import("./index224.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),onConfirm:e})},Re=async(e,t)=>{if("ltd"===p.value)try{const{data:t}=await S({sName:e});if(!t.setup)return void xt({name:t.name,type:"i",pluginInfo:t});Tt({name:e})}catch(a){}else kt({sourceId:t})},Ie=()=>{N((()=>{He(),We()}))},Ne=I(null),Fe=I(null),Oe=I(null),Ae=I(!1),Pe=I(""),je=I(!1),Me=I(!1),ze=I([]),qe=e=>{if("el-input__inner"===e.target.className||"TEXTAREA"===e.target.tagName)return;const t="list"===g.value.type;if(t&&!Oe.value)return;const a=document.querySelector(".el-dialog__body")||document.querySelector(".el-dialog__container");if(a&&"none"!==a.style.display)return;let l=[];ze.value.forEach((e=>{var t;(null==(t=Oe.value)?void 0:t.selectList.includes(e.path))&&l.push(e)}));const i=t?l:Fe.value.selectList;if(e.ctrlKey&&65===e.keyCode&&(e.preventDefault(),Oe.value.handleCheckAll(!0)),e.ctrlKey&&88===e.keyCode)switch(i.length){case 0:return;case 1:In(i[0],"cut");break;default:Un(i,"cut")}if(e.ctrlKey&&67===e.keyCode)switch(i.length){case 0:return;case 1:In(i[0],"copy");break;default:Un(i,"copy")}if(e.ctrlKey&&86===e.keyCode){if(0===ge.value.files.length)return;Dn()}if(113===e.keyCode)switch(i.length){case 0:return;case 1:hn(i[0],t?Ne.value.editRow:Fe.value.editFile)}if(13===e.keyCode)switch(i.length){case 0:return;case 1:if(i[0].isNew||i[0].isReName||i[0].isPs)return;Fn(i[0])}if(46===e.keyCode){if(0===i.length)return;if(i[0].isNew||i[0].isReName)return;Jn(i)}},Ve=()=>{document.addEventListener("keydown",qe)},He=()=>{document.removeEventListener("keydown",qe)},Be=e=>{""!==e&&1!=le.value&&(ae.value=[Qn(e)],Ge())},Ge=()=>{ze.value=[...ae.value,...oe.value,...ue.value].map(((e,t)=>(e.vid=t,e))),Ei().watchDataList(ze.value)},We=()=>{we({param:{search:""}}),Ve(),g.value.type;const e=localStorage.getItem("copyOrCutData");e&&(ge.value=JSON.parse(e))},Ue=async()=>{try{const e=g.value.param.path,{data:t}=await St(e);L(t.msg)||-1!=t.msg.indexOf("企业版")||s.error(t.msg);let a=t.list;for(let l in a)a["".concat(e,"/").concat(l)]=a[l];Pe.value=h(t.total_asize),setTimeout((function(){oe.value=oe.value.map((e=>(e.diskInfo=a[e.path],e.isDirComputed=!1,e))),Ge()}),300)}finally{Me.value=!1,je.value=!0}},Je=()=>{$e(),x("Path",g.value.param.path)},$e=async()=>{oe.value=[],ue.value=[],ze.value=[];try{g.value.loading=!0;const e=(()=>{const e=JSON.parse(JSON.stringify(g.value.param));return"time"==e.sort&&(e.sort="mtime"),"fileName"==e.sort&&(e.sort="name"),void 0!==e.search&&""===e.search&&delete e.search,void 0!==e.all&&"True"!==e.all&&delete e.all,e})(),{status:t,msg:a,data:l}=await _t(e);if("True"==e.all&&l.is_max&&s.error("当前当前搜索结果已超出最大值3000条！"),!t&&void 0!==a){s.error(a);const e=g.value.param.path.split("/");e.pop();const t=e.join("/").replace(/\/+$/,"")||"/";if("/"===t)return;return we({param:{path:t}}),void $e()}const{path:i,dir:n,files:o,store:r,bt_sync:c,page:u,tamper_data:p,search_history:d,file_recycle:f}=l;let{dirs:h,files:m,msg:v,tip:y,rules:b}=p;const w=[],_="ok"===y;if(me.value.status=_,me.value.tip=_?"":y,he.value=ts(d),oe.value=[],n.forEach(((e,t)=>{oe.value.push(Zn("dir",e,v?"":h[t],i,c))})),ue.value=[],o.forEach(((e,t)=>{const a=Zn("file",e,v?"":m[t],i);0===t&&_&&(ve.value=b.length>0?b.find((e=>e.pid===a.tamperProofId)):void 0),"images"===a.icon&&w.push(a.fileName),ue.value.push(a)})),w.length>0){const{data:e}=await Lt({return_type:"base64",height:45,width:45,files:w,path:i});de.value=Object.entries(e.data),Ei().setSmallImage()}else de.value=[];fe.value=r,Z.value=f;let E=i;E="/"===E?"根目录":i.split("/").pop(),we({label:E,total:k(l.page),type:"list",param:{path:l.path}}),Q.value=!1,Ge()}catch(t){e(t)}finally{g.value.loading=!1}};return{authType:p,mainHeight:l,mainWidth:r,fileTabActive:m,fileTabActiveData:g,fileTabList:y,isAddTabs:w,closeTabs:E,favoriteList:fe,diskList:Y,dataList:ze,deleteFileData:ye,imgPathItem:be,recyclingBinStatus:Z,copyFilesData:ge,navBtnHeight:f,imageList:de,disabledCutTab:Q,dirPath:M,pathInputRef:z,pathInputMode:q,pathListGroup:V,more:B,searchVal:G,searchRef:W,isChildren:U,contextRef:_,scrollWidth:C,showLeftArrow:O,showRightArrow:A,searchHistory:he,updateTabActiveData:we,getFilesList:$e,triggerEvent:e=>{e?se(W).showPopover():se(W).hidePopover()},searchEvent:async e=>{G.value=e,we({param:{search:G.value,all:U.value?"True":"False"}}),await $e()},getRealTask:Se,handleDragOff:e=>{var t,a;if(e.preventDefault(),"/"!==g.value.param.path){if(null==(t=null==e?void 0:e.dataTransfer)?void 0:t.items){Array.from(null==(a=null==e?void 0:e.dataTransfer)?void 0:a.items).some((e=>"file"===e.kind))&&(gn.value||yn())}}else Le()},cutPathInputMode:async e=>{if(q.value=e,e){if(g.value.param.path===M.value)return;const e=M.value;if(e.length>0&&!e.includes("/"))return s.error("路径输入不符合规则"),void(M.value=g.value.param.path);if(0===e.length)return void(M.value=g.value.param.path);if((await wt({path:M.value})).data.exists){const t=await pn(e);M.value=t||e}else{try{await c({width:50,title:"路径不存在",content:"【".concat(e,"】路径不存在,是否创建并跳转?")})}catch(t){if("cancel"===t)return void(M.value=g.value.param.path)}await a({loading:"正在新建文件，请稍后...",request:re({path:e,type:"dir"}),message:!0,success:t=>{t.status&&pn(e)}})}}else D(z.value)},cutDirPath:(e,t)=>{""===e&&(M.value="/"),z.value.blur(),ae.value=[],Ge(),we({param:{search:"",p:1,all:"False"}}),t||pn(e)},getPathListGroup:Te,getCurrentFoldDirList:async(e,t)=>{try{Ce(),V.value[t].showFold=!0,V.value[t].loading=!0;const{data:{dir:a}}=await _t({path:e,p:1,showRow:2e3});V.value[t].loading=!1,V.value[t].list=a.map((t=>({name:t.nm,path:"".concat(e,"/").concat(t.nm).replace(/\/+/g,"/")}))),H.value=t,window.addEventListener("click",Ce)}catch(a){}},goBack:()=>{if(Q.value)return;if(Q.value=!0,"/"==g.value.param.path){if(""===g.value.param.search)return Q.value=!1,s.error("当前目录为根目录");we({param:{search:"",all:"False"}}),pn("/")}let e=g.value.param.path.split("/");e.pop(),we({param:{search:"",all:"False"}});let t=e.join("/");pn(t)},closeOther:()=>{y.value=y.value.filter(((e,t)=>t===E.index)),E.index!==m.value&&Je(),m.value=0,we(),_e()},closeRight:()=>{y.value.splice(E.index+1);let e=y.value[E.index].param.path;m.value=E.index,g.value.param.path!==e&&(we(),Je()),we(),_e()},watchTabsWidth:()=>{N((()=>{b.value=(()=>{const e=document.querySelector(".tabs");if(e)return e.getBoundingClientRect().width;return 0})();const e=document.querySelectorAll(".tab-item");let t=0;e.forEach((e=>{const a=e.getBoundingClientRect();t+=a.width})),w.value=b.value-t>160}))},handleRightClick:(e,t,a)=>{Object.assign(E,{id:t.id,index:a}),_.value.show(e)},watchWindowResize:_e,watchScrollWidth:e=>{let t=e;O.value=0!=t&&-1!=t,-1===t&&(C.value=0,t=0),A.value=F.value>0&&t!=F.value;const a=document.querySelector(".tabs");a&&a.scrollTo({top:0,left:C.value,behavior:"smooth"})},cutTab:e=>{Q.value&&m.value!==e||(m.value=e,Q.value=!0,ae.value=[],we(),Je(),_e())},scrollLeft:()=>{const e=r.value-36;C.value<=e/2?C.value=0:C.value-=e/2},scrollRight:()=>{const e=r.value-36;if(F.value<=e/2)return void(C.value=F.value);let t=C.value+=e/2;t>F.value&&(t=F.value),C.value=t},closeTab:(e,t)=>{const a=y.value.length;if(1===a)return s.error("至少保留一个标签页");const l=y.value.findIndex((e=>e.id===t));y.value.splice(l,1),m.value>l?(m.value=m.value-1,we()):m.value===l&&(Q.value=!0,m.value=a-l==1?l-1:l,we(),Je()),_e()},fileBatchNum:K,createListType:te,columnShow:ee,cloudList:[{name:"百度云存储",icon:"baidu-cloud",command:"bos"},{name:"阿里云存储",icon:"alioss-cloud",command:"alioss"},{name:"腾讯云存储",icon:"tencent-cloud",command:"txcos"},{name:"华为云存储",icon:"huawei-cloud",command:"obs"}],actionsBtn:xe,fileBatchEvent:e=>{switch(e){case"copy":Un(K.value,"copy");break;case"cut":Un(K.value,"cut");break;case"compress":qn(K.value);break;case"auth":ln(K.value);break;case"del":Jn(K.value)}},handleChangeMenuIcon:()=>{s.warn("功能正在开发中...")},handleChangeMenuList:()=>{"list"!==g.value.type&&(we({type:"list"}),g.value.type="list",Ie())},handleCommand:async e=>{var t;switch(e){case"upload":yn();break;case"openUrlLinkDown":ke();break;case"bos":case"alioss":case"txcos":case"obs":const{data:a}=await Et(),l=null==(t=null==a?void 0:a.down)?void 0:t.find((t=>t.name===e));l&&(null==l?void 0:l.is_conf)?an({type:"down",zName:l.title,pname:e}):Re(e,73)}},openPlugin:Re,collectCommand:e=>{if("manger"!==e)if(g.value.label=e.name,"dir"===e.type)pn(e.path);else{const t={...e,fileName:e.name,ext:e.ext||e.name.split(".").pop()};Fn(t)}else Fi()},createCommand:e=>{var t;switch(g.value.type,null==(t=document.querySelector(".vue-recycle-scroller"))||t.scroll({top:0}),e){case"file":case"dir":te.value=e,Be(e);break;case"link":Ni()}},globalTamperStatus:me,createItem:ae,fileList:ue,fileLength:pe,dirList:oe,dirLength:ce,size:Pe,sizeShow:je,sizeLoad:Me,table:Ne,isNoCreteItem:le,iconView:Fe,listView:Oe,btnPopover:Ae,diskAnalysis:X,watchDeleteFileData:e=>{if(0===Object.keys(e).length)return;const{type:t,path:a,isNew:l}=e;l&&(ae.value=[]),"dir"===t?oe.value=oe.value.filter((e=>e.path!==a)):ue.value=ue.value.filter((e=>e.path!==a)),ye.value={},g.value.total=ze.value.length,Ge()},watchCreateListType:Be,sizeComputed:async()=>{let e=g.value.param.path;if("/"!==e)try{if(Me.value=!0,X.value.reqEnd&&X.value.isSetup&&"ltd"===p.value)oe.value=oe.value.map((e=>(e.isDirComputed=!0,e))),Ge(),Ue();else{const{data:t}=await tt({path:e});Pe.value=t,je.value=!0,Me.value=!1}}finally{0===Pe.value.length&&je.value&&(Me.value=!1)}},checkRoot:async()=>{"/"===g.value.param.path?Ae.value=!0:Ae.value=!1},initMain:We,bindKeydown:Ve,unbindKeydown:He,initNavBtn:async()=>{"true"===localStorage.getItem("MYSQL-RECYCLE")&&(Ln("database"),localStorage.removeItem("MYSQL-RECYCLE")),De.value.forEach((e=>{e.show=ee.value[e.key]})),await Yn(),Kn()},refreshList:async()=>{Q.value||(Q.value=!0,await $e())},refreshFilesList:Je,init:()=>{t.getGlobalInfo(),Se(),(()=>{try{N((async()=>{const{data:e}=await S({sName:"disk_analysis"});Object.assign(X.value,{reqEnd:!0,isSetup:e.status&&e.setup&&e.endtime>-1,isBuy:e.endtime>-1})}))}catch(e){}})();T("searchFile")&&(Ii(),R("searchFile")),Te(M.value)},$reset:()=>{oe.value=[],ue.value=[],de.value=[],fe.value=[],he.value=[],O.value=!1,A.value=!1,g.value.param.search=""}}}),{persist:[{storage:localStorage,paths:["fileTabList"]}]}),os=Object.freeze(Object.defineProperty({__proto__:null,default:ss},Symbol.toStringTag,{value:"Module"}));export{di as $,Gn as A,In as B,en as C,mn as D,qn as E,ss as F,Hn as G,Vn as H,_n as I,Bn as J,Un as K,ln as L,Fi as M,Jn as N,Wn as O,Ni as P,Zi as Q,Ti as R,Oi as S,Xn as T,ns as U,oi as V,Nn as W,ti as X,ai as Y,Kn as Z,pi as _,on as a,wi as a0,bi as a1,yi as a2,hi as a3,vi as a4,fi as a5,ii as a6,ei as a7,Vi as a8,Ga as a9,Dl as aA,Ol as aB,ci as aC,ri as aD,gi as aE,si as aF,ui as aG,mi as aH,Zl as aI,Ql as aJ,ul as aK,ni as aL,_i as aM,_l as aN,gl as aO,Hl as aP,Rn as aQ,Xl as aR,is as aS,os as aT,Xa as aa,el as ab,Da as ac,_a as ad,Oa as ae,La as af,Ca as ag,xa as ah,Fa as ai,Ma as aj,Ba as ak,wa as al,Ta as am,qa as an,ja as ao,Sa as ap,fn as aq,Ia as ar,Pa as as,Pl as at,Kl as au,Yl as av,Qa as aw,Za as ax,Ja as ay,ll as az,Ii as b,ls as c,Mi as d,Dn as e,Ln as f,Yn as g,cn as h,Ei as i,vn as j,bn as k,Mn as l,wn as m,Ui as n,yn as o,pn as p,Fn as q,an as r,jn as s,Cn as t,Li as u,Ki as v,On as w,An as x,Pn as y,zn as z};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
