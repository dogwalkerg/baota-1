import{l as t,H as e,a6 as a,G as s,b as l,u as n,al as i,am as o,p as r,ao as u}from"./utils-lib.js?v=1734676359";import{_ as m}from"./index90.js?v=1734676359";import{c,s as p,e as d,y as _,w as v,o as f,n as g,k as b,J as y,x as h,p as x,q as j}from"./base-lib.js?v=1734676359";import{c as k,a as w,h as C,g as S,u as O}from"./column.js?v=1734676359";import{u as T,g as B,b as E,o as L,l as I,h as P,i as R,s as J,j as D,d as G,f as N,k as A}from"./useController3.js?v=1734676359";import{u as M,S as V}from"./useStore7.js?v=1734676359";import{u as q}from"./index124.js?v=1734676359";import"./validator.js?v=1734676359";import"./index.vue_vue_type_style_index_0_scoped_03ce946a_lang.js?v=1734676359";import{modifyProject as H,createProject as z,setProject as F,removeProject as K}from"./site.js?v=1734676359";const U=l(),{siteInfo:Q,isRefreshList:W,activeType:X}=M(),{setSiteInfo:Y}=V(),Z=()=>{Q.value=null,t({title:"添加Go项目",area:62,component:()=>e((()=>import("./index302.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),showFooter:!0})},$=(a,s="")=>{Y(a,s),t({title:"Go项目管理["+a.name+"] -- 添加时间["+a.addtime+"]",area:[84,72],component:()=>e((()=>import("./index303.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)})},tt=async(t,e,l)=>{let n=Object.assign({},t.value);""!==n.domains?(n.bind_extranet=1,n.domains=a(n.domains)?n.domains.split("\n"):n.domains):(n.bind_extranet=0,delete n.domains);let i=t.value.env;1===l&&(i=(t=>{let e=t.split("\n").filter((t=>""!==t)),a=[];return e.forEach((t=>{let e=t.split("=");a.push({k:e[0],v:e[1]})})),a})(i)),n.env_file=2===l?t.value.envPath:"",n.env_list=JSON.stringify(1===l?i:[]),await e();const o={data:JSON.stringify(n)},r=Q.value?H:z,u=await s({request:r(o,"go")});let m=u.data;return U.msg({dangerouslyUseHTMLString:!0,message:m.status?m.data:m.error_msg,type:m.status?"success":"error",duration:m.status?2e3:0,showClose:!m.status,customClass:"!max-w-[66rem]"}),u.status&&(W.value=!0),u.status},et=async(t,e,a,s)=>{const{label:l,value:n}=s,i=new Map([["start","批量启动选中项目后，项目将正常访问"],["stop","批量停用选中的项目后，项目将会停止运行"],["restart","批量重启选中的项目后，项目将会重新启动"],["delete","批量删除选中的项目后，项目将无法恢复"]]),o=async(t,e)=>{var a,s,l;const i=new Map([["start",F],["stop",F],["restart",F],["delete",K]]),{name:o}=t,r=i.get(n);switch(n){case"start":case"stop":case"restart":if(r){const e=await r({data:JSON.stringify({project_name:o})},X.value,n);return{...t,batchStatus:e.status?1:2,message:(null==(a=null==e?void 0:e.data)?void 0:a.msg)||(null==(s=null==e?void 0:e.data)?void 0:s.data)||(null==(l=null==e?void 0:e.data)?void 0:l.error_msg)}}break;case"delete":if(r)return await r({data:JSON.stringify({project_name:o})},X.value)}};await t({title:"批量".concat(l),content:"".concat(i.get(n),"，是否继续操作？"),column:[{label:"项目名称",prop:"name"},k()],onConfirm:async()=>(await e(o),W.value=!0,!1)})},at=c({__name:"index",setup(t){const{mainHeight:a}=n(),{getSiteList:s,setSiteInfo:l}=V(),{activeType:c,isRefreshList:k,siteInfo:M}=p(V()),{BtOperation:H}=i({options:[{type:"button",label:"添加Go项目",active:!0,onClick:Z},{type:"button",label:"SDK版本管理",onClick:()=>{I("go")}},{type:"button",label:"项目守护隔离时间",onClick:P}]}),z=q({key:"type_id",name:"Go分类",options:()=>[{label:"全部分类",value:"all"}],event:R,ignore:["0"],field:"type_name"}),F=u([{label:"启用项目",value:"start",event:et},{label:"停用项目",value:"stop",event:et},{label:"重启项目",value:"restart",event:et},G(),N({classList:A}),{label:"删除项目",value:"delete",event:et}]),{BtTable:K,BtPage:U,BtRefresh:Q,BtSearch:W,BtColumn:X,BtBatch:Y,BtTableCategory:tt,refresh:at,config:st}=o({request:t=>{const{type_id:e,...a}=t;return s({data:JSON.stringify({...a,type_id:r(e)||"all"===e?"":e})})},columns:[w(),T({onClick:t=>{$(t)}}),B({onClick:(t,e)=>{if("setting"===e)return void $(t,"state");const a=t.run?"stop":"start";J(t,"restart"===e?e:a)}}),C(),S({table:"sites",width:200}),E({onClick:t=>{$(t,"ssl")}}),O([{title:"设置",onClick:t=>{$(t)}},{title:"删除",onClick:t=>{D(t)}}])],extension:[z,F],empty:()=>d("span",null,[_("您的列表为空，您可以"),d("span",{class:"bt-link",onClick:Z},[_("添加一个项目")])])});return v(k,(async t=>{var e;if(t){if(await at(),null==(e=M.value)?void 0:e.name){const t=st.data.find((t=>t.name===M.value.name));t&&l(t)}k.value=!1}})),f((()=>{g((()=>{e((()=>import("./index302.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),e((()=>import("./index303.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)}))})),(t,e)=>{const s=m;return b(),y(s,null,{"header-left":h((()=>[d(x(H)),j("div",{class:"flex items-center ml-1rem",onClick:e[0]||(e[0]=(...t)=>x(L)&&x(L)(...t))},e[1]||(e[1]=[j("i",{class:"svgtofont-desired text-[1.6rem]"},null,-1),j("span",{class:"bt-link"},"需求反馈",-1)]))])),"header-right":h((()=>[d(x(tt),{class:"!w-[200px] mr-[10px]"}),d(x(W),{class:"mr-[10px]",placeholder:"请输入项目名称或备注"}),d(x(Q),{class:"mr-[10px]"}),d(x(X))])),content:h((()=>[d(x(K),{"max-height":x(a)-220},null,8,["max-height"])])),"footer-left":h((()=>[d(x(Y))])),"footer-right":h((()=>[d(x(U))])),_:1})}}}),st=Object.freeze(Object.defineProperty({__proto__:null,default:at},Symbol.toStringTag,{value:"Module"}));export{tt as a,st as i};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
