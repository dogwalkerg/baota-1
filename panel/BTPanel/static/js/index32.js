import{u as e,b2 as a,l as t,H as s,o,G as l,a8 as i,k as n,V as r}from"./utils-lib.js?v=1734676359";import{_ as m}from"./index90.js?v=1734676359";import{_ as c}from"./index97.js?v=1734676359";import{_ as u}from"./index182.js?v=1734676359";import{c as p}from"./column.js?v=1734676359";import{g,M as d,N as f,O as v}from"./useStore3.js?v=1734676359";import{c as b,h as _,r as h,w as y,o as j,B as N,k as S,J as k,x as w,q as x,e as C,p as T,C as O}from"./base-lib.js?v=1734676359";import{g as q,N as I,d as J}from"./useMethods.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";const R={class:"flex items-center"},E=b({__name:"index",setup(b){const{refs:{isRefreshStorageList:E,customLimit:H}}=g(),{mainHeight:L}=e(),A=_({loading:!1,total:0,p:1,limit:Number(localStorage.getItem("dockerstroagelimit"))||20}),D=h(),M=h([]),U=h([]),V=[{label:"删除",value:"delete",event:async(e,a,t,s)=>{const{label:o,value:l}=s,i=async(e,a)=>{const{Name:t}=e;if("delete"===l)return await v({data:JSON.stringify({name:t})})};await e({title:"批量".concat(o,"存储卷"),content:"批量".concat(o,"已选的存储卷，是否继续操作！"),column:[{label:"存储卷",prop:"Name"},p()],onConfirm:async()=>(await a(i),z(),!1)})}}],B=[{active:!0,content:"添加存储卷",event:()=>{t({component:()=>s((()=>import("./add-storage-dialog.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),title:"添加存储卷",area:58,btn:"添加"})}},{content:"清理存储卷",event:async()=>{await o({type:"calc",title:"清理存储卷",content:"您真的要清理所有未被容器使用的存储卷吗？（可能不会包含您自己创建的卷）"}),l({request:d(),message:!0,loading:"正在清理存储卷，请稍后...",success:()=>z()})}}],G=e=>{H.value.storage=!0,localStorage.setItem("dockerstroagelimit",A.limit.toString()),z(!1)};let P=!0;const z=async e=>{try{if(E.value=!1,!1===e)return void(U.value=J({p:A.p,limit:A.limit,list:M.value})||[]);P&&(A.loading=!0),await l({request:f(),data:Array,success:e=>{P=!1,M.value=e,A.total=e.length,U.value=J({p:A.p,limit:A.limit,list:M.value})||[]}}),A.loading=!1}catch(a){}},F=q({deleteDataEvent:async e=>{await o({type:"calc",title:"删除存储卷【".concat(e.Name,"】"),content:"您真的要删除存储卷【".concat(e.Name,"】吗？")}),l({request:v({data:JSON.stringify({name:e.Name})}),message:!0,success:()=>z()})}});return y((()=>E.value),(e=>{e&&z()})),j((async()=>{z(),F.value=a(JSON.parse(localStorage.getItem("dockerStorageTableColumn")||"[]"),F.value),H.value.storage||setTimeout((()=>{L.value>900?A.limit=20:A.limit=10}),0)})),(e,a)=>{const t=u,s=i,o=n,l=r,p=c,g=m,d=N("bt-loading");return S(),k(g,{class:"p-[1.6rem]"},{"header-left":w((()=>[x("div",R,[C(t,{options:B}),x("a",{class:"ml-[1rem] bt-link",onClick:a[0]||(a[0]=e=>T(I)())}," 需求反馈 ")])])),"header-right":w((()=>[C(s,{name:"dockerStorageTableColumn",column:T(F),tableRef:T(D)},null,8,["column","tableRef"])])),content:w((()=>[O(C(o,{ref_key:"storageTable",ref:D,key:"storageTable",column:T(F),"max-height":T(L)-220,data:T(U),description:"存储卷列表为空"},null,8,["column","max-height","data"]),[[d,T(A).loading],[d,"正在加载存储卷列表，请稍后...","title"]])])),"footer-left":w((()=>[C(l,{"table-ref":T(D),options:V},null,8,["table-ref"])])),"footer-right":w((()=>[C(p,{page:T(A).p,"onUpdate:page":a[1]||(a[1]=e=>T(A).p=e),row:T(A).limit,"onUpdate:row":a[2]||(a[2]=e=>T(A).limit=e),total:T(A).total,onChange:G},null,8,["page","row","total"])])),popup:w((()=>a[3]||(a[3]=[]))),_:1})}}});export{E as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
