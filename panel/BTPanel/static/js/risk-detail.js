import{_ as t}from"./index90.js?v=1734676359";import{_ as e}from"./index97.js?v=1734676359";import{aj as s,R as a,G as o,S as r,k as i}from"./utils-lib.js?v=1734676359";import{A as n}from"./firewall.js?v=1734676359";import{c as l,r as p,e as m,h as d,w as c,o as _,k as u,J as j,x as w,p as f}from"./base-lib.js?v=1734676359";import{f as h}from"./useController6.js?v=1734676359";import{u as g}from"./column.js?v=1734676359";import{aQ as k}from"./store.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./validator.js?v=1734676359";import"./index91.js?v=1734676359";import"./useStore7.js?v=1734676359";import"./site.js?v=1734676359";import"./useController3.js?v=1734676359";import"./store2.js?v=1734676359";import"./index88.js?v=1734676359";const x=l({__name:"risk-detail",props:{compData:{default:()=>{}}},setup(l){const x=l,b=p([]),y=p(0),C=(t,e)=>{k({path:t})},v=p([{label:"巡检时间",width:"150px",render:t=>{const e=s(t.time,"number",0);return m("span",null,[a(e)])}},{label:"URL",render:t=>m("span",{class:"bt-link",title:t.url,onClick:()=>window.open(t.url)},[t.url])},{label:"关键词",prop:"content",width:"200px"},{label:"类型",prop:"risk_content",width:"200px"},{label:"风险位置",width:"150px",render:t=>h[t.risk_type]},g([{onClick:t=>{let e="/www/server/panel/class/projectModel/content/source/",s=e+t.source_file;t.risk_type.indexOf("_update")>-1?((t,e)=>{"title_hash_update"!==t.risk_type&&"tail_hash_update"!==t.risk_type||(e="/www/server/panel/class/projectModel/content/hash/"+t.site_name+"/"),t.source_content_file;let s=e+t.new_content_file;C(s)})(t,e):C(s,t.content)},title:"详情"}])]),D=d({p:1,limit:10,testing_id:x.compData.testing_id}),U=async(t=1)=>{await o({loading:"正在获取IP规则列表，请稍后...",request:n(D),data:{data:[Array,b],page:r(y)}})};return c((()=>x.compData),(t=>{D.testing_id=t.testing_id})),_((()=>U())),(s,a)=>{const o=i,r=e,n=t;return u(),j(n,{class:"p-[2rem]"},{content:w((()=>[m(o,{column:f(v),data:f(b)},null,8,["column","data"])])),"footer-right":w((()=>[m(r,{total:f(y),page:f(D).p,"onUpdate:page":a[0]||(a[0]=t=>f(D).p=t),row:f(D).limit,"onUpdate:row":a[1]||(a[1]=t=>f(D).limit=t),onChange:U},null,8,["total","page","row"])])),_:1})}}});export{x as default};
