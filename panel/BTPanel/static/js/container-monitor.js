import{G as e,t,R as s,dj as a,e as l}from"./utils-lib.js?v=1734676359";import{c as i,r,h as o,ax as n,w as c,o as m,aB as u,B as d,C as p,p as v,k as f,l as b,q as x,y as _,v as g,e as h,n as w}from"./base-lib.js?v=1734676359";import{a2 as y}from"./useStore3.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";const k={class:"flex flex-col !h-full"},B={class:"card"},S={class:"con flex items-center"},j={class:"p-[1.5rem] text-[1.2rem] font-bold"},I={class:"text-[#919191]"},A={class:"p-[1.5rem] text-[1.2rem] font-bold"},C={class:"text-[#919191]"},M={class:"chartCon flex flex-wrap w-full justify-between"},R={class:"flex w-[49%]"},z={class:"card w-full flex-1 mb-[1rem]"},D={class:"chart w-full h-[20rem]"},L={class:"flex w-[49%]"},N={class:"card w-full flex-1 mb-[1rem]"},P={class:"chart w-full h-[20rem]"},G={class:"flex w-[49%]"},K={class:"card w-full flex-1 mb-[1rem]"},O={class:"chart w-full h-[20rem]"},U={class:"flex w-[49%]"},q={class:"card w-full flex-1 mb-[1rem]"},H={class:"chart w-full h-[20rem]"},J=l(i({__name:"container-monitor",props:{compData:{default:()=>({})}},setup(l){const i=l,J=r(),T=r(),E=r(),F=r(),Q=r(!1),V=r(),W=o({cpu_list:[],mem_list:{usage:[],cache:[]},disk_list:{read:[],write:[]},network_list:{tx:[],rx:[]},time_list:[],limit:"",top_limit:"",bottom_limit:""}),X=async s=>{const a=(new Date).getTime(),l=JSON.stringify({id:s.id,dk_status:s.status}),i=await e({request:y({data:l})}),r=i.data;if(!i.status)return!1;W.limit=t(r.limit),W.top_limit=t(r.tx_total),W.bottom_limit=t(r.rx_total),W.time_list.push(a),W.mem_list.usage.push([a,t(r.usage,!1,null,"MB")]),W.mem_list.cache.push([a,t(r.cache,!1,null,"MB")]),W.cpu_list.push([a,r.cpu_usage]),W.disk_list.read.push([a,t(r.read_total,!1,null,"MB")]),W.disk_list.write.push([a,t(r.write_total,!1,null,"MB")]),W.network_list.tx.push([a,t(r.tx,!1,null,"KB")]),W.network_list.rx.push([a,t(r.rx,!1,null,"KB")]);const o=Y("cpu"),n=Y("mem"),c=Y("disk"),m=Y("network");o.xAxis.data=W.time_list,o.series[0].data=W.cpu_list,n.series[0].data=W.mem_list.usage,n.series[1].data=W.mem_list.cache,c.series[0].data=W.disk_list.read,c.series[1].data=W.disk_list.write,m.series[0].data=W.network_list.tx,m.series[1].data=W.network_list.rx,ee.value=o,te.value=n,se.value=c,ae.value=m,Q.value=!1},Y=e=>{let t="/MB",a=Z();switch(e){case"cpu":a.tooltip.formatter=function(e){const t=e[0];return s(t.data[0])+"<br>"+t.seriesName+": "+t.data[1]+"%"},a.yAxis.min=0,a.series=[{name:"CPU",type:"line",symbol:"none",smooth:!0,itemStyle:{normal:{color:"rgb(0, 153, 238)"}}}];break;case"network":t="/KB";case"mem":case"disk":var l={mem:["内存","缓存"],disk:["读取","写入"],network:["上行","下行"],color:[{mem:["rgb(185, 220, 253)","rgb(185, 220, 253,0.6)","rgb(185, 220, 253,0.3)","rgba(229,147,187)","rgba(229,147,187,0.6)","rgba(229,147,187,0.3)"],disk:["rgb(255, 70, 131)","rgb(255, 70, 131,0.6)","rgb(255, 70, 131,0.3)","rgba(46, 165, 186)","rgba(46, 165, 186,0.6)","rgba(46, 165, 186,0.3)"],network:["rgb(255, 140, 0)","rgb(255, 140, 0,0.6)","rgb(255, 140, 0,0.3)","rgb(30, 144, 255)","rgb(30, 144, 255,0.6)","rgb(30, 144, 255,0.3)"]}]};a.tooltip.formatter=function(e){const a=e[0].data[0],l=s(a/1e3);let i="";for(var r=0;r<e.length;r++)i+='<span style="display: inline-block; width: 10px; height: 10px; margin-rigth:10px; border-radius: 50%; background: '+e[r].color+';"></span>  '+e[r].seriesName+"：",i+=e[r].data[1]+t+(e.length-1!==r?"<br />":"");return"时间："+l+"<br />"+i},a.legend={top:"18px",data:l[e]},a.series=[{name:l[e][0],type:"line",symbol:"none",itemStyle:{normal:{color:l.color[0][e][0],areaStyle:{}}}},{name:l[e][1],type:"line",symbol:"none",itemStyle:{normal:{color:l.color[0][e][4],areaStyle:{}}}}]}return a},Z=()=>({tooltip:{trigger:"axis",axisPointer:{type:"cross"}},grid:{x:50,y:50,x2:30,y2:30},xAxis:{type:"time",scale:!0,splitNumber:2,boundaryGap:!0,axisLine:{lineStyle:{color:"#666"}},axisLabel:{formatter:e=>s(e/1e3,"hh:mm:ss")}},yAxis:{type:"value",boundaryGap:[0,"100%"],splitLine:{lineStyle:{color:"#ddd"}},axisLine:{lineStyle:{color:"#666"}}}}),$=n("tabActive");c((()=>$.value),(()=>{"monitor"!==$.value&&(V.value&&clearInterval(V.value),V.value=null)}));const ee=r(Y("cpu")),te=r(Y("mem")),se=r(Y("disk")),ae=r(Y("network"));return m((()=>{var e;Q.value=!0,e=i.compData.row,w((()=>{ee.value=Y("cpu"),te.value=Y("mem"),se.value=Y("disk"),ae.value=Y("network"),J.value.chart.resize(),T.value.chart.resize(),E.value.chart.resize(),F.value.chart.resize(),X(e)})),V.value=setInterval((function(){X(i.compData.row)}),3e3)})),u((()=>{clearInterval(V.value)})),(e,t)=>{const s=a,l=d("bt-loading");return p((f(),b("div",k,[x("div",B,[t[2]||(t[2]=x("div",{class:"title"},"基础信息",-1)),x("div",S,[x("div",j,[t[0]||(t[0]=_(" 内存限额：")),x("span",I,g(v(W).limit),1)]),x("div",A,[t[1]||(t[1]=_(" 流量情况：")),x("span",C," 上行："+g(v(W).top_limit)+" - 下行："+g(v(W).bottom_limit),1)])])]),x("div",M,[x("div",R,[x("div",z,[t[3]||(t[3]=x("div",{class:"title"},"CPU",-1)),x("div",D,[h(s,{ref_key:"CPURef",ref:J,options:v(ee)},null,8,["options"])])])]),x("div",L,[x("div",N,[t[4]||(t[4]=x("div",{class:"title"},"内存",-1)),x("div",P,[h(s,{ref_key:"memRef",ref:T,options:v(te)},null,8,["options"])])])]),x("div",G,[x("div",K,[t[5]||(t[5]=x("div",{class:"title"},"磁盘IO",-1)),x("div",O,[h(s,{ref_key:"diskRef",ref:E,options:v(se)},null,8,["options"])])])]),x("div",U,[x("div",q,[t[6]||(t[6]=x("div",{class:"title"},"网络IO",-1)),x("div",H,[h(s,{ref_key:"netRef",ref:F,options:v(ae)},null,8,["options"])])])])])])),[[l,v(Q)],[l,"正在获取监控数据，请稍候...","title"]])}}}),[["__scopeId","data-v-ea6dd89f"]]);export{J as default};
