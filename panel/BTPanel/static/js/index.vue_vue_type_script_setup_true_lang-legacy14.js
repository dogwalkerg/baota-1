!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return r(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function o(e,r,n){return(r=function(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,r||"default");if("object"!=t(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function i(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */i=function(){return r};var e,r={},n=Object.prototype,a=n.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},u="function"==typeof Symbol?Symbol:{},s=u.iterator||"@@iterator",c=u.asyncIterator||"@@asyncIterator",l=u.toStringTag||"@@toStringTag";function p(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{p({},"")}catch(e){p=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var a=e&&e.prototype instanceof x?e:x,i=Object.create(a.prototype),u=new F(n||[]);return o(i,"_invoke",{value:P(t,r,u)}),i}function v(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}r.wrap=f;var d="suspendedStart",h="suspendedYield",y="executing",m="completed",g={};function x(){}function w(){}function _(){}var b={};p(b,s,(function(){return this}));var j=Object.getPrototypeOf,E=j&&j(j(A([])));E&&E!==n&&a.call(E,s)&&(b=E);var k=_.prototype=x.prototype=Object.create(b);function S(t){["next","throw","return"].forEach((function(e){p(t,e,(function(t){return this._invoke(e,t)}))}))}function O(e,r){function n(o,i,u,s){var c=v(e[o],e,i);if("throw"!==c.type){var l=c.arg,p=l.value;return p&&"object"==t(p)&&a.call(p,"__await")?r.resolve(p.__await).then((function(t){n("next",t,u,s)}),(function(t){n("throw",t,u,s)})):r.resolve(p).then((function(t){l.value=t,u(l)}),(function(t){return n("throw",t,u,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,e){function a(){return new r((function(r,a){n(t,e,r,a)}))}return i=i?i.then(a,a):a()}})}function P(t,r,n){var a=d;return function(o,i){if(a===y)throw Error("Generator is already running");if(a===m){if("throw"===o)throw i;return{value:e,done:!0}}for(n.method=o,n.arg=i;;){var u=n.delegate;if(u){var s=L(u,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===d)throw a=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=y;var c=v(t,r,n);if("normal"===c.type){if(a=n.done?m:h,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(a=m,n.method="throw",n.arg=c.arg)}}}function L(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,L(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=v(a,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var i=o.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function N(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function F(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function A(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function t(){for(;++o<r.length;)if(a.call(r,o))return t.value=r[o],t.done=!1,t;return t.value=e,t.done=!0,t};return i.next=i}}throw new TypeError(t(r)+" is not iterable")}return w.prototype=_,o(k,"constructor",{value:_,configurable:!0}),o(_,"constructor",{value:w,configurable:!0}),w.displayName=p(_,l,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,p(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},r.awrap=function(t){return{__await:t}},S(O.prototype),p(O.prototype,c,(function(){return this})),r.AsyncIterator=O,r.async=function(t,e,n,a,o){void 0===o&&(o=Promise);var i=new O(f(t,e,n,a),o);return r.isGeneratorFunction(e)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},S(k),p(k,l,"Generator"),p(k,s,(function(){return this})),p(k,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=A,F.prototype={constructor:F,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(N),!t)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,a){return u.type="throw",u.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],u=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=a.call(i,"catchLoc"),c=a.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),N(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var a=n.arg;N(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:A(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},r}function u(t,e,r,n,a,o,i){try{var u=t[o](i),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,a)}function s(t){return function(){var e=this,r=arguments;return new Promise((function(n,a){var o=t.apply(e,r);function i(t){u(o,n,a,i,s,"next",t)}function s(t){u(o,n,a,i,s,"throw",t)}i(void 0)}))}}System.register(["./utils-lib-legacy.js?v=1734676359","./base-lib-legacy.js?v=1734676359","./index-legacy353.js?v=1734676359","./form-item-legacy.js?v=1734676359","./useController-legacy3.js?v=1734676359","./useStore-legacy7.js?v=1734676359","./site-legacy.js?v=1734676359","./validator-legacy.js?v=1734676359"],(function(t,r){"use strict";var n,o,u,c,l,p,f,v,d,h,y,m,g,x,w,_,b,j,E,k,S,O,P,L,T,N,F,A,C,I,V,q,D,G,J,U,M,H,R,B,X,$,z,Y,Q,K,W;return{setters:[function(t){n=t.G,o=t.M,u=t.ah,c=t.o,l=t.bX,p=t.l,f=t.H,v=t.an,d=t.r,h=t.D,y=t.aO,m=t.j},function(t){g=t.g,x=t.s,w=t.r,_=t.h,b=t.c,j=t.ax,E=t.o,k=t.k,S=t.l,O=t.q,P=t.y,L=t.e,T=t.p,N=t.M,F=t.v,A=t.x,C=t.z,I=t.i,V=t.Q,q=t.aj,D=t.A},function(t){G=t.B},function(t){J=t.k,U=t.n},function(t){M=t.p},function(t){H=t.u,R=t.S},function(t){B=t.setJavaStaticFile,X=t.getPortStatus,$=t.removeServerProxy,z=t.bindExtranet,Y=t.unbindExtranet,Q=t.modifyServerProxy,K=t.addServerProxy},function(t){W=t.f}],execute:function(){var Z,tt,et,rt=g("SITE-EXTERNAL-MAP-STORE",(function(){var t=H(),e=t.siteInfo,r=t.siteType,a=w(!1),c=function(){var t=s(i().mark((function t(r){var a,o,u,s;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=r.status,o=r.index,u=r.path,t.next=4,n({loading:"正在设置静态文件...",request:B({status:a?1:0,index:o,path:u,project_name:e.value.name}),message:!0});case 4:return s=t.sent,t.abrupt("return",{status:s.status,msg:s.msg});case 8:return t.prev=8,t.t0=t.catch(0),t.abrupt("return",{status:!1,msg:"设置静态文件失败"});case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}(),l=function(){var t=s(i().mark((function t(){var r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,X({project_name:e.value.name});case 3:if(r=t.sent,Array.isArray(r.data.data)){t.next=6;break}return t.abrupt("return",{data:[],total:0,other:{}});case 6:return t.abrupt("return",{data:r.data.data,total:r.data.data.length,other:{}});case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",{data:[],total:0,other:{}});case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(){return t.apply(this,arguments)}}(),p=function(){var t=s(i().mark((function t(e){var r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n({loading:"正在删除反向代理映射...",request:$(e),message:!0});case 3:return r=t.sent,t.abrupt("return",{status:r.status,msg:r.msg});case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",{status:!1,msg:"删除代理失败"});case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),f=function(){var t=s(i().mark((function t(e,n){var a,u,s,c,l,p,f;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.status,u=o.load("正在修改状态，请稍后..."),t.prev=2,s=r.value,c=a?z:Y,t.next=7,c(e,s);case 7:return l=t.sent,p=l.data,f=p.msg||p.data||p.error_msg,t.abrupt("return",{status:p.status,msg:f});case 13:return t.prev=13,t.t0=t.catch(2),t.abrupt("return",{status:!1,msg:"修改状态失败"});case 17:return t.prev=17,u.close(),t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[2,13,17,20]])})));return function(e,r){return t.apply(this,arguments)}}(),v=function(){var t=s(i().mark((function t(e,r){var a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n({loading:"正在操作中，请稍后...",request:r?Q(e):K(e)});case 3:return a=t.sent,t.abrupt("return",{msg:a.msg,status:a.status});case 7:t.prev=7,t.t0=t.catch(0),u(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,r){return t.apply(this,arguments)}}();return{isRefreshPortList:a,setStaticFileEvent:c,getJavaPortData:l,deleteProxyEvent:p,changeStatusEvent:f,saveProxyMapEvent:v}})),nt=H(),at=(nt.activeType,nt.siteInfo),ot=nt.siteType,it=(nt.rowData,R()),ut=(it.getFileEvent,it.saveFileEvent,it.setSiteInfo),st=it.getProjectConfig,ct=it.jumpTabEvent,lt=x(rt()).isRefreshPortList,pt=rt(),ft=pt.setStaticFileEvent,vt=pt.deleteProxyEvent,dt=(pt.getJavaPortData,pt.saveProxyMapEvent),ht=pt.changeStatusEvent,yt=_({status:null===(Z=at.value)||void 0===Z||null===(Z=Z.project_config)||void 0===Z||null===(Z=Z.static_info)||void 0===Z?void 0:Z.status,index:(null===(tt=at.value)||void 0===tt||null===(tt=tt.project_config)||void 0===tt||null===(tt=tt.static_info)||void 0===tt?void 0:tt.index)||"index.html",path:(null===(et=at.value)||void 0===et||null===(et=et.project_config)||void 0===et||null===(et=et.static_info)||void 0===et?void 0:et.path)||"",popup:!1}),mt=w(!1),gt=w(!1),xt=w(!1),wt=function(){var t=s(i().mark((function t(e){var r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ft(e);case 2:return(r=t.sent).status&&(yt.popup=!1,_t()),t.abrupt("return",r.status);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),_t=function(){var t=s(i().mark((function t(){var e,r,n,a,o,u;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=at.value,r=e.project_type,n=e.name,a="python"===r?{name:n}:{project_name:n},t.next=5,st(a);case 5:(o=t.sent).status&&o.data.name&&(u=o.data.project_config,mt.value=!!u.bind_extranet,gt.value="springboot"!==u.java_type&&"java"===r,u&&ut(o.data)),t.next=13;break;case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",{status:!1,msg:"获取域名信息失败"});case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(){return t.apply(this,arguments)}}(),bt=function(){var t=s(i().mark((function t(e){var r,n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={proxy_id:e.proxy_id,site_name:at.value.name},t.next=3,vt(r);case 3:return(n=t.sent).status&&(lt.value=!0),t.abrupt("return",n.status);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),jt=function(t){return"".concat(t,"/").replace(/\s+/g,"").replace(/\/\//g,"/")},Et=function(t){var e,r,n,o=a(a({},t),{},{status:t.status?1:0,site_name:at.value.name,rewrite:JSON.stringify(t.rewrite),add_headers:JSON.stringify((e=t.add_headers,r=e.split("\n").filter((function(t){return""!==t})),n=[],r.forEach((function(t){var e=t.split("=");n.push({k:e[0],v:e[1]})})),n))});return o.isEdit||delete o.proxy_id,delete o.isEdit,o},kt=function(){var t=s(i().mark((function t(e){var r,n,a,s,l,p,f;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,"java"===(r=ot.value)){t.next=6;break}return mt.value=!e,t.next=6,c({width:40,title:"外网映射",content:"".concat(e?"开启":"关闭","外网映射后，").concat(e?"可以通过绑定域名进行访问":"已绑定域名将取消关联访问","，是否继续操作？"),icon:"warning-filled"});case 6:return n=at.value,a=n.name,s=n.project_config,l={python:{data:JSON.stringify({name:a})},java:{data:JSON.stringify({project_name:a})},default:{data:JSON.stringify({project_name:a,domains:s.domains})}},p=l[r]||l.default,t.next=11,ht(p,{status:e});case 11:f=t.sent,o.request(f),f.status&&(_t(),lt.value=!0),St(f),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(0),u(t.t0);case 20:case"end":return t.stop()}}),t,null,[[0,17]])})));return function(e){return t.apply(this,arguments)}}(),St=function(t){var e=ot.value;if("java"===e&&t.msg.includes("域名")){mt.value=!1;var r=function(){ct("domain")};o.msg({message:"".concat(t.msg,'，<span class="text-primary cursor-pointer go-domains">前往添加域名</span>'),duration:3e3,dangerouslyUseHTMLString:!0,type:"error",onClose:function(){r&&window.removeEventListener("click",r)}}),r&&window.addEventListener("click",r,{once:!0})}else if("java"!==e){var n,a,i,u,s;t.status||t.data.status?o.success((null===(n=t.data)||void 0===n?void 0:n.msg)||(null===(a=t.data)||void 0===a?void 0:a.data)||t.msg):o.error((null===(i=t.data)||void 0===i?void 0:i.error_msg)||(null===(u=t.data)||void 0===u?void 0:u.msg)||(null===(s=t.data)||void 0===s?void 0:s.data))}else o.request(t)},Ot=function(){var t=s(i().mark((function t(e,r){var n,a,u;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(n=at.value.project_config)||void 0===n||null===(n=n.static_info)||void 0===n||!n.status||"/"!==e.value.proxy_dir){t.next=3;break}return o.error("项目已存在根路由【/】配置，无法设置该代理目录"),t.abrupt("return",!1);case 3:return t.next=5,r();case 5:if(t.prev=5,e.value.status||!e.value.proxy_id){t.next=11;break}return xt.value=!1,t.abrupt("return",bt(e.value));case 11:return e.value.rewrite.src_path=jt(e.value.rewrite.src_path),e.value.rewrite.target_path=jt(e.value.rewrite.target_path),a=Et(e.value),t.next=16,dt(a,e.value.isEdit);case 16:return u=t.sent,o.request(u),u.status&&(xt.value=!1,lt.value=!0),t.abrupt("return",u.status);case 20:t.next=25;break;case 22:t.prev=22,t.t0=t.catch(5);case 25:case"end":return t.stop()}}),t,null,[[5,22]])})));return function(e,r){return t.apply(this,arguments)}}(),Pt={class:"flex flex-col"},Lt={class:"flex items-center"},Tt={key:0},Nt={key:0,class:"flex items-center"},Ft={class:"mt-[8px] leading-8 text-[1.2rem] list-disc ml-[20px]"},At={key:0,class:"text-danger"};t("_",b({__name:"index",setup:function(t,n){var u,c=n.expose,g=x(R()),_=g.siteType,b=g.siteInfo,H=x(rt()).isRefreshPortList,B=rt().getJavaPortData,X=j("popupClose"),$=w(!1),z=l({request:(u=s(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("java"!==_.value){t.next=4;break}return t.next=3,B();case 3:return t.abrupt("return",t.sent);case 4:return t.abrupt("return",{data:[],total:0});case 5:case"end":return t.stop()}}),t)}))),function(){return u.apply(this,arguments)}),columns:[M(),{label:"防火墙状态",prop:"fire_wall",width:200,render:function(t){var e,n;return L("span",{onClick:function(){null===t.fire_wall?p({title:"端口规则",area:44,component:function(){return f((function(){return r.import("./add-port-rule-legacy.js?v=1734676359")}),void 0,r.meta.url)},compData:a(a({},null===t.fire_wall?{port:t.port,isEdit:!1,noNps:!0}:a(a({},t.fire_wall),{},{isEdit:!0,noNps:!0})),{},{refreshFn:B}),showFooter:!0}):o.msg({message:L("span",null,[P("请前往系统防火墙模块修改，"),L("span",{class:"text-primary cursor-pointer go-firewall",onClick:Z},[P("立即前往")])]),duration:2e3,dangerouslyUseHTMLString:!0,type:"error"})},class:(null===t.fire_wall||"drop"===(null===(e=t.fire_wall)||void 0===e?void 0:e.Strategy)?"text-danger":"text-primary")+" cursor-pointer"},[null===t.fire_wall?"未配置":"accept"===(null===(n=t.fire_wall)||void 0===n?void 0:n.Strategy)?"放行":"禁止"])}},{label:"外网映射",prop:"nginx_proxy",showOverflowTooltip:!1,render:function(t){var e,r,n,a,o;return mt.value?L("div",{class:"flex"},[L("span",{onClick:function(){var e={isEdit:!1,proxy_dir:"",proxy_id:"",proxy_port:"",site_name:"",rewrite:{status:!1,src_path:"",target_path:""},add_headers:"",status:!0};null!==t.nginx_proxy?(e.isEdit=!0,e.proxy_id=t.nginx_proxy.proxy_id,e.proxy_dir=t.nginx_proxy.proxy_dir,e.proxy_port=t.nginx_proxy.proxy_port,e.site_name=t.nginx_proxy.site_name,e.status=!!t.nginx_proxy.status,e.rewrite=t.nginx_proxy.rewrite,e.add_headers=t.nginx_proxy.add_headers.map((function(t){return"".concat(t.k,"=").concat(t.v)})).join("\n")):(e.isEdit=!1,e.proxy_port=t.port),tt(e)},class:(null===t.nginx_proxy||0===(null===(e=t.nginx_proxy)||void 0===e?void 0:e.status)?"text-danger":"text-primary")+" cursor-pointer max-w-[26rem] truncate",title:null!==t.nginx_proxy&&null!==(r=t.nginx_proxy)&&void 0!==r&&r.status?"已开启，代理路由："+(null===(n=t.nginx_proxy)||void 0===n?void 0:n.proxy_dir):""},[null===t.nginx_proxy?"未配置":null!==(a=t.nginx_proxy)&&void 0!==a&&a.status?"已开启，代理路由："+(null===(o=t.nginx_proxy)||void 0===o?void 0:o.proxy_dir):"已停止"])," "]):"请先点击上方启用外网映射后再使用"}}],extension:[v(H)]}),Y=z.BtTable,Q=z.refresh,K=function(t){return{type:"custom",render:function(e){return e.value.hasOwnProperty("status")||(e.value.status=!1),L(y,{label:"开启代理"},{default:function(){return[L(V,{modelValue:t.value.status,"onUpdate:modelValue":function(e){return t.value.status=e}},null)]}})}}},Z=function(){X(),d.push({path:"/firewall/system"})},tt=function(t){var r=h({data:t,options:function(t){return I((function(){return[K(t),{type:"input",label:"代理目录",key:"proxy_dir",attrs:{width:"26rem",placeholder:"请输入内容，用,分割",onInput:function(){}},rules:[{required:!0,message:"请输入代理目录",trigger:"blur"}]},{type:"custom",render:function(e){return L(y,{label:"代理端口",prop:"proxy_port"},{default:function(){return[L(G,{modelValue:t.value.proxy_port,"onUpdate:modelValue":function(e){return t.value.proxy_port=e},"controls-position":"right",class:"!w-[10rem]"},null)]}})},rules:{proxy_port:[{required:!0,message:"请输入代理端口",trigger:"blur"},{validator:function(t,e,r){/^\d+$/.test(e)?e<0||e>65535?r(new Error("端口号范围为0-65535")):r():r(new Error("端口号必须为数字，范围0-65535"))}}]}},U($)].concat(e($.value?[{type:"textarea",label:"自定义头部",key:"add_headers",attrs:{placeholder:"自定义头部，1行1个,例如：\nX-Client-IP=$remote_addr",class:"!w-[26rem]",width:"26rem",rows:4,resize:"none"}},{type:"custom",render:function(){return L(y,{label:"路由重写"},{default:function(){return[L(V,{modelValue:t.value.rewrite.status,"onUpdate:modelValue":function(e){return t.value.rewrite.status=e}},null)]}})}}].concat(e(t.value.rewrite.status?[{type:"custom",render:function(){return L(y,{label:" "},{default:function(){return[L("div",{class:"flex items-center"},[L(y,{label:"原路由",prop:"srcPath"},{default:function(){return[L(m,{modelValue:t.value.rewrite.src_path,"onUpdate:modelValue":function(e){return t.value.rewrite.src_path=e},class:"w-[25rem]",placeholder:"原路由,例如：".concat(t.value.proxy_dir,"/").replace(/ /g,"").replace(/\/\//g,"/")},null)]}}),L(y,{label:"替换路由",prop:"targetPath",class:"!mt-[0] ml-[1rem]"},{default:function(){return[L(m,{modelValue:t.value.rewrite.target_path,"onUpdate:modelValue":function(e){return t.value.rewrite.target_path=e},class:"w-[25rem]",placeholder:"替换路由,例如：".concat(t.value.proxy_dir,"/xxx/").replace(/ /g,"").replace(/\/\//g,"/")},null)]}})])]}})}}]:[])):[]))}))},submit:Ot}),n=r.BtForm,a=r.submit;p({title:"".concat(t.isEdit?"修改反向代理映射【".concat(t.proxy_id,"】"):"添加反向代理映射"),area:50,showFooter:!0,component:function(){return L(n,{class:"p-2rem"},null)},onConfirm:a})};return E(_t),c({init:function(){_t(),Q()}}),function(t,e){var r,n,a=q,u=D;return k(),S("div",Pt,[O("div",Lt,[e[2]||(e[2]=P(" 外网映射 ")),L(a,{modelValue:T(mt),"onUpdate:modelValue":e[0]||(e[0]=function(t){return N(mt)?mt.value=t:null}),class:"ml-[8px]",disabled:T(gt),onChange:T(kt)},null,8,["modelValue","disabled","onChange"])]),"java"===T(_)?(k(),S("div",Tt,[L(T(Y),{class:"my-2rem",maxHeight:450}),"springboot"===(null===(r=T(b).project_config)||void 0===r?void 0:r.java_type)?(k(),S("div",Nt,[e[4]||(e[4]=P(" 静态文件： ")),O("span",null,F(null!==(n=T(b).project_config)&&void 0!==n&&null!==(n=n.static_info)&&void 0!==n&&n.status?"已配置":"未配置"),1),L(u,{class:"!ml-[2rem]",type:"default",onClick:e[1]||(e[1]=function(t){return function(){var t,e,r;if(!mt.value)return o.error("请先点击上方启用外网映射后再使用");var n,a=h({data:{status:null===(t=b.value)||void 0===t||null===(t=t.project_config)||void 0===t||null===(t=t.static_info)||void 0===t?void 0:t.status,index:(null===(e=b.value)||void 0===e||null===(e=e.project_config)||void 0===e||null===(e=e.static_info)||void 0===e?void 0:e.index)||"index.html",path:(null===(r=b.value)||void 0===r||null===(r=r.project_config)||void 0===r||null===(r=r.static_info)||void 0===r?void 0:r.path)||""},options:function(t){var e;return t.value.status=(null===(e=b.value.project_config)||void 0===e||null===(e=e.static_info)||void 0===e?void 0:e.status)||!1,I((function(){return[K(t),{type:"input",label:"默认文档",key:"index",attrs:{placeholder:"请输入内容，用,分割",class:"w-[26rem]"},rules:[{validator:function(e,r,n){t.value.status&&""===r?n(new Error("默认文档不能为空")):n()}}]},J("文件路径","path",{attrs:{style:"width: 26rem"},rules:[{validator:function(e,r,n){t.value.status&&""===r?n(new Error("文件路径不能为空")):n()}}]},(function(){W({type:"dir",path:t.value.path,change:function(e){t.value.path=e}})}))]}))},submit:(n=s(i().mark((function t(e,r){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r();case 2:return t.abrupt("return",wt(e.value));case 3:case"end":return t.stop()}}),t)}))),function(t,e){return n.apply(this,arguments)})}),u=a.BtForm,c=a.submit;p({title:"设置静态文件【".concat(b.value.name,"】"),area:65,showFooter:!0,component:function(){return L(u,{class:"p-2rem"},null)},onConfirm:c})}()})},{default:A((function(){return e[3]||(e[3]=[P(" 设置静态文件 ")])})),_:1})])):C("",!0)])):C("",!0),O("ul",Ft,[e[5]||(e[5]=O("li",null,"如果您的是HTTP项目，且需要外网通过80/443访问，请开启外网映射",-1)),e[6]||(e[6]=O("li",null,"开启外网映射前，请到【域名管理】中至少添加1个域名",-1)),"java"===T(_)?(k(),S("li",At,"外网映射开启后可在配置文件中查看修改服务器（Nginx/Apache）的配置文件")):C("",!0)])])}}}))}}}))}();
