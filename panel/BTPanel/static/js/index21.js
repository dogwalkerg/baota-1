import{l as a,H as e,G as s,ah as l,c as t,F as o,k as r,V as n,S as i}from"./utils-lib.js?v=1734676359";import{_ as u}from"./index90.js?v=1734676359";import{_ as p}from"./index97.js?v=1734676359";import{c as d,h as c,r as m,R as _,i as g,w as f,o as v,B as h,k as y,l as b,p as x,J as j,x as w,e as k,z as C,q,y as S,M as V,F as L,I as R,aX as A,C as T,A as U,ag as D,ah as F,v as H}from"./base-lib.js?v=1734676359";import{_ as J}from"./index116.js?v=1734676359";import{f as O,g as E,u as I}from"./column.js?v=1734676359";import{e as M}from"./validator.js?v=1734676359";import{getModulesCloudServer as N,getModulesList as P}from"./database.js?v=1734676359";import{g as z,a as B,b as G,e as X,h as K,k as Q,n as W,i as Y,d as Z,l as $}from"./useMethod3.js?v=1734676359";import{_ as aa}from"./index.vue_vue_type_script_setup_true_lang3.js?v=1734676359";import{_ as ea}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";import"./index.vue_vue_type_style_index_0_scoped_03ce946a_lang.js?v=1734676359";const sa={class:"flex items-center"},la={class:"w-[20rem] truncate inline-block"},ta=d({__name:"index",setup(d){const{refs:{isRefreshTable:ta,isLoading:oa,envStatus:ra,isHaveServer:na},resetRefresh:ia,refreshTableList:ua}=z(),pa=c({total:0,page:1,row:10}),da=m([]),ca=_([]),ma=m(null),_a=m("all"),ga=m(""),fa=m([]),va=X(),ha=g((()=>!ra.value.setup&&!na.value)),ya=()=>{a({title:"管理员密码",area:42,component:()=>e((()=>import("./index122.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),showFooter:!0})},ba=async()=>{try{return await s({request:N({data:JSON.stringify({type:"pgsql"})},"pgsql"),data:[Array,fa]}),fa.value.length||(na.value=!1),fa.value}catch(a){l(a,"pgsql-getServerList")}},xa=async()=>{try{let a={p:pa.page,limit:pa.row,tables:"databases",search:ga.value,sid:"all"===_a.value?"":_a.value};""===a.sid&&delete a.sid;await s({loading:oa,request:P({data:JSON.stringify(a)},"pgsql"),data:{data:[Array,da],page:i(pa)}})}catch(a){l(a,"pgsql-getDatabaseList")}},ja=async()=>{xa(),await ba(),ca.value=[...K(Q),O({event:(a,e)=>W(a,e)}),Y(fa.value,"pgsql"),E({table:"databases"}),I([{onClick:Z,title:"权限"},{onClick:Q,title:"改密"},{onClick:$,title:"删除"}])]};return f((()=>ta.value),(async a=>{a&&await xa(),ia()})),v((()=>ja())),(a,e)=>{const s=J,l=U,i=t,d=D,c=F,m=o,_=r,g=n,f=p,v=u,O=h("bt-loading");return y(),b("div",null,[x(ha)?(y(),j(s,{key:0},{content:w((()=>[k(aa,{type:"PgSql"})])),_:1})):C("",!0),k(v,null,{"header-left":w((()=>[q("div",sa,[k(l,{type:"primary",onClick:e[0]||(e[0]=a=>x(B)(ba))},{default:w((()=>e[6]||(e[6]=[S(" 添加数据库 ")]))),_:1}),k(l,{onClick:ya},{default:w((()=>e[7]||(e[7]=[S("管理员密码")]))),_:1}),k(l,{onClick:x(G)},{default:w((()=>e[8]||(e[8]=[S("远程数据库")]))),_:1},8,["onClick"]),k(ea,{"comp-data":x(fa),class:"mx-12px"},null,8,["comp-data"]),k(i,{onClick:e[1]||(e[1]=a=>x(M)({name:"数据库",type:12})),icon:"desired",iconClass:"text-1.6rem"},{default:w((()=>e[9]||(e[9]=[S(" 需求反馈 ")]))),_:1})])])),"header-right":w((()=>[k(c,{modelValue:x(_a),"onUpdate:modelValue":e[2]||(e[2]=a=>V(_a)?_a.value=a:null),onChange:x(ua),class:L(["!w-[14rem] mr-[8px]",{"custom-types-bg-green":"all"!==x(_a)}])},{default:w((()=>[k(d,{label:"全部",value:"all"}),(y(!0),b(R,null,A(x(fa),((a,e)=>(y(),j(d,{key:e,label:"".concat("all"!==x(_a)?"已选：":"").concat(a.ps),value:a.id},{default:w((()=>[q("span",la,H(a.ps),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue","onChange","class"]),k(m,{class:"w-[26rem]",modelValue:x(ga),"onUpdate:modelValue":e[3]||(e[3]=a=>V(ga)?ga.value=a:null),onSearch:x(ua),placeholder:"请输入数据库名称/备注"},null,8,["modelValue","onSearch"])])),content:w((()=>[T(k(_,{ref_key:"pgsqlDbTableRef",ref:ma,column:x(ca),data:x(da)},null,8,["column","data"]),[[O,x(oa)]])])),"footer-left":w((()=>[k(g,{options:x(va),"table-ref":x(ma)},null,8,["options","table-ref"])])),"footer-right":w((()=>[k(f,{total:x(pa).total,page:x(pa).page,"onUpdate:page":e[4]||(e[4]=a=>x(pa).page=a),row:x(pa).row,"onUpdate:row":e[5]||(e[5]=a=>x(pa).row=a),onChange:x(ua)},null,8,["total","page","row","onChange"])])),_:1})])}}});export{ta as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
