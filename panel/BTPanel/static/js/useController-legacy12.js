!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */t=function(){return r};var n,r={},a=Object.prototype,u=a.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},i=s.iterator||"@@iterator",l=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function p(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{p({},"")}catch(n){p=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var a=t&&t.prototype instanceof x?t:x,u=Object.create(a.prototype),s=new F(r||[]);return o(u,"_invoke",{value:I(e,n,s)}),u}function v(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=f;var h="suspendedStart",m="suspendedYield",d="executing",g="completed",y={};function x(){}function b(){}function w(){}var k={};p(k,i,(function(){return this}));var _=Object.getPrototypeOf,L=_&&_(_(T([])));L&&L!==a&&u.call(L,i)&&(k=L);var E=w.prototype=x.prototype=Object.create(k);function j(e){["next","throw","return"].forEach((function(t){p(e,t,(function(e){return this._invoke(t,e)}))}))}function S(t,n){function r(a,o,s,i){var l=v(t[a],t,o);if("throw"!==l.type){var c=l.arg,p=c.value;return p&&"object"==e(p)&&u.call(p,"__await")?n.resolve(p.__await).then((function(e){r("next",e,s,i)}),(function(e){r("throw",e,s,i)})):n.resolve(p).then((function(e){c.value=e,s(c)}),(function(e){return r("throw",e,s,i)}))}i(l.arg)}var a;o(this,"_invoke",{value:function(e,t){function u(){return new n((function(n,a){r(e,t,n,a)}))}return a=a?a.then(u,u):u()}})}function I(e,t,r){var a=h;return function(u,o){if(a===d)throw Error("Generator is already running");if(a===g){if("throw"===u)throw o;return{value:n,done:!0}}for(r.method=u,r.arg=o;;){var s=r.delegate;if(s){var i=V(s,r);if(i){if(i===y)continue;return i}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===h)throw a=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=d;var l=v(e,t,r);if("normal"===l.type){if(a=r.done?g:m,l.arg===y)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(a=g,r.method="throw",r.arg=l.arg)}}}function V(e,t){var r=t.method,a=e.iterator[r];if(a===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=n,V(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var u=v(a,e.iterator,t.arg);if("throw"===u.type)return t.method="throw",t.arg=u.arg,t.delegate=null,y;var o=u.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,y):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,y)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function F(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function T(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function e(){for(;++a<t.length;)if(u.call(t,a))return e.value=t[a],e.done=!1,e;return e.value=n,e.done=!0,e};return o.next=o}}throw new TypeError(e(t)+" is not iterable")}return b.prototype=w,o(E,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:b,configurable:!0}),b.displayName=p(w,c,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,p(e,c,"GeneratorFunction")),e.prototype=Object.create(E),e},r.awrap=function(e){return{__await:e}},j(S.prototype),p(S.prototype,l,(function(){return this})),r.AsyncIterator=S,r.async=function(e,t,n,a,u){void 0===u&&(u=Promise);var o=new S(f(e,t,n,a),u);return r.isGeneratorFunction(t)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},j(E),p(E,c,"Generator"),p(E,i,(function(){return this})),p(E,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},r.values=T,F.prototype={constructor:F,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(P),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,a){return s.type="throw",s.arg=e,t.next=r,a&&(t.method="next",t.arg=n),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var i=u.call(o,"catchLoc"),l=u.call(o,"finallyLoc");if(i&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&u.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),y}},r}function n(e,t,n,r,a,u,o){try{var s=e[u](o),i=s.value}catch(e){return void n(e)}s.done?t(i):Promise.resolve(i).then(r,a)}function r(e){return function(){var t=this,r=arguments;return new Promise((function(a,u){var o=e.apply(t,r);function s(e){n(o,a,u,s,i,"next",e)}function i(e){n(o,a,u,s,i,"throw",e)}s(void 0)}))}}System.register(["./utils-lib-legacy.js?v=1734676359","./base-lib-legacy.js?v=1734676359","./validator-legacy.js?v=1734676359","./index.vue_vue_type_script_setup_true_lang-legacy20.js?v=1734676359","./index-legacy101.js?v=1734676359","./useStore-legacy7.js?v=1734676359","./index-legacy88.js?v=1734676359","./useController-legacy4.js?v=1734676359","./index-legacy276.js?v=1734676359","./site-legacy.js?v=1734676359"],(function(e,n){"use strict";var a,u,o,s,i,l,c,p,f,v,h,m,d,g,y,x,b,w,k,_,L,E,j,S,I,V,C,P,F,T,N,O,z,G,B,U,q,R,H,A,M,Y,D,J,Q,K,W,X,Z,$,ee,te,ne,re,ae,ue,oe,se,ie,le,ce,pe,fe,ve,he;return{setters:[function(e){a=e.c,u=e.j,o=e.b,s=e.e,i=e.u,l=e._,c=e.h,p=e.a4,f=e.G,v=e.M,h=e.ah,m=e.o,d=e.a6},function(e){g=e.c,y=e.o,x=e.B,b=e.C,w=e.p,k=e.k,_=e.l,L=e.I,E=e.v,j=e.z,S=e.q,I=e.e,V=e.y,C=e.x,P=e.r,F=e.h,T=e.w,N=e.J,O=e.D,z=e.b7,G=e.A,B=e.aj,U=e.aw,q=e.t,R=e.M,H=e.G,A=e.aY,M=e.Q,Y=e.a7,D=e.a4,J=e.g,Q=e.i,K=e.n},function(e){W=e._,X=e.f,Z=e.p},function(e){$=e._},function(e){ee=e._},function(e){te=e.u,ne=e.S},function(e){re=e._},function(e){ae=e.i},function(e){ue=e.A},function(e){oe=e.getSiteErrorLogs,se=e.getSpringBootLogList,ie=e.getSpringBootLog,le=e.changeSiteLogPath,ce=e.setPushTask,pe=e.getSiteLogPushStatus,fe=e.getIpArea,ve=e.getSiteLogs,he=e.getSiteLogFile}],execute:function(){var n={class:"h-full"},me={key:0,class:"mb-[16px]"},de={class:"flex"},ge={key:1,class:"bg-[#7F7F7F] flex items-center justify-center h-full",style:{"min-height":"500px"}},ye={class:"bg-white px-[48px] py-[16px] text-[#333] flex items-center"},xe=e("b",g({__name:"error-log",setup:function(e,t){var r=t.expose,u=te(),o=u.isBindExtranet,s=u.siteType,i=ne().jumpTabEvent;return y(bt),r({init:bt}),function(e,t){var r=a,u=x("bt-loading");return b((k(),_("div",n,[w(o)?(k(),_(L,{key:0},["proxy"===w(s)?(k(),_("div",me,"日志大小："+E(w(vt).size),1)):j("",!0),S("div",de,[I(ee,{content:w(vt).logs,isHtml:!0,fullScreen:{title:"全屏查看[错误]日志",onRefresh:w(bt)},style:{height:"56rem",width:"99.5%"}},null,8,["content","fullScreen"])])],64)):(k(),_("div",ge,[S("div",ye,[t[2]||(t[2]=V(" 请开启 ")),I(r,{class:"mx-[.4rem]",onClick:t[0]||(t[0]=function(e){return w(i)("mapping")})},{default:C((function(){return t[1]||(t[1]=[V(" 外网映射 ")])})),_:1}),t[3]||(t[3]=V(" 后查看 "))])]))])),[[u,w(ft)]])}}})),be={class:"mr-[10px]"},we={class:"flex items-center"},ke={class:"flex items-center"},_e={class:"text-primary"},Le={class:"flex flex-col text-[#666] p-12px"},Ee={class:"flex items-center"},je={class:"flex items-center mt-[8px] w-full"},Se=g({__name:"index",props:{refreshFn:{type:Function,default:function(){return{}}},sessionConfig:{default:function(){}}},emits:["save"],setup:function(e,n){var a=n.emit,s=e,i=o(),l=a,c=P(!1),p=P(),f=P(!0),v=P(0),h=P(100),m=P(5),d=P(5),g=F({status:!1,time:5,timer:0}),y=function(){var e=r(t().mark((function e(n){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g.status=n,g.time=d.value,(!g.time||g.time<1)&&(g.time=5,d.value=5),n?(g.timer=setInterval((function(){s.refreshFn()}),1e3*d.value),v.value=setInterval((function(){m.value--,0===m.value&&(m.value=d.value),h.value=m.value/d.value*100}),1e3)):(clearInterval(g.timer),clearInterval(v.value),m.value=d.value,h.value=100,f.value||i.success("关闭成功")),l("save",g);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=r(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(g.time<1)){e.next=3;break}return i.error("时间间隔不能小于1秒"),e.abrupt("return");case 3:m.value=g.time,d.value=g.time,i.success("保存成功"),clearInterval(g.timer),clearInterval(v.value),y(!0),l("save",g);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=r(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.refreshFn();case 2:i.success("刷新成功");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),q=function(){c.value=!1,g.time=d.value};return T((function(){return s.sessionConfig}),(function(e){p.value=e,null!=e&&e.time&&f.value&&(d.value=e.time,m.value=e.time,y(e.status),f.value=!1)}),{deep:!0}),function(e,t){var n=z,r=G,a=B,o=u,s=U;return k(),_("div",be,[S("div",we,[I(r,{class:"h-[3.2rem] refresh-btn",onClick:L},{default:C((function(){return[S("div",ke,[w(g).status?(k(),N(n,{key:0,class:"mr-8px",width:22,"show-text":!0,"stroke-width":1,type:"circle",color:"#20a53a","text-color":"#20a53a",percentage:w(h)},{default:C((function(){return[S("span",_e,E(Number(w(m))),1)]})),_:1},8,["percentage"])):j("",!0),t[3]||(t[3]=S("span",null,"刷新日志",-1))])]})),_:1}),I(s,{placement:"bottom-start",width:"280",trigger:"click","popper-class":"el-tooltip-white",onHide:q},{reference:C((function(){return[I(r,{class:"down-button !ml-0",onClick:t[2]||(t[2]=function(e){return c.value=!w(c)})},{default:C((function(){return t[7]||(t[7]=[S("i",{class:"svgtofont-el-arrow-down"},null,-1)])})),_:1})]})),default:C((function(){return[S("div",Le,[S("div",Ee,[t[4]||(t[4]=S("span",{class:"mr-4px"},"定时刷新",-1)),I(a,{modelValue:w(g).status,"onUpdate:modelValue":t[0]||(t[0]=function(e){return w(g).status=e}),onChange:y},null,8,["modelValue"])]),b(S("div",je,[t[6]||(t[6]=S("span",{class:"mr-4px flex-nowrap"},"时间间隔",-1)),I(o,{modelValue:w(g).time,"onUpdate:modelValue":t[1]||(t[1]=function(e){return w(g).time=e}),"text-type":"秒",min:1,type:"number",class:"!w-[10rem]"},null,8,["modelValue"]),I(r,{class:"!ml-4px",type:"primary",onClick:x},{default:C((function(){return t[5]||(t[5]=[V(" 保存 ")])})),_:1})],512),[[O,w(g).status]])])]})),_:1})])])}}}),Ie=s(Se,[["__scopeId","data-v-6f46a916"]]),Ve={class:"h-full"},Ce={key:0,class:"flex items-center justify-between pb-1.6rem"},Pe={class:"flex items-center"},Fe={class:"ml-[8px]"},Te={class:"flex items-center"},Ne={class:"flex items-center p-[12px]"},Oe={key:1,class:"mb-[16px]"},ze={key:2,class:"mt-1rem"},Ge={key:1,class:"bg-[#7F7F7F] flex items-center justify-center h-full",style:{"min-height":"500px"}},Be={class:"bg-white px-[48px] py-[16px] text-[#333] flex items-center"},Ue={class:"p-[20px]"},qe=e("_",g({__name:"response-log",setup:function(e,t){var n=t.expose,r=i().plugin,o=q(r.value).webserver,s=te(),p=s.isBindExtranet,f=s.siteType,v=ne().jumpTabEvent;return y(Dt),n({init:Dt}),function(e,t){var n=B,r=A,s=l,i=M,h=re,m=G,d=U,g=Ie,y=a,P=u,F=Y,T=D,N=c,O=x("bt-loading");return k(),_("div",Ve,[w(p)?(k(),_(L,{key:0},["proxy"!==w(f)?(k(),_("div",Ce,[b((k(),_("div",Pe,["python"!==w(f)?(k(),_(L,{key:0},[I(n,{onChange:w(Bt),modelValue:w(Vt).alert,"onUpdate:modelValue":t[0]||(t[0]=function(e){return w(Vt).alert=e})},null,8,["onChange","modelValue"]),S("span",Fe,[t[13]||(t[13]=V(" 关键字告警 ")),S("span",{class:"!inline-block bt-link",onClick:t[1]||(t[1]=function(){return w(Ht)&&w(Ht).apply(void 0,arguments)})}," [配置] ")]),I(r,{direction:"vertical",class:"!h-2rem !mx-1.6rem"})],64)):j("",!0),I(i,{onChange:w(Gt),modelValue:w(Vt).showIp,"onUpdate:modelValue":t[2]||(t[2]=function(e){return w(Vt).showIp=e})},{default:C((function(){return[S("div",Te,[t[14]||(t[14]=V(" 显示IP归属地信息 ")),I(s,{icon:"icon-ltd",size:16,color:"#9B7E48",class:"ml-[4px]"})])]})),_:1},8,["onChange","modelValue"]),"php"===w(f)?(k(),_(L,{key:1},[I(r,{direction:"vertical",class:"!h-2rem !mx-1.6rem"}),I(d,{trigger:"click",placement:"bottom","popper-class":"white-tips-popover",width:"400",visible:w(It),"onUpdate:visible":t[5]||(t[5]=function(e){return R(It)?It.value=e:null})},{reference:C((function(){return[I(m,{type:"default"},{default:C((function(){return t[16]||(t[16]=[V("更改日志路径")])})),_:1})]})),default:C((function(){return[S("div",Ne,[I(h,{placeholder:"请输入日志路径",modelValue:w(St),"onUpdate:modelValue":t[3]||(t[3]=function(e){return R(St)?St.value=e:null}),onIconClick:w(Ot),icon:"el-folder-opened"},null,8,["modelValue","onIconClick"]),I(m,{type:"primary",class:"!ml-[8px]",onClick:t[4]||(t[4]=function(e){return w(zt)()})},{default:C((function(){return t[15]||(t[15]=[V(" 保存 ")])})),_:1})])]})),_:1},8,["visible"])],64)):j("",!0)])),[[O,w(ft)]]),I(g,{refreshFn:w(Mt)},null,8,["refreshFn"])])):j("",!0),"proxy"===w(f)?(k(),_("div",Oe,"日志大小："+E(w(Vt).size),1)):j("",!0),b(I(ee,{content:w(Vt).logs,isHtml:!0,fullScreen:{title:"全屏查看[响应]日志",onRefresh:w(Mt)},style:H({height:"php"===w(f)?"52rem":"56rem",width:"99.5%"})},null,8,["content","fullScreen","style"]),[[O,w(ft)]]),"nginx"===w(o)&&"php"===w(f)?(k(),_("div",ze,[t[17]||(t[17]=V(" * 若网站开启cdn导致日志")),t[18]||(t[18]=S("span",{class:"text-danger"},"来源IP",-1)),t[19]||(t[19]=V("解析错误，可前往[ ")),S("span",{class:"cursor-pointer bt-link",onClick:t[6]||(t[6]=function(e){return w(ae)("globalSetting")})},"全局设置"),t[20]||(t[20]=V(" ]打开cdn来源IP解析 "))])):j("",!0)],64)):(k(),_("div",Ge,[S("div",Be,[t[22]||(t[22]=V(" 请开启 ")),I(y,{class:"mx-[.4rem]",onClick:t[7]||(t[7]=function(e){return w(v)("mapping")})},{default:C((function(){return t[21]||(t[21]=[V(" 外网映射 ")])})),_:1}),t[23]||(t[23]=V(" 后查看 "))])])),I(N,{title:"关键字告警配置",onConfirm:t[11]||(t[11]=function(e){return w(qt)(w(Tt),"confirm")}),onCancel:w(Ut),modelValue:w(Pt),"onUpdate:modelValue":t[12]||(t[12]=function(e){return R(Pt)?Pt.value=e:null}),area:46,showFooter:""},{default:C((function(){return[S("div",Ue,[I(T,{"label-position":"right",model:w(Tt),rules:w(Nt),ref_key:"alertSetFormRef",ref:Ft},{default:C((function(){return[I(F,{label:"周期",prop:"cycle"},{default:C((function(){return[I(P,{modelValue:w(Tt).cycle,"onUpdate:modelValue":t[8]||(t[8]=function(e){return w(Tt).cycle=e}),type:"number",min:1,width:"24rem","text-type":"分钟"},null,8,["modelValue"])]})),_:1}),I(F,{label:"关键字",prop:"keys"},{default:C((function(){return[I(P,{modelValue:w(Tt).keys,"onUpdate:modelValue":t[9]||(t[9]=function(e){return w(Tt).keys=e}),type:"textarea",resize:"none",row:6,width:"24rem"},null,8,["modelValue"])]})),_:1}),I(F,{label:"告警方式",prop:"channel"},{default:C((function(){return[I(W,{modelValue:w(Tt).channel,"onUpdate:modelValue":t[10]||(t[10]=function(e){return w(Tt).channel=e}),multiple:!0,class:"!w-[24rem]"},null,8,["modelValue"])]})),_:1})]})),_:1},8,["model","rules"]),t[24]||(t[24]=S("ul",{class:"mt-[8px] leading-8 text-[1.2rem] list-disc ml-[20px]"},[S("li",null,"检查时只检查间隔时间内的日志内容"),S("li",null,"周期时间请勿设置太小，建议10分钟以上以免导致服务器资源异常")],-1))])]})),_:1},8,["onCancel","modelValue"])])}}})),Re={key:1,class:"bg-[#7F7F7F] flex items-center justify-center h-full",style:{"min-height":"500px"}},He={class:"bg-white px-[48px] py-[16px] text-[#333] flex items-center"},Ae=g({__name:"safe-analysis",setup:function(e){var t=te(),n=t.isBindExtranet,r=t.siteInfo,u=ne().jumpTabEvent;return function(e,t){var o=a;return k(),_("div",null,[w(n)?(k(),N(ue,{key:0,type:"site",name:w(r).name},null,8,["name"])):(k(),_("div",Re,[S("div",He,[t[2]||(t[2]=V(" 请开启 ")),I(o,{class:"mx-[.4rem]",onClick:t[0]||(t[0]=function(e){return w(u)("mapping")})},{default:C((function(){return t[1]||(t[1]=[V(" 外网映射 ")])})),_:1}),t[3]||(t[3]=V(" 后查看 "))])]))])}}}),Me={class:"flex flex-col"},Ye={class:"flex items-center"},De={class:"mt-[16px]"},Je={class:"p-[12px] w-full flex items-start overflow-y-auto h-full"},Qe=["innerHTML"],Ke=g({__name:"spring-boot-logs",setup:function(e,t){var n=t.expose,r=i().mainHeight;return y(jt),n({init:jt}),function(e,t){var n=p,a=G,u=c,o=x("bt-loading");return b((k(),_("div",Me,[S("div",Ye,[t[2]||(t[2]=S("span",null,"日志路径",-1)),I(n,{modelValue:w(yt).path,"onUpdate:modelValue":t[0]||(t[0]=function(e){return w(yt).path=e}),options:w(ht),onChange:w(kt),placeholder:"请选择",class:"!w-[38rem] !mx-[.8rem]"},null,8,["modelValue","options","onChange"])]),S("div",De,[S("div",null,[I(a,{type:"primary",onClick:w(wt)},{default:C((function(){return t[3]||(t[3]=[V("刷新日志")])})),_:1},8,["onClick"]),I(a,{type:"default",onClick:w(Lt)},{default:C((function(){return t[4]||(t[4]=[V("实时日志")])})),_:1},8,["onClick"])]),I(ee,{title:"全屏查看【项目】日志",content:w(yt).logs,isHtml:!0,fullScreen:{title:"全屏查看【项目】日志",onRefresh:w(wt)},class:"mt-[16px]",style:H({height:"java"===w(mt)?"48rem":"64rem",width:"99.5%"})},null,8,["content","fullScreen","style"])]),I(u,{title:"查看日志",onCancel:w(Et),modelValue:w(dt),"onUpdate:modelValue":t[1]||(t[1]=function(e){return R(dt)?dt.value=e:null}),area:["100%","100%"],"close-btn":1},{default:C((function(){return[S("div",{ref_key:"logPopupCon",ref:gt,class:"bg-[#333] text-white w-full h-full",style:H("height: ".concat(w(r),"px;"))},[S("pre",Je,[t[5]||(t[5]=V("\t\t\t\t\t")),S("code",{class:"flex-1 w-full p-0 bg-none whitespace-pre-line text-i text-[#ececec]",innerHTML:w(yt).logs},null,8,Qe),t[6]||(t[6]=V("\n\t\t\t\t"))])],4)]})),_:1},8,["onCancel","modelValue"])])),[[o,w(ft)]])}}}),We=J("SITE-LOGS-STORE",(function(){var e=te(),n=e.siteType,a=e.siteInfo,u=function(){var e=r(t().mark((function e(r){var a,u;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,oe(r,n.value);case 3:return a=e.sent,u=a.data,e.abrupt("return",{data:u,status:!0});case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",{msg:"获取错误日志失败",status:!1});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),o=function(){var e=r(t().mark((function e(n){var r,a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,se(n);case 3:return r=e.sent,a=r.data,e.abrupt("return",{data:a.data,status:a.status});case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",{msg:"获取日志失败",status:!1});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),s=function(){var e=r(t().mark((function e(n){var r,a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ie(n);case 3:return r=e.sent,a=r.data,e.abrupt("return",{status:a.status,msg:a.data});case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",{msg:"保存路径失败",status:!1});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),i=function(){var e=r(t().mark((function e(n){var r;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f({loading:"正在保存日志路径，请稍后...",request:le(n),message:!0});case 3:return r=e.sent,e.abrupt("return",{status:r.status,msg:r.msg});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{msg:"保存路径失败",status:!1});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=r(t().mark((function e(n){var r;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f({loading:"正则处理中，请稍后...",request:ce(n),message:!0});case 3:return r=e.sent,e.abrupt("return",{status:r.status,msg:r.msg});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{status:!1,msg:"推送失败"});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=r(t().mark((function e(){var n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f({request:pe({sitename:a.value.name}),data:{status:Boolean,"config.cycle":[Number,"cycle"],"config.keys":[Array,"keys"],"config.channel":[String,"channel"]}});case 3:return n=e.sent,e.abrupt("return",{data:n,status:!0});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{msg:"获取推送配置失败",status:!1});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=r(t().mark((function e(){var n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f({request:fe(),data:{msg:[Number,"msg"]}});case 3:return n=e.sent,e.abrupt("return",{data:n.msg,status:!0});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{msg:"获取IP归属地失败",status:!1});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=r(t().mark((function e(r){var a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ve(r,n.value);case 3:return a=e.sent,e.abrupt("return",{data:a.data,status:a.status});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{msg:"获取日志失败",status:!1});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return{getErrorLogsEvent:u,getSpringLogEvent:o,setSpringPathEvent:s,saveResLogPathEvent:i,setPushTaskEvent:l,getLogPushEvent:c,getIpStatusEvent:p,getResLogEvent:v}})),Xe=i().payment,Ze=q(Xe.value).authType,$e=We(),et=$e.getErrorLogsEvent,tt=$e.getSpringLogEvent,nt=$e.setSpringPathEvent,rt=$e.saveResLogPathEvent,at=$e.setPushTaskEvent,ut=$e.getLogPushEvent,ot=$e.getIpStatusEvent,st=$e.getResLogEvent,it=te(),lt=it.siteType,ct=it.siteInfo,pt=it.isBindExtranet,ft=P(!1),vt=P({logs:"",size:"0 b"}),ht=P([]),mt=P(""),dt=P(!1),gt=P(null),yt=F({path:"",logs:"",type:"",size:"",isNew:!1,isGunicorn:!1}),xt=(e("t",Q((function(){var e;return(null===(e=ct.value)||void 0===e?void 0:e.tabName)||("java"===lt.value?"projectLog":"response")}))),e("a",P([{label:"响应日志",name:"response",lazy:!0,render:function(){return I(qe,null,null)}},{label:"错误日志",name:"error",lazy:!0,render:function(){return I(xe,null,null)}},{label:"日志安全分析",name:"safe",lazy:!0,render:function(){return I(Ae,null,null)}}]))),bt=(e("i",(function(){var e,t;"java"===lt.value?(xt.value.some((function(e){return"projectLog"===e.name}))||xt.value.unshift({label:"项目日志",name:"projectLog",lazy:!0,render:function(){return I($,null,null)}}),"springboot"===(null===(t=ct.value)||void 0===t||null===(t=t.project_config)||void 0===t?void 0:t.java_type)&&(xt.value.some((function(e){return"springbootLog"===e.name}))||xt.value.push({label:"springBoot日志",name:"springbootLog",lazy:!0,render:function(){return I(Ke,null,null)}}))):xt.value=xt.value.filter((function(e){return"projectLog"!==e.name&&"springbootLog"!==e.name}));["php","proxy","html"].includes(lt.value)?pt.value=!0:pt.value=!(null===(e=ct.value)||void 0===e||null===(e=e.project_config)||void 0===e||!e.bind_extranet)})),function(){var e=r(t().mark((function e(){var n,r,a,u,o,s;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pt.value){e.next=2;break}return e.abrupt("return");case 2:return n=ct.value.name,r=lt.value,a={proxy:{site_name:n,type:"error"},default:{siteName:n}},e.prev=5,ft.value=!0,e.next=9,et(a[r]||a.default);case 9:return s=e.sent,"proxy"===r&&(vt.value.size=s.data.size||"0 b"),vt.value.logs=(null===(u=s.data)||void 0===u?void 0:u.logs)||(null===(o=s.data)||void 0===o?void 0:o.msg)||"暂无日志信息",e.abrupt("return",s);case 15:return e.prev=15,e.t0=e.catch(5),h(e.t0),e.abrupt("return",{msg:"获取错误日志失败",status:!1});case 19:return e.prev=19,ft.value=!1,e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[5,15,19,22]])})));return function(){return e.apply(this,arguments)}}()),wt=function(){var e=r(t().mark((function e(){var n,r,a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ft.value=!0,e.prev=1,n={project_name:ct.value.name},e.next=5,tt(n);case 5:r=e.sent,a=r.data,r.status&&(ht.value=a.map((function(e){return{label:e,value:e}})),yt.logs="正在获取日志",yt.path=(null==a?void 0:a[0])||"",kt()),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1);case 14:return e.prev=14,ft.value=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])})));return function(){return e.apply(this,arguments)}}(),kt=function(){var e=r(t().mark((function e(n){var r;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,yt.path){e.next=4;break}return yt.logs="暂未在SpringBoot框架中查找到日志配置信息",e.abrupt("return",!1);case 4:return e.next=6,nt({log_file:yt.path});case 6:return(r=e.sent).status||v.error(r.msg),yt.logs=r.msg||"获取日志失败",e.abrupt("return",r);case 12:return e.prev=12,e.t0=e.catch(0),e.abrupt("return",{msg:"保存路径失败",status:!1});case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),_t=null,Lt=function(){dt.value=!0,K((function(){gt.value&&(gt.value.scrollTop=gt.value.scrollHeight)})),_t&&clearInterval(_t),_t=setInterval((function(){wt()}),2e3)},Et=function(){dt.value=!1,clearInterval(_t),_t=null},jt=function(){var e,t;mt.value="java",yt.type=(null===(e=ct.value.project_config)||void 0===e?void 0:e.loglevel)||"",yt.isGunicorn="gunicorn"===(null===(t=ct.value.project_config)||void 0===t?void 0:t.stype),wt()},St=P(""),It=P(!1),Vt=F({alert:!1,showIp:!1,ipData:0,logs:"",size:"0 b"}),Ct=P(!1),Pt=P(!1),Ft=P(),Tt=F({cycle:0,keys:"",channel:[]}),Nt=F({cycle:[{required:!0,message:"请输入周期",trigger:"blur"}],keys:[{required:!0,message:"请输入关键字",trigger:"blur"}],channel:[{required:!0,message:"请选择告警方式",trigger:"blur"}]}),Ot=function(){X({type:"dir",path:St.value,change:function(e){St.value=e,setTimeout((function(){It.value=!0}),0)}})},zt=function(){var e=r(t().mark((function e(){var n=arguments;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.length>0&&void 0!==n[0]?n[0]:{site_name:ct.value.name,log_path:St.value},e.next=3,m({title:"保存日志路径",content:"是否保存日志路径[".concat(St.value,"]")});case 3:return e.next=5,rt({site_name:ct.value.name,log_path:St.value});case 5:e.sent.status&&(Mt(),Yt(),It.value=!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Gt=function(){var e=r(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"ltd"!==Ze.value?(Vt.showIp=!1,Z({disablePro:!0,sourceId:184})):Mt();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Bt=function(){var e=r(t().mark((function e(n){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ct.value=!0,n?Pt.value=!0:qt({},"switch");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ut=function(){Ct.value&&(Vt.alert=!Vt.alert,Ct.value=!1)},qt=function(){var e=r(t().mark((function e(n,r){var a,u;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!Pt.value){e.next=4;break}return e.next=4,Ft.value.validate();case 4:return a={sitename:ct.value.name},"switch"!==r&&(Ct.value||delete a.sitename,a.channel=n.channel.filter((function(e){return""!==e})).join(","),a.cycle=n.cycle,a.keys=JSON.stringify(d(n.keys)?n.keys.split(","):n.keys)),e.next=8,at(a);case 8:return(u=e.sent).status&&Rt(),e.abrupt("return",u.status);case 13:return e.prev=13,e.t0=e.catch(0),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,n){return e.apply(this,arguments)}}(),Rt=function(){var e=r(t().mark((function e(){var n,r,a,u,o,s;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ut();case 3:return n=e.sent,r={},n.status?(Vt.alert=n.data.status,a=n.data,u=a.cycle,o=a.keys,s=a.channel,r={cycle:u,keys:o,channel:s.split(","),status:n.status}):Vt.alert=!1,Object.assign(Tt,r),e.abrupt("return",{data:r,status:n.status});case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",{msg:"获取告警配置失败",status:!1});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),Ht=function(){Pt.value=!0,Rt()},At=function(){var e=r(t().mark((function e(){var n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ot();case 3:n=e.sent,Vt.showIp=1===n.data,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{msg:"获取IP归属地失败",status:!1});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),Mt=function(){var e=r(t().mark((function e(){var n,r,a,u,o=arguments;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>0&&void 0!==o[0]?o[0]:ct.value.name,r=o.length>1&&void 0!==o[1]?o[1]:lt.value,"ltd"!==Ze.value&&(Vt.showIp=!1),a={proxy:{site_name:n,type:"access"},default:{siteName:n,ip_area:Number(Vt.showIp)}},e.prev=4,ft.value=!0,e.next=8,st(a[r]||a.default);case 8:return u=e.sent,"proxy"===r?(Vt.logs=u.data.msg||"暂无日志信息",Vt.size=u.data.size||"0 b"):Vt.logs=u.data.msg||"暂无日志信息",e.abrupt("return",u);case 13:return e.prev=13,e.t0=e.catch(4),h(e.t0),e.abrupt("return",{msg:"获取日志失败",status:!1});case 17:return e.prev=17,ft.value=!1,e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[4,13,17,20]])})));return function(){return e.apply(this,arguments)}}(),Yt=function(){f({request:he({siteName:ct.value.name}),data:{log_file:String,status:Boolean,msg:String},success:function(e){St.value=e.log_file,e.status||v.error(e.msg)}})},Dt=function(){var e=r(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pt.value){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,At();case 4:if("python"===lt.value){e.next=7;break}return e.next=7,Rt();case 7:return e.next=9,Mt();case 9:Yt();case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}}))}();
