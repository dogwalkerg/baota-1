import{l as e,H as s,M as a,G as l,c as t,R as i,df as n,e as o}from"./utils-lib.js?v=1734676359";import{c as r,r as m,o as d,B as u,C as v,p as c,k as p,l as f,q as y,e as h,M as k,y as _,z as g,J as x,x as w,I as C,aX as b,F as j,aj as P,A as F,au as q,v as D,G as H,aw as B}from"./base-lib.js?v=1734676359";import{_ as A}from"./index91.js?v=1734676359";import{getFirewallStore as E}from"./useStore4.js?v=1734676359";import{aa as I,ab as V,ac as R,ad as G,ae as L}from"./firewall.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";const M={class:"sn-home"},T={class:"sn-home-switch"},U={class:"flex items-center"},z={key:0,class:"sn-home-note flex items-center"},J={key:1},O={class:"mt-[2rem]"},S={class:"sn-home-overview-item-title"},X={key:0,class:"sn-home-list"},K={class:"sn-home-list-item flex items-center"},N={class:"ml-[0.4rem] truncate flex-1"},Q={class:"text-right"},W={class:"text-[#999] leading-2.2rem"},Y={class:"mt-1rem"},Z={class:"flex justify-end items-center"},$={key:1,class:"sn-home-list"},ee=o(r({__name:"index",setup(o){const{refs:{phpTabActive:r}}=E(),ee=m(!1),se=m(!1),ae=m(!1),le=m(!1),te=m([]),ie=m(!1),ne=[{title:"高风险",value:0,style:"color: #F50606;",name:"risk_high"},{title:"中危",value:0,style:"color: #FF9900",name:"risk_mod"},{title:"低危",value:0,style:"color: #DDC400",name:"risk_low"},{title:"网站数量",value:0,style:"color: #333",name:"site_count"},{title:"告警次数",value:0,style:"color: #333",name:"risk_count"}],oe=()=>{e({title:"模拟攻击",area:60,compData:()=>de(),component:()=>s((()=>import("./simulate-attack.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)})},re=async e=>{if(ee.value=!e,!ae.value||!le.value)return ee.value=!1,void a.error("请先开启PHP模块设置");await l({loading:"正在"+(e?"开启":"关闭")+"监控，请稍后...",request:I({status:e?"start":"stop"}),message:!0,data:{status:[Boolean,s=>{s&&(ee.value=e)}]}})},me=()=>r.value="php",de=()=>{(async()=>{await l({request:V(),data:{status:[Boolean,ee],send:[Boolean,ae],php_status:[Boolean,le]}}),ae.value&&le.value?ie.value=!1:ie.value=!0})(),(async()=>{const{data:e}=await l({loading:se,request:R()});te.value=e.logs,ne.forEach((s=>{s.value=e[s.name]}))})()};return d((()=>de())),(e,s)=>{const a=P,o=t,r=F,m=A,d=B,E=q,I=u("bt-loading");return v((p(),f("div",M,[y("div",T,[y("div",U,[s[1]||(s[1]=y("div",{class:"mr-4"},"监控开关",-1)),h(a,{modelValue:c(ee),"onUpdate:modelValue":s[0]||(s[0]=e=>k(ee)?ee.value=e:null),width:36,onChange:re,disabled:c(ie)},null,8,["modelValue","disabled"])]),c(ie)?(p(),f("div",z,[s[3]||(s[3]=y("i",{class:"svgtofont-el-warning-filled text-[#E6A23C] text-[1.6rem]"},null,-1)),s[4]||(s[4]=_(" 无法使用PHP安全告警，请开启 ")),c(le)?g("",!0):(p(),f("span",{key:0,class:"bt-link !text-danger underline",onClick:me,title:"点击跳转PHP模块页面"}," PHP模块 ")),c(le)||c(ae)?g("",!0):(p(),f("span",J,"、")),c(ae)?g("",!0):(p(),x(o,{key:2,title:"点击跳转告警设置页面",type:"danger",class:"underline"},{default:w((()=>s[2]||(s[2]=[_(" 设置告警 ")]))),_:1}))])):g("",!0),c(ae)&&c(le)?(p(),x(r,{key:1,type:"primary",onClick:oe},{default:w((()=>s[5]||(s[5]=[_("模拟攻击")]))),_:1})):g("",!0)]),y("div",{class:j(["sn-home-overview",ne[0].value?"sn-home-overview-red":ne[1].value?"sn-home-overview-yellow":"sn-home-overview-green"])},[s[6]||(s[6]=y("div",{class:"text-[#666] text-[1.4rem]"},"风险等级概览",-1)),y("div",O,[(p(),f(C,null,b(ne,((e,s)=>y("div",{class:j(["sn-home-overview-item",s<3?"line-border":""]),key:s},[y("div",S,D(e.title),1),y("div",{class:"sn-home-overview-item-num",style:H(e.style)},D(e.value),5)],2))),64))])],2),c(te).length?(p(),f("div",X,[(p(!0),f(C,null,b(c(te),((e,a)=>(p(),x(d,{key:a,placement:"bottom",width:260,trigger:"hover",offset:0},{reference:w((()=>[y("div",K,[y("div",null,[y("div",{class:j(["sn-home-list-item-type max-w-[12rem] w-max flex items-center",1===e.risk?"green":2===e.risk?"org":"red"])},[s[7]||(s[7]=y("i",{class:"svgtofont-el-warning !text-[1.6rem] w-[16px]"},null,-1)),y("span",N,D(e.intercept),1)],2)]),y("span",null,"攻击者IP："+D(e.address),1),y("span",null,"网站："+D(e.domain),1),y("span",null,"路径："+D(e.url),1),y("div",Q,"触发时间："+D(c(i)(e.addtime)),1)])])),default:w((()=>{return[y("div",W,[y("div",null,"【"+D(e.domain)+"】",1),y("div",Y,[s[8]||(s[8]=_(" 路径： ")),y("span",{class:j((t=e.risk,3===t?"text-[#F50606]":2===t?"text-[#FF9900]":"text-[#DDC400]"))},D(e.intercept),3)]),y("div",null,"路径："+D(c(n)(e.url)),1),y("div",null,[s[9]||(s[9]=_(" 解决方案： ")),(p(!0),f(C,null,b((a=e.solution,(null==a?void 0:a.split("|split|"))||[]),((e,s)=>(p(),f("p",{key:s},D(e),1)))),128))]),y("div",Z,[h(o,{onClick:s=>{return a=e.url,void l({loading:"正在加入URL白名单...",request:G({url_rule:a}),message:!0});var a}},{default:w((()=>s[10]||(s[10]=[_("误报")]))),_:2},1032,["onClick"]),h(m),h(o,{onClick:s=>(async e=>{await l({loading:"正在处理，请稍候...",request:L({operation:1,id:e}),message:!0})})(e.id)},{default:w((()=>s[11]||(s[11]=[_("已处理")]))),_:2},1032,["onClick"])])])];var a,t})),_:2},1024)))),128))])):(p(),f("div",$,[h(E,{description:"暂无数据"})])),s[12]||(s[12]=y("div",{class:"text-[#C1C1C1] mt-[1rem]"},"以上仅提供最新的前100条风险数据",-1))])),[[I,c(se)]])}}}),[["__scopeId","data-v-f9f07082"]]);export{ee as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
