!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,u,l=[],i=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);i=!0);}catch(e){c=!0,a=e}finally{try{if(!i&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(c)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(t,n,r){return(n=function(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,n||"default");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function u(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */u=function(){return n};var t,n={},r=Object.prototype,a=r.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},l="function"==typeof Symbol?Symbol:{},i=l.iterator||"@@iterator",c=l.asyncIterator||"@@asyncIterator",s=l.toStringTag||"@@toStringTag";function f(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(t){f=function(e,t,n){return e[t]=n}}function p(e,t,n,r){var a=t&&t.prototype instanceof b?t:b,u=Object.create(a.prototype),l=new N(r||[]);return o(u,"_invoke",{value:C(e,n,l)}),u}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=p;var m="suspendedStart",v="suspendedYield",h="executing",y="completed",g={};function b(){}function w(){}function x(){}var _={};f(_,i,(function(){return this}));var k=Object.getPrototypeOf,V=k&&k(k(S([])));V&&V!==r&&a.call(V,i)&&(_=V);var j=x.prototype=b.prototype=Object.create(_);function O(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function L(t,n){function r(o,u,l,i){var c=d(t[o],t,u);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"==e(f)&&a.call(f,"__await")?n.resolve(f.__await).then((function(e){r("next",e,l,i)}),(function(e){r("throw",e,l,i)})):n.resolve(f).then((function(e){s.value=e,l(s)}),(function(e){return r("throw",e,l,i)}))}i(c.arg)}var u;o(this,"_invoke",{value:function(e,t){function a(){return new n((function(n,a){r(e,t,n,a)}))}return u=u?u.then(a,a):a()}})}function C(e,n,r){var a=m;return function(o,u){if(a===h)throw Error("Generator is already running");if(a===y){if("throw"===o)throw u;return{value:t,done:!0}}for(r.method=o,r.arg=u;;){var l=r.delegate;if(l){var i=E(l,r);if(i){if(i===g)continue;return i}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===m)throw a=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=h;var c=d(e,n,r);if("normal"===c.type){if(a=r.done?y:v,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(a=y,r.method="throw",r.arg=c.arg)}}}function E(e,n){var r=n.method,a=e.iterator[r];if(a===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=d(a,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var u=o.arg;return u?u.done?(n[e.resultName]=u.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):u:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function D(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function S(n){if(n||""===n){var r=n[i];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var o=-1,u=function e(){for(;++o<n.length;)if(a.call(n,o))return e.value=n[o],e.done=!1,e;return e.value=t,e.done=!0,e};return u.next=u}}throw new TypeError(e(n)+" is not iterable")}return w.prototype=x,o(j,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,s,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,f(e,s,"GeneratorFunction")),e.prototype=Object.create(j),e},n.awrap=function(e){return{__await:e}},O(L.prototype),f(L.prototype,c,(function(){return this})),n.AsyncIterator=L,n.async=function(e,t,r,a,o){void 0===o&&(o=Promise);var u=new L(p(e,t,r,a),o);return n.isGeneratorFunction(t)?u:u.next().then((function(e){return e.done?e.value:u.next()}))},O(j),f(j,s,"Generator"),f(j,i,(function(){return this})),f(j,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=S,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,a){return l.type="throw",l.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var u=this.tryEntries[o],l=u.completion;if("root"===u.tryLoc)return r("end");if(u.tryLoc<=this.prev){var i=a.call(u,"catchLoc"),c=a.call(u,"finallyLoc");if(i&&c){if(this.prev<u.catchLoc)return r(u.catchLoc,!0);if(this.prev<u.finallyLoc)return r(u.finallyLoc)}else if(i){if(this.prev<u.catchLoc)return r(u.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<u.finallyLoc)return r(u.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var u=o?o.completion:{};return u.type=e,u.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(u)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),D(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;D(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:S(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},n}function l(e,t,n,r,a,o,u){try{var l=e[o](u),i=l.value}catch(e){return void n(e)}l.done?t(i):Promise.resolve(i).then(r,a)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function u(e){l(o,r,a,u,i,"next",e)}function i(e){l(o,r,a,u,i,"throw",e)}u(void 0)}))}}System.register(["./index-legacy101.js?v=1734676359","./base-lib-legacy.js?v=1734676359","./validator-legacy.js?v=1734676359","./utils-lib-legacy.js?v=1734676359","./index-legacy90.js?v=1734676359","./index-legacy97.js?v=1734676359","./index-legacy99.js?v=1734676359","./useController-legacy3.js?v=1734676359","./useStore-legacy7.js?v=1734676359","./site-legacy.js?v=1734676359","./__commonjsHelpers__-legacy.js?v=1734676359","./index-legacy91.js?v=1734676359","./column-legacy.js?v=1734676359"],(function(e,n){"use strict";var r,o,l,c,s,f,p,d,m,v,h,y,g,b,w,x,_,k,V,j,O,L,C,E,P,D,N,S,U,T,q,A,M,I,G,F,R,Y,$,B,H,J,z,W,X,K,Q,Z,ee,te,ne,re,ae,oe,ue,le,ie,ce,se,fe,pe,de,me,ve,he,ye,ge,be,we,xe,_e,ke,Ve,je,Oe;return{setters:[function(e){r=e._},function(e){o=e.c,l=e.r,c=e.k,s=e.l,f=e.e,p=e.x,d=e.I,m=e.aX,v=e.p,h=e.J,y=e.y,g=e.v,b=e.M,w=e.F,x=e.A,_=e.a$,k=e.b0,V=e.c0,j=e.h,O=e.ax,L=e.R,C=e.i,E=e.w,P=e.aB,D=e.o,N=e.B,S=e.C,U=e.q,T=e.z,q=e.n,A=e.ag,M=e.ah,I=e.aw,G=e.aT,F=e.aj,R=e.aY,Y=e.a7,$=e.a4},function(e){B=e._},function(e){H=e.R,J=e.e,z=e.u,W=e.c,X=e.G,K=e.ah,Q=e.o,Z=e.a7,ee=e.aa,te=e.k,ne=e.O,re=e.j,ae=e.h,oe=e.b},function(e){ue=e._},function(e){le=e._},function(e){ie=e._},function(e){ce=e.t},function(e){se=e.u},function(e){fe=e.addExcloud,pe=e.setSiteStatusProof,de=e.modifyPathConfig,me=e.multiCreate,ve=e.setPushStatus,he=e.setPushConfig,ye=e.getGlabalTotal,ge=e.getTamperRuleByPath,be=e.delTempClose,we=e.setTempClose,xe=e.modifyGlobalConfig,_e=e.getTamperCoreLogs,ke=e.getPushList,Ve=e.delLogs,je=e.getProofIndex,Oe=e.getProofLog},null,null,null],execute:function(){var n={class:"time flex"},Le=J(o({__name:"day-cut",props:{days:{default:""}},emits:["cut-day","cut-day-click"],setup:function(e,t){var r=t.emit,a=l(""),o=l(1),u=l(),i=l([{content:"昨天",active:!1,event:function(){o.value=0;var e=H(new Date((new Date).getTime()-864e5),"yyyy-MM-dd");r("cut-day",0,e),V.value=""}},{content:"今天",active:!0,event:function(e){o.value=1;var t=H(new Date,"yyyy-MM-dd");r("cut-day",1,t),V.value=""}}]),V=l(""),j=function(e){return e.getTime()>Date.now()},O=function(e){a.value="自定义时间",o.value=2,r("cut-day",2,H(e,"yyyy-MM-dd"))};return function(e,t){var r=x,a=_,l=k;return c(),s("div",n,[f(a,{class:"control-btn"},{default:p((function(){return[(c(!0),s(d,null,m(v(i),(function(e,t){return c(),h(r,{key:t,type:v(o)===t?"primary":"",onClick:e.event},{default:p((function(){return[y(g(e.content),1)]})),_:2},1032,["type","onClick"])})),128))]})),_:1}),f(l,{align:"right",type:"date",modelValue:v(V),"onUpdate:modelValue":t[0]||(t[0]=function(e){return b(V)?V.value=e:null}),placeholder:"自定义时间",ref_key:"player",ref:u,class:w(["auto-time !w-[13rem]","".concat(2===v(o)?"active":"")]),onChange:O,"disabled-date":j},null,8,["modelValue","class"])])}}}),[["__scopeId","data-v-2839b599"]]),Ce={key:0,class:"flex justify-between mb-[1.6rem]"},Ee={class:"flex items-center"},Pe={class:"flex items-center"},De={class:"bt-danger"},Ne={key:1,class:"flex items-center justify-center mb-[1.6rem]"},Se={class:"flex items-center flex-1 mr-1rem"},Ue={key:0,class:"flex-1"},Te={class:"flex items-center"},qe={class:"current-box"},Ae={class:"current-box-item"},Me=["title"],Ie={class:"current-box-item"},Ge=["title"],Fe={key:0,class:"flex justify-between"},Re={class:"flex items-center"},Ye={class:"flex items-center"},$e={class:"flex items-center"},Be={class:"flex items-center"},He={class:"flex items-center"},Je={class:"mt-8 leading-10 list-disc pl-2rem"},ze={class:"flex-wrap"},We=o({__name:"overview",props:{compData:{default:{}}},setup:function(e,n){var o=n.expose,w=e,_=oe(),J=z().getSenderAlarmListInfo,We=se().siteInfo,Xe=l(!1),Ke=V(),Qe=l(!1),Ze=l(1),et=l(H(new Date,"yyyy-MM-dd")),tt=l({}),nt=j({p:1,rows:10,total:0}),rt=l(!1),at=l([]),ot=l([]),ut=l({logContent:"",logDialog:!1,name:""}),lt=[{content:"如果需要频繁修改当前文件，确认提交即可。"},{content:"如果需要频繁修改该文件同级文件内容，请删除路径尾部文件名，确认提交即可。"},{content:f(d,null,[y("若大量临时缓存文件被拦截，可参考："),f("code",null,[y("/www/wwwroot/bt.cn/cache/bt_1234.php")]),y("，直接添加"),f("code",null,[y("/www/wwwroot/bt.cn/cache/bt*.php")]),y("即可")])},{content:"注意：以上操作会解除对文件或目录的限制，请确保你信任这些内容，以防止安全问题。"}],it=l(!1),ct=l(),st=l(!1),ft=j({path:""}),pt=j({path:[{required:!0,message:"请输入目录/文件",trigger:"blur"}]}),dt=O("kernelModuleStatus",L(!0)),mt=l({}),vt=l(!1),ht=l(!1),yt=l(),gt=j({expire:30,unit:"minute"}),bt=l(),wt=l(!1),xt=j({name:We.value.path+"/"+We.value.name,cycle:30,count:3,interval:600,push_count:1,module:""}),_t=C((function(){return"tamper_proof_refactored"===w.compData.type?[{content:"如果开启防篡改后您的网站出现异常，请尝试排除网站日志、缓存、临时文件、上传等目录后重试，或直接关闭异常网站防篡改功能"}]:[{content:"开启防篡改后，部分项目【无法更新，文件无法上传，无法操作等】，需要关闭防篡改或添加白名单"}]})),kt=j({cycle:[{required:!0,message:"请输入时间",trigger:"blur"},{validator:function(e,t,n){/^[1-9]\d*$/.test(t)?n():n(new Error("必须为大于0的整数"))},trigger:["blur","change"]}],count:[{required:!0,message:"请输入次数",trigger:"blur"},{validator:function(e,t,n){/^[1-9]\d*$/.test(t)?n():n(new Error("必须为大于0的整数"))},trigger:["blur","change"]}],push_count:[{required:!0,message:"请输入次数",trigger:"blur"},{validator:function(e,t,n){/^[1-9]\d*$/.test(t)?n():n(new Error("必须为大于0的整数"))},trigger:["blur","change"]}],interval:[{required:!0,message:"请输入时间",trigger:"blur"},{validator:function(e,t,n){/^[1-9]\d*$/.test(t)?n():n(new Error("必须为大于0的整数"))},trigger:["blur","change"]}],module:[{validator:function(e,t,n){""===xt.module?n(new Error("请选择告警方式")):n()},trigger:["change"]}]}),Vt=l("log"),jt=l([{label:"日志",name:"log",lazy:!0,render:function(){}}]),Ot=j({expire:[{required:!0,message:"请输入时间",trigger:"blur"},{validator:function(e,t,n){/^[1-9]\d*$/.test(t)?n():n(new Error("时间必须为大于0的整数"))},trigger:["blur","change"]}]}),Lt=l(),Ct=l(!1),Et=j({date:""}),Pt=j({date:[{required:!0,message:"请选择日期",trigger:"blur"}]}),Dt=function(e){return e.getTime()>Date.now()},Nt=[{label:"关闭防护",value:0},{label:"拦截模式",value:1},{label:"观察模式",value:2}],St=j({create:"创建",delete:"删除",modify:"修改",move:"移动",rename:"重命名",chmod:"权限变更"}),Ut=j({0:"关闭",1:"拦截",2:"观察"}),Tt=l([{label:"时间",prop:"time",width:150,render:function(e){return H(e[0])}},{label:"模式",prop:"mode",width:60,render:function(e){return f("span",{class:"text-[".concat(1===e[1]?"#20a53a":"#f0ad4e","]")},[Ut[e[1]]])}},{label:"类型",prop:"type",width:70,render:function(e){return St[e[2]]}},{label:"文件",prop:"type",showOverflowTooltip:!0,render:function(e){return f("div",{class:"truncate"},[e[3]])}},{label:"溯源日志",prop:"ip",width:78,render:function(e){return f("span",{class:"bt-link cursor-pointer",onClick:function(){ut.value.logContent=e[4]&&e[4].length?e[4].join("\n"):"当前日志为空",ut.value.name=e[3],ut.value.logDialog=!0}},[y("溯源日志")])}},{label:"状态",prop:"action",width:75,render:function(e){return"防护成功"}},{label:"操作",align:"right",width:90,render:function(e){return f(W,{onClick:function(){ft.path=e[3],it.value=!0}},{default:function(){return[y("加入白名单")]}})}}]),qt=l([{label:"时间",prop:"date",width:150},{label:"目录",prop:"content"},{label:"类型",prop:"type",width:100,render:function(e){return f("span",null,[ce[e.type]])}},{label:"用户",prop:"user",width:90},{label:"进程",prop:"process",width:90}]),At=function(){var e=i(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ct.value.validate();case 2:return e.next=4,X({loading:st,request:fe({siteName:We.value.name,excludePath:ft.path}),message:!0});case 4:e.sent.status&&(it.value=!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Mt=function(){var e=i(u().mark((function e(t){var n,r,a,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Qe.value=!0,e.next=4,je({day:t});case 4:a=e.sent,o=a.data,tt.value=null===(n=o.sites)||void 0===n?void 0:n.find((function(e){return e.siteName==We.value.name})),tt.value.totalNum=tt.value.total.site.total,tt.value.theNum=tt.value.total.day.total,tt.value.open=tt.value.open,ot.value=null===(r=o.sites)||void 0===r?void 0:r.map((function(e){return{siteName:e.siteName,path:e.path}})),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),K(e.t0);case 16:return e.prev=16,Qe.value=!1,e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[0,13,16,19]])})));return function(t){return e.apply(this,arguments)}}(),It=function(){var e=i(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:X({loading:rt,request:Oe({day:t,siteName:We.value.name}),data:{logs:[Array,at]}});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Gt=function(){var e=i(u().mark((function e(t){var n,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return tt.value.open=t,e.prev=1,e.next=4,pe({siteName:We.value.name,status:t});case 4:r=e.sent,null!==(n=r.data)&&void 0!==n&&n.length?(_.request(r.data[0]),r.status&&Mt(et.value)):_.request(r),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),K(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),Ft=function(){gt.expire=30,gt.unit="minute",ht.value=!0},Rt=function(){var e=i(u().mark((function e(t){var n,r,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Q({title:"".concat(t?"开启":"关闭","保护目录配置【").concat(We.value.name,"】"),content:t?"启用该保护目录配置后，目录将受到保护，是否继续操作？":"关闭该保护目录配置后，目录将失去保护，是否继续操作？",icon:"warning"});case 3:if(null===(n=tt.value)||void 0===n||!n.path){e.next=10;break}return e.next=6,X({loading:"正在设置防篡改，请稍侯...",request:de({path_id:tt.value.pid,key:"status",value:t?1:0}),message:!0});case 6:e.sent.status&&Wt(),e.next=15;break;case 10:return e.next=12,me({paths:JSON.stringify([{path:We.value.path+"/",ps:We.value.name}])});case 12:r=e.sent,(o=r.data).length&&o[0].status?(_.success("开启防篡改成功"),Wt()):_.error("开启防篡改失败");case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),"cancel"===e.t0&&q((function(){tt.value=a(a({},tt.value),{},{open:!t})}));case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t){return e.apply(this,arguments)}}(),Yt=function(){var e=i(u().mark((function e(t){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(n=tt.value)&&void 0!==n&&n.path){e.next=4;break}return _.warn("请先开启防篡改开关再进行告警设置"),q((function(){vt.value=!1})),e.abrupt("return");case 4:if(!t){e.next=8;break}wt.value=!0,e.next=14;break;case 8:return e.next=10,Q({title:"关闭保护目录告警【".concat(We.value.name,"】"),content:"关闭该保护目录告警后，该配置将无法发送告警，是否继续操作？",icon:"warning"});case 10:return e.next=12,X({loading:"正在关闭告警任务，请稍侯...",request:ve({id:tt.value.pid,name:"tamper_push",status:0}),message:!0});case 12:e.sent.status&&Wt();case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$t=function(){var e=i(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J();case 2:_.success("刷新成功");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Bt=function(){wt.value=!1,vt.value=!1},Ht=function(){var e=i(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,bt.value.validate();case 2:return e.next=4,X({loading:"正在设置告警任务，请稍侯...",request:he({id:tt.value.pid,name:"tamper_push",data:JSON.stringify({cycle:Number(xt.cycle),count:Number(xt.count),interval:Number(xt.interval),push_count:Number(xt.push_count),module:xt.module,type:"",title:"【".concat(We.value.path,"】篡改告警")})}),message:!0});case 4:e.sent.status&&(wt.value=!1,Zt());case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Jt=function(){var e=i(u().mark((function e(t,n){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ze.value=t,et.value=n,"tamper_proof_refactored"!==w.compData.type){e.next=9;break}return e.next=5,Mt(n);case 5:return e.next=7,It(n);case 7:e.next=12;break;case 9:return nt.p=1,e.next=12,Qt(n);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),zt=function(){var e=i(u().mark((function e(){var t,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Qe.value=!0,e.next=4,ye();case 4:t=e.sent,n=t.data,mt.value=n,dt.value=n.glabal_status.kernel_module_status,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),K(e.t0);case 13:return e.prev=13,Qe.value=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[0,10,13,16]])})));return function(){return e.apply(this,arguments)}}(),Wt=function(){var e=i(u().mark((function e(){var t,n,r,a,o,l,i,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ge({path:We.value.path});case 3:if(t=e.sent,n=t.data,tt.value=n,n.hasOwnProperty("status")){for(i in tt.value.open=!!n.status,r=0,a=0,o=[],l=[],n.total.all)r+=n.total.all[i],o.push("".concat(ce[i],": ").concat(n.total.all[i]));for(c in n.total.today)a+=n.total.today[c],l.push("".concat(ce[c],": ").concat(n.total.today[c]));tt.value.totalNum=r,tt.value.totalTitle=o.join("\n"),tt.value.theNum=a,tt.value.theTitle=l.join("\n"),Qt(et.value)}else tt.value.open=!1,tt.value.totalNum="--",tt.value.theNum="--";e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),K(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),Xt=function(){var e=i(u().mark((function e(){var t,n=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=n.length>0&&void 0!==n[0]&&n[0])){e.next=4;break}return e.next=4,yt.value.validate();case 4:return e.next=6,X({loading:"正在设置临时关闭防护，请稍侯...",request:t?we(gt):be(),message:!0});case 6:e.sent.status&&(ht.value=!1,zt(),Wt());case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Kt=function(){var e=i(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q({title:"开启全局开关",content:"开启后，站点目录对应的防篡改配置将生效，是否继续操作？",icon:"warning"});case 2:return e.next=4,X({loading:"正在开启全局开关，请稍侯...",request:xe({value:1,key:"status"}),message:!0});case 4:e.sent.status&&zt();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Qt=function(){var e=i(u().mark((function e(t){var n,r,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_e({path_id:tt.value.pid,date:t||et.value,rows:nt.rows,p:nt.p});case 3:n=e.sent,Array.isArray(n.data)?(at.value=n.data,nt.total=n.hasOwnProperty("page")?Z(n.page):n.data.length):Array.isArray(null==n||null===(r=n.data)||void 0===r?void 0:r.data)?(at.value=n.data.data,nt.total=n.data.hasOwnProperty("page")?Z(n.data.page):(null===(a=n.data)||void 0===a?void 0:a.total)||n.data.data.length):(at.value=[],nt.total=0),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),Zt=function(){var e=i(u().mark((function e(){var t,n,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ke();case 3:t=e.sent,n=t.data,r=n.tamper_push&&n.tamper_push[tt.value.pid]||{},vt.value=!(null==r||!r.status),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),K(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),en=function(){Et.date="",Ct.value=!0},tn=function(){var e=i(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Lt.value.validate();case 3:return e.next=5,Ve({path_id:tt.value.pid,date:Et.date});case 5:t=e.sent,_.request(t),t.status&&(Ct.value=!1,Qt()),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();E([function(){return mt.value.temp_close_time},function(){return Ke.value}],(function(e){var n=t(e,2),r=n[0],a=n[1];!Xe.value&&0!==r&&1e3*r+3e3<a&&(mt.value.temp_close_time=0,zt(),Wt())}));var nn=function(){var e=i(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w.compData.maskLayer){e.next=2;break}return e.abrupt("return");case 2:if(et.value=H(new Date,"yyyy-MM-dd"),"tamper_proof_refactored"!==w.compData.type){e.next=10;break}return e.next=6,Mt(et.value);case 6:return e.next=8,It(et.value);case 8:e.next=19;break;case 10:if(w.compData.isVersion){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,zt();case 14:return e.next=16,Wt();case 16:if(null===(t=tt.value)||void 0===t||!t.path){e.next=19;break}return e.next=19,Zt();case 19:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return P((function(){Xe.value=!0})),D(nn),o({sitesList:ot,init:nn}),function(e,t){var n,a,o,u,l,i=A,w=M,_=I,V=W,j=G,O=F,L=R,C=x,E=ee,P=ie,D=te,q=le,J=ue,z=ne,X=re,K=Y,Q=$,Z=ae,oe=B,ce=k,se=r,fe=N("bt-loading");return S((c(),s("div",null,["tamper_proof_refactored"===e.compData.type?(c(),s("div",Ce,[U("div",Ee,[t[26]||(t[26]=U("span",{class:"mr-1rem"},"防篡改状态",-1)),f(w,{class:"!w-[16rem]",modelValue:v(tt).open,"onUpdate:modelValue":t[0]||(t[0]=function(e){return v(tt).open=e}),onChange:Gt},{default:p((function(){return[(c(),s(d,null,m(Nt,(function(e){return f(i,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),64))]})),_:1},8,["modelValue"]),f(_,{placement:"top-start",width:"200","popper-class":"green-tips-popover",trigger:"hover",content:""},{reference:p((function(){return t[24]||(t[24]=[U("i",{class:"svgtofont-el-question-filled text-warning ml-[12px] text-[16px]"},null,-1)])})),default:p((function(){return[t[25]||(t[25]=U("ul",{class:"list-disc pl-1.6rem"},[U("li",null,"拦截模式：拦截，并记录"),U("li",null,"观察模式：不拦截，只记录")],-1))]})),_:1})]),f(Le,{days:v(Ze),onCutDay:Jt},null,8,["days"])])):(c(),s(d,{key:1},[null!==(n=v(mt))&&void 0!==n&&n.temp_close_time?(c(),h(j,{key:0,type:"warning",class:"!mb-[1.6rem] !p-[1.2rem]",closable:!1,"show-icon":""},{title:p((function(){return[U("div",Pe,[t[28]||(t[28]=y(" 当前已临时关闭全局防篡改，将在 ")),U("span",De,g(v(H)(v(mt).temp_close_time)),1),t[29]||(t[29]=y(" 恢复防护 ")),f(V,{class:"bt-link ml-1rem",onClick:t[1]||(t[1]=function(e){return Xt(!1)})},{default:p((function(){return t[27]||(t[27]=[y(" 点击立即恢复 ")])})),_:1})])]})),_:1})):(c(),s("div",Ne,[U("div",Se,[t[32]||(t[32]=U("span",{class:"mr-1rem"},"防篡改开关",-1)),f(O,{modelValue:v(tt).open,"onUpdate:modelValue":t[2]||(t[2]=function(e){return v(tt).open=e}),width:36,onChange:Rt},null,8,["modelValue"]),f(L,{direction:"vertical",class:"!h-2rem !mx-1.6rem"}),t[33]||(t[33]=U("span",{class:"mr-1rem"},"告警设置",-1)),f(O,{class:"mr-[1.6rem]",modelValue:v(vt),"onUpdate:modelValue":t[3]||(t[3]=function(e){return b(vt)?vt.value=e:null}),width:36,onChange:Yt},null,8,["modelValue"]),null!==(a=v(mt))&&void 0!==a&&null!==(a=a.glabal_status)&&void 0!==a&&a.settings_status?T("",!0):(c(),s("div",Ue,[f(j,{type:"warning",class:"h-3.2rem",closable:!1,"show-icon":""},{title:p((function(){return[U("div",Te,[t[31]||(t[31]=y(" 未启用企业级防篡改，请先开启 ")),f(V,{class:"underline",type:"danger",onClick:Kt},{default:p((function(){return t[30]||(t[30]=[y(" 全局开关 ")])})),_:1})])]})),_:1})]))]),f(C,{type:"primary",onClick:Ft},{default:p((function(){return t[34]||(t[34]=[y(" 全局临时开关 ")])})),_:1})]))],64)),U("div",qe,[U("div",Ae,[t[35]||(t[35]=U("div",null,"总拦截次数",-1)),U("div",{title:null===(o=v(tt))||void 0===o?void 0:o.totalTitle},g(v(tt).totalNum),9,Me)]),U("div",Ie,[t[36]||(t[36]=U("div",null,"当日拦截次数",-1)),U("div",{title:null===(u=v(tt))||void 0===u?void 0:u.theTitle},g(v(tt).theNum),9,Ge)])]),"tamper_core"===e.compData.type?(c(),s(d,{key:2},[f(E,{ref:"tamperRef",type:"",class:"mt-1rem",modelValue:v(Vt),"onUpdate:modelValue":t[4]||(t[4]=function(e){return b(Vt)?Vt.value=e:null}),options:v(jt)},null,8,["modelValue","options"]),null!==(l=v(tt))&&void 0!==l&&l.path?(c(),s("div",Fe,[f(C,{type:"default",onClick:en},{default:p((function(){return t[37]||(t[37]=[y("清理日志")])})),_:1}),U("div",Re,[f(Le,{days:v(Ze),onCutDay:Jt},null,8,["days"]),f(P,{onRefresh:Qt,class:"ml-1rem"})])])):T("",!0)],64)):T("",!0),f(J,null,{"header-left":p((function(){return t[38]||(t[38]=[])})),"header-right":p((function(){return t[39]||(t[39]=[])})),content:p((function(){return["tamper_core"==e.compData.type?S((c(),h(D,{key:0,column:v(qt),maxHeight:320,data:v(at)},null,8,["column","data"])),[[fe,v(rt)]]):S((c(),h(D,{key:1,column:v(Tt),maxHeight:400,data:v(at)},null,8,["column","data"])),[[fe,v(rt)]])]})),"footer-left":p((function(){return t[40]||(t[40]=[])})),"footer-right":p((function(){return["tamper_core"===e.compData.type?(c(),h(q,{key:0,class:"mb-1rem",page:v(nt).p,"onUpdate:page":t[5]||(t[5]=function(e){return v(nt).p=e}),row:v(nt).rows,"onUpdate:row":t[6]||(t[6]=function(e){return v(nt).rows=e}),total:v(nt).total,"pager-count":4,onChange:t[7]||(t[7]=function(e){return Qt()})},null,8,["page","row","total"])):T("",!0)]})),_:1}),f(z,{options:v(_t),"list-style":"disc",class:"ml-2rem"},null,8,["options"]),f(Z,{title:"临时关闭防篡改",modelValue:v(ht),"onUpdate:modelValue":t[10]||(t[10]=function(e){return b(ht)?ht.value=e:null}),area:58,onConfirm:t[11]||(t[11]=function(e){return Xt(!0)}),"show-footer":""},{default:p((function(){return[f(Q,{class:"p-[2rem]",ref_key:"tempFormRef",ref:yt,model:v(gt),rules:v(Ot)},{default:p((function(){return[f(K,{label:"临时关闭",prop:"expire"},{default:p((function(){return[U("div",Ye,[f(X,{type:"number",modelValue:v(gt).expire,"onUpdate:modelValue":t[8]||(t[8]=function(e){return v(gt).expire=e}),width:"14rem",class:"!w-14rem",placeholder:"请输入时间"},null,8,["modelValue"]),f(w,{class:"ml-1rem !w-[10rem]",modelValue:v(gt).unit,"onUpdate:modelValue":t[9]||(t[9]=function(e){return v(gt).unit=e})},{default:p((function(){return[f(i,{label:"分钟",value:"minute"}),f(i,{label:"小时",value:"hour"}),f(i,{label:"天",value:"day"})]})),_:1},8,["modelValue"]),t[41]||(t[41]=U("span",{class:"text-[#666] ml-[4px]"},"，到期后自动恢复防护",-1))])]})),_:1})]})),_:1},8,["model","rules"])]})),_:1},8,["modelValue"]),f(Z,{title:"设置告警任务",modelValue:v(wt),"onUpdate:modelValue":t[18]||(t[18]=function(e){return b(wt)?wt.value=e:null}),area:54,onConfirm:Ht,onCancel:Bt,"show-footer":""},{default:p((function(){return[f(Q,{class:"p-[2rem]",ref_key:"alarmFormRef",ref:bt,model:v(xt),rules:v(kt)},{default:p((function(){return[f(K,{label:"保护列表"},{default:p((function(){return[f(X,{modelValue:v(xt).name,"onUpdate:modelValue":t[12]||(t[12]=function(e){return v(xt).name=e}),disabled:"",width:"35rem"},null,8,["modelValue"])]})),_:1}),f(K,{label:"触发条件"},{default:p((function(){return[U("div",$e,[f(K,{prop:"cycle"},{default:p((function(){return[f(X,{modelValue:v(xt).cycle,"onUpdate:modelValue":t[13]||(t[13]=function(e){return v(xt).cycle=e}),type:"number",width:"12rem"},null,8,["modelValue"])]})),_:1}),t[42]||(t[42]=U("span",{class:"text-[#666] mx-[.6rem]"},"分钟内，篡改",-1)),f(K,{prop:"count"},{default:p((function(){return[f(X,{modelValue:v(xt).count,"onUpdate:modelValue":t[14]||(t[14]=function(e){return v(xt).count=e}),type:"number",width:"12rem"},null,8,["modelValue"])]})),_:1}),t[43]||(t[43]=U("span",{class:"text-[#666] mx-[.6rem]"},"次",-1))])]})),_:1}),f(K,{label:"间隔时间",prop:"interval"},{default:p((function(){return[U("div",Be,[f(X,{modelValue:v(xt).interval,"onUpdate:modelValue":t[15]||(t[15]=function(e){return v(xt).interval=e}),type:"number",width:"12rem",class:"!w-12rem"},null,8,["modelValue"]),t[44]||(t[44]=U("span",{class:"text-[#666] mx-[.6rem]"},"秒后再次监控触发条件",-1))])]})),_:1}),f(K,{label:"推送次数",prop:"push_count"},{default:p((function(){return[U("div",He,[f(X,{modelValue:v(xt).push_count,"onUpdate:modelValue":t[16]||(t[16]=function(e){return v(xt).push_count=e}),type:"number",width:"12rem",class:"!w-12rem"},null,8,["modelValue"]),t[45]||(t[45]=U("span",{class:"text-[#666] mx-[.6rem]"}," 次后停止推送，次日再次监控 ",-1))])]})),_:1}),f(K,{label:"告警方式",prop:"module"},{default:p((function(){return[f(oe,{modelValue:v(xt).module,"onUpdate:modelValue":t[17]||(t[17]=function(e){return v(xt).module=e}),multiple:!1,class:"!w-35rem",limit:["sms"]},null,8,["modelValue"])]})),_:1}),U("ul",Je,[U("li",null,[t[47]||(t[47]=y(" 点击配置后状态未更新，尝试点击【 ")),f(V,{class:"!inline-block",onClick:$t},{default:p((function(){return t[46]||(t[46]=[y("手动刷新")])})),_:1}),t[48]||(t[48]=y(" 】 "))])])]})),_:1},8,["model","rules"])]})),_:1},8,["modelValue"]),f(Z,{title:"清理日志",modelValue:v(Ct),"onUpdate:modelValue":t[20]||(t[20]=function(e){return b(Ct)?Ct.value=e:null}),area:38,onConfirm:tn,"show-footer":""},{default:p((function(){return[f(Q,{class:"p-[2rem]",ref_key:"clearFormRef",ref:Lt,model:v(Et),rules:v(Pt)},{default:p((function(){return[f(K,{label:"需要清理的日期",prop:"date"},{default:p((function(){return[f(ce,{modelValue:v(Et).date,"onUpdate:modelValue":t[19]||(t[19]=function(e){return v(Et).date=e}),type:"date",class:"date",placeholder:"选择日期","value-format":"YYYY-MM-DD","disabled-date":Dt},null,8,["modelValue"])]})),_:1}),f(z,{class:"pl-2rem",options:[{content:"当前仅支持按日期清理日志"}]})]})),_:1},8,["model","rules"])]})),_:1},8,["modelValue"]),f(Z,{title:"溯源日志[".concat(v(ut).name,"]"),modelValue:v(ut).logDialog,"onUpdate:modelValue":t[21]||(t[21]=function(e){return v(ut).logDialog=e}),area:[60]},{default:p((function(){return[U("div",ze,[f(se,{class:"h-[40rem] !rounded-none",content:v(ut).logContent},null,8,["content"])])]})),_:1},8,["title","modelValue"]),f(Z,{title:"清理日志",modelValue:v(it),"onUpdate:modelValue":t[23]||(t[23]=function(e){return b(it)?it.value=e:null}),area:56,onConfirm:At,"show-footer":""},{default:p((function(){return[f(Q,{class:"p-[2rem]",ref_key:"addWhiteListFormRef",ref:ct,model:v(ft),rules:v(pt),disabled:v(st)},{default:p((function(){return[f(K,{label:"目录/文件",prop:"path"},{default:p((function(){return[f(X,{modelValue:v(ft).path,"onUpdate:modelValue":t[22]||(t[22]=function(e){return v(ft).path=e}),width:"35rem",placeholder:"请输入目录/文件"},null,8,["modelValue"])]})),_:1}),f(K,null,{default:p((function(){return[f(z,{options:lt,class:"pl-1rem leading-2rem","list-style":"disc"})]})),_:1})]})),_:1},8,["model","rules","disabled"])]})),_:1},8,["modelValue"])])),[[fe,v(Qe)],[fe,"正在获取站点防篡改信息，请稍侯","title"]])}}});e("default",J(We,[["__scopeId","data-v-75f12539"]]))}}}))}();
