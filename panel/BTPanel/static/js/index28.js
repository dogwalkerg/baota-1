import{u as e,G as a,M as t,j as s,k as l,l as i,H as o,o as n}from"./utils-lib.js?v=1734676359";import{c as r,ax as m,h as c,r as p,R as d,o as h,B as u,k as g,l as f,e as _,x as v,q as w,p as b,L as y,y as x,C as k,N as H,ar as j,A as z,aN as C,a4 as N}from"./base-lib.js?v=1734676359";import{_ as S}from"./index90.js?v=1734676359";import{_ as E}from"./index97.js?v=1734676359";import{_ as M}from"./index91.js?v=1734676359";import{c as B}from"./useMethods.js?v=1734676359";import{u as L}from"./column.js?v=1734676359";import{E as A,F as R}from"./useStore3.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";const q={class:"container-dialog p-[1.6rem]"},I={class:"flex items-center relative"},O={class:"py-[1rem]"},T=r({__name:"index",setup(r){const{mainHeight:T}=e(),V=m("popupSetFooter",!1),D=c({name:"",description:"暂无数据"}),F=c({loading:!1,list:[],showList:[],selection:[],historySearch:[],rowData:{},total:0,p:1,limit:10,tableHeight:"410px"}),U=p(!0),J=(e,a,s,l)=>{const i=e.data;a.value+="".concat(i),i.includes("bt_successful")&&(t.success("拉取成功"),s(),l(),W()),i.includes("bt_failed")&&(t.error("拉取失败"),s())},P=d((({createEvent:e,pullImages:a,delEvent:t})=>[{label:"镜像名",prop:"name",width:200},{label:"Start数",prop:"star_count",width:70},{label:"来源",width:60,render:e=>e.is_official?"官方":"非官方"},{label:"描述/说明",prop:"description",showOverflowTooltip:!0},L([{onClick:e,width:80,title:"创建容器"},{onClick:a,title:"拉取",render:e=>_("span",{class:"cursor-pointer text-primary",onClick:()=>a(e)},[e.is_pull?["更新",_(M,null,null)]:"拉取"])},{onClick:t,isHide:e=>!e.is_pull,title:"删除"}])])({createEvent:async e=>{B({image:e.name})},pullImages:async e=>{let a={model_index:"btdocker",mod_name:"image",def_name:"pull_from_some_registry",ws_callback:111,name:"docker官方库",image:e.name};await i({title:"拉取镜像",area:65,component:()=>o((()=>import("./pull-image-log-dialog.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),compData:{url:"/ws_model",params:a,onWSReceive:J,onRefresh:()=>W()}})},delEvent:async e=>{const t={id:e.id,name:e.name,force:"0"};try{await n({type:"calc",title:"删除镜像【".concat(e.name,"】"),content:"您真的要删除镜像【".concat(e.name,"】吗？")}),a({request:R({data:JSON.stringify(t)}),message:!0,success:()=>W(F.p)})}catch(s){}}})),G=p(),K=()=>{F.showList=F.list.slice((F.p-1)*F.limit,F.p*F.limit)},W=async e=>{a({request:A({data:JSON.stringify({name:D.name})}),data:Array,success:a=>{0===a.length&&(D.description="没有搜索到".concat(D.name,"相关的镜像")),F.list=a,F.total=a.length,F.p=isNaN(e||NaN)?1:e,K()},loading:j(F,"loading")})},Q=()=>{if(""===D.name)return t.error("请输入需要搜索的镜像名");window.open("https://hub.docker.com/search?type=image&q="+D.name)};return h((()=>{W(),setTimeout((()=>{if(V)F.tableHeight="410px";else{U.value=!1;const e=T.value-270;F.tableHeight="".concat(e,"px"),e>800&&(F.limit=20)}}),0)})),(e,a)=>{const t=s,i=z,o=C,n=l,r=E,m=S,c=N,p=u("bt-loading");return g(),f("div",q,[_(c,{ref_key:"searchFormRef",ref:G,model:b(D),"label-position":"right",onSubmit:a[4]||(a[4]=H((()=>{}),["prevent"]))},{default:v((()=>[w("div",I,[_(t,{modelValue:b(D).name,"onUpdate:modelValue":a[0]||(a[0]=e=>b(D).name=e),class:"!w-[51rem]",onChangePassive:a[1]||(a[1]=e=>(D.description="暂无数据",void(D.name=D.name.replace(/\s+/g,"")))),placeholder:"请输入需要搜索的镜像名",clearable:"",onClear:W,onKeyup:y(W,["enter","native"])},null,8,["modelValue"]),_(i,{type:"primary",class:"!ml-[1.5rem]",onClick:W},{default:v((()=>a[5]||(a[5]=[x("搜索")]))),_:1}),_(o,{class:"item",effect:"dark",content:"跳转docker Hub搜索内容",placement:"top-start"},{default:v((()=>[_(i,{type:"default",class:"!ml-[1rem] h-3rem",onClick:Q},{default:v((()=>a[6]||(a[6]=[w("svg",{t:"1704277357898",class:"w-[1.6rem] h-[1.6rem] mr-[.4rem] inline-block",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6185",width:"128",height:"128"},[w("path",{d:"M241.6 704a47.04 47.04 0 1 1 48.32-47.04A47.68 47.68 0 0 1 241.6 704z m705.92-242.88a144 144 0 0 0-106.24-9.6 141.44 141.44 0 0 0-57.6-89.92l-11.2-9.6-9.6 10.88a120.64 120.64 0 0 0-22.72 85.76 109.12 109.12 0 0 0 21.44 57.28 155.52 155.52 0 0 1-32 13.76 204.16 204.16 0 0 1-64 10.24H66.56L64 544a248.96 248.96 0 0 0 21.44 130.88l8 16.32a322.88 322.88 0 0 0 277.12 141.76c209.28 0 368.32-99.84 448-291.84A132.8 132.8 0 0 0 953.28 480l6.72-12.48-12.48-7.04z",fill:"#158BB5","p-id":"6186"}),w("path",{d:"M452.8 189.44h85.44v85.44h-85.44z m0 113.92h85.44v85.12h-85.44zM566.72 416h85.12v86.4h-85.12z m-113.92 0h85.44v86.4h-85.44z m-113.6 0h85.12v86.4H339.2z m0-113.6h85.12v85.12H339.2zM224 303.36h86.72v85.12H224zM224 416h86.72v86.4H224z m-112.32 0h85.12v86.4H111.68z m129.92 215.68a24.64 24.64 0 0 0-24 25.28 24.96 24.96 0 0 0 49.6 0 24.96 24.96 0 0 0-25.6-24.64",fill:"#158BB5","p-id":"6187"})],-1),w("span",null,"搜索",-1)]))),_:1})])),_:1})]),w("div",O,[_(m,null,{content:v((()=>[k(_(n,{ref:"searchImagesTable",column:b(P),"max-height":b(F).tableHeight,data:b(F).showList,description:b(D).description},null,8,["column","max-height","data","description"]),[[p,b(F).loading],[p,"正在加载模板列表，请稍后...","title"]])])),"footer-right":v((()=>[_(r,{class:"mt-1rem",page:b(F).p,"onUpdate:page":a[2]||(a[2]=e=>b(F).p=e),row:b(F).limit,"onUpdate:row":a[3]||(a[3]=e=>b(F).limit=e),total:b(F).total,onChange:K},null,8,["page","row","total"])])),_:1})])])),_:1},8,["model"])])}}});export{T as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
