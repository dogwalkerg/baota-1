import{c as e,r as a,o as l,k as s,l as t,e as o,x as m,p as u,q as n,M as r,y as d,Q as i}from"./base-lib.js?v=1734676359";import{G as c,db as p,b as v,b3 as f,k as h,O as x,h as V}from"./utils-lib.js?v=1734676359";import{B as j}from"./index185.js?v=1734676359";import{_}from"./index90.js?v=1734676359";import{h as y,u as b}from"./column.js?v=1734676359";import{aY as g,aZ as q}from"./firewall.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./ace.js?v=1734676359";import"./index91.js?v=1734676359";const w={class:"p-[2rem]"},C={class:"p-[2rem]"},k={class:"flex items-center p-[2rem] text-[1.4rem]"},U={class:"flex flex-col ml-[1.2rem]"},A={class:"flex items-center mt-[1.2rem]"},F=e({__name:"index",setup(e){const F=v(),O=a([]),B=a(""),E=a(!1),G=a({}),H=a(!1),J=a(!1),M=a([{label:"隔离时间",prop:"time"},y({label:"文件",prop:"path"}),b([{title:"样本文件",width:60,onClick:async e=>{G.value=e;const a=await c({request:p({path:e.path})});a.data.msg?F.request(a):(B.value=a.data.data,E.value=!0)}},{title:"删除",onClick:async e=>{H.value=!0,G.value=e}}])]),N=async()=>{c({request:g(),data:[Array,O]})},Q=async()=>{c({request:f({path:G.value.path,data:B.value,encoding:"utf-8"}),message:!0})},S=async()=>{c({request:q({data:JSON.stringify({md5:G.value.md5,path:G.value.path,type:J.value?"delete":""})}),message:!0,success:()=>{N(),J.value=!1,H.value=!1}})};return l((()=>{N()})),(e,a)=>{const l=h,c=_,p=x,v=j,f=V,y=i;return s(),t("div",w,[o(c,null,{content:m((()=>[o(l,{column:u(M),data:u(O)},null,8,["column","data"])])),_:1}),o(p,{options:[{content:"样本文件：查杀时的文件内容被记录形成的样本文件"}],class:"ml-[2rem] mt-[1.2rem]"}),o(f,{title:"在线编辑",showFooter:"",modelValue:u(E),"onUpdate:modelValue":a[1]||(a[1]=e=>r(E)?E.value=e:null),area:70,onConfirm:Q},{default:m((()=>[n("div",C,[o(v,{modelValue:u(B),"onUpdate:modelValue":a[0]||(a[0]=e=>r(B)?B.value=e:null),class:"!h-[40rem]"},null,8,["modelValue"])])])),_:1},8,["modelValue"]),o(f,{title:"删除文件",showFooter:"",area:40,modelValue:u(H),"onUpdate:modelValue":a[3]||(a[3]=e=>r(H)?H.value=e:null),onConfirm:S},{default:m((()=>[n("div",k,[a[6]||(a[6]=n("i",{class:"svgtofont-el-question text-[#E6A23C] text-[4rem]"},null,-1)),n("div",U,[a[5]||(a[5]=n("span",{class:"leading-8"},"是否要删除关联的源文件？",-1)),n("div",A,[o(y,{modelValue:u(J),"onUpdate:modelValue":a[2]||(a[2]=e=>r(J)?J.value=e:null),class:"!mr-[.4rem]"},null,8,["modelValue"]),a[4]||(a[4]=d(" 源文件 "))])])])])),_:1},8,["modelValue"])])}}});export{F as default};
