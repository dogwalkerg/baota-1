import{ah as e,G as a,o as l,j as t,c as o,h as s,b as n,u as r,bQ as i,e as d,al as u,l as p,H as m,k as c,V as _,t as v,O as h,X as f}from"./utils-lib.js?v=1734676359";import{c as g,r as b,h as w,w as y,o as x,aB as V,k as H,l as k,p as C,J as j,x as E,y as q,z as T,q as P,e as A,I as U,aX as I,v as z,M as O,ag as R,ah as M,a7 as S,A as L,aY as D,a4 as N,B,C as X,Q as G,aj as J,R as F}from"./base-lib.js?v=1734676359";import{u as Q}from"./useStore7.js?v=1734676359";import{_ as W}from"./index101.js?v=1734676359";import{_ as Y}from"./index88.js?v=1734676359";import{_ as K}from"./index116.js?v=1734676359";import{f as Z,h as $}from"./validator.js?v=1734676359";import{getComposerVersion as ee,deleteComposerFile as ae,execComposer as le,getComposerLine as te,setTomcatSettings as oe,getSitePhpVersion as se,setSecurityHeaders as ne,getSecurityHeaders as re,updateCorsConfig as ie,deleteCorsConfig as de,getCorsConfig as ue,getCrontabList as pe,modifyCrontabStatus as me,startTaskCrontab as ce,removeCrontab as _e,setPhpApp as ve,delPhpApp as he,getPhpAppList as fe}from"./site.js?v=1734676359";import{_ as ge}from"./index.vue_vue_type_script_setup_true_lang25.js?v=1734676359";import{_ as be}from"./index90.js?v=1734676359";import{a as we,b as ye,u as xe,c as Ve}from"./column.js?v=1734676359";import He from"./index397.js?v=1734676359";import{o as ke}from"./useController3.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";import"./index.vue_vue_type_style_index_0_scoped_03ce946a_lang.js?v=1734676359";import"./index97.js?v=1734676359";import"./index99.js?v=1734676359";const Ce={class:"p-1rem"},je={class:"flex items-center"},Ee={key:0,class:"text-danger"},qe={key:1,class:"text-danger text-[1.2rem]"},Te={class:"mt-[8px] leading-8 text-[1.2rem] list-disc ml-[20px]"},Pe={key:0},Ae={class:"p-2rem h-50rem flex flex-col"},Ue={class:"mb-1rem"},Ie={class:"flex-1 overflow-auto"},ze=g({__name:"index",setup(r,{expose:i}){var d;const{siteInfo:u}=Q(),p=null==(d=u.value)?void 0:d.project_type,m=n(),c=b(!1),_=b(!1),v=w({path:u.value.path,user:"phpasync"!==p?"www":"root",php:["静态","其它"].includes(u.value.php_version)?"auto":"PHP-"+u.value.php_version.replace(".",""),otherCommand:"",mirror:"https://mirrors.aliyun.com/composer/",command:"install",composerVersion:"install",version:"2.7.3",help_tips:"",comp_json:"",comp_lock:"",phpVersion:[],commandOptions:[{label:"install",value:"install"},{label:"update",value:"update"},{label:"require",value:"require"},{label:"create-project",value:"create-project"},{label:"自定义",value:""}]}),h=b("正在执行..."),f=b(!1),g=b(),B=b(!1);y((()=>u.value),(e=>{v.php=["静态","其它"].includes(e.php_version)?"auto":"PHP-"+e.php_version.replace(".","")}),{immediate:!0});const X=async a=>{c.value=!0;try{const e=await ee({path:a||u.value.path});e.data.status?(_.value=!1,v.phpVersion=e.data.php_versions.filter((e=>"00"!==e.version)),v.phpVersion.unshift({name:"自动选择",version:"auto"}),v.comp_json=!1,v.comp_lock=!1,"string"==typeof e.data.comp_json&&(v.comp_json=e.data.comp_json),"string"==typeof e.data.comp_lock&&(v.comp_lock=e.data.comp_lock)):(_.value=!0,m.request(e))}catch(l){e(l)}finally{c.value=!1}},G=()=>{Z({type:"dir",path:v.path,change:e=>{v.path=e,X(v.path)}})},J=async()=>{a({loading:"正在删除，请稍后...",request:ae({path:v.path+"/composer.lock"}),message:!0,success:e=>{e.status&&X(v.path)}})},F=async()=>{var e;let t={php_version:null==(e=v.php)?void 0:e.replace("PHP-",""),composer_args:v.command,composer_cmd:v.otherCommand,repo:v.mirror,path:v.path,user:v.user,composer_version:v.version};await l({title:"执行composer命令",content:"即将执行设定的composer命令，继续吗？",icon:"warning-filled"}),a({loading:"正在执行，请稍后...",request:le(t),message:!0,success:e=>{e.status&&(f.value=!0,(async()=>{g.value=setInterval((async()=>{try{$()}catch(e){clearInterval(g.value)}}),2e3)})())}})},$=async(a=!1)=>{try{const e=await te({filename:"/tmp/composer.log",num:100});h.value=e.data.msg,a&&m.success("刷新成功")}catch(l){e(l)}},oe=()=>{B.value=!0,$()},se=()=>{clearInterval(g.value),f.value=!1,B.value=!1,h.value=""};return x(X),i({init:X}),V((()=>{clearInterval(g.value)})),(e,a)=>{const l=K,n=R,r=M,i=S,d=t,u=Y,m=o,c=L,g=D,b=N,w=W,y=s;return H(),k("div",null,[C(_)?(H(),j(l,{key:0,width:"28rem"},{default:E((()=>a[11]||(a[11]=[q(" 没有找到可用的composer版本 ")]))),_:1})):T("",!0),P("div",Ce,[A(b,{model:C(v)},{default:E((()=>[A(i,{label:"Composer版本"},{default:E((()=>[P("div",je,[A(r,{modelValue:C(v).version,"onUpdate:modelValue":a[0]||(a[0]=e=>C(v).version=e),class:"!w-[28rem]"},{default:E((()=>[A(n,{label:"2.7.3",value:"2.7.3"}),A(n,{label:"1.10.27",value:"1.10.27"})])),_:1},8,["modelValue"])])])),_:1}),A(i,{label:"PHP版本"},{default:E((()=>["phpasync"!==C(p)?(H(),j(r,{key:0,class:"!w-[28rem]",modelValue:C(v).php,"onUpdate:modelValue":a[1]||(a[1]=e=>C(v).php=e)},{default:E((()=>[(H(!0),k(U,null,I(C(v).phpVersion,((e,a)=>(H(),j(n,{key:a,label:e.name,value:e.version},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])):(H(),j(d,{key:1,modelValue:C(v).php,"onUpdate:modelValue":a[2]||(a[2]=e=>C(v).php=e),disabled:""},null,8,["modelValue"]))])),_:1}),A(i,{label:"执行参数"},{default:E((()=>[A(r,{class:"!w-[28rem]","empty-values":[null,void 0],modelValue:C(v).command,"onUpdate:modelValue":a[3]||(a[3]=e=>C(v).command=e)},{default:E((()=>[(H(!0),k(U,null,I(C(v).commandOptions,((e,a)=>(H(),j(n,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),A(i,{label:"补充命令"},{default:E((()=>[A(d,{modelValue:C(v).otherCommand,"onUpdate:modelValue":a[4]||(a[4]=e=>C(v).otherCommand=e),placeholder:"请输入补充命令",width:"28rem"},null,8,["modelValue"])])),_:1}),A(i,{label:"镜像源"},{default:E((()=>[A(r,{modelValue:C(v).mirror,"onUpdate:modelValue":a[5]||(a[5]=e=>C(v).mirror=e),filterable:"","allow-create":"","default-first-option":"",class:"!w-[28rem]"},{default:E((()=>[A(n,{label:"阿里云(mirrors.aliyun.com)",value:"https://mirrors.aliyun.com/composer/"}),A(n,{label:"官方源(packagist.org)",value:"repos.packagist"}),A(n,{label:"中国全量镜像(packagist.phpcomposer.com)",value:"https://packagist.phpcomposer.com"}),A(n,{label:"Packagist Mirror(packagist.mirrors.sjtug.sjtu.edu.cn)",value:"https://packagist.mirrors.sjtug.sjtu.edu.cn"}),A(n,{label:"腾讯源(mirrors.tencent.com)",value:"https://mirrors.tencent.com/composer/"}),A(n,{label:"华为云(mirrors.huaweicloud.com)",value:"https://mirrors.huaweicloud.com/repository/php/"})])),_:1},8,["modelValue"])])),_:1}),"phpasync"!==C(p)?(H(),j(i,{key:0,label:"执行用户",prop:"command"},{default:E((()=>[A(r,{modelValue:C(v).user,"onUpdate:modelValue":a[6]||(a[6]=e=>C(v).user=e),class:"!w-28rem"},{default:E((()=>[A(n,{label:"www(推荐)",value:"www"}),A(n,{label:"root(不推荐)",value:"root"})])),_:1},8,["modelValue"])])),_:1})):T("",!0),A(i,{label:"执行目录",prop:"composerVersion"},{default:E((()=>[A(u,{modelValue:C(v).path,"onUpdate:modelValue":a[7]||(a[7]=e=>C(v).path=e),icon:"el-folder-opened",onIconClick:G,width:"28rem"},null,8,["modelValue"])])),_:1}),A(i,{label:" ",prop:"composerVersion"},{default:E((()=>[P("div",null,[C(v).comp_lock?(H(),k("span",Ee,[q(z(C(v).comp_lock)+" ",1),A(m,{onClick:J},{default:E((()=>a[12]||(a[12]=[q("[点击删除]")]))),_:1})])):T("",!0),C(v).comp_json?(H(),k("span",qe,z(C(v).comp_json),1)):T("",!0)])])),_:1}),A(i,{label:" "},{default:E((()=>[A(c,{type:"primary",disabled:!!("boolean"!=typeof C(v).comp_json&&C(v).comp_json||"boolean"!=typeof C(v).comp_lock&&C(v).comp_lock),onClick:F},{default:E((()=>a[13]||(a[13]=[q(" 执行 ")]))),_:1},8,["disabled"]),A(g,{direction:"vertical",class:"!h-1rem !mx-2rem"}),A(c,{onClick:oe},{default:E((()=>a[14]||(a[14]=[q("查看日志")]))),_:1})])),_:1})])),_:1},8,["model"]),P("ul",Te,[a[15]||(a[15]=P("li",null,"Composer是PHP主流依赖包管理器，若您的项目使用Composer管理依赖包，可在此处对依赖进行升级或安装",-1)),a[16]||(a[16]=P("li",null,"Composer版本：当前安装的Composer版本，可点击右侧的【升级Composer】将Composer升级到最新稳定版",-1)),a[17]||(a[17]=P("li",null,"PHP版本：用于执行composer的PHP版本，无特殊要求，默认即可，如安装出错，可尝试选择其它PHP版本",-1)),a[18]||(a[18]=P("li",null,"执行参数：按需选择执行参数,可配合补充命令使用",-1)),a[19]||(a[19]=P("li",null,"补充命令：若此处为空，则按composer.json中的配置执行，此处支持填写完整composer命令",-1)),a[20]||(a[20]=P("li",null,"镜像源：提供【阿里源】和【官方源】，建议国内服务器使用【阿里源】，海外服务器使用【官方源】",-1)),"phpasync"!==C(p)?(H(),k("li",Pe,"执行用户：默认为www用户，除非您的网站以root权限运行，否则不建议使用root用户执行composer")):T("",!0),a[21]||(a[21]=P("li",null,"执行目录：默认为当前网站根目录",-1))])]),A(y,{title:"请执行完毕确认结果无误后关闭此窗口",onCancel:se,modelValue:C(f),"onUpdate:modelValue":a[8]||(a[8]=e=>O(f)?f.value=e:null),area:[50,42]},{default:E((()=>[A(w,{class:"h-full",title:"全屏查看composer执行日志",content:C(h),isHtml:!0,isRefreshBtn:!1,isAuto:!0},null,8,["content"])])),_:1},8,["modelValue"]),A(y,{title:"composer执行日志",onCancel:se,modelValue:C(B),"onUpdate:modelValue":a[10]||(a[10]=e=>O(B)?B.value=e:null),area:60},{default:E((()=>[P("div",Ae,[P("div",Ue,[A(c,{type:"primary",onClick:a[9]||(a[9]=e=>$(!0))},{default:E((()=>a[22]||(a[22]=[q(" 刷新日志 ")]))),_:1})]),P("div",Ie,[A(w,{class:"h-full",title:"全屏查看composer执行日志",content:C(h),isHtml:!0,isRefreshBtn:!1},null,8,["content"])])])])),_:1},8,["modelValue"])])}}}),Oe={class:"p-1rem relative"},Re={class:"mt-[8px] leading-8 text-[1.2rem] list-disc ml-[20px]"},Me={key:0},Se=g({__name:"index",setup(e,{expose:l}){const{siteInfo:t}=Q(),s=b(!1),n=b(!1),r=w({tomcat:!1}),i=b(""),d=()=>{a({loading:"正在设置，请稍后...",request:oe({siteName:t.value.name}),message:!0,success:e=>{e.status&&u()}})},u=async()=>{a({loading:s,request:se({siteName:t.value.name}),success:e=>{r.tomcat=e.data.tomcat>0,n.value=!e.data.tomcatversion,i.value=e.data.tomcatversion}})},p=()=>{$({name:"tomcat",type:"i"})};return x(u),l({init:u}),(e,a)=>{const l=o,t=K,u=G,m=B("bt-loading");return X((H(),k("div",null,[C(n)?(H(),j(t,{key:0,width:"28rem"},{content:E((()=>[a[2]||(a[2]=q(" 请先安装tomcat， ")),A(l,{onClick:p,class:"!text-[1.2rem]"},{default:E((()=>a[1]||(a[1]=[q(" 立即安装 ")]))),_:1})])),_:1})):T("",!0),P("div",Oe,[A(u,{modelValue:C(r).tomcat,"onUpdate:modelValue":a[0]||(a[0]=e=>C(r).tomcat=e),onChange:d},{default:E((()=>a[3]||(a[3]=[q(" 启用Tomcat ")]))),_:1},8,["modelValue"]),P("ul",Re,[C(i)?(H(),k("li",Me,"当前版本为Tomcat"+z(C(i))+" ,若您需要其它版本,请到软件商店- 所有软件 中切换；",1)):T("",!0),a[4]||(a[4]=P("li",null,"部署顺序: 安装Tomcat >> 创建站点 >> 上传并配置项目 >> 启用Tomcat",-1)),a[5]||(a[5]=P("li",null,"若您的tomcat应用中有php脚本,访问时请添加.php扩展名",-1)),a[6]||(a[6]=P("li",null,"开启成功后,大概需要1-5分钟时间生效!",-1))])])])),[[m,C(s)]])}}}),Le={class:"px-2rem"},De={class:"ml-[8px]"},Ne=g({__name:"index",setup(e,{expose:l}){const{siteInfo:t}=Q(),o=b(!1),s=b([{help:"阻止浏览器上下文中执行恶意JavaScript代码",value:!1,field:"x_xss_protection"},{help:"阻止浏览器的内容嗅探",value:!1,field:"x_content_type_options"},{help:"让浏览器跳转时不携带referrer",value:!1,field:"referrer_policy"},{help:"让浏览器加载内容时只加载自己网站的内容",value:!1,field:"content_security_policy"},{help:"防止浏览器进行用户行为跟踪",value:!1,field:"permissions_policy"}]),n=()=>{let e={};s.value.forEach((a=>{e[a.field]=a.value}));const l={site_name:t.value.name,security_info:JSON.stringify(e)};a({loading:"正在设置，请稍后...",request:ne(l),message:!0,success:e=>{e.status&&r()}})},r=()=>{a({loading:o,request:re({site_name:t.value.name}),success:e=>{s.value.forEach((a=>{e.data[a.field]&&(a.value=e.data[a.field])}))}})};return x(r),l({init:r}),(e,a)=>{const l=J,t=B("bt-loading");return X((H(),k("div",Le,[(H(!0),k(U,null,I(C(s),((e,a)=>(H(),k("div",{key:a,class:"flex items-center mb-[12px]"},[A(l,{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,onChange:n},null,8,["modelValue","onUpdate:modelValue"]),P("span",De,z(e.help),1)])))),128))])),[[t,C(o)]])}}}),Be=d(g({__name:"add-cors",setup(e,{expose:l}){const{plugin:o}=r(),{webserver:s}=o.value,{siteInfo:n}=Q(),d=b(!1),u=b(),p=w({status:!1,allowed_origins:"",allowed_methods:[],allHeaders:[],allowed_headers:"",expHeaders:[],exposed_headers:"",max_age:""}),m=w({allowed_methods:!1,allHeaders:!1,expHeaders:!1}),c=w({allowed_methods:!1,allHeaders:!1,expHeaders:!1}),_=[{label:"GET",value:"GET"},{label:"POST",value:"POST"},{label:"OPTIONS",value:"OPTIONS"},{label:"PATCH",value:"PATCH"},{label:"DELETE",value:"DELETE"},{label:"HEAD",value:"HEAD"}],v=[{label:"Content-Type",value:"Content-Type"},{label:"Authorization",value:"Authorization"},{label:"X-Requested-With",value:"X-Requested-With"},{label:"Range",value:"Range"},{label:"Accept",value:"Accept"},{label:"Cache-Control",value:"Cache-Control"},{label:"If-Modified-Since",value:"If-Modified-Since"},{label:"自定义",value:"custom"}],h=[{label:"X-Custom-Header",value:"X-Custom-Header"},{label:"Content-Length",value:"Content-Length"},{label:"ETag",value:"ETag"},{label:"Cache-Control",value:"Cache-Control"},{label:"Last-Modified",value:"Last-Modified"},{label:"Expires",value:"Expires"},{label:"Vary",value:"Vary"},{label:"自定义",value:"custom"}],f={allowed_methods:_,allHeaders:v,expHeaders:h},g=w({allowed_origins:[{required:!0,message:"请输入来源（Origins）",trigger:"blur"}],allowed_methods:[{required:!0,message:"请选择请求方法（Methods）",trigger:"change"}],allHeaders:[{required:!0,message:"请选择请求头（Headers）",trigger:"change"}],allowed_headers:[{trigger:["blur","change"],validator:(e,a,l)=>{p.allHeaders.includes("custom")&&!a&&1===p.allHeaders.length?l(new Error("请输入自定义请求头")):l()}}],expHeaders:[{required:!0,message:"请选择响应头（Headers）",trigger:"change"}],exposed_headers:[{trigger:["blur","change"],validator:(e,a,l)=>{p.expHeaders.includes("custom")&&!a&&1===p.expHeaders.length?l(new Error("请输入自定义响应头")):l()}}],max_age:[{required:!0,message:"请输入缓存时间（Seconds）",trigger:"blur"},{validator:(e,a,l)=>{""===a||!Number.isInteger(parseFloat(a))||a<0?l(new Error("请输入大于0的整数")):l()},trigger:["blur","change"]}]}),y=(e,a)=>{p[a]=e?f[a].map((e=>e.value)):[],c[a]=!1},V=(e,a)=>{var l;const t=e.length,o=f[a].length;m[a]=t===o,c[a]=t>0&&t<o,null==(l=u.value)||l.clearValidate()},I=async()=>{var e,l,t;const o={path:"/www/server/panel/vhost/".concat(s,"/").concat(n.value.name,".conf"),encoding:"utf-8"};if(p.status){await(null==(e=u.value)?void 0:e.validate());const{allowed_origins:a,allowed_methods:s,allHeaders:n,allowed_headers:r,expHeaders:i,exposed_headers:d,max_age:m}=p;let c=n.filter((e=>"custom"!==e)),_=i.filter((e=>"custom"!==e));n.includes("custom")&&(null==(l=null==r?void 0:r.split("\n"))||l.forEach((e=>{c.includes(e)||c.push(e)}))),i.includes("custom")&&(null==(t=null==d?void 0:d.split("\n"))||t.forEach((e=>{_.includes(e)||_.push(e)}))),Object.assign(o,{allowed_origins:a,allowed_methods:s.join(","),allowed_headers:c.join(","),exposed_headers:_.join(","),max_age:m})}const r=p.status?ie:de;return(await a({loading:"正在设置，请稍后...",request:r(o),message:!0,success:e=>{e.status&&z()}})).status},z=()=>{a({loading:d,request:ue({path:"/www/server/panel/vhost/".concat(s,"/").concat(n.value.name,".conf")}),success:e=>{Array.isArray(e.data.msg)&&e.data.msg.length?(e=>{var a,l,t;const{allowed_methods:o,exposed_headers:s,allowed_headers:n}=e;let r=[],i=[];null==(a=null==n?void 0:n.replace(/\,/g,"\n"))||a.split("\n").forEach((e=>{v.find((a=>a.value===e))?p.allHeaders.push(e):(p.allHeaders.includes("custom")||p.allHeaders.push("custom"),r.push(e))})),null==(l=null==s?void 0:s.replace(/\,/g,"\n"))||l.split("\n").forEach((e=>{h.find((a=>a.value===e))?p.expHeaders.push(e):(p.expHeaders.includes("custom")||p.expHeaders.push("custom"),i.push(e))})),Object.assign(p,{...e,status:!0,allowed_headers:r.join("\n"),exposed_headers:i.join("\n"),allowed_methods:Array.isArray(o)?o:(null==(t=null==o?void 0:o.replace(/\s/g,""))?void 0:t.split(","))||[]}),Object.keys(c).forEach((e=>{c[e]=!0}))})(e.data.msg[0]):O()}})},O=()=>{Object.assign(p,{allowed_origins:"",allowed_methods:[],allHeaders:[],allowed_headers:"",expHeaders:[],exposed_headers:"",max_age:""}),Object.keys(c).forEach((e=>{c[e]=!1,m[e]=!1}))};return x(z),l({onConfirm:I,init:z}),(e,a)=>{const l=J,o=S,s=t,n=G,r=i,f=L,b=N,w=B("bt-loading");return X((H(),j(b,{ref_key:"formRef",ref:u,class:"cors-form max-h-[61rem] overflow-auto","label-width":"140px","label-position":"right",model:C(p),rules:C(g)},{default:E((()=>[A(o,{label:"状态"},{default:E((()=>[A(l,{class:"mr-[12px]",modelValue:C(p).status,"onUpdate:modelValue":a[0]||(a[0]=e=>C(p).status=e)},null,8,["modelValue"])])),_:1}),C(p).status?(H(),k(U,{key:0},[A(o,{label:"来源（Origins）",prop:"allowed_origins"},{default:E((()=>[A(s,{modelValue:C(p).allowed_origins,"onUpdate:modelValue":a[1]||(a[1]=e=>C(p).allowed_origins=e),type:"textarea",resize:"none",width:"36rem",rows:3},null,8,["modelValue"])])),_:1}),A(o,{label:"请求方法（Methods）",prop:"allowed_methods"},{default:E((()=>[P("div",null,[A(n,{modelValue:C(m).allowed_methods,"onUpdate:modelValue":a[2]||(a[2]=e=>C(m).allowed_methods=e),size:"small",indeterminate:C(c).allowed_methods,onChange:a[3]||(a[3]=e=>y(C(m).allowed_methods,"allowed_methods"))},{default:E((()=>a[18]||(a[18]=[q(" 全选 ")]))),_:1},8,["modelValue","indeterminate"]),A(r,{modelValue:C(p).allowed_methods,"onUpdate:modelValue":a[4]||(a[4]=e=>C(p).allowed_methods=e),options:_,size:"small",onChange:a[5]||(a[5]=e=>V(C(p).allowed_methods,"allowed_methods"))},null,8,["modelValue"])])])),_:1}),A(o,{label:"请求头（Headers）",prop:"allHeaders"},{default:E((()=>[A(n,{modelValue:C(m).allHeaders,"onUpdate:modelValue":a[6]||(a[6]=e=>C(m).allHeaders=e),size:"small",indeterminate:C(c).allHeaders,onChange:a[7]||(a[7]=e=>y(C(m).allHeaders,"allHeaders"))},{default:E((()=>a[19]||(a[19]=[q("全选")]))),_:1},8,["modelValue","indeterminate"]),A(r,{modelValue:C(p).allHeaders,"onUpdate:modelValue":a[8]||(a[8]=e=>C(p).allHeaders=e),size:"small",options:v,onChange:a[9]||(a[9]=e=>V(C(p).allHeaders,"allHeaders"))},null,8,["modelValue"]),A(o,{label:"",prop:"allowed_headers"},{default:E((()=>[C(p).allHeaders.includes("custom")?(H(),j(s,{key:0,modelValue:C(p).allowed_headers,"onUpdate:modelValue":a[10]||(a[10]=e=>C(p).allowed_headers=e),placeholder:"请输入自定义请求头，一行一个",class:"mt-[4px]",type:"textarea",resize:"none",width:"36rem",rows:3},null,8,["modelValue"])):T("",!0)])),_:1})])),_:1}),A(o,{label:"响应头（Headers）",prop:"expHeaders"},{default:E((()=>[A(n,{modelValue:C(m).expHeaders,"onUpdate:modelValue":a[11]||(a[11]=e=>C(m).expHeaders=e),size:"small",indeterminate:C(c).expHeaders,onChange:a[12]||(a[12]=e=>y(C(m).expHeaders,"expHeaders"))},{default:E((()=>a[20]||(a[20]=[q("全选")]))),_:1},8,["modelValue","indeterminate"]),A(r,{modelValue:C(p).expHeaders,"onUpdate:modelValue":a[13]||(a[13]=e=>C(p).expHeaders=e),size:"small",options:h,onChange:a[14]||(a[14]=e=>V(C(p).expHeaders,"expHeaders"))},null,8,["modelValue"]),A(o,{label:"",prop:"exposed_headers"},{default:E((()=>[C(p).expHeaders.includes("custom")?(H(),j(s,{key:0,modelValue:C(p).exposed_headers,"onUpdate:modelValue":a[15]||(a[15]=e=>C(p).exposed_headers=e),placeholder:"请输入自定义响应头，一行一个",class:"mt-[4px]",type:"textarea",resize:"none",width:"36rem",rows:3},null,8,["modelValue"])):T("",!0)])),_:1})])),_:1}),A(o,{label:"缓存时间（Seconds）",prop:"max_age"},{default:E((()=>[A(s,{modelValue:C(p).max_age,"onUpdate:modelValue":a[16]||(a[16]=e=>C(p).max_age=e),type:"number",width:"36rem","text-type":"秒"},null,8,["modelValue"])])),_:1})],64)):T("",!0),A(o,{label:" "},{default:E((()=>[A(f,{type:"primary",onClick:a[17]||(a[17]=e=>I())},{default:E((()=>a[21]||(a[21]=[q("保存")]))),_:1})])),_:1})])),_:1},8,["model","rules"])),[[w,C(d)]])}}}),[["__scopeId","data-v-83045fcd"]]),Xe=g({__name:"index",setup(e,{expose:t}){const{siteInfo:o}=Q(),s=b(),n=b([]),r=b(!1),{BtOperation:i}=u({options:[{label:"添加计划任务",type:"button",active:!0,onClick:()=>h()}]}),d=async(e,a,l,t)=>{const{label:o,value:s}=t,n=new Map([["stark","即将批量执行选中的计划任务"],["start","即将批量开启选中任务"],["stop","即将批量停止选中任务"],["delete","即将批量删除选中任务"]]),r=async(e,a)=>{const l=new Map([["stark",ce],["start",me],["stop",me],["delete",_e]]),{id:t}=e,o=l.get(s);switch(s){case"stark":case"delete":if(o)return o({id:t});break;case"start":case"stop":if(o)return o({id:t,status:"start"===s?1:0})}};await e({title:"批量".concat(o),content:"".concat(n.get(s),"，是否继续操作？"),column:[{label:"项目名称",prop:"name"},Ve()],onConfirm:async()=>(await a(r),y(),!1)})},v=async e=>{await l({title:e.status?"停用计划任务":"启用计划任务",content:e.status?"计划任务暂停后将无法继续运行，您真的要停用这个计划任务吗？":"该计划任务已停用，是否要启用这个计划任务？",icon:"question-filled"}),await a({loading:"正在设置计划任务状态，请稍候...",request:me({id:e.id}),message:!0,success:y})},h=e=>{p({isAsync:!0,title:"".concat(e?"编辑":"添加","计划任务").concat(e?"【"+e.name+"】":""),area:74,component:()=>m((()=>import("./add-crontab.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),compData:{row:e||!1,sitename:o.value.name,refreshEvent:y},showFooter:!0})},f=e=>{p({isAsync:!0,title:"查看【"+(e.rname||e.name)+"】日志",area:80,compData:{id:e.id},component:()=>m((()=>import("./log-detail3.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)})},g=async e=>{a({loading:"正在执行计划任务，请稍后...",request:ce({id:e.id}),message:!0,success:()=>{f(e)}})},w=async({id:e,name:t})=>{await l({title:"删除计划任务",content:"您确定要删除计划任务【".concat(t,"】，是否继续？"),icon:"warning-filled"}),a({loading:"正在删除计划任务，请稍后...",request:_e({id:e}),message:!0,success:y})},y=async()=>{a({loading:r,request:pe({sitename:o.value.name}),data:{data:[Array,n]}})},V=F([we(),{label:"计划任务",prop:"rname",render:e=>e.rname||e.name},ye({event:e=>{v(e)},data:["停用","正常"]}),{label:"执行周期",prop:"cycle"},{label:"上次执行时间",prop:"addtime"},xe([{onClick:g,title:"执行"},{onClick:e=>{h(e)},title:"编辑"},{onClick:e=>{f(e)},title:"日志"},{onClick:w,title:"删除"}])]),k=[{label:"执行任务",value:"stark",event:d},{label:"启动任务",value:"start",event:d},{label:"停止任务",value:"stop",event:d},{label:"删除任务",value:"delete",event:d}];return x(y),t({init:y}),(e,a)=>{const l=c,t=_,o=be,d=B("bt-loading");return H(),j(o,null,{"header-left":E((()=>[A(C(i))])),"header-right":E((()=>a[0]||(a[0]=[]))),content:E((()=>[X(A(l,{ref_key:"cronTableRef",ref:s,"max-height":560,column:C(V),data:C(n)},null,8,["column","data"]),[[d,"正在加载计划任务列表，请稍后...","title"],[d,C(r)]])])),"footer-left":E((()=>[A(t,{"table-ref":C(s),options:C(k)},null,8,["table-ref","options"])])),_:1})}}}),Ge={class:"flex items-center"},Je={class:"flex items-center ml-1rem"},Fe={class:"p-2rem"},Qe=["innerHTML"],We=g({__name:"index",setup(e,{expose:t}){const o=n(),{siteInfo:r}=Q(),i=b(!1),d=b(),u=b([]),f=w({visible:!1,title:"",log:""}),g=[{isHtml:!0,content:'使用教程：<a\n\t\t\thref="https://www.bt.cn/bbs/thread-132632-1-1.html"\n\t\t\ttarget="_blank"\n\t\t\tclass="text-primary"\n\t\t\t>https://www.bt.cn/bbs/thread-132632-1-1.html</a\n\t\t>'}],y=async e=>{await l({title:"应用环境包【".concat(e.app_name,"】"),icon:"warning-filled",content:"您真的要应用环境包【".concat(e.app_name,"】吗？")}),a({loading:"正在应用，请稍后...",request:ve({site_name:r.value.name,app_name:e.app_name,app_version:e.app_version}),message:!0})},V=async e=>{await l({icon:"warning-filled",title:"删除环境包【".concat(e.app_name,"】"),content:"您真的要删除环境包【".concat(e.app_name,"】吗？")}),a({loading:"正在删除，请稍后...",request:he({site_name:r.value.name,app_name:e.app_name,app_version:e.app_version}),message:!0,success:e=>{e.status&&T()}})},j=()=>{p({isAsync:!0,title:"创建应用环境包",area:70,btn:"确定",component:()=>m((()=>import("./create-package.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),compData:{refreshEvent:T}})},T=()=>{a({loading:i,request:fe({site_name:r.value.name}),data:{data:[Array,u]}})},U=F([we(),{label:"名称",prop:"app_name"},{label:"版本",prop:"app_version"},{label:"大小",prop:"size",render:e=>v(Number(e.size))||"--"},{label:"时间",prop:"addtime",width:150},xe([{title:"应用",onClick:y},{title:"下载",onClick:e=>{window.open("/download?filename="+e.package_path,"_blank")}},{title:"更新日志",onClick:e=>{if(""===e.update_log)return o.error("暂无更新日志");f.title="【".concat(e.app_name," v").concat(e.app_version,"】更新日志"),f.log=e.update_log,f.visible=!0},width:80},{title:"删除",onClick:V}])]),I=[{label:"删除",value:"deleteApp",event:async(e,a,l,t)=>{const o=async e=>await he({site_name:r.value.name,app_name:e.app_name,app_version:e.app_version});await e({title:"批量删除应用包【".concat(r.value.name,"】"),content:"批量删除选中的应用包，是否继续操作？",column:[{prop:"app_name",label:"名称"},Ve()],onConfirm:async()=>(await a(o),T(),!1)})}}];return x(T),t({init:T}),(e,a)=>{const l=L,t=c,o=_,n=s,r=be,p=h,m=B("bt-loading");return H(),k("div",null,[A(r,null,{"header-left":E((()=>[P("div",Ge,[A(l,{type:"primary",onClick:j},{default:E((()=>a[2]||(a[2]=[q("创建")]))),_:1}),P("div",Je,[a[3]||(a[3]=P("i",{class:"svgtofont-desired text-[1.6rem]"},null,-1)),P("span",{class:"bt-link",onClick:a[0]||(a[0]=(...e)=>C(ke)&&C(ke)(...e))},"需求反馈")])])])),content:E((()=>[X(A(t,{ref_key:"appEnvTableRef",ref:d,column:C(U),"min-height":470,data:C(u)},null,8,["column","data"]),[[m,C(i)],[m,"正在获取列表，请稍候...","title"]])])),"footer-left":E((()=>[A(o,{"table-ref":C(d),options:C(I)},null,8,["table-ref","options"])])),popup:E((()=>[A(n,{title:C(f).title,modelValue:C(f).visible,"onUpdate:modelValue":a[1]||(a[1]=e=>C(f).visible=e),area:60},{default:E((()=>[P("div",Fe,[P("pre",{class:"text-[#555] max-h-[50rem] overflow-y-auto",innerHTML:C(f).log},null,8,Qe)])])),_:1},8,["title","modelValue"])])),_:1}),A(p,{class:"mt-[2rem]",options:g})])}}}),Ye=d(g({__name:"index",setup(e,{expose:a}){var l,t,o;const{siteInfo:s}=Q(),n=null==(l=s.value)?void 0:l.project_type,r=b((null==(t=s.value)?void 0:t.otherName)?null==(o=s.value)?void 0:o.otherName:"phpasync"!==n?"composer":"nginx"),i="phpasync"===n,d=b([{label:"Composer",name:"composer",lazy:!0,isHide:i,render:ze},{label:"Tomcat",name:"tomcat",lazy:!0,isHide:i,render:Se},{label:"Nginx安全请求头",name:"nginx",lazy:!0,render:Ne},{label:"跨域访问CORS配置",name:"cors",isHide:i,lazy:!0,render:Be},{label:"默认文档",name:"defalut",isHide:!i,lazy:!0,render:ge},{label:"计划任务",name:"crontab",isHide:!i,lazy:!0,render:Xe},{label:"网站告警",name:"siteAlarm",isHide:!i,lazy:!0,render:He},{label:"应用环境包",name:"siteApp",isHide:i,lazy:!0,render:We}]),{BtTabs:u}=f({type:"card",value:r,options:d}),p=()=>{d.value=d.value.filter((e=>!0!==e.isHide))};return x(p),a({init:p}),(e,a)=>(H(),j(C(u)))}}),[["__scopeId","data-v-876ff66f"]]);export{Ye as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
