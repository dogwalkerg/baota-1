import{G as a,af as t,ah as e,b as s,aj as l,R as n,l as o,H as i}from"./utils-lib.js?v=1734676359";import{b as r,d as c,e as p}from"./firewall.js?v=1734676359";import{h as d,e as u,y as m,aN as w}from"./base-lib.js?v=1734676359";import{u as h,c as _}from"./column.js?v=1734676359";import{getFirewallStore as y}from"./useStore4.js?v=1734676359";import{k as f}from"./validator.js?v=1734676359";const b=s(),{refs:{sshInfo:k,firewallInfo:v}}=y(),j=async()=>{try{const a=await r();k.value=a.data}catch(a){}},C=async()=>{const t=await a({request:c()});v.value={...v.value,...t.data},v.value.ping=!t.data.ping},T=async()=>{const t=await a({request:p(),data:Boolean});v.value.status=t},P=async a=>{let s;try{s=b.load("正在获取插件状态，请稍后...");return(await t({sName:a})).data}catch(l){e(l)}finally{s.close()}},g=d({1:"全站扫描",2:"快速扫描",3:"单URL"}),x=d({title:"标题",body:"网页内",keywords:"关键词",descriptions:"描述",title_update:"标题更新",keywords_update:"关键词更新",description_update:"描述更新",tail_hash_update:"尾部script代码块更新",title_hash_update:"头部head代码块更新"}),S=()=>[{label:"巡检时间",width:150,render:a=>{const t=l(a.time,"number",0);return u("span",null,[n(t)])}},{label:"URL",showOverflowTooltip:!0,render:a=>u("span",{class:"bt-link",title:a.url,onClick:()=>window.open(a.url)},[a.url])},{label:"关键词",prop:"content",width:180},{label:"类型",prop:"risk_content",width:180},{label:"风险位置",width:120,showOverflowTooltip:!0,render:a=>x[a.risk_type]},h([{onClick:L,title:"详情"}])],L=a=>{var t;let e="/www/server/panel/class/projectModel/content/source/",s=e+a.source_file;(null==(t=a.risk_type)?void 0:t.indexOf("_update"))>-1?M(a,e):E(s,a.content)},M=(a,t)=>{"title_hash_update"!==a.risk_type&&"tail_hash_update"!==a.risk_type||(t="/www/server/panel/class/projectModel/content/hash/"+a.site_name+"/");let e=t+a.new_content_file;E(e)},E=(a,t)=>{f(a,"editor","html")},F=a=>{o({title:"风险详情",area:[70,55],component:()=>i((()=>import("./index229.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),compData:a})},I=(a,t,e)=>u("div",null,"link"===t?[a,u("span",{class:"ml-4px bt-ico-ask",onClick:()=>window.open(e)},[m("?")])]:[u("span",null,[a]),u(w,{content:t,placement:"top"},{default:()=>[u("span",{class:"ml-4px bt-ico-ask"},[e||"?"])]})]),O={3306:"MySQL服务默认端口",888:"phpMyAdmin默认端口",22:"SSH远程服务",20:"FTP主动模式数据端口",21:"FTP协议默认端口","39000-40000":"FTP被动模式端口范围","30000-40000":"FTP被动模式端口范围",11211:"Memcached服务端口",873:"rsync数据同步服务",8888:"宝塔Linux面板默认端口"},R=({changePolicy:a})=>[{label:"策略",render:(t,e)=>u("span",{class:"cursor-pointer",style:"color:".concat("accept"===t.Strategy?"#20a53a":"#ef0808"),onClick:()=>a(t)},["accept"==t.Strategy?"放行":"禁止"])},{label:"方向",render:(a,t)=>"INPUT"===a.Chain?"入站":"出站"}],N=({editEvent:a,deleteEvent:t})=>h([{onClick:a,title:"修改"},{onClick:t,title:"删除"}]),U=async(a,t,e,s,l)=>{await a({title:"批量删除",content:"即将删除所选中的数据，是否继续操作?",column:[s,_()],onConfirm:async()=>(await t(e),l(),!1)})};export{C as a,j as b,P as c,N as d,U as e,S as f,T as g,g as m,F as o,O as p,I as r,R as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
