import{G as a,ah as e,h as l,c as s,F as t,k as o,V as n,S as r,l as i,H as u}from"./utils-lib.js?v=1734676359";import{_ as d}from"./index90.js?v=1734676359";import{_ as m}from"./index97.js?v=1734676359";import{c,r as p,k as _,l as f,e as g,x as v,y,q as h,p as b,M as x,A as w,aj as j,h as k,R as C,i as V,w as S,o as U,B as q,J as R,z as A,F as D,I as J,aX as O,C as T,ag as F,ah as H,v as L}from"./base-lib.js?v=1734676359";import{_ as M}from"./index116.js?v=1734676359";import{setAuthStatus as N,getModulesCloudServer as z,getMongodbConfig as B,getModulesList as E}from"./database.js?v=1734676359";import{f as I,g as G,u as P}from"./column.js?v=1734676359";import{g as X,a as K,f as Q,b as W,e as Y,h as Z,k as $,n as aa,i as ea,j as la,l as sa}from"./useMethod3.js?v=1734676359";import{e as ta}from"./validator.js?v=1734676359";import{_ as oa}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1734676359";import{_ as na}from"./index.vue_vue_type_script_setup_true_lang3.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";import"./index.vue_vue_type_style_index_0_scoped_03ce946a_lang.js?v=1734676359";const ra={class:"p-20px"},ia={class:"flex items-center"},ua=c({__name:"index",setup(s){const{refs:{safetyStatus:t}}=X(),o=p(!1),n=async()=>{try{await a({loading:"正在设置安全状态，请稍候...",request:N({data:JSON.stringify({status:t.value?"1":"0"})}),message:!0,success:a=>{a.status||(t.value=!t.value)}})}catch(l){e(l,"changeSafety")}};return(a,e)=>{const s=w,r=j,i=l;return _(),f("div",null,[g(s,{type:"default",onClick:e[0]||(e[0]=a=>o.value=!0)},{default:v((()=>e[3]||(e[3]=[y("安全认证")]))),_:1}),g(i,{title:"安全认证",modelValue:b(o),"onUpdate:modelValue":e[2]||(e[2]=a=>x(o)?o.value=a:null),area:40},{default:v((()=>[h("div",ra,[h("div",ia,[e[4]||(e[4]=h("span",{class:"mr-8px"},"安全认证：",-1)),g(r,{modelValue:b(t),"onUpdate:modelValue":e[1]||(e[1]=a=>x(t)?t.value=a:null),width:36,onChange:n},null,8,["modelValue"])]),e[5]||(e[5]=h("ul",{class:"mt-8px leading-8 text-[1.2rem] list-disc ml-20px"},[h("li",null,"安全认证：开启后访问数据需要使用帐号和密码")],-1))])])),_:1},8,["modelValue"])])}}}),da={class:"flex items-center"},ma={class:"w-[20rem] truncate inline-block"},ca=c({__name:"index",setup(e){const{refs:{isRefreshTable:l,isLoading:c,safetyStatus:j,envStatus:N,isHaveServer:ra},resetRefresh:ia,refreshTableList:ca}=X(),pa=k({total:0,page:1,row:10}),_a=p([]),fa=C([]),ga=p(null),va=p("all"),ya=p(""),ha=p(""),ba=p([]),xa=Y(),wa=V((()=>!N.value.setup&&!ra.value)),ja=()=>[...Z($),I({event:(a,e)=>aa(a,e)}),ea(ba.value,"mongodb"),G({table:"databases"}),P([{onClick:a=>(a=>{i({title:"【".concat(a.name,"】权限配置"),area:53,compData:a,showFooter:!0,component:()=>u((()=>import("./index118.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)})})(a),title:"权限"},{onClick:a=>la(a),title:"工具"},{onClick:a=>$(a),title:"改密"},{onClick:a=>sa(a),title:"删除"}])],ka=async()=>(await a({request:z({data:JSON.stringify({type:"mongodb"})},"mongodb"),data:[Array,ba]}),ba.value.length||(ra.value=!1),ba.value),Ca=async()=>{let e={p:pa.page,limit:pa.row,tables:"databases",search:ya.value,sid:"all"===va.value?"":va.value};""===e.sid&&delete e.sid,await a({loading:c,request:E({data:JSON.stringify(e)},"mongodb"),data:{data:[Array,_a],page:r(pa)}})},Va=async()=>{const e=await a({request:B(),data:{root:[String,ha],authorization:[String,a=>({status:"enabled"===a||!1})]}});j.value=e.status};return S((()=>l.value),(async a=>{a&&await Ca(),ia()})),U((()=>(async()=>{Ca(),Va(),await ka(),fa.value=ja()})())),(a,e)=>{const l=M,r=w,i=s,u=F,p=H,k=t,C=o,V=n,S=m,U=d,N=q("bt-loading");return _(),f("div",null,[b(wa)?(_(),R(l,{key:0},{content:v((()=>[g(na,{type:"MongoDB"})])),_:1})):A("",!0),g(U,null,{"header-left":v((()=>[h("div",da,[g(r,{type:"primary",onClick:e[0]||(e[0]=a=>b(K)(ka))},{default:v((()=>e[7]||(e[7]=[y("添加数据库")]))),_:1}),b(j)?(_(),R(r,{key:0,onClick:e[1]||(e[1]=a=>b(Q)(b(ha),(()=>Va())))},{default:v((()=>e[8]||(e[8]=[y("root密码")]))),_:1})):A("",!0),g(r,{onClick:b(W)},{default:v((()=>e[9]||(e[9]=[y("远程数据库")]))),_:1},8,["onClick"]),g(ua,{class:"mx-[10px]"}),g(oa,{"comp-data":b(ba)},null,8,["comp-data"]),g(i,{onClick:e[2]||(e[2]=a=>b(ta)({name:"数据库",type:12})),icon:"desired",class:"ml-[12px]",iconClass:"text-1.6rem"},{default:v((()=>e[10]||(e[10]=[y("需求反馈")]))),_:1})])])),"header-right":v((()=>[g(p,{modelValue:b(va),"onUpdate:modelValue":e[3]||(e[3]=a=>x(va)?va.value=a:null),onChange:b(ca),class:D(["!w-[14rem] mr-[8px]",{"custom-types-bg-green":"all"!==b(va)}])},{default:v((()=>[g(u,{label:"全部",value:"all"}),(_(!0),f(J,null,O(b(ba),((a,e)=>(_(),R(u,{key:e,label:"".concat("all"!==b(va)?"已选：":"").concat(a.ps),value:a.id},{default:v((()=>[h("span",ma,L(a.ps),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue","onChange","class"]),g(k,{class:"w-[26rem]",modelValue:b(ya),"onUpdate:modelValue":e[4]||(e[4]=a=>x(ya)?ya.value=a:null),onSearch:b(ca),placeholder:"请输入数据库名称/备注"},null,8,["modelValue","onSearch"])])),content:v((()=>[T(g(C,{ref_key:"mongoDbTableRef",ref:ga,column:b(fa),data:b(_a)},null,8,["column","data"]),[[N,b(c)]])])),"footer-left":v((()=>[g(V,{options:b(xa),"table-ref":b(ga)},null,8,["options","table-ref"])])),"footer-right":v((()=>[g(S,{total:b(pa).total,page:b(pa).page,"onUpdate:page":e[5]||(e[5]=a=>b(pa).page=a),row:b(pa).row,"onUpdate:row":e[6]||(e[6]=a=>b(pa).row=a),onChange:b(ca)},null,8,["total","page","row","onChange"])])),_:1})])}}});export{ca as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
