import{M as e,G as a,k as s,e as l,aa as t}from"./utils-lib.js?v=1734676359";import{c as o,h as r,r as i,B as c,k as m,l as n,e as d,x as p,q as u,p as f,y as h,C as _,v,N as g,ar as b,Q as x,A as y,a4 as j,M as k,ay as C}from"./base-lib.js?v=1734676359";import V from"./add-compose-template.js?v=1734676359";import{_ as L}from"./index88.js?v=1734676359";import{g as S,a5 as q,a6 as w}from"./useStore3.js?v=1734676359";import{f as D}from"./validator.js?v=1734676359";import{l as I}from"./useMethods.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index185.js?v=1734676359";import"./ace.js?v=1734676359";import"./index91.js?v=1734676359";import"./column.js?v=1734676359";const M={class:"container-dialog !p-0"},N={class:"flex items-center relative"},U={class:"table w-full mt-[1rem]"},A={class:"pl-[2rem]"},J={class:"help-info-text c7 list-disc text-[#ff0000] mt-[1.5rem]"},O=l(o({__name:"search-local-template",emits:["close","complate"],setup(l,{expose:t,emit:o}){const k=o,{refs:{isRefreshTemplateList:C}}=S(),V=r({path:"",checked:!1}),O=r({loading:!1,list:[],selection:[]}),R=I(),T=i(),z=r({selectList:[]}),B=()=>{D({type:"dir",change:e=>{V.path=e}})},F=async()=>{if(""===V.path)return e.error("请选择路径"),!1;a({request:q({data:JSON.stringify({path:V.path,sub_dir:V.checked?"1":"0"})}),data:[Array,b(O,"list")],loading:b(O,"loading")})},G=e=>{z.selectList=e};return t({confirm:()=>{0!==z.selectList.length?a({request:w({data:JSON.stringify({template_list:z.selectList})}),message:!0,success:e=>{e.status&&(k("complate",e),C.value=!0,k("close"))}}):e.error("请选择模板")}}),(e,a)=>{const l=L,t=x,o=y,r=s,i=j,b=c("bt-loading");return m(),n("div",M,[d(i,{ref_key:"cmdFormRef",ref:T,size:"default",model:f(V),class:"relative w-full","label-position":"right",onSubmit:a[3]||(a[3]=g((()=>{}),["prevent"]))},{default:p((()=>[u("div",N,[d(l,{modelValue:f(V).path,"onUpdate:modelValue":a[0]||(a[0]=e=>f(V).path=e),width:"51rem",icon:"icon-file_mode",onIconClick:B,onChangePassive:a[1]||(a[1]=e=>{V.path=V.path.replace(/\s+/g,"")}),placeholder:"请输入镜像路径"},null,8,["modelValue"]),d(t,{class:"!absolute top-[0rem] left-[36rem]",modelValue:f(V).checked,"onUpdate:modelValue":a[2]||(a[2]=e=>f(V).checked=e)},{default:p((()=>a[4]||(a[4]=[h("包含子目录")]))),_:1},8,["modelValue"]),d(o,{class:"ml-8px",type:"primary",onClick:F},{default:p((()=>a[5]||(a[5]=[h("搜索")]))),_:1})]),u("div",U,[_(d(r,{ref:"ftpTable",column:f(R),height:"33rem",data:f(O).list,description:"模板列表为空",onSelectionChange:G},null,8,["column","data"]),[[b,f(O).loading],[b,"正在加载模板列表，请稍后...","title"]])]),u("div",A,[u("ul",J,[u("li",null,"选中需要添加的Compose 【已选中："+v(f(z).selectList.length)+"个】",1)])])])),_:1},8,["model"])])}}}),[["__scopeId","data-v-892f0f0c"]]),R={class:"flex flex-col p-[1.6rem] lib-box"},T=l(o({__name:"index",props:{compData:{default:()=>({})}},emits:["close"],setup(e,{expose:a,emit:s}){const l=s,o=e,r=i("first"),c=i(),u=i(),h=e=>{var a;(null==(a=o.compData)?void 0:a.callback)&&o.compData.callback(e)},_=()=>{l("close")};return a({onConfirm:async()=>{try{"first"==r.value?c.value.onConfirm():u.value.confirm()}catch(e){}}}),(e,a)=>{const s=C,l=t;return m(),n("div",R,[d(l,{type:"card",modelValue:f(r),"onUpdate:modelValue":a[0]||(a[0]=e=>k(r)?r.value=e:null)},{default:p((()=>[d(s,{label:"添加Compose模板",name:"first"},{default:p((()=>[d(V,{ref_key:"first",ref:c,onClose:_,onComplate:h},null,512)])),_:1}),d(s,{label:"搜索本地模板",name:"second"},{default:p((()=>[d(O,{ref_key:"second",ref:u,onClose:_,onComplate:h},null,512)])),_:1})])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-a46eb19c"]]);export{T as default};
