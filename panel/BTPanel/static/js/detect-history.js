import{u as t,cz as a,aj as s,R as e,l as n,H as i,G as r,S as o,k as l}from"./utils-lib.js?v=1734676359";import{_ as p}from"./index90.js?v=1734676359";import{_ as m}from"./index97.js?v=1734676359";import{getSingleSiteRisk as d,getRisk as c}from"./site.js?v=1734676359";import{c as _,R as u,r as b,a_ as g,o as h,B as f,k as j,J as k,x,C as w,p as D,e as y,F as C,y as R}from"./base-lib.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";const H=_({__name:"detect-history",props:{compData:{default:()=>({isPopup:!1,name:""})}},setup(_){const H=_,{mainHeight:P}=t(),U=u(!1),A=b([]),E=b(0),L=b(H.compData.isPopup);H.compData;const q=g({p:1,limit:20}),v=[{label:"网站列表",prop:"site_name"},{label:"扫描URL总数",prop:"scans",width:120},{label:"扫描耗时",prop:"time",render:t=>[t.end_time<=1||t.end_time-t.start_time<=0?y("span",null,[R("0秒")]):y("span",null,[a(t.end_time-t.start_time)])]},{label:"风险次数",prop:"risks",render:t=>[0==t.risks?y("span",null,[R("无风险")]):y("span",{class:"bt-link !text-danger",onClick:()=>z(t)},[t.risks])]},{label:"状态",prop:"status",render:t=>[0===t.is_status&&0===t.end_time||1===t.end_time?y("span",{class:"text-red"},[R("扫描未完成")]):1===t.is_status&&0===t.end_time?y("span",{class:"text-[#fc6d26]"},[R("扫描中")]):y("span",null,[R("扫描完成")])]},{label:"扫描时间",prop:"start_time",render:t=>{const a=s(t.start_time,"number",0);return y("span",null,[e(a)])}},{label:"操作",align:"right",width:200,render:t=>[0===t.is_status&&0===t.end_time||1===t.end_time||1===t.is_status&&0===t.end_time?y("span",{class:"text-[#c8c9cc] cursor-not-allowed"},[R("扫描未完成")]):y("span",{class:"bt-link",onClick:()=>(t=>{window.open("/project/content/report/html?id="+t.testing_id)})(t)},[R("查看报告")])]}],z=t=>{n({title:"风险详情",area:[70,55],component:()=>i((()=>import("./risk-detail.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),compData:t})},B=async(t=1)=>{await r({loading:U,request:L.value?d({site_name:H.compData.name,...q}):c({...q}),data:{data:[Array,A],page:o(E)}})};return h((()=>{B()})),(t,a)=>{const s=l,e=m,n=p,i=f("bt-loading");return j(),k(n,{class:C({"p-[2rem]":D(L)})},{content:x((()=>[w(y(s,{ref:"table",column:v,data:D(A),"max-height":D(L)?500:D(P)-240,description:"检测历史列表为空"},null,8,["data","max-height"]),[[i,D(U)],[i,"正在加载检测历史列表，请稍后...","title"]])])),"footer-right":x((()=>[y(e,{total:D(E),page:D(q).p,"onUpdate:page":a[0]||(a[0]=t=>D(q).p=t),row:D(q).limit,"onUpdate:row":a[1]||(a[1]=t=>D(q).limit=t),onChange:B},null,8,["total","page","row"])])),popup:x((()=>a[2]||(a[2]=[]))),_:1},8,["class"])}}});export{H as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
