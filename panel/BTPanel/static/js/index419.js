import{D as e,al as a,l,H as t,am as s,G as n,o as i,an as r,M as u,aO as o,b6 as c,aM as d,J as m,X as p}from"./utils-lib.js?v=1734676359";import{c as v,s as _,o as g,B as h,k as y,l as b,p as f,J as x,x as w,q as k,v as C,z as B,C as L,e as R,r as V,y as j,A as q,aj as U,aN as z,i as P,aT as O,P as W,ah as T,ag as A,Q as E,h as S,a5 as D}from"./base-lib.js?v=1734676359";import{_ as I}from"./index116.js?v=1734676359";import{b as M}from"./index81.js?v=1734676359";import{_ as Z}from"./index90.js?v=1734676359";import{l as G,u as H}from"./column.js?v=1734676359";import{_ as N}from"./index91.js?v=1734676359";import{u as J}from"./useStore9.js?v=1734676359";import{Q,R as X,S as $,T as F,b as Y,U as K,V as ee,W as ae,X as le,Y as te,c as se,Z as ne,_ as ie,g as re,u as ue,$ as oe,a0 as ce,w as de,a1 as me,x as pe}from"./useMethod5.js?v=1734676359";import{h as ve}from"./form-item.js?v=1734676359";const _e={class:"content-mask"},ge={class:"mr-8px"},he=v({__name:"setup",setup(a,{expose:l}){const{form:t,loading:s}=_(M()),n=async()=>{await r()},{BtForm:i,submit:r}=e({data:()=>t.value,options:()=>Se(n),submit:async(e,a)=>{await a()}});return g((async()=>{await Me(),await He()})),l({init:Me}),(e,a)=>{const l=I,t=h("bt-loading");return y(),b("div",null,[f(Ie).value?(y(),x(l,{key:0},{content:w((()=>[k("div",_e,[a[0]||(a[0]=k("i",{class:"text-orange !text-[2.2rem] svgtofont-el-warning mr-4px"},null,-1)),k("span",ge,C(f(Ie).message),1)])])),_:1})):B("",!0),L(R(f(i),null,null,512),[[t,f(s)]])])}}}),ye={class:"content-mask"},be={class:"mr-8px"},fe=v({__name:"plugin",setup(e,{expose:u}){const{isRefreshPluginList:o}=_(M()),{localRow:c}=_(J()),{BtOperation:d}=a({options:V([{onClick:()=>{l({title:"安装插件",area:90,component:()=>t((()=>import("./plugin-install.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)})},type:"button",label:"安装"}])}),{BtTable:m,BtPage:p,BtRecommendSearch:v,BtRefresh:g,BtColumn:h,BtBatch:L,BtTableCategory:U,BtErrorMask:z,tableRef:P,classList:O,refresh:W}=s({request:e=>Ne(),columns:[{label:"名称",minWidth:180,isCustom:!0,prop:"name"},G({prop:"is_plugin_activate",label:"激活",size:"small",event:async(e,a)=>{n({loading:"设置中...",message:!0,request:Q({s_id:c.value.id,plugin_file:a.plugin_file,activate:e?1:0}),success:l=>{l.status||(a.is_plugin_activate=!e)}})}}),G({prop:"auto_update",label:"自动更新",size:"small",event:async(e,a)=>{n({loading:"设置中...",message:!0,request:X({s_id:c.value.id,plugin_file:a.plugin_file,enable:e?1:0}),success:l=>{l.status||(a.is_plugin_activate=!e)}})}}),H([{title:"更新",render:e=>e.can_update?R("div",{class:"inline-flex items-center"},[R("span",{class:"bt-link",onClick:()=>{n({loading:"更新中...",message:!0,request:$({s_id:c.value.id,plugin_file:e.plugin_file}),success:e=>{o.value=!0}})}},[j("更新")]),R(N,null,null)]):""},{onClick:e=>{i({title:"卸载 【".concat(e.name,"】"),content:"确定要卸载该插件吗？",onConfirm:async()=>{n({loading:"卸载中...",message:!0,request:F({s_id:c.value.id,plugin_file:e.plugin_file}),success:e=>{o.value=!0}})}})},title:"卸载"}],{fixed:"right",label:"操作",width:120})],extension:[r(o)]});return u({init:W}),(e,a)=>{const l=I,t=q,s=Z;return y(),b("div",null,[f(Ie).value?(y(),x(l,{key:0},{content:w((()=>[k("div",ye,[a[1]||(a[1]=k("i",{class:"text-orange !text-[2.2rem] svgtofont-el-warning mr-4px"},null,-1)),k("span",be,C(f(Ie).message),1)])])),_:1})):B("",!0),R(s,null,{"header-left":w((()=>[R(t,{type:"primary",class:"mr-[12px]",onClick:a[0]||(a[0]=e=>f(Y)(f(c).id,"local"))},{default:w((()=>a[2]||(a[2]=[k("i",{class:"svgtofont-icon-ltd !text-[2rem] text-[#D4B675] mr-4px"},null,-1),j(" WP管理 ")]))),_:1}),R(f(d))])),content:w((()=>[R(f(m))])),_:1})])}}}),xe={class:"content-mask"},we={class:"mr-8px"},ke=v({__name:"theme",setup(e,{expose:u}){const{isRefreshThemeList:o}=_(M()),{localRow:c}=_(J()),{BtOperation:d}=a({options:V([{onClick:()=>{l({title:"安装主题",area:90,component:()=>t((()=>import("./theme-install.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)})},type:"button",label:"安装"}])}),{BtTable:m,BtPage:p,BtRecommendSearch:v,BtRefresh:g,BtColumn:h,BtBatch:L,BtTableCategory:P,BtErrorMask:O,tableRef:W,classList:T,refresh:A}=s({request:e=>Xe(),columns:[{label:"名称",minWidth:180,isCustom:!0,prop:"name"},{prop:"is_theme_activate",label:"激活",render:e=>e.is_theme_activate?R(z,{content:"至少有1个主题是激活状态的，在禁用它之前请先激活另一个主题",placement:"top"},{default:()=>[R(U,{modelValue:e.is_theme_activate,size:"small",disabled:e.is_theme_activate},null)]}):R(U,{modelValue:e.is_theme_activate,size:"small",onChange:a=>{n({loading:"激活中...",message:!0,request:K({s_id:c.value.id,stylesheet:e.stylesheet}),success:()=>{o.value=!0}})}},null)},G({prop:"auto_update",label:"自动更新",size:"small",event:async(e,a)=>{n({loading:"设置中...",message:!0,request:ee({s_id:c.value.id,stylesheet:a.stylesheet,enable:e?1:0}),success:l=>{l.status||(a.auto_update=!e)}})}}),H([{title:"更新",render:e=>e.can_update?R("span",{class:"bt-link",onClick:()=>{i({title:"更新【".concat(e.name,"】"),content:"将从当前版本：".concat(e.version,"更新到最新版本：").concat(e.latest_version,"，继续吗？"),onConfirm:async()=>{n({loading:"更新中...",message:!0,request:ae({s_id:c.value.id,stylesheet:e.stylesheet}),success:()=>{o.value=!0}})}})}},[j("更新"),R(N,null,null)]):""},{onClick:e=>{},title:"卸载",render:e=>e.is_theme_activate?R("span",{class:"cursor-not-allowed text-[#999]"},[j("卸载")]):R("span",{class:"bt-link",onClick:()=>{i({title:"卸载【".concat(e.name,"】"),content:"确定要卸载此主题吗？",onConfirm:async()=>{n({loading:"卸载中...",message:!0,request:le({s_id:c.value.id,stylesheet:e.stylesheet}),success:()=>{o.value=!0}})}})}},[j("卸载")])}])],extension:[r(o)]});return u({init:A}),(e,a)=>{const l=I,t=q,s=Z;return y(),b("div",null,[f(Ie).value?(y(),x(l,{key:0},{content:w((()=>[k("div",xe,[a[1]||(a[1]=k("i",{class:"text-orange !text-[2.2rem] svgtofont-el-warning mr-4px"},null,-1)),k("span",we,C(f(Ie).message),1)])])),_:1})):B("",!0),R(s,null,{"header-left":w((()=>[R(t,{type:"primary",class:"mr-[12px]",onClick:a[0]||(a[0]=e=>f(Y)(f(c).id,"local"))},{default:w((()=>a[2]||(a[2]=[k("i",{class:"svgtofont-icon-ltd !text-[2rem] text-[#D4B675] mr-4px"},null,-1),j(" WP管理 ")]))),_:1}),R(f(d))])),content:w((()=>[R(f(m))])),_:1})])}}});const{localRow:Ce,isRefreshLocalList:Be}=_(J()),{login_url:Le,isUpdate:Re,versionText:Ve,isCache:je,username:qe,password:Ue,language:ze,form:Pe,currentVersion:Oe,updateVersion:We,siteLanguageOption:Te}=_(M()),{setLoading:Ae}=M(),Ee=[{label:"基础设置",name:"setup",lazy:!0,render:()=>he},{label:"插件",name:"plugin",lazy:!0,render:()=>fe},{label:"主题",name:"theme",lazy:!0,render:()=>ke}],Se=e=>P((()=>{const a=[{type:"custom",render:()=>R(o,{labelWidth:110,label:"更改管理员登录URL"},{default:()=>[R("div",{class:"flex items-center"},[R("div",{class:"mr-[8px]"},[Pe.value.home_url,j("/")]),R(W,{modelValue:Pe.value.Login_url,"onUpdate:modelValue":e=>Pe.value.Login_url=e,class:"w-[200px]",placeholder:"请输入管理员登录URL"},null)]),R("div",{class:"text-[#999] text-[12px]"},[j("通过更改登录URL并防止访问WP-login.php页面和WP-Admin目录来保护您的网站。")])]})},{type:"custom",render:()=>R(o,{labelWidth:110,label:"重定向URL"},{default:()=>[R("div",{class:"flex items-center"},[R("div",{class:"mr-[8px]"},[Pe.value.home_url,j("/")]),R(W,{modelValue:Pe.value.redirection_url,"onUpdate:modelValue":e=>Pe.value.redirection_url=e,class:"w-[200px]",placeholder:"请输入重定向URL"},null)]),R("div",{class:"text-[#999] text-[12px]"},[j("重定向URL当某人尝试访问WP-login.php页面和WP-Admin目录时，而未登录时。")])]})}];return[ve("登录URL",(()=>R("span",{class:"bt-link",onClick:()=>window.open(Le.value)},[Le.value]))),{type:"custom",render:()=>R(o,{label:"状态"},{default:()=>[R(O,{style:"width: 400px;padding: 0 10px;",closable:!1,type:Re.value?"warning":"info"},{default:()=>[Ve.value]}),R(q,{type:"primary",class:"ml-[15px]",onClick:()=>{Re.value?n({loading:"升级中...",request:te({s_id:Ce.value.id,version:We.value}),message:!0,success:e=>{Be.value=!0}}):u.error("当前版本无需升级")}},{default:()=>[j("升级")]})]})},{type:"custom",render:()=>R(o,{label:"缓存"},{default:()=>[R(U,{modelValue:je.value,"onUpdate:modelValue":e=>je.value=e,onChange:e=>{n({loading:"".concat(e?"开启":"关闭","缓存中，请稍候..."),message:!0,request:se({version:Ce.value.php_version,sitename:Ce.value.name,act:e?"enable":"disable"}),success:a=>{a.status&&(Ce.value.cache_status=e)}})}},null),R(q,{type:"default",class:"ml-[15px]",onClick:()=>{n({loading:"清除缓存中...",request:ne({s_id:Ce.value.id}),message:!0})}},{default:()=>[j("清除")]})]})},{type:"custom",render:()=>R(o,{label:"用户名"},{default:()=>[R(W,{modelValue:qe.value,"onUpdate:modelValue":e=>qe.value=e,class:"!w-[400px]",disabled:!0},null)]})},{type:"custom",render:()=>R(o,{label:"重置密码"},{default:()=>[R("div",{class:"flex items-center"},[R(W,{modelValue:Ue.value,"onUpdate:modelValue":e=>Ue.value=e,class:"!w-[400px]"},null),R(q,{type:"primary",class:"ml-[15px]",onClick:()=>{Ue.value=c(16,"wp")}},{default:()=>[j("生成")]})])]})},{type:"input",label:"邮箱",key:"admin_email",attrs:{style:"width: 400px;",placeholder:"请输入邮箱"},rules:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:["blur","change"]},{validator:(e,a,l)=>{/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(a)?l():l(new Error("邮箱格式不正确"))},trigger:["blur","change"]}]},{type:"custom",render:()=>{let e;return R(o,{label:"网站语言"},{default:()=>{return[R(T,{modelValue:ze.value,"onUpdate:modelValue":e=>ze.value=e,placeholder:"请选择语言",class:"!w-[400px]",loading:Ze.value},(a=e=Te.value.map((e=>R(A,{key:e.value,label:e.label,value:e.value},null))),"function"==typeof a||"[object Object]"===Object.prototype.toString.call(a)&&!D(a)?e:{default:()=>[e]}))];var a}})}},{type:"custom",render:()=>R(o,{label:"WPS-HIDE-LOGIN"},{default:()=>[R(E,{modelValue:Pe.value.wps,"onUpdate:modelValue":e=>Pe.value.wps=e,label:"启用WPS-HIDE-LOGIN"},null)]})},...Pe.value.wps?a:[],{type:"custom",render:()=>R(o,{label:" "},{default:()=>[R(q,{type:"primary",onClick:async()=>{await e(),n({loading:"保存中...",request:ie(De()),message:!0,success:async e=>{e.status&&(await Me(),await He())}})}},{default:()=>[j("保存")]})]})}]})),De=()=>{const e={s_id:Ce.value.id,language:ze.value,admin_email:Pe.value.admin_email,whl_enabled:Pe.value.wps?1:0,whl_page:Pe.value.Login_url,whl_redirect_admin:Pe.value.redirection_url};return Ue.value&&(e.admin_password=Ue.value),e},Ie=S({value:!1,message:""}),Me=async()=>{try{Ae(!0),Ie.value=!1;const{data:{msg:e},status:a}=await re({s_id:Ce.value.id});d(e)&&(je.value=e.cache_enabled,Oe.value=e.local_version,We.value=e.latest_version,Re.value=e.can_upgrade,Le.value=e.login_url,qe.value=e.admin_user,ze.value=e.language,Pe.value.admin_email=e.admin_email,Pe.value.Login_url=e.whl_page,Pe.value.home_url=e.home_url,Pe.value.redirection_url=e.whl_redirect_admin,Pe.value.wps=e.whl_enabled,Te.value=Object.entries(e).map((([e,a])=>({label:a,value:e})))),a||(Ie.value=!0,Ie.message=e)}catch(e){}finally{Ae(!1)}},{loading:Ze,setLoading:Ge}=ue(),He=async()=>{Ge(!0);try{const{data:{msg:e}}=await oe();d(e)&&(Te.value=Object.entries(e).map((([e,a])=>({label:a,value:e}))))}catch(e){}finally{Ge(!1)}},Ne=async e=>{try{return Je()}catch(a){return{data:[],total:0,other:{search_history:[]}}}},Je=async()=>{Ie.value=!1;const{data:e,status:a,msg:l}=await ce({s_id:Ce.value.id});return a||(Ie.value=!0,Ie.message=l),{data:e,total:e.length}},Qe=async e=>{try{const{data:{msg:a}}=await de({s_id:Ce.value.id,keyword:e.search,p:e.p,p_size:e.limit});return m(a.list)&&(a.list=a.list.map((e=>({...e,author:e.author.replace('href="','target="_blank" style="color: #1d9534" href="')})))),{data:a.list,total:a.total,other:{search_history:[]}}}catch(a){return{data:[],total:0,other:{search_history:[]}}}},Xe=async e=>{try{return $e()}catch(a){return{data:[],total:0,other:{search_history:[]}}}},$e=async()=>{Ie.value=!1;const{data:e,status:a,msg:l}=await me({s_id:Ce.value.id});return a||(Ie.value=!0,Ie.message=l),{data:e,total:e.length}},Fe=async e=>{try{const{data:{msg:a}}=await pe({s_id:Ce.value.id,keyword:e.search,p:e.p,p_size:e.limit});return{data:a.list,total:a.total,other:{search_history:[]}}}catch(a){return{data:[],total:0,other:{search_history:[]}}}},Ye=v({__name:"index",setup(e){const{tabActive:a}=_(M()),{BtTabs:l}=p({type:"card",options:Ee,value:a});return(e,a)=>(y(),b("div",null,[R(f(l))]))}}),Ke=Object.freeze(Object.defineProperty({__proto__:null,default:Ye},Symbol.toStringTag,{value:"Module"}));export{Fe as a,Qe as g,Ke as i};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
