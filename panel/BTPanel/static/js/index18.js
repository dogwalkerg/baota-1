import{_ as a}from"./index90.js?v=1734676359";import{_ as e}from"./index97.js?v=1734676359";import{G as s,c as l,F as t,k as o,V as r,S as n}from"./utils-lib.js?v=1734676359";import{c as i,r as u,h as d,R as p,i as m,w as c,o as _,B as f,k as v,l as g,p as b,J as y,x as h,e as x,z as j,q as w,y as k,M as C,F as q,I as S,aX as V,C as R,A as U,ag as A,ah as J,v as T}from"./base-lib.js?v=1734676359";import{_ as F}from"./index116.js?v=1734676359";import{g as H,e as L,a as M,b as N,h as O,k as z,i as B,l as G}from"./useMethod3.js?v=1734676359";import{g as I,u as X}from"./column.js?v=1734676359";import{getModulesCloudServer as D,getModulesList as E}from"./database.js?v=1734676359";import{e as K}from"./validator.js?v=1734676359";import{_ as P}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1734676359";import{_ as Q}from"./index.vue_vue_type_script_setup_true_lang3.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";import"./index.vue_vue_type_style_index_0_scoped_03ce946a_lang.js?v=1734676359";const W={class:"flex items-center"},Y={class:"w-[20rem] truncate inline-block"},Z=i({__name:"index",setup(i){const{refs:{isRefreshTable:Z,isLoading:$,isHaveServer:aa},resetRefresh:ea,refreshTableList:sa}=H(),la=u(null),ta=u([]),oa=d({total:0,page:1,row:10}),ra=p([]),na=u("all"),ia=u(""),ua=u([]),da=L().filter((a=>"back"!==a.value)),pa=m((()=>!aa.value)),ma=async()=>(await s({request:D({data:JSON.stringify({type:"sqlserver"})},"mongodb"),data:[Array,ua]}),ua.value.length||(aa.value=!1),ua.value),ca=async()=>{let a={p:oa.page,limit:oa.row,tables:"databases",search:ia.value,sid:"all"===na.value?"":na.value};""===a.sid&&delete a.sid,await s({loading:$,request:E({data:JSON.stringify(a)},"sqlserver"),data:{data:[Array,ta],page:n(oa)}})},_a=async()=>{ca(),await ma(),ra.value=[...O(z),B(ua.value,"sqlserver"),I({table:"databases"}),X([{onClick:a=>z(a),title:"改密"},{onClick:a=>G(a),title:"删除"}])]};return c((()=>Z.value),(async a=>{a&&await ca(),ea()})),_((()=>_a())),(s,n)=>{const i=F,u=U,d=l,p=A,m=J,c=t,_=o,H=r,L=e,O=a,z=f("bt-loading");return v(),g("div",null,[b(pa)?(v(),y(i,{key:0},{content:h((()=>[x(Q,{type:"SqlServer"})])),_:1})):j("",!0),x(O,null,{"header-left":h((()=>[w("div",W,[x(u,{type:"primary",onClick:n[0]||(n[0]=a=>b(M)(ma))},{default:h((()=>n[6]||(n[6]=[k("添加数据库")]))),_:1}),x(u,{onClick:b(N)},{default:h((()=>n[7]||(n[7]=[k("远程数据库")]))),_:1},8,["onClick"]),x(P,{"comp-data":b(ua),class:"ml-[10px]"},null,8,["comp-data"]),x(d,{onClick:n[1]||(n[1]=a=>b(K)({name:"数据库",type:12})),icon:"desired",class:"ml-[12px]",iconClass:"text-1.6rem"},{default:h((()=>n[8]||(n[8]=[k("需求反馈")]))),_:1})])])),"header-right":h((()=>[x(m,{modelValue:b(na),"onUpdate:modelValue":n[2]||(n[2]=a=>C(na)?na.value=a:null),onChange:b(sa),class:q(["!w-[14rem] mr-[8px]",{"custom-types-bg-green":"all"!==b(na)}])},{default:h((()=>[x(p,{label:"全部",value:"all"}),(v(!0),g(S,null,V(b(ua),((a,e)=>(v(),y(p,{key:e,label:"".concat("all"!==b(na)?"已选：":"").concat(a.ps),value:a.id},{default:h((()=>[w("span",Y,T(a.ps),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue","onChange","class"]),x(c,{class:"w-[26rem]",modelValue:b(ia),"onUpdate:modelValue":n[3]||(n[3]=a=>C(ia)?ia.value=a:null),onSearch:b(sa),placeholder:"请输入数据库名称/备注"},null,8,["modelValue","onSearch"])])),content:h((()=>[R(x(_,{ref_key:"sqlTableRef",ref:la,column:b(ra),data:b(ta)},null,8,["column","data"]),[[z,b($)]])])),"footer-left":h((()=>[x(H,{options:b(da),"table-ref":b(la)},null,8,["options","table-ref"])])),"footer-right":h((()=>[x(L,{total:b(oa).total,page:b(oa).page,"onUpdate:page":n[4]||(n[4]=a=>b(oa).page=a),row:b(oa).row,"onUpdate:row":n[5]||(n[5]=a=>b(oa).row=a),onChange:b(sa)},null,8,["total","page","row","onChange"])])),_:1})])}}});export{Z as default};
