import{_ as t}from"./index90.js?v=1734676359";import{o as a,R as e,G as s,k as i,b as o}from"./utils-lib.js?v=1734676359";import{_ as n,ao as r,ap as c}from"./store2.js?v=1734676359";import{aa as l,aN as m,az as p,aB as d,aO as u,aP as f}from"./store.js?v=1734676359";import{c as h,r as b,az as y,o as j,k as _,l as x,e as g,x as k,p as w}from"./base-lib.js?v=1734676359";import{u as N}from"./column.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index88.js?v=1734676359";import"./validator.js?v=1734676359";import"./index91.js?v=1734676359";const v={class:"py-[1rem] px-16px"},q=h({__name:"index",props:{compData:{default:()=>({})}},emits:["close"],setup(h,{expose:q,emit:D}){const C=o(),T=h,z=D,E=b(T.compData.editorTabsActive.history||[]),L=[{label:"版本时间",prop:"time",render:t=>y("span",{},(t=>{const a=new Date(1e3*Number(t));return isNaN(a.getTime())?t:e(a)})(t))},N([{onClick:async t=>{const a={filename:l.path,history:t},e=await s({request:r(a)}),i=m(l.id);e.status?(p.value={id:l.id,st_mtime:t,path:l.path,type:"editor"},z("close"),await d({title:"".concat(l.title," <-> ").concat(l.title),type:"diff",mode:"diff",path:l.path}),await u({mode:"ace/mode/".concat(l.mode),left:{content:e.data.data,editable:!1,copyLinkEnabled:!1},right:{content:i.getValue(),editable:!1,copyLinkEnabled:!1}})):C.request(e)},width:65,title:"文件对比"},{onClick:async t=>{await a({title:"恢复历史文件",content:"是否恢复历史文件 ".concat(e(Number(t)),"?恢复历史文件后，当前文件内容将会被替换！")}),s({loading:"正在恢复历史文件，请稍后...",request:n({filename:l.path,history:t}),message:!0,success:t=>{t.status&&(T.compData.callback(),R())}})},title:"恢复"},{onClick:async t=>{await a({title:"删除历史文件",content:"是否删除历史文件 ".concat(e(Number(t)),"?删除历史文件后，将无法恢复！")}),s({loading:"正在删除历史文件，请稍后...",request:c({filename:l.path||"",history:t}),message:!0,success:t=>{t.status&&R()}})},title:"删除"}])],R=async()=>{try{const{data:t}=await f(l.path);E.value=t.historys}catch(t){}};return j((()=>{R()})),q({}),(a,e)=>{const s=i,o=t;return _(),x("div",v,[g(o,null,{content:k((()=>[g(s,{ref:"fileTableRef",height:"40rem",column:L,description:"列表为空",data:w(E)},null,8,["data"])])),_:1})])}}});export{q as default};
