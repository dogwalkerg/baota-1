import{_ as e}from"./index90.js?v=1734676359";import{u as a,di as t,M as l,G as s,o as n,j as r,k as i,O as o,e as d}from"./utils-lib.js?v=1734676359";import{c as m,R as u,r as p,a_ as c,az as I,o as f,B as y,k as P,l as _,e as h,x as w,p as b,q as x,C as g,D as V,y as j,ay as k,aA as U,A as q}from"./base-lib.js?v=1734676359";import{ak as v,al as C,am as H,an as R,ao as A,ap as L}from"./firewall.js?v=1734676359";import{u as z}from"./column.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";const B={class:"flex w-full p-[2rem]"},D={class:"w-[86%] flex-1"},G={class:"flex items-center"},M={class:"flex items-center"},N=d(m({__name:"index",setup(d){const{mainHeight:m}=a(),N=u(!1),O=p([]),T=p([]),E=c({type:"url",url:"",startIP:"",endIP:"",urlHelp:[{content:"例子1: bt.cn/admin/admin.php?system=abc 添加地址: ^/admin/admin.php"},{content:"例子2: bt.cn/admin/1 1 为可变 1-99 添加地址为: ^/admin/[1-99]"}],ipHelp:[{content:"添加某个IP：起始IP为192.168.10.6 结束IP为192.168.10.6"},{content:"添加IP段：起始IP为192.168.1.1 结束IP为192.168.1.254"}]}),F=e=>{E.type=e.paneName,Q()},J=async()=>{switch(E.type){case"url":if(!E.url)return l.error("请输入URL地址");await s({loading:"正在添加，请稍后...",request:C({url_rule:E.url}),message:!0}),E.url="";break;case"ip":if(!t(E.startIP)||!t(E.endIP))return l.error("IP地址格式不正确");await s({loading:"正在添加，请稍后...",request:v({start_ip:E.startIP,end_ip:E.endIP}),message:!0}),E.startIP="",E.endIP=""}Q()},K=async()=>{await n({title:"清空白名单",content:"是否清空白名单？",icon:"warning-filled"}),await s({loading:"正在清空，请稍后...",request:H({type:E.type+"_white"}),message:!0,success:e=>{e.status&&Q()}})},Q=async()=>{await s({loading:N,request:R(),data:{ip_white:[Array,O],url_white:[Array,T]}})},S=async(e,a)=>{const t="url"===E.type;t?a-=1:a=O.value.findIndex((a=>a.at(0)===e.at(0)&&a.at(1)===e.at(1))),await s({loading:"正在删除，请稍后...",request:t?A({index:a}):L({index:a}),message:!0,success:e=>{e.status&&Q()}})},W=[{label:"起始IP",render:e=>I("span",e.at(0))},{label:"结束IP",render:e=>I("span",e.at(1))},z([{onClick:S,title:"删除"}])],X=[{label:"URL",render:e=>I("span",e)},z([{onClick:S,title:"删除"}])];return f((()=>Q())),(a,t)=>{const l=k,s=U,n=r,d=q,u=i,p=o,c=e,I=y("bt-loading");return P(),_("div",B,[h(s,{"tab-position":"left",modelValue:b(E).type,"onUpdate:modelValue":t[0]||(t[0]=e=>b(E).type=e),onTabClick:F,class:"w-[8%] mr-[2.4rem]"},{default:w((()=>[h(l,{label:"URL白名单",name:"url"}),h(l,{label:"IP白名单",name:"ip"})])),_:1},8,["modelValue"]),x("div",D,[h(c,{class:"flex-1"},{"header-left":w((()=>[g(x("div",G,[h(n,{modelValue:b(E).url,"onUpdate:modelValue":t[1]||(t[1]=e=>b(E).url=e),width:"30rem",placeholder:"URL地址，例如：/admin/update"},null,8,["modelValue"])],512),[[V,"url"===b(E).type]]),g(x("div",M,[h(n,{modelValue:b(E).startIP,"onUpdate:modelValue":t[2]||(t[2]=e=>b(E).startIP=e),width:"25rem",placeholder:"起始IP地址"},null,8,["modelValue"]),h(n,{modelValue:b(E).endIP,"onUpdate:modelValue":t[3]||(t[3]=e=>b(E).endIP=e),class:"ml-[0.8rem]",width:"25rem",placeholder:"结束IP地址"},null,8,["modelValue"])],512),[[V,"ip"===b(E).type]]),h(d,{type:"primary",title:"添加",onClick:J,class:"ml-[0.8rem]"},{default:w((()=>t[4]||(t[4]=[j(" 添加 ")]))),_:1}),h(d,{onClick:K},{default:w((()=>t[5]||(t[5]=[j("清空")]))),_:1})])),content:w((()=>[g(h(u,{column:"url"===b(E).type?X:W,data:"url"===b(E).type?b(T):b(O),"max-height":b(m)-360},null,8,["column","data","max-height"]),[[I,b(N)],[I,"正在加载列表，请稍后...","title"]])])),"footer-left":w((()=>[h(p,{"list-style":"disc",options:"ip"===b(E).type?b(E).ipHelp:b(E).urlHelp,class:"mt-[2rem] ml-[2rem]"},null,8,["options"])])),_:1})])])}}}),[["__scopeId","data-v-f97a4ae0"]]);export{N as default};
