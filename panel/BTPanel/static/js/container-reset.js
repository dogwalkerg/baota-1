import{c as e,r as a,h as t,o as l,k as s,l as r,e as m,x as u,p as o,C as i,y as n,D as d,N as p,q as y,a7 as c,a4 as f,A as b}from"./base-lib.js?v=1734676359";import{G as C,a4 as v,j as _}from"./utils-lib.js?v=1734676359";import{g,bA as x}from"./useStore3.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";const N={class:"pt-1.6rem"},R=e({__name:"container-reset",setup(e){const{refs:{currentConDetail:R},getCurrentCon:M}=g(),j=a(),V=t({Name:"",MaximumRetryCount:0}),q=[{value:"no",label:"不重启"},{value:"unless-stopped",label:"仅非正常退出的时候重启"},{value:"always",label:"停止后马上重启"},{value:"on-failure",label:"失败后重启"}],w={MaximumRetryCount:[{required:!0,message:"请输入最大重试计数",trigger:["blur"]},{type:"number",message:"请输入正整数",min:0,trigger:["blur"]}]};return l((async()=>{var e,a;V.Name=(null==(e=R.value.HostConfig)?void 0:e.RestartPolicy.Name)||"",V.MaximumRetryCount=(null==(a=R.value.HostConfig)?void 0:a.RestartPolicy.MaximumRetryCount)||0})),(e,a)=>{const t=v,l=c,g=_,h=f,k=b;return s(),r("div",N,[m(h,{ref_key:"cmdFormRef",ref:j,model:o(V),rules:w,onSubmit:a[2]||(a[2]=p((()=>{}),["prevent"]))},{default:u((()=>[m(l,{prop:"type",label:"重启策略"},{default:u((()=>[m(t,{modelValue:o(V).Name,"onUpdate:modelValue":a[0]||(a[0]=e=>o(V).Name=e),options:q,class:"!w-[20rem]"},null,8,["modelValue"])])),_:1}),i(m(l,{prop:"MaximumRetryCount",label:"最大重试计数"},{default:u((()=>[m(g,{width:"20rem",type:"number",modelValue:o(V).MaximumRetryCount,"onUpdate:modelValue":a[1]||(a[1]=e=>o(V).MaximumRetryCount=e),modelModifiers:{number:!0},placeholder:"请输入最大重试计数",min:0,textType:"次"},{append:u((()=>a[4]||(a[4]=[n(" 次 ")]))),_:1},8,["modelValue"])])),_:1},512),[[d,"on-failure"==o(V).Name]])])),_:1},8,["model"]),m(k,{class:"ml-[10rem]",title:"保存策略",type:"primary",onClick:a[3]||(a[3]=e=>(async()=>{await j.value.validate();const e={id:R.value.Id,restart_policy:{Name:V.Name}};"on-failure"==V.Name&&(e.restart_policy.MaximumRetryCount=Number(V.MaximumRetryCount)),C({loading:"正在保存策略,请稍后...",request:x({data:JSON.stringify(e)}),message:!0,success:async e=>{e.status&&M(R.value.Id)}})})())},{default:u((()=>a[5]||(a[5]=[n("保存策略")]))),_:1}),a[6]||(a[6]=y("ul",{class:"tips mt-[3.4rem] list-square ml-[10rem]"},[y("li",{class:"mt-[4px]"},"手动关闭的将不会自动启动")],-1))])}}});export{R as default};
