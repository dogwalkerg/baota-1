import{c as e,r as a,h as l,R as t,o as s,k as o,l as r,e as m,x as p,p as d,M as u,q as i,C as n,D as c,y as h,N as f,a7 as g,Q as V,aa as y,A as b,a4 as v}from"./base-lib.js?v=1734676359";import{_}from"./index88.js?v=1734676359";import{G as x,U as w,j,a4 as U,e as C}from"./utils-lib.js?v=1734676359";import{g as E,P as k,bB as q}from"./useStore3.js?v=1734676359";import{f as D}from"./validator.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";import"./column.js?v=1734676359";const I={class:"container-dialog"},S={class:"flex items-center"},A={class:"mt-[2.4rem]"},N={class:"flex items-center"},P=C(e({__name:"container-mirror",props:{compData:{default:()=>({})}},setup(e){const{refs:{currentConDetail:C},getCurrentCon:P}=E(),R=e,z=a("easy"),B=[{label:"简单模式",value:"easy"},{label:"高级模式",value:"more"}],F=l({repository:"",tag:"latest",stash:"official",message:"",author:"",isExport:[],path:"",name:""}),G=t([]),H=a(),J={repository:[{required:!0,trigger:["blur","change"],message:"请输入镜像名"}]},M=()=>{D({type:"dir",change:e=>{F.path=e}})},O=async()=>{await H.value.validate();const e={id:R.compData.row.id,repository:F.repository,tag:F.tag};"more"==z.value&&(e.message=F.message,e.author=F.author,e.repository="".concat(""!=F.stash?F.stash+"/":"").concat(F.repository),F.isExport.length>0&&(e.path=F.path,e.name=F.name)),x({request:q({data:JSON.stringify(e)}),message:!0,success:async e=>{e.status&&(await P(C.value.Id),z.value="easy",Q())}})},Q=()=>{F.repository="",F.tag="latest",F.stash="official",F.message="",F.author="",F.isExport=[],F.path="",F.name="",H.value.clearValidate()};return s((async()=>{await x({request:k(),data:Array,success:e=>{G.value=e.map((e=>({label:e.name,value:"docker.io"===e.url?"official":e.namespace})))}})})),(e,a)=>{const l=w,t=g,s=j,x=U,C=V,E=y,k=_,q=b,D=v;return o(),r("div",I,[m(D,{ref_key:"cmdFormRef",ref:H,model:d(F),rules:J,"label-position":"right",onSubmit:a[10]||(a[10]=f((()=>{}),["prevent"]))},{default:p((()=>[m(t,{style:{"margin-bottom":"1.5rem"},label:"创建方式"},{default:p((()=>[m(l,{type:"button",modelValue:d(z),"onUpdate:modelValue":a[0]||(a[0]=e=>u(z)?z.value=e:null),options:B},null,8,["modelValue"])])),_:1}),m(t,{prop:"repository",style:{"margin-bottom":"1.5rem"},label:"镜像名"},{default:p((()=>[m(s,{modelValue:d(F).repository,"onUpdate:modelValue":a[1]||(a[1]=e=>d(F).repository=e),width:"24rem",placeholder:"请输入镜像名"},null,8,["modelValue"])])),_:1}),m(t,{prop:"path",label:"版本号",display:"flex"},{default:p((()=>[i("div",S,[m(s,{modelValue:d(F).tag,"onUpdate:modelValue":a[2]||(a[2]=e=>d(F).tag=e),width:"24rem",placeholder:"请输入版本号"},null,8,["modelValue"]),a[11]||(a[11]=i("span",{class:"ml-[1rem] text-[#666] text-[1.2rem] whitespace-nowrap"},"默认：latest",-1))])])),_:1}),n(i("div",null,[m(t,{prop:"path",label:"仓库地址"},{default:p((()=>[m(x,{modelValue:d(F).stash,"onUpdate:modelValue":a[3]||(a[3]=e=>d(F).stash=e),options:d(G),class:"!w-[24rem]",placeholder:"请选择仓库地址"},null,8,["modelValue","options"])])),_:1}),m(t,{prop:"path",label:"描述"},{default:p((()=>[m(s,{modelValue:d(F).message,"onUpdate:modelValue":a[4]||(a[4]=e=>d(F).message=e),width:"24rem",placeholder:"描述"},null,8,["modelValue"])])),_:1}),m(t,{prop:"path",label:"作者"},{default:p((()=>[m(s,{modelValue:d(F).author,"onUpdate:modelValue":a[5]||(a[5]=e=>d(F).author=e),width:"24rem",placeholder:"作者"},null,8,["modelValue"])])),_:1}),i("div",A,[m(E,{modelValue:d(F).isExport,"onUpdate:modelValue":a[6]||(a[6]=e=>d(F).isExport=e),class:"mb-[2rem] ml-[10rem]"},{default:p((()=>[m(C,{size:"default",label:"生成镜像并导出压缩包",value:"生成镜像并导出压缩包"})])),_:1},8,["modelValue"]),n(m(t,{label:" "},{default:p((()=>[m(k,{modelValue:d(F).path,"onUpdate:modelValue":a[7]||(a[7]=e=>d(F).path=e),class:"!w-[24rem]",icon:"el-folder-opened",onIconClick:M,onChangePassive:a[8]||(a[8]=e=>{F.path=F.path.replace(/\s+/g,"")}),placeholder:"请输入镜像路径"},null,8,["modelValue"])])),_:1},512),[[c,d(F).isExport.length>0]]),n(m(t,{prop:"path",label:"文件名"},{default:p((()=>[i("div",N,[m(s,{modelValue:d(F).name,"onUpdate:modelValue":a[9]||(a[9]=e=>d(F).name=e),width:"24rem",placeholder:"文件名"},null,8,["modelValue"]),a[12]||(a[12]=i("span",{class:"ml-[1rem]"},".tar",-1))])])),_:1},512),[[c,d(F).isExport.length>0]])])],512),[[c,"more"==d(z)]]),m(q,{type:"primary",class:"ml-[10rem]",onClick:O},{default:p((()=>a[13]||(a[13]=[h("生成镜像")]))),_:1})])),_:1},8,["model"])])}}}),[["__scopeId","data-v-8ad6e595"]]);export{P as default};
