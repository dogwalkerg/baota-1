import{l as e,H as a,G as t,S as r,F as s,k as l,V as o,o as n}from"./utils-lib.js?v=1734676359";import{_ as i}from"./index90.js?v=1734676359";import{_ as p}from"./index97.js?v=1734676359";import{c as d,r as m,h as u,e as _,o as c,B as f,k as y,l as g,x as b,y as j,p as v,M as w,C as h,q as x,v as S,A as E}from"./base-lib.js?v=1734676359";import{y as V,z as k}from"./firewall.js?v=1734676359";import{r as q,d as A,e as F}from"./useMethod4.js?v=1734676359";import{getFirewallStore as O}from"./useStore4.js?v=1734676359";import{a as C}from"./column.js?v=1734676359";import{_ as H}from"./index.vue_vue_type_script_setup_true_lang11.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./validator.js?v=1734676359";import"./index91.js?v=1734676359";const I={class:"mt-16px leading-8 text-[1.2rem] list-disc ml-[2rem]"},J=d({__name:"index",setup(d){const{refs:{firewallInfo:J,systemTabActive:N}}=O(),T=m(null),U=m([]),D=m(""),M=m(0),P=m(!1),R=u({p:1,limit:20}),z=(t,r)=>{e({title:t?"修改地区规则":"添加地区规则",area:44,component:()=>a((()=>import("./add-area-rule.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),showFooter:!0,compData:{...r,isEdit:t,refreshFn:B}})},B=async(e=1)=>{"area"===N.value&&await t({loading:P,request:V({data:JSON.stringify({...R,query:D.value})}),data:{data:[Array,U],page:r(M)}})},G=[C(),{label:"地区",render:e=>_("span",null,[e.country+"("+e.brief+")"])},{label:"策略",render:(e,a)=>_("span",{class:"text-"+("accept"===e.types?"primary":"danger")},["accept"==e.types?"放行":"禁止"])},{label:"端口",render:e=>_("span",null,[e.ports?e.ports:"全部"])},{label:"时间",prop:"addtime",renderHeader:()=>q("时间","-- : 表示面板数据库中未记录创建时间，规则从系统中直接读取，忽略即可")},A({editEvent:e=>z(!0,e),deleteEvent:async e=>{await n({icon:"warning-filled",title:"删除地区规则",content:"删除选中规则后，该规则屏蔽的地区，端口将恢复正常访问，是否继续操作？"});const a={...e,s_port:e.start_port,d_port:e.ended_port,d_ip:e.ended_ip};delete a.start_port,a.ended_port,a.ended_ip,await t({loading:"正在删除规则，请稍后...",request:k({data:JSON.stringify(a)}),message:!0,success:B})}})],L=[{label:"删除",value:"delete",event:async(e,a)=>{await F(e,a,(async e=>{const a={...e,s_port:e.start_port,d_port:e.ended_port,d_ip:e.ended_ip};return delete a.start_port,a.ended_port,a.ended_ip,await k({data:JSON.stringify(a)})}),{label:"地区",prop:"country"},B)}}];return c((()=>B())),(e,a)=>{const t=E,r=s,n=l,d=o,m=p,u=i,c=f("bt-loading");return y(),g("div",null,[_(u,null,{"header-left":b((()=>[_(t,{type:"primary",onClick:a[0]||(a[0]=e=>z())},{default:b((()=>a[6]||(a[6]=[j(" 添加地区规则 ")]))),_:1}),_(H,{type:"country_rule",refreshFn:B})])),"header-right":b((()=>[_(r,{class:"!w-[32rem]",modelValue:v(D),"onUpdate:modelValue":a[1]||(a[1]=e=>w(D)?D.value=e:null),onSearch:a[2]||(a[2]=e=>B()),placeholder:"请输入地区"},null,8,["modelValue"])])),content:b((()=>[h(_(n,{ref_key:"areaTableRef",ref:T,column:G,data:v(U),description:"地区列表为空"},null,8,["data"]),[[c,v(P)],[c,"正在加载地区列表，请稍后...","title"]])])),"footer-left":b((()=>[_(d,{"table-ref":v(T),options:L},null,8,["table-ref"])])),"footer-right":b((()=>[_(m,{total:v(M),page:v(R).p,"onUpdate:page":a[3]||(a[3]=e=>v(R).p=e),row:v(R).limit,"onUpdate:row":a[4]||(a[4]=e=>v(R).limit=e),onChange:a[5]||(a[5]=e=>B()),name:"area"},null,8,["total","page","row"])])),_:1}),x("ul",I,[x("li",null,"每隔一个月会自动更新一次最新的IP池，最近更新时间："+S(v(J).update_time),1)])])}}});export{J as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
