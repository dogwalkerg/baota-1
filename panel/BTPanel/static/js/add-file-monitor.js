import{G as a,O as e}from"./utils-lib.js?v=1734676359";import{c as t,h as s,r as o,i as l,o as i,k as r,l as p,e as d,x as n,p as c,I as m,aX as u,a7 as f,aa as h,a4 as b,q as _,v as g,Q as D}from"./base-lib.js?v=1734676359";import{_ as j}from"./index88.js?v=1734676359";import{bq as w}from"./firewall.js?v=1734676359";import{f as y}from"./validator.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";import"./column.js?v=1734676359";const x={class:"p-20px"},v=t({__name:"add-file-monitor",props:{compData:{default:()=>{}}},setup(t,{expose:v}){const V=t,q=s({path:"",type:"dir",domain:V.compData.name,actions:[]}),k=o(),C=l((()=>"dir"===q.type)),I=[{name:"read",title:"读取"},{name:"del",title:"删除"},{name:"reit",title:"修改/增加"}],O={path:[{required:!0,message:"请选择监测路径",trigger:"blur"}],actions:[{required:!0,message:"请选择告警操作",trigger:"change"}]},U=()=>{V.compData.row||y({type:"all",path:q.path,change:(a,e)=>{q.path=a,q.type=e,q.actions="dir"===e?["read"]:["read","del","reit"]}})};return i((()=>(()=>{if(V.compData.path&&(q.path=V.compData.path.replace("//","/")),V.compData.row){const a=["del","read","reit"],e=[];Object.entries(V.compData.row).forEach((([t,s])=>{a.includes(t)&&Number(s)&&e.push(t)})),q.type=V.compData.row.type,q.actions=e}})())),v({onConfirm:async e=>{await k.value.validate();let t={...q},s=[0,0,0,0];q.actions.includes("read")&&(s[0]=1),q.actions.includes("del")&&(s[1]=1),q.actions.includes("reit")&&(s[2]=1,s[3]=1),t.actions=s.join(","),await a({loading:"正在添加文件监视器，请稍后...",request:w(!!V.compData.row,{...t}),message:!0,success:a=>{a.status&&(V.compData.refresh&&V.compData.refresh(),e())}})}}),(a,t)=>{const s=j,o=f,l=D,i=h,w=b,y=e;return r(),p("div",x,[d(w,{model:c(q),ref_key:"addFileMonitorRef",ref:k,rules:O},{default:n((()=>[d(o,{prop:"path",label:"监测路径"},{default:n((()=>[d(s,{modelValue:c(q).path,"onUpdate:modelValue":t[0]||(t[0]=a=>c(q).path=a),class:"!w-[28rem]",icon:"icon-file_mode",onIconClick:U,disabled:!!V.compData.row,onChangePassive:t[1]||(t[1]=a=>{q.path=q.path.replace(/\s+/g,"")}),placeholder:"请选择文件目录"},null,8,["modelValue","disabled"])])),_:1}),d(o,{label:"告警操作",prop:"actions"},{default:n((()=>[d(i,{modelValue:c(q).actions,"onUpdate:modelValue":t[2]||(t[2]=a=>c(q).actions=a)},{default:n((()=>[(r(),p(m,null,u(I,((a,e)=>d(l,{key:e,label:a.name,disabled:c(C)&&e>0},{default:n((()=>[_("div",null,[_("span",null,g(a.title),1)])])),_:2},1032,["label","disabled"]))),64))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"]),d(y,{options:[{content:"目录暂时只支持读取告警操作"}],class:"ml-20px mt-20px","list-style":"disc"})])}}});export{v as default};
