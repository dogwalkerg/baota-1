import{c as e,h as a,r as s,bF as l,o,k as t,l as n,q as r,y as u,I as i,aX as c,F as p,v as d,C as v,D as m,p as y,e as x,x as f,J as b,z as h,M as _,P as k,aw as M,a7 as g,a4 as w,A as j,bj as C}from"./base-lib.js?v=1734676359";import{u as V,ab as q,aI as I,b as U,e as F}from"./utils-lib.js?v=1734676359";import{q as H}from"./validator.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";import"./column.js?v=1734676359";const z={class:"nps-survey-box"},B={class:"py-[40px] px-[30px]"},E={class:"nps-survey-score h-[130px]"},J={id:"survey-score",class:"flex items-center justify-around"},N={class:"survey-score-num small"},A=["data-content","onMouseover","onMouseleave","onClick"],D={class:"survey-score-num medium"},G=["data-content","onMouseover","onMouseleave","onClick"],O={class:"survey-score-num large"},P=["data-content","onMouseover","onMouseleave","onClick"],S={class:"flex flex-col items-center"},X={class:"nps-survey-title"},$={key:0,class:"text-danger"},K={class:"text-[14px]"},L={key:0,class:"nps-surver-tips"},Q=F(e({__name:"index",emits:["close"],setup(e,{emit:F}){const Q=F,{proxy:R}=C(),{load:T,error:W}=U(),{panel:Y}=V(),Z=a({}),ee=s([]),ae=s(!1),se=s(0),le=s(0),oe=e=>se.value===e||le.value===e,te=(e,a)=>{if(le.value===a)return!1;se.value=a},ne=(e,a,s)=>{ee.value[s].error=""==e?"问题答案不可为空":"",Z[a]=e,R.$forceUpdate()},re=(e,a)=>{if(le.value===a)return!1;se.value=-1},ue=(e,a)=>{if(!ee.value.length)return W("暂时无法进行评分哦~请刷新页面重试"),!1;le.value=a},ie=async()=>{try{await ee.value.forEach((e=>{if(""!=e.error)throw W("还有必填项没有填写哦~"),new Error("还有必填项没有填写哦~")}));let e=T("正在提交问卷，请稍后...");(await I({questions:JSON.stringify(Z),product_type:0,rate:le.value,software_name:"panel"})).status&&(e.close(),Q("close"),H())}catch(e){}};return l((async()=>{try{const{data:e}=await q({version:-1,product_type:0});ee.value=e,ee.value=[{id:4,hint:"您在使用产品过程中有什么需求没有被满足，或遇到什么BUG没被解决，请将您的问题或需求详细描述给我们，我们尽力为您解决及开发对应的功能",product_type:0,question:"您的哪些需求在宝塔面板上还没有被满足的?",required:1,version:0,textarea:!0,isHint:!0}],ee.value.forEach((e=>{Z[e.id]=""}))}catch(e){}})),o((async()=>{Y.value.panelNps=!0})),(e,a)=>{const s=k,l=M,o=g,C=w,V=j;return t(),n("div",z,[a[5]||(a[5]=r("div",{class:"nps-survey-banner"},[r("span",null,[r("i"),u(),r("span",{style:{"vertical-align":"4px"}},"宝塔面板产品体验调查")])],-1)),r("div",B,[r("div",E,[a[2]||(a[2]=r("div",{class:"text-[20px] font-bold text-center text-[#000]"},"您向朋友或同事推荐宝塔面板的可能性有多大?",-1)),r("div",J,[r("ul",N,[(t(),n(i,null,c([1,2,3,4,5,6],(e=>r("li",{"data-content":e,class:p({act:oe(e)}),onMouseover:a=>te(0,e),onMouseleave:a=>re(0,e),onClick:a=>ue(0,e)},d(oe(e)?"".concat(e,"分"):e),43,A))),64))]),r("ul",D,[(t(),n(i,null,c([7,8],(e=>r("li",{"data-content":e,class:p({act:oe(e)}),onMouseover:a=>te(0,e),onMouseleave:a=>re(0,e),onClick:a=>ue(0,e)},d(e+(oe(e)?"分":"")),43,G))),64))]),r("ul",O,[(t(),n(i,null,c([9,10],(e=>r("li",{"data-content":e,class:p({act:oe(e)}),onMouseover:a=>te(0,e),onMouseleave:a=>re(0,e),onClick:a=>ue(0,e)},d(oe(e)?"".concat(e,"分"):e),43,P))),64))])])]),v(r("div",S,[x(C,{ref:"npsForm","label-position":"top",model:y(Z),size:"default"},{default:f((()=>[(t(!0),n(i,null,c(y(ee),((e,u)=>(t(),b(o,{label:"",key:u,error:e.error},{label:f((()=>[r("span",X,[e.required?(t(),n("span",$,"*")):h("",!0),r("span",K,d(e.question),1)]),e.textarea?h("",!0):(t(),n("span",L,d(e.hint),1))])),default:f((()=>[e.textarea?(t(),b(l,{key:0,ref_for:!0,ref:"popover",placement:"top-start","popper-class":"green-tips-popover p-20px !border-none",title:"",width:"51.2rem",visible:y(ae),"onUpdate:visible":a[1]||(a[1]=e=>_(ae)?ae.value=e:null),trigger:"focus",content:e.hint},{reference:f((()=>[x(s,{type:"textarea",onFocus:a[0]||(a[0]=e=>ae.value=!0),class:"!w-[51.2rem]",rows:6,maxlength:500,placeholder:e.isHint?e.hint:"",modelValue:y(Z)[e.id],"onUpdate:modelValue":a=>y(Z)[e.id]=a,onInput:a=>ne(a,e.id,u),onBlur:a=>e.isHint=!0},null,8,["placeholder","modelValue","onUpdate:modelValue","onInput","onBlur"])])),_:2},1032,["visible","content"])):(t(),b(s,{key:1,class:"w-[51.2rem]",maxlength:500,placeholder:"请填写问题答案",modelValue:y(Z)[e.id],"onUpdate:modelValue":a=>y(Z)[e.id]=a,onInput:a=>ne(a,e.id,u)},null,8,["modelValue","onUpdate:modelValue","onInput"]))])),_:2},1032,["error"])))),128))])),_:1},8,["model"]),a[4]||(a[4]=r("div",{class:"text-primary leading-[3.5rem] mb-[1rem]"},"我们特别重视您的需求反馈，我们会每周进行需求评审。希望能更好的帮到您",-1)),x(V,{class:"w-[12.5rem]",size:"large",type:"primary",onClick:ie},{default:f((()=>a[3]||(a[3]=[u("提交")]))),_:1})],512),[[m,0!==y(le)]])])])}}}),[["__scopeId","data-v-179700dc"]]);export{Q as default};
