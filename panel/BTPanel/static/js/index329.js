import{c as e,r as a,h as l,o as t,k as s,l as r,e as o,x as d,p as i,J as m,y as n,P as u,a7 as p,a4 as c}from"./base-lib.js?v=1734676359";import{_ as b}from"./validator.js?v=1734676359";import{j as f,b as g}from"./utils-lib.js?v=1734676359";import{g as y}from"./useStore10.js?v=1734676359";import{E as _,F as v}from"./ssl.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";import"./column.js?v=1734676359";const V={class:"p-2rem"},w=e({__name:"index",props:{compData:{default:()=>{}}},emits:["close"],setup(e,{expose:w,emit:h}){const j=e,x=h,D=g(),{refs:{tabActive:E,isRefreshDomainList:U,isRefreshCertificateList:k}}=y(),q=a(),C=a(!1),L=l({domain:"",title:"",cycle:30,allSsl:!1,total:2,sender:[]}),R=a({cycle:[{required:!0,message:"请输入剩余天数",trigger:"blur"},{validator:(e,a,l)=>{/^[1-9]\d*$/.test(a)?l():l(new Error("请输入大于0的正整数"))},trigger:["blur","change"]}],total:[{required:!0,message:"请输入总发送上线",trigger:"blur"},{validator:(e,a,l)=>{/^\d+$/.test(a)?l():l(new Error("请输入大于等于0的正整数"))},trigger:["blur","change"]}],sender:[{required:!0,message:"请选择通知方式",trigger:"blur"},{validator:(e,a,l)=>{0===a.length?l(new Error("请选择通知方式")):l()},trigger:["blur","change"]}]});return t((()=>{"domain"===E.value?L.domain=j.compData.domain:L.title=j.compData.title})),w({onConfirm:async()=>{try{if(!(await q.value.validate()))return;C.value=!0;let e={cycle:L.cycle,total:L.total,sender:L.sender.join(",")};"domain"===E.value?e.domain=L.domain:e.ssl_id=j.compData.ssl_id;const a="domain"===E.value?await _(e):await v(e);D.request(a),a.status&&("domain"===E.value?U.value=!0:k.value=!0,x("close"))}catch(e){}finally{C.value=!1}}}),(e,a)=>{const l=u,t=p,g=f,y=b,_=c;return s(),r("div",V,[o(_,{ref_key:"sslExpire",ref:q,disabled:i(C),rules:i(R),model:i(L),"label-width":"100px"},{default:d((()=>["domain"===i(E)?(s(),m(t,{key:0,label:"域名"},{default:d((()=>[o(l,{class:"!w-[28rem]",modelValue:i(L).domain,"onUpdate:modelValue":a[0]||(a[0]=e=>i(L).domain=e),disabled:""},null,8,["modelValue"])])),_:1})):(s(),m(t,{key:1,label:"证书"},{default:d((()=>[o(l,{class:"!w-[28rem]",modelValue:i(L).title,"onUpdate:modelValue":a[1]||(a[1]=e=>i(L).title=e),disabled:""},null,8,["modelValue"])])),_:1})),o(t,{label:"剩余天数",prop:"cycle"},{default:d((()=>[o(g,{modelValue:i(L).cycle,"onUpdate:modelValue":a[2]||(a[2]=e=>i(L).cycle=e),width:"14rem",textType:"天",min:"1",type:"number"},{append:d((()=>a[5]||(a[5]=[n(" 天 ")]))),_:1},8,["modelValue"])])),_:1}),o(t,{label:"总发送上限",prop:"total"},{default:d((()=>[o(g,{modelValue:i(L).total,"onUpdate:modelValue":a[3]||(a[3]=e=>i(L).total=e),width:"14rem",textType:"次",min:"0",type:"number"},{append:d((()=>a[6]||(a[6]=[n(" 次 ")]))),_:1},8,["modelValue"])])),_:1}),o(t,{label:"通知方式",prop:"sender"},{default:d((()=>[o(y,{modelValue:i(L).sender,"onUpdate:modelValue":a[4]||(a[4]=e=>i(L).sender=e),class:"!w-[28rem]"},null,8,["modelValue"])])),_:1})])),_:1},8,["disabled","rules","model"])])}}});export{w as default};
