!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(e,n,r){return(n=function(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,n||"default");if("object"!=t(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function u(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */u=function(){return n};var e,n={},r=Object.prototype,a=r.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},c=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function f(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(e){f=function(t,e,n){return t[e]=n}}function p(t,e,n,r){var a=e&&e.prototype instanceof b?e:b,u=Object.create(a.prototype),i=new q(r||[]);return o(u,"_invoke",{value:E(t,n,i)}),u}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}n.wrap=p;var v="suspendedStart",h="suspendedYield",m="executing",y="completed",g={};function b(){}function w(){}function x(){}var k={};f(k,c,(function(){return this}));var _=Object.getPrototypeOf,j=_&&_(_(N([])));j&&j!==r&&a.call(j,c)&&(k=j);var C=x.prototype=b.prototype=Object.create(k);function O(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function S(e,n){function r(o,u,i,c){var s=d(e[o],e,u);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==t(f)&&a.call(f,"__await")?n.resolve(f.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):n.resolve(f).then((function(t){l.value=t,i(l)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var u;o(this,"_invoke",{value:function(t,e){function a(){return new n((function(n,a){r(t,e,n,a)}))}return u=u?u.then(a,a):a()}})}function E(t,n,r){var a=v;return function(o,u){if(a===m)throw Error("Generator is already running");if(a===y){if("throw"===o)throw u;return{value:e,done:!0}}for(r.method=o,r.arg=u;;){var i=r.delegate;if(i){var c=L(i,r);if(c){if(c===g)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===v)throw a=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=m;var s=d(t,n,r);if("normal"===s.type){if(a=r.done?y:h,s.arg===g)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=y,r.method="throw",r.arg=s.arg)}}}function L(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,L(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=d(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var u=o.arg;return u?u.done?(n[t.resultName]=u.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):u:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function q(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function N(n){if(n||""===n){var r=n[c];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var o=-1,u=function t(){for(;++o<n.length;)if(a.call(n,o))return t.value=n[o],t.done=!1,t;return t.value=e,t.done=!0,t};return u.next=u}}throw new TypeError(t(n)+" is not iterable")}return w.prototype=x,o(C,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(C),t},n.awrap=function(t){return{__await:t}},O(S.prototype),f(S.prototype,s,(function(){return this})),n.AsyncIterator=S,n.async=function(t,e,r,a,o){void 0===o&&(o=Promise);var u=new S(p(t,e,r,a),o);return n.isGeneratorFunction(e)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},O(C),f(C,l,"Generator"),f(C,c,(function(){return this})),f(C,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},n.values=N,q.prototype={constructor:q,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(r,a){return i.type="throw",i.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var u=this.tryEntries[o],i=u.completion;if("root"===u.tryLoc)return r("end");if(u.tryLoc<=this.prev){var c=a.call(u,"catchLoc"),s=a.call(u,"finallyLoc");if(c&&s){if(this.prev<u.catchLoc)return r(u.catchLoc,!0);if(this.prev<u.finallyLoc)return r(u.finallyLoc)}else if(c){if(this.prev<u.catchLoc)return r(u.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<u.finallyLoc)return r(u.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var u=o?o.completion:{};return u.type=t,u.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(u)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var a=r.arg;P(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:N(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},n}function i(t,e,n,r,a,o,u){try{var i=t[o](u),c=i.value}catch(t){return void n(t)}i.done?e(c):Promise.resolve(c).then(r,a)}function c(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function u(t){i(o,r,a,u,c,"next",t)}function c(t){i(o,r,a,u,c,"throw",t)}u(void 0)}))}}System.register(["./utils-lib-legacy.js?v=1734676359","./index-legacy101.js?v=1734676359","./index-legacy90.js?v=1734676359","./index-legacy97.js?v=1734676359","./index-legacy99.js?v=1734676359","./index-legacy107.js?v=1734676359","./base-lib-legacy.js?v=1734676359","./useMethod-legacy2.js?v=1734676359","./column-legacy.js?v=1734676359","./useMethod-legacy3.js?v=1734676359","./validator-legacy.js?v=1734676359"],(function(t,n){"use strict";var r,o,i,s,l,f,p,d,v,h,m,y,g,b,w,x,k,_,j,C,O,S,E,L,T,P,q,N,A,V,D,F,G,I,M,U,B,R,W,z,J,H,Y,$,Z,K,Q,X,tt,et,nt,rt,at,ot,ut,it,ct,st,lt,ft,pt,dt,vt,ht,mt,yt,gt,bt,wt,xt;return{setters:[function(t){r=t.l,o=t.H,i=t.o,s=t.b,l=t.a5,f=t.a6,p=t.G,d=t.a7,v=t.M,h=t.u,m=t.F,y=t.a8,g=t.k,b=t.V,w=t.h},function(t){x=t._},function(t){k=t._},function(t){_=t._},function(t){j=t._},function(t){C=t.B},function(t){O=t.c,S=t.r,E=t.h,L=t.k,T=t.l,P=t.e,q=t.x,N=t.C,A=t.p,V=t.az,D=t.A,F=t.aZ,G=t.D,I=t.g,M=t.s,U=t.i,B=t.y,R=t.o,W=t.B,z=t.J,J=t.q,H=t.z,Y=t.M,$=t.aT},function(t){Z=t.g,K=t.a,Q=t.m,X=t.r,tt=t.c,et=t.e,nt=t.s,rt=t.b,at=t.d,ot=t.f,ut=t.h,it=t.i,ct=t.j,st=t.k,lt=t.l,ft=t.n,pt=t.o,dt=t.p},function(t){vt=t.a,ht=t.d,mt=t.b,yt=t.o,gt=t.u,bt=t.c},function(t){wt=t.o},function(t){xt=t.c}],execute:function(){var kt,_t=O({__name:"index",emits:["upload-success"],setup:function(t,e){var a=e.expose,l=e.emit,f=s(),p=l,d=S(),v=window.location.protocol+"//"+window.location.host+"/crontab?action=import_crontab_from_json",h=E({overwrite:1}),m=S([]),y=[".json"].join(","),g=function(){var t=c(u().mark((function t(e,a,i){var c,s,l,d;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!1!==e.status){t.next=5;break}return f.error(e.msg),t.abrupt("return");case 5:return d=[],null===(c=e.successful_tasks)||void 0===c||c.forEach((function(t){d.push({name:t,status:1,msg:"导入成功"})})),null===(s=e.failed_tasks)||void 0===s||s.forEach((function(t){d.push({name:t,status:0,msg:"导入失败"})})),null===(l=e.skipped_tasks)||void 0===l||l.forEach((function(t){d.push({name:t,status:2,msg:"重复任务已跳过"})})),t.next=11,r({title:"导入计划任务结果",area:42,component:function(){return o((function(){return n.import("./index-legacy102.js?v=1734676359")}),void 0,n.meta.url)},compData:{resultData:d,autoTitle:e.msg,resultColumn:[{label:"计划任务名称",prop:"name"},{label:"操作结果",align:"right",render:function(t){return V("span",{class:1===t.status?"text-primary":0===t.status?"text-danger":""},t.msg)}}]}});case 11:p("upload-success");case 12:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),b=function(){f.error("导入失败")},w={"x-http-token":window.vite_public_request_token},x=function(){var t=c(u().mark((function t(e){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.value=e,t.next=3,i({type:"check",title:"提示",content:"是否继续将文件中的数据导入到现有计划任务中？",check:{content:"跳过重复计划任务",value:!0,onConfirm:function(t){h.overwrite=t?1:0}}});case 3:if(!(n=t.sent)||h.overwrite){t.next=7;break}return t.next=7,i({icon:"warning",title:"提示",content:"导入重复的任务可能会导致系统服务异常，请谨慎操作！"});case 7:return t.abrupt("return",n);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),k=function(){var t=c(u().mark((function t(e,n){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:m.value=n;case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),_=function(t,e,n){m.value=n.map((function(n){return n.uid===e.uid&&(n.percentage=t.percent),n}))};return a({open:function(){d.value.$el.click()},fileData:h}),function(t,e){var n=D,r=F;return L(),T("div",null,[P(r,{class:"upload-demo",ref:"upload",name:"file",data:function(){return A(h)},action:v,headers:w,accept:A(y),"on-error":b,multiple:!1,"show-file-list":!1,"auto-upload":!0,"on-success":g,"on-progress":_,"file-list":A(m),"on-change":k,"before-upload":x},{default:q((function(){return[N(P(n,{ref_key:"openRef",ref:d,size:"small",type:"primary"},null,512),[[G,!1]])]})),_:1},8,["data","accept","file-list"])])}}}),jt=t("C",I("CRONTAB-VIEW-STORE",(function(){return{rowData:S({})}})))(),Ct=M(jt).rowData,Ot=t("w",l({route:"/ws_panel"})),St=S(),Et=S(),Lt=t("t",S([])),Tt=S(!1),Pt=S(0),qt=E({p:1,count:20,search:"",type_id:"all",order_param:""}),Nt=S([]),At=S(!0),Vt=S(!1),Dt=S(""),Ft=function(){return St.value.open()},Gt=(t("i",U((function(){var t=Ct.value,e=t.save,n=t.sType;return!(["enterpriseBackup","logs","special_log","toShell"].includes(n)||!e&&f(e))}))),function(){var t=c(u().mark((function t(e,n,r,a,o){var i,s,l,f,d,v;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=a.label,s=a.value,l=i.replace("任务",""),f=function(){var t=c(u().mark((function t(e,n){var r,a,o;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=new Map([["exec",at],["delete",pt]]),a=e.id,t.t0=s,t.next="exec"===t.t0||"delete"===t.t0?5:10;break;case 5:if(!(o=r.get(s))){t.next=10;break}return t.next=9,o({id:a});case 9:return t.abrupt("return",t.sent);case 10:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),d=function(){var t=c(u().mark((function t(e,n){var r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=JSON.stringify(n.map((function(t){return t.id}))),e.unmount(),o(),t.next=5,p({loading:"正在执行，请稍后...",request:ft({id_list:r,type:s,if_stop:"False"}),success:function(t){var e=t.data.map((function(t){var e=Object.entries(t)[0];return{msg:t.status?l+"成功":e[1],name:e[0],status:t.status}}));wt(e,{title:"".concat(l,"计划任务")})}});case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),v=function(){var t=c(u().mark((function t(e,n){var r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=JSON.stringify(n.map((function(t){return t.id}))),e.unmount(),o(),t.next=5,p({loading:"正在执行，请稍后...",request:et({ids:r}),success:function(t){window.open("/download?filename="+t.msg.replace("导出成功!,下载路径为",""))}});case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),t.next=7,e({title:"批量".concat(l,"计划任务"),content:"即将批量".concat(l,"选中的计划任务，是否继续操作?"),column:[{label:"计划任务",prop:"name"},bt()],onConfirm:function(){var t=c(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=s,t.next="start"===t.t0||"stop"===t.t0?3:"delete"===t.t0||"exec"===t.t0?6:"out"===t.t0?9:12;break;case 3:return t.next=5,d(e,r.value);case 5:case 8:case 11:return t.abrupt("break",12);case 6:return t.next=8,n(f);case 9:return t.next=11,v(e,r.value);case 12:return Ut(),t.abrupt("return",!1);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()});case 7:case"end":return t.stop()}}),t)})));return function(e,n,r,a,o){return t.apply(this,arguments)}}()),It=[{label:"执行任务",value:"exec",event:Gt},{label:"启动任务",value:"start",event:Gt},{label:"停止任务",value:"stop",event:Gt},{label:"设置分类",value:"setClass",event:(kt=c(u().mark((function t(e,n,r,a,o){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,xt({name:"计划任务分类",options:Nt.value.filter((function(t){return"all"!==t.value&&t.value>0})),selectList:r.value,request:function(){var t=c(u().mark((function t(e,n){var a;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=JSON.stringify(r.value.map((function(t){return t.id}))),t.next=3,p({loading:"正在批量设置分类，请稍后...",request:nt({id:e.id,crontab_ids:a}),message:!0});case 3:o(),n(),Ut();case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()});case 2:case"end":return t.stop()}}),t)}))),function(t,e,n,r,a){return kt.apply(this,arguments)})},{label:"导出任务",value:"out",event:Gt},{label:"删除任务",value:"delete",event:Gt}],Mt=(t("o",function(){var t=c(u().mark((function t(e){var n,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ct({id:Ct.value.id});case 3:n=t.sent,(r=n.data).status?(yt({path:r.msg}),e&&e()):v.request(r),t.next=10;break;case 8:t.prev=8,t.t0=t.catch(0);case 10:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()),function(t){t.column;var e=t.prop,n=t.order;qt.order_param=n?e+("ascending"===n?" asc":" desc"):"",Ut()}),Ut=t("g",c(u().mark((function t(){var e;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=a({},qt),"all"===qt.type_id&&(e.type_id=""),t.next=5,p({loading:Tt,request:Z(e),data:{data:[Array,Lt],page:Object},success:function(t){Pt.value=d(t.page)}});case 5:t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0);case 10:return t.prev=10,Tt.value=!1,t.finish(10);case 13:case"end":return t.stop()}}),t,null,[[0,7,10,13]])})))),Bt=function(){var t=c(u().mark((function t(){var e;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,rt();case 3:e=t.sent,At.value=Boolean(e.status),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}(),Rt=t("s",function(){var t=c(u().mark((function t(e){var n,r,a,o=arguments;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={},r=(n=o.length>1&&void 0!==o[1]&&o[1])?{id:Ct.value.id}:{id:e.id},t.prev=3,t.next=6,at(r);case 6:a=t.sent,v.request(a),n||Wt(e),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(3);case 14:case"end":return t.stop()}}),t,null,[[3,11]])})));return function(e){return t.apply(this,arguments)}}()),Wt=function(t){Ct.value=t,r({title:"查看【"+(t.rname||t.name)+"】日志",area:80,component:function(){return o((function(){return n.import("./index-legacy103.js?v=1734676359")}),void 0,n.meta.url)}})},zt=function(){var t=c(u().mark((function t(e,n){var r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,"top"!=n){t.next=7;break}return t.next=4,st({task_id:e.id});case 4:r=t.sent,t.next=11;break;case 7:if("untop"!=n){t.next=11;break}return t.next=10,lt({task_id:e.id});case 10:r=t.sent;case 11:v.request(r),Ut(),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(0);case 18:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(e,n){return t.apply(this,arguments)}}(),Jt=function(){var t=c(u().mark((function t(e){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=!e.status,t.next=4,i({title:"".concat(n?"启用":"停用","计划任务"),content:"该计划任务".concat(n?"已停止":"正在运行","，是否要").concat(n?"启用":"停用","这个计划任务？")});case 4:return t.next=6,p({loading:"正在设置计划任务状态，请稍候...",request:ot({id:Number.parseInt(e.id),if_stop:n?"False":"True"}),message:!0});case 6:Ut(),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0);case 12:return t.prev=12,t.finish(12);case 14:case"end":return t.stop()}}),t,null,[[0,9,12,14]])})));return function(e){return t.apply(this,arguments)}}(),Ht=function(t){Ct.value=t||!1,r({title:"".concat(t?null!=t&&t.id?"编辑":"复制":"添加","计划任务"),area:100,showFooter:!0,component:function(){return o((function(){return n.import("./index-legacy105.js?v=1734676359").then((function(t){return t.i}))}),void 0,n.meta.url)}})},Yt=function(){var t=c(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p({request:ut(),data:{msg:Array},success:function(t){Nt.value=[{label:"全部分类",value:"all"},{label:"系统任务",value:"-1"},{label:"默认分类",value:"0"},{label:"正在运行",value:"-2"},{label:"已停止",value:"-3"}].concat(e(t.msg.map((function(t){return{label:t.name,value:t.id.toString()}}))))}});case 2:return t.abrupt("return",Promise.resolve(Nt.value||[]));case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),$t={getClassList:Yt,addClass:K,editClass:Q,deleteClass:X},Zt=function(){var t=c(u().mark((function t(e){var n,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.id,r=e.name,t.prev=1,t.next=4,i({title:"删除计划任务",content:"您确定要删除计划任务【".concat(r,"】，是否继续？")});case 4:return t.next=6,p({loading:"正在删除计划任务，请稍候...",request:it({id:n}),message:!0});case 6:Ut(),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}(),Kt=S([vt(),ht({event:function(t,e){zt(t,e)},param:"sort"}),{label:"任务名称",minWidth:250,sortable:"custom",showOverflowTooltip:!0,render:function(t){return t.rname||t.name}},{label:"分类",prop:"type_name",isCustom:!0},mt({event:Jt,sortable:"custom",data:["停用","正常"]}),{label:"执行周期",prop:"cycle",minWidth:150,isCustom:!0,showOverflowTooltip:!0},{label:"保存数量",isCustom:!0,render:function(t){return["site","database","enterpriseBack","path","mysql_increment_backup"].includes(t.sType)&&t.save?P("span",null,[t.save,B("份"),P("span",{class:"bt-link",onClick:function(){return function(t){Ct.value=t,r({title:"".concat(t.name,"-备份文件"),area:80,component:function(){return o((function(){return n.import("./index-legacy104.js?v=1734676359")}),void 0,n.meta.url)}})}(t)}},[B("[查看]")])]):"logs"===t.sType||"special_log"===t.sType?"".concat(t.save?t.save+"份":"--"):"--"}},{label:"备份到",minWidth:160,isCustom:!0,render:function(t){if("mysql_increment_backup"===t.sType||"enterpriseBackup"===t.sType){var e=t.backupTo.split("|"),n="";return e.forEach((function(t){return n+=tt[t]+","})),n.slice(0,-1)}var r=tt[t.backupTo];return"toShell"===t.sType?"--":r||"--"}},{label:"备份路径",prop:"db_backup_path",width:100,isCustom:!0,showOverflowTooltip:!0,render:function(t){return["site","database","path"].includes(t.sType)?P("span",{class:"bt-link",onClick:function(){return yt({path:t.db_backup_path})}},[t.db_backup_path]):"--"}},{label:"上次执行时间",prop:"addtime",minWidth:150,sortable:"custom",isCustom:!0},{label:"上次定时任务执行结果",prop:"result",isCustom:!1,minWidth:140,sortable:"custom",render:function(t){return P("span",{class:t.result?"text-primary":"text-danger"},[t.result?"正常":"异常"])}},gt([{onClick:function(t){return Rt(t)},title:"执行"},{onClick:Ht,title:"编辑"},{onClick:Wt,title:"日志"},{onClick:function(t){return Ht(a(a({},t),{},{id:""}))},title:"复制"},{onClick:Zt,title:"删除"}])]),Qt=function(){var t=c(u().mark((function t(){var e;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i({title:"一键修复",content:"此修复主要用于解决计划任务无法定时执行，请谨慎操作,是否继续?"});case 2:Vt.value=!0,e=[],Dt.value="开始修复计划任务...",Ot.request("/crontab/repair_crontab_service",{customType:"model",onMessage:function(t){t.includes("修复完成")?(v.success("修复成功"),Bt(),Vt.value=!1):(e.push(t),Dt.value=e.join("\n"))}});case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Xt=function(){var t=c(u().mark((function t(){var e;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==Lt.value.length){t.next=3;break}return v.error("暂无数据可导出"),t.abrupt("return");case 3:return t.prev=3,t.next=6,et();case 6:e=t.sent,window.open("/download?filename="+e.msg.replace("导出成功!,下载路径为","")),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3);case 13:case"end":return t.stop()}}),t,null,[[3,10]])})));return function(){return t.apply(this,arguments)}}(),te=function(){r({title:"日志切割设置",area:56,component:function(){return o((function(){return n.import("./index-legacy106.js?v=1734676359")}),void 0,n.meta.url)}})},ee={class:"flex items-center"},ne={class:"flex items-center"},re={class:"flex-wrap"},ae=O({__name:"index",setup:function(t){var e=h().mainHeight;return R((function(){return Ut(),Yt(),void Bt()})),function(t,n){var r=$,a=D,o=C,u=m,i=j,c=y,s=g,l=b,f=_,p=k,d=x,v=w,h=W("bt-loading");return L(),T("div",null,[A(At)?H("",!0):(L(),z(r,{key:0,closable:!1,type:"error",class:"!mb-[1.6rem]"},{title:q((function(){return[J("div",ee,[n[9]||(n[9]=J("i",{class:"svgtofont-el-warning-filled text-[#F56C6C] !text-[1.4rem] mr-[4px]"},null,-1)),n[10]||(n[10]=B(" 检测到当前计划任务服务异常，请及时修复，温馨提示：修复前请先临时关闭系统加固，否则可能导致修复失败。 ")),J("span",{class:"bt-link",onClick:n[0]||(n[0]=function(){return A(Qt)&&A(Qt).apply(void 0,arguments)})},"[ 一键修复 ]")])]})),_:1})),P(p,null,{"header-left":q((function(){return[P(a,{type:"primary",onClick:n[1]||(n[1]=function(t){return A(Ht)()})},{default:q((function(){return n[11]||(n[11]=[B("添加任务")])})),_:1}),P(a,{onClick:A(Ft)},{default:q((function(){return n[12]||(n[12]=[B("导入")])})),_:1},8,["onClick"]),P(a,{onClick:A(Xt)},{default:q((function(){return n[13]||(n[13]=[B("导出")])})),_:1},8,["onClick"]),P(a,{onClick:n[2]||(n[2]=function(t){return A(te)()})},{default:q((function(){return n[14]||(n[14]=[B("日志切割设置")])})),_:1}),P(_t,{ref_key:"fileRef",ref:St,onUploadSuccess:A(Ut)},null,8,["onUploadSuccess"]),J("div",{class:"flex items-center ml-4px",onClick:n[3]||(n[3]=function(t){return A(dt)()})},n[15]||(n[15]=[J("i",{class:"svgtofont-desired text-[1.6rem]"},null,-1),J("span",{class:"bt-link"},"需求反馈",-1)]))]})),"header-right":q((function(){return[J("div",ne,[P(o,{name:"CrontabTask",class:"mr-[10px] !w-[16rem]",modelValue:A(qt).type_id,"onUpdate:modelValue":n[4]||(n[4]=function(t){return A(qt).type_id=t}),options:A(Nt),field:"name",config:A($t),onChange:A(Ut),ignore:["-1","0","-2","-3"]},null,8,["modelValue","options","config","onChange"]),J("div",null,[P(u,{class:"!w-[26rem]",modelValue:A(qt).search,"onUpdate:modelValue":n[5]||(n[5]=function(t){return A(qt).search=t}),onSearch:A(Ut),onClear:A(Ut),placeholder:"支持任务名称模糊搜索"},null,8,["modelValue","onSearch","onClear"])]),P(i,{onRefresh:A(Ut),class:"!mx-[10px]"},null,8,["onRefresh"]),P(c,{name:"Crontab",column:A(Kt)},null,8,["column"])])]})),content:q((function(){return[N(P(s,{ref_key:"crontabRef",ref:Et,column:A(Kt),"max-height":A(e)-220,data:A(Lt),onSortChange:A(Mt)},null,8,["column","max-height","data","onSortChange"]),[[h,A(Tt)],[h,"正在加载中，请稍候...","title"]])]})),"footer-left":q((function(){return[P(l,{"table-ref":A(Et),options:A(It)},null,8,["table-ref","options"])]})),"footer-right":q((function(){return[P(f,{page:A(qt).p,"onUpdate:page":n[6]||(n[6]=function(t){return A(qt).p=t}),row:A(qt).count,"onUpdate:row":n[7]||(n[7]=function(t){return A(qt).count=t}),total:A(Pt),onChange:A(Ut)},null,8,["page","row","total","onChange"])]})),_:1}),P(v,{title:"正在修复服务，请耐心等候",modelValue:A(Vt),"onUpdate:modelValue":n[8]||(n[8]=function(t){return Y(Vt)?Vt.value=t:null}),area:[60]},{default:q((function(){return[J("div",re,[P(d,{class:"h-[40rem] !rounded-none",content:A(Dt)},null,8,["content"])])]})),_:1},8,["modelValue"])])}}}),oe=Object.freeze(Object.defineProperty({__proto__:null,default:ae},Symbol.toStringTag,{value:"Module"}));t("a",oe)}}}))}();
