import{_ as t}from"./index100.js?v=1734676359";import{_ as a}from"./index101.js?v=1734676359";import{_ as e}from"./index90.js?v=1734676359";import{t as s,G as l,u as n,J as r,aM as i,am as o,an as u,e as c}from"./utils-lib.js?v=1734676359";import{s as m,g as d,r as p,i as h,e as g,c as y,w as v,o as f,k as x,l as b,p as _,J as j,x as w,q as k,z as I,G as T}from"./base-lib.js?v=1734676359";import{b as L}from"./useController2.js?v=1734676359";import{S as O,T as S,u as q}from"./useStore6.js?v=1734676359";import{e as C}from"./validator.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index99.js?v=1734676359";import"./index272.js?v=1734676359";import"./column.js?v=1734676359";import"./index91.js?v=1734676359";const R=d("LOG-AUDIT-STORE",(()=>{const t=p([]),a=p(!1),e=p({title:"",uptime:0,list:[],name:"",log_file:"",size:0}),n=p(!0);return{menuOptions:t,currentItem:e,isInit:n,isRefreshList:a,getMenuList:async()=>{try{const t=t=>null==t?void 0:t.map((t=>(t.name="".concat(t.name,"-").concat(t.title).concat("string"==typeof t.size?"":"(".concat(s(t.size),")")),t))),a=await l({request:O(),data:[Array,t]});return e.value=a[0],{data:a,status:!0,msg:""}}catch(t){return{data:[],status:!1,msg:"获取日志菜单失败"}}},getLogData:async(t,a)=>{try{if(!t)return{data:"",total:0,other:{}};e.value=t;const s={log_name:t.log_file,...a},{data:n}=await l({loading:"正在获取日志详细数据,请稍候...",request:S({data:JSON.stringify(s)})});return{data:n,status:!0,msg:""}}catch(s){return{data:{},status:!1,msg:"请求失败"}}}}})),z=()=>{const t=R();return m(t)},{selectedItem:B}=q(),{currentItem:A,isInit:D,isRefreshList:G}=z(),{getLogData:H,getMenuList:J}=R(),{payment:M}=n(),P=p([]),E=p(""),N=p([]),U=p(!0),V=h((()=>U.value?"请输入来源/端口/角色/事件":"请输入关键字")),W=t=>{var a;try{return U.value=!0,0===t.length?(P.value=[{label:"时间",prop:"time"},{label:"角色",prop:""},{label:"事件",prop:""}],{data:[],total:0,other:{}}):(P.value=null==(a=Object.keys(t[0]))?void 0:a.map(((t,a)=>"事件"===t?{label:t,render:function(t){const a={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#x27;":"'"};return g("span",null,[t["事件"].replace(/&amp;|&lt;|&gt;|&quot;|&#39;|&#x27;/g,(t=>a[t]))])}}:{label:t,prop:t})),{data:t,total:t.length,other:{}})}catch(e){return{data:[],total:0,other:{}}}},F=t=>(U.value=!1,E.value=(null==t?void 0:t.join("\n"))||"暂无执行日志",{data:[],total:t.length,other:{}}),K=async t=>{try{if(t.name===B.value)return;B.value=t.name,A.value=t,G.value=!0}catch(a){}},Q={title:"日志审计-功能介绍",ps:"对系统、网络、应用程序等进行记录的各种操作、事件、异常情况等信息进行收集、分析和审计，通过对这些日志信息的审计，可以发现系统存在的安全问题，及时采取措施进行修复和防范。",source:104,desc:["分析和解析常用日志"],tabImgs:[{title:"日志审计",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/logs/logAudit_2.png"}]},X=c(y({__name:"index",setup(s){const{payment:l,mainHeight:c,mainWidth:m}=n(),{currentItem:d,isInit:p,isRefreshList:h}=z(),{BtTable:y,BtPage:O,BtSearch:S,BtRefresh:q,refresh:R}=o({request:async t=>await(async(t,a)=>{try{if("ltd"===M.value.authType){if(D.value){const{data:a}=await J();N.value=a,D.value=!1,t=N.value[0]}const{data:e}=await H(t,a);if(r(e))return F(e);if(i(e))return W(e.data)}}catch(e){return{data:[],total:0,other:{}}}})(d.value,t),columns:P,extension:[u(h)]});return v((()=>l.value.authType),(t=>{"ltd"===t&&R()})),f((async()=>{p.value=!0})),(s,n)=>{const r=e,i=a,o=t;return x(),b("div",null,["ltd"===_(l).authType?(x(),j(L,{key:0,logsType:"audit",menuOptions:_(N),width:36,onTabClick:_(K)},{LogView:w((()=>[k("div",{class:"flex-1",style:T("width:"+(_(m)-500)+"px")},[g(r,{class:"table-view"},{"header-left":w((()=>[k("div",{class:"flex items-center",onClick:n[0]||(n[0]=t=>_(C)({name:"日志",id:999,isCard:!1}))},n[1]||(n[1]=[k("i",{class:"svgtofont-desired text-[1.6rem]"},null,-1),k("span",{class:"bt-link"},"需求反馈",-1)]))])),"header-right":w((()=>[g(_(S),{placeholder:_(V),class:"!w-24rem"},null,8,["placeholder"]),g(_(q),{class:"ml-[10px]"})])),content:w((()=>[_(U)?(x(),j(_(y),{key:0,"max-height":_(c)-226,class:"my-8px"},null,8,["max-height"])):I("",!0)])),"footer-right":w((()=>[_(U)?(x(),j(_(O),{key:0,type:"unknown"})):I("",!0)])),_:1}),_(U)?I("",!0):(x(),j(i,{key:0,content:_(E),isHtml:!0,autoScroll:!0,style:T("height:"+(_(c)-172)+"px")},null,8,["content","style"]))],4)])),_:1},8,["menuOptions","onTabClick"])):(x(),j(o,{key:1,data:_(Q),class:"px-[20%] my-[2rem]"},null,8,["data"]))])}}}),[["__scopeId","data-v-d7ca1701"]]);export{X as default};
