!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function n(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?t(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function r(t,n,r){return(n=function(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,n||"default");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function a(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */a=function(){return n};var t,n={},r=Object.prototype,l=r.hasOwnProperty,u=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function p(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{p({},"")}catch(t){p=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var a=t&&t.prototype instanceof _?t:_,l=Object.create(a.prototype),o=new O(r||[]);return u(l,"_invoke",{value:q(e,n,o)}),l}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=d;var v="suspendedStart",m="suspendedYield",h="executing",w="completed",b={};function _(){}function x(){}function y(){}var g={};p(g,s,(function(){return this}));var k=Object.getPrototypeOf,V=k&&k(k(D([])));V&&V!==r&&l.call(V,s)&&(g=V);var j=y.prototype=_.prototype=Object.create(g);function P(e){["next","throw","return"].forEach((function(t){p(e,t,(function(e){return this._invoke(t,e)}))}))}function S(t,n){function r(a,u,o,s){var i=f(t[a],t,u);if("throw"!==i.type){var c=i.arg,p=c.value;return p&&"object"==e(p)&&l.call(p,"__await")?n.resolve(p.__await).then((function(e){r("next",e,o,s)}),(function(e){r("throw",e,o,s)})):n.resolve(p).then((function(e){c.value=e,o(c)}),(function(e){return r("throw",e,o,s)}))}s(i.arg)}var a;u(this,"_invoke",{value:function(e,t){function l(){return new n((function(n,a){r(e,t,n,a)}))}return a=a?a.then(l,l):l()}})}function q(e,n,r){var a=v;return function(l,u){if(a===h)throw Error("Generator is already running");if(a===w){if("throw"===l)throw u;return{value:t,done:!0}}for(r.method=l,r.arg=u;;){var o=r.delegate;if(o){var s=U(o,r);if(s){if(s===b)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===v)throw a=w,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=h;var i=f(e,n,r);if("normal"===i.type){if(a=r.done?w:m,i.arg===b)continue;return{value:i.arg,done:r.done}}"throw"===i.type&&(a=w,r.method="throw",r.arg=i.arg)}}}function U(e,n){var r=n.method,a=e.iterator[r];if(a===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,U(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),b;var l=f(a,e.iterator,n.arg);if("throw"===l.type)return n.method="throw",n.arg=l.arg,n.delegate=null,b;var u=l.arg;return u?u.done?(n[e.resultName]=u.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,b):u:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,b)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function D(n){if(n||""===n){var r=n[s];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var a=-1,u=function e(){for(;++a<n.length;)if(l.call(n,a))return e.value=n[a],e.done=!1,e;return e.value=t,e.done=!0,e};return u.next=u}}throw new TypeError(e(n)+" is not iterable")}return x.prototype=y,u(j,"constructor",{value:y,configurable:!0}),u(y,"constructor",{value:x,configurable:!0}),x.displayName=p(y,c,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===x||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,p(e,c,"GeneratorFunction")),e.prototype=Object.create(j),e},n.awrap=function(e){return{__await:e}},P(S.prototype),p(S.prototype,i,(function(){return this})),n.AsyncIterator=S,n.async=function(e,t,r,a,l){void 0===l&&(l=Promise);var u=new S(d(e,t,r,a),l);return n.isGeneratorFunction(t)?u:u.next().then((function(e){return e.done?e.value:u.next()}))},P(j),p(j,c,"Generator"),p(j,s,(function(){return this})),p(j,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=D,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var n in this)"t"===n.charAt(0)&&l.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,a){return o.type="throw",o.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var u=this.tryEntries[a],o=u.completion;if("root"===u.tryLoc)return r("end");if(u.tryLoc<=this.prev){var s=l.call(u,"catchLoc"),i=l.call(u,"finallyLoc");if(s&&i){if(this.prev<u.catchLoc)return r(u.catchLoc,!0);if(this.prev<u.finallyLoc)return r(u.finallyLoc)}else if(s){if(this.prev<u.catchLoc)return r(u.catchLoc,!0)}else{if(!i)throw Error("try statement without catch or finally");if(this.prev<u.finallyLoc)return r(u.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&l.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var u=a?a.completion:{};return u.type=e,u.arg=t,a?(this.method="next",this.next=a.finallyLoc,b):this.complete(u)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),b},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),b}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;C(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:D(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),b}},n}function l(e,t,n,r,a,l,u){try{var o=e[l](u),s=o.value}catch(e){return void n(e)}o.done?t(s):Promise.resolve(s).then(r,a)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var u=e.apply(t,n);function o(e){l(u,r,a,o,s,"next",e)}function s(e){l(u,r,a,o,s,"throw",e)}o(void 0)}))}}System.register(["./utils-lib-legacy.js?v=1734676359","./base-lib-legacy.js?v=1734676359","./site-legacy.js?v=1734676359","./index-legacy279.js?v=1734676359","./index-legacy88.js?v=1734676359","./validator-legacy.js?v=1734676359","./useStore-legacy7.js?v=1734676359","./useController-legacy4.js?v=1734676359","./useController-legacy3.js?v=1734676359","./index-legacy90.js?v=1734676359","./column-legacy.js?v=1734676359","./__commonjsHelpers__-legacy.js?v=1734676359","./index-legacy91.js?v=1734676359","./useStore-legacy8.js?v=1734676359","./useStore-legacy9.js?v=1734676359","./useMethod-legacy5.js?v=1734676359"],(function(e,t){"use strict";var r,l,o,s,i,c,p,d,f,v,m,h,w,b,_,x,y,g,k,V,j,P,S,q,U,L,C,O,D,E,I,F,N,H,T,M,z,A,R,Q,G,J,$,W,Y,B,X,K,Z,ee,te,ne,re,ae,le,ue,oe,se,ie,ce,pe,de,fe,ve,me,he,we,be,_e,xe,ye,ge,ke,Ve,je,Pe;return{setters:[function(e){r=e.u,l=e.af,o=e.aj,s=e.b6,i=e.o,c=e.G,p=e.j,d=e.c,f=e.O,v=e.e,m=e.b,h=e.l,w=e.H,b=e.ah,_=e.h,x=e.d,y=e.k,g=e.V,k=e.X},function(e){V=e.c,j=e.h,P=e.r,S=e.e,q=e.y,U=e.I,L=e.o,C=e.k,O=e.l,D=e.x,E=e.p,I=e.M,F=e.C,N=e.q,H=e.aX,T=e.v,M=e.z,z=e.J,A=e.aw,R=e.a7,Q=e.ag,G=e.ah,J=e.a4,$=e.bv,W=e.ax,Y=e.w,B=e.F,X=e.D,K=e.az,Z=e.B,ee=e.A},function(e){te=e.checkAutoInstall,ne=e.createAsync,re=e.getSwooleCorrespondencePhp,ae=e.getSystemUserListAsync,le=e.GetPHPVersion,ue=e.checkInstallAsync,oe=e.addPhpSite,se=e.setDeploymentInfo,ie=e.getDeploymentList,ce=e.getPluginInfo,pe=e.createWebsiteMultiple,de=e.delPhpUploadApp,fe=e.getPhpAppUploadList,ve=e.getFtpMysqlStatus},function(e){me=e.default},function(e){he=e._},function(e){we=e.h,be=e.f,_e=e.i},function(e){xe=e.u},function(e){ye=e.q},function(e){ge=e.c},function(e){ke=e._},function(e){Ve=e.a,je=e.u,Pe=e.c},null,null,null,null,null],execute:function(){var Se={class:"flex"},qe={class:"flex items-center h-3.2rem"},Ue=["onClick"],Le={key:0,class:"text-[1.2rem] ml-[8px] flex items-center"},Ce={key:1,class:"text-[1.2rem] ml-[8px] flex items-center"},Oe={class:"flex items-center"},De={class:"flex items-center mb-[4px]"},Ee=V({__name:"index",props:{compData:{default:{}}},setup:function(e,t){var v=t.expose,m=e,h=r().panel,w=xe().isRefreshList,b=j({database:!1}),_=P(),x=P(!1),y=P({site_path:"/www/wwwroot",project_cmd:"",install_dependence:0,php_version:"",swoole_version:4,domains:"",sql:!1,project_ps:"",project_port:"",codeing:"utf8mb4",open_proxy:!1,project_proxy_path:"",datauser:"",datapassword:"",run_user:"www",composer_version:""}),g=P(!1),k=P([]),V=P([]);P({});var W=P(!1),Y=P({}),B="/www/wwwroot/",X=[{content:"当前仅支持nginx服务器使用"},{content:"【swoole版本】开启自动安装依赖时会给对应版本的php安装swoole"},{content:S(U,null,[q("【自动安装项目依赖】只尝试"),S("span",{class:"text-danger"},[q("composer install")]),q("进行安装依赖，最终安装结果请前往 项目-日志-安装依赖日志 进行确认，若安装依赖不成功，项目会"),S("span",{class:"text-danger"},[q("启动失败")])])},{content:"安装依赖不成功，可能和composer版本有关，可尝试切换composer版本"}],K=function(){var e=u(a().mark((function e(t){var n,r,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="mysql"===t?t:"php-"+(Number(t)/10).toFixed(1),e.next=3,l({sName:n});case 3:r=e.sent,u=r.data,we({name:u.name,type:"i",pluginInfo:u});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(){be({type:"dir",path:y.value.site_path.replace(/\/$/,""),change:function(e){o(e,"string",""),y.value.site_path=e,W.value=!0,ee()}})},ee=function(){var e=u(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,te({path:y.value.site_path});case 3:t=e.sent,y.value.composer_version=t.data?"2.7.3":"",y.value.install_dependence=t.data?1:0,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),le=function(){var e=u(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{(t="php-"+(Number(y.value.php_version)/10).toFixed(1))&&_e({name:t})}catch(n){}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ue=function(){var e=u(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y.value.php_version=t,Y.value=null!==(n=k.value.find((function(e){return e.php_version===t})))&&void 0!==n?n:{};case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(e){var t,n,r;"string"==typeof e&&(y.value.site_path&&y.value.site_path!==B.replace(/\/$/,"")||(W.value=!1),W.value||(y.value.site_path=(null===(t=B)||void 0===t?void 0:t.replace(/\/\//g,"/"))+(null===(n=e.split("\n")[0])||void 0===n||null===(n=n.replace(/:/g,"_"))||void 0===n?void 0:n.trim())),y.value.datauser=null===(r=e.split("\n")[0])||void 0===r||null===(r=r.replace(/\W/g,"_"))||void 0===r?void 0:r.substr(0,16),y.value.datapassword=s(16),y.value.project_ps=e.split("\n")[0])},se=function(e){y.value.composer_version=e,y.value.install_dependence=e?1:0},ie=function(e){var t,r=n(n({},e),{},{sql_user:e.datauser,sql_pwd:e.datapassword,sql_codeing:e.codeing,install_dependence:e.install_dependence,open_proxy:e.open_proxy?1:0,webname:{domain:"",domainlist:[],count:0}}),a=null===(t=e.domains)||void 0===t?void 0:t.split("\n");return a.forEach((function(e,t){0===t?r.webname.domain=e:r.webname.domainlist.push(a[t])})),r.webname.count=r.webname.domainlist.length,r.webname=JSON.stringify(r.webname),delete r.domains,delete r.datauser,delete r.datapassword,delete r.codeing,r},ce=function(){var e=u(a().mark((function e(t){var n,r,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.value.validate();case 2:if(null!==(n=Y.value)&&void 0!==n&&n.swoole_status){e.next=5;break}return e.next=5,i({width:50,title:"提示",isHtml:!0,content:"当前版本PHP-安装扩展未安装swoole，可能导致项目无法启动，是否继续操作？",icon:"warning-filled"});case 5:return r=ie(y.value),e.next=8,c({request:ne(r),message:!0});case 8:null!=(l=e.sent)&&l.status&&(w.value=!0,t());case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pe=function(){var e=u(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae();case 3:t=e.sent,V.value=t.data,e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),de=function(){var e=u(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y.value.swoole_version=t,e.next=3,fe();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fe=function(){var e=u(a().mark((function e(){var t,n,r,l,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,re({swoole_version:y.value.swoole_version});case 3:(t=e.sent).status&&(k.value=t.data,u=null===(n=k.value)||void 0===n?void 0:n.filter((function(e){return e.setup_status})),y.value.php_version=null===(r=u[0])||void 0===r?void 0:r.php_version,Y.value=null!==(l=u[0])&&void 0!==l?l:{}),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),ve=function(){var e=u(a().mark((function e(){var t,n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.compData.getStatus();case 2:t=e.sent,b.database=t.mysql,(n=h.value.sitePath)&&(y.value.site_path=n,B=null===(r=n+"/")||void 0===r?void 0:r.replace(/\/\//g,"/")),fe(),pe();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return L(ve),v({init:ve,onConfirm:ce}),function(e,t){var n=p,r=A,a=R,l=he,u=Q,o=G,s=d,i=J,c=f,v=$;return C(),O("div",null,[S(i,{ref_key:"addSwooleSiteFormRef",ref:_,disabled:E(x),model:E(y),rules:E(ye)},{default:D((function(){return[S(a,{label:"绑定域名",prop:"domains"},{default:D((function(){return[S(r,{ref:"popover",placement:"top-start","popper-class":"green-tips-popover !p-0",title:"",width:"400",visible:E(g),"onUpdate:visible":t[2]||(t[2]=function(e){return I(g)?g.value=e:null}),"trigger-keys":[],trigger:"focus"},{reference:D((function(){return[F(S(n,{onInput:oe,modelValue:E(y).domains,"onUpdate:modelValue":t[0]||(t[0]=function(e){return E(y).domains=e}),type:"textarea",width:"52rem",rows:4,resize:"none",onFocus:t[1]||(t[1]=function(e){return g.value=!0}),placeholder:"如需填写多个域名，请换行填写，每行一个域名，默认为80端口\nIP地址格式：192.168.1.199\n泛解析添加方法 *.domain.com\n如另加端口格式为 www.domain.com:88"},null,8,["modelValue"]),[[v,void 0,"popover"]])]})),default:D((function(){return[t[16]||(t[16]=N("div",{class:"!p-[12px] bg-[#20a53a] text-white"},[q(" 如需填写多个域名，请换行填写，每行一个域名，默认为80端口 "),N("br"),q(" IP地址格式：192.168.1.199 "),N("br"),q(" 泛解析添加方法 *.domain.com "),N("br"),q(" 如另加端口格式为 www.domain.com:88 ")],-1))]})),_:1},8,["visible"])]})),_:1}),S(a,{label:"项目目录",prop:"site_path"},{default:D((function(){return[S(l,{modelValue:E(y).site_path,"onUpdate:modelValue":t[3]||(t[3]=function(e){return E(y).site_path=e}),placeholder:"请输入项目目录",icon:"el-folder-opened",width:"52rem",onFocus:t[4]||(t[4]=function(e){return W.value=!0}),onBlur:ee,onIconClick:Z},null,8,["modelValue"])]})),_:1}),S(a,{label:"swoole版本"},{default:D((function(){return[N("div",Se,[N("div",null,[S(o,{modelValue:E(y).swoole_version,"onUpdate:modelValue":t[5]||(t[5]=function(e){return E(y).swoole_version=e}),class:"!w-[8rem]",onChange:de},{default:D((function(){return[S(u,{label:"2.x",value:2}),S(u,{label:"4.x",value:4}),S(u,{label:"5.x",value:5})]})),_:1},8,["modelValue"])]),S(a,{label:"PHP版本",prop:"php_version"},{default:D((function(){var e,n,r;return[N("div",qe,[S(o,{modelValue:E(y).php_version,"onUpdate:modelValue":t[6]||(t[6]=function(e){return E(y).php_version=e}),placeholder:"请选择PHP版本",class:"!w-[14rem]",onChange:ue},{default:D((function(){return[(C(!0),O(U,null,H(E(k),(function(e,n){return C(),z(u,{key:n,disabled:!e.setup_status,label:"PHP-".concat(e.php_version),value:e.php_version},{default:D((function(){return[N("span",null,"PHP-"+T(e.php_version),1),e.setup_status?M("",!0):(C(),O(U,{key:0},[t[17]||(t[17]=q(" [ ")),N("span",{class:"mx-[4px] bt-link",onClick:function(t){return K(e.php_version)}},"未安装",8,Ue),t[18]||(t[18]=q(" ] "))],64))]})),_:2},1032,["disabled","label","value"])})),128))]})),_:1},8,["modelValue"]),E(y).php_version?(C(),O(U,{key:0},[null!==(e=E(Y))&&void 0!==e&&e.swoole_status?null!==(n=E(Y))&&void 0!==n&&n.setup_swoole_isactive||null===(r=E(Y))||void 0===r||!r.swoole_version?M("",!0):(C(),O("span",Ce,[q(" 当前php未安装swoole"+T(E(y).swoole_version)+"扩展 ",1),S(s,{class:"ml-[4px]",onClick:le},{default:D((function(){return t[21]||(t[21]=[q(">>立即安装")])})),_:1})])):(C(),O("span",Le,[t[20]||(t[20]=q(" 当前php未安装swoole扩展 ")),S(s,{class:"ml-[4px]",onClick:le},{default:D((function(){return t[19]||(t[19]=[q(">>立即安装")])})),_:1})]))],64)):M("",!0)])]})),_:1})])]})),_:1}),S(a,{label:"数据库"},{default:D((function(){return[N("div",Oe,[S(o,{class:"!w-[16rem]",modelValue:E(y).sql,"onUpdate:modelValue":t[7]||(t[7]=function(e){return E(y).sql=e}),disabled:!E(b).database},{default:D((function(){return[S(u,{label:"不创建",value:!1}),S(u,{label:"MySQL",value:"MYSQL"})]})),_:1},8,["modelValue","disabled"]),E(b).database?M("",!0):(C(),O("span",{key:0,onClick:t[8]||(t[8]=function(e){return K("mysql")}),class:"ml-[4px] text-danger cursor-pointer !text-[1.2rem]"},"未安装数据库，点击安装")),E(y).sql?(C(),z(o,{key:1,class:"!w-[16rem] ml-[8px]",modelValue:E(y).codeing,"onUpdate:modelValue":t[9]||(t[9]=function(e){return E(y).codeing=e})},{default:D((function(){return[S(u,{label:"utf8mb4",value:"utf8mb4"}),S(u,{label:"utf8",value:"utf8"}),S(u,{label:"gbk",value:"gbk"}),S(u,{label:"big5",value:"big5"})]})),_:1},8,["modelValue"])):M("",!0)])]})),_:1}),E(y).sql?(C(),z(a,{key:0,label:"数据库账号"},{default:D((function(){return[N("div",De,[S(a,{prop:"datauser"},{default:D((function(){return[S(n,{placeholder:"创建数据库账号",modelValue:E(y).datauser,"onUpdate:modelValue":t[10]||(t[10]=function(e){return E(y).datauser=e})},null,8,["modelValue"])]})),_:1}),S(a,{label:"密码",class:"!mt-0"},{default:D((function(){return[S(n,{placeholder:"数据库密码",modelValue:E(y).datapassword,"onUpdate:modelValue":t[11]||(t[11]=function(e){return E(y).datapassword=e})},null,8,["modelValue"])]})),_:1})]),t[22]||(t[22]=N("span",{class:"text-[#999] text-[1.2rem]"},"创建站点的同时，为站点创建一个对应的数据库帐户，方便不同站点使用不同数据库。",-1))]})),_:1})):M("",!0),S(a,{label:"运行用户"},{default:D((function(){return[S(o,{class:"!w-[16rem]",modelValue:E(y).run_user,"onUpdate:modelValue":t[12]||(t[12]=function(e){return E(y).run_user=e})},{default:D((function(){return[(C(!0),O(U,null,H(E(V),(function(e){return C(),z(u,{key:e,label:e,value:e},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"]),t[23]||(t[23]=N("span",{class:"text-[#999] text-[1.2rem] ml-[.4rem]"},"* 无特殊需求请选择www用户",-1))]})),_:1}),S(a,{label:"启动命令",prop:"project_cmd"},{default:D((function(){return[S(n,{modelValue:E(y).project_cmd,"onUpdate:modelValue":t[13]||(t[13]=function(e){return E(y).project_cmd=e}),width:"52rem",placeholder:"请输入项目的启动命令，例：php serve.php"},null,8,["modelValue"])]})),_:1}),S(a,{label:"依赖安装"},{default:D((function(){return[S(o,{class:"!w-[16rem]",modelValue:E(y).composer_version,"onUpdate:modelValue":t[14]||(t[14]=function(e){return E(y).composer_version=e}),"empty-values":[null,void 0],onChange:se},{default:D((function(){return[S(u,{label:"不安装",value:""}),S(u,{label:"用composer2.7.3安装",value:"2.7.3"}),S(u,{label:"用composer1.10.27安装",value:"1.10.27"})]})),_:1},8,["modelValue"])]})),_:1}),S(a,{label:"备注"},{default:D((function(){return[S(n,{modelValue:E(y).project_ps,"onUpdate:modelValue":t[15]||(t[15]=function(e){return E(y).project_ps=e}),placeholder:"请输入备注,可为空",width:"52rem"},null,8,["modelValue"])]})),_:1})]})),_:1},8,["disabled","model","rules"]),S(c,{class:"mt-2rem pl-1rem",options:X})])}}}),Ie=v(Ee,[["__scopeId","data-v-dad57cfa"]]),Fe={class:"flex"},Ne={class:"mr-2rem"},He={key:1,class:"!text-[1.2rem]"},Te={class:"flex items-center"},Me={class:"flex items-center mb-[4px]"},ze=V({__name:"index",props:{compData:{default:{}}},setup:function(e,t){var v=t.expose,h=e,w=r().panel,b=xe().isRefreshList,_=m(),x=j({database:!1}),y=P(),g=P(!1),k=P({site_path:"/www/wwwroot",project_cmd:"php think run",install_dependence:0,php_version:"",thinkphp_version:!0,domains:"",sql:!1,project_ps:"",project_port:"",codeing:"utf8mb4",open_proxy:!1,project_proxy_path:"",datauser:"",datapassword:"",run_user:"www",composer_version:""}),V=P(!1),F=P([]),T=P([]),$=P({}),W=P(!1),Y="/www/wwwroot/",B=[{content:"当前仅支持nginx服务器使用"},{content:"【fileinfo版本】若未安装，项目会启动失败"},{content:S(U,null,[q("【自动安装项目依赖】只尝试"),S("span",{class:"text-danger"},[q("composer install")]),q("进行安装依赖，最终安装结果请前往 项目-日志-安装依赖日志 进行确认，若安装依赖不成功，项目会"),S("span",{class:"text-danger"},[q("启动失败")])])},{content:"安装依赖不成功，可能和composer版本有关，可尝试切换composer版本"}],X=function(){be({type:"dir",path:k.value.site_path.replace(/\/$/,""),change:function(e){o(e,"string",""),k.value.site_path=e,W.value=!0,K()}})},K=function(){var e=u(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,te({path:k.value.site_path});case 3:t=e.sent,k.value.composer_version=t.data?"2.7.3":"",k.value.install_dependence=t.data?1:0,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=u(a().mark((function e(t){var n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l({sName:t});case 2:n=e.sent,r=n.data,we({name:r.name,type:"i",pluginInfo:r});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=u(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,le();case 3:n=e.sent,F.value=n.data.filter((function(e){return"纯静态"!==e.name})),F.value=F.value.reverse(),k.value.php_version=null!==(t=F.value)&&void 0!==t&&t.length?F.value[0].version:"",e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),re=function(){var e=u(a().mark((function e(){var t,n,r,l=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]&&l[0],e.prev=1,t&&(n=_.load("正在检查安装信息，请稍后...")),e.next=5,ue({name:"fileinfo",php_version:k.value.php_version});case 5:r=e.sent,t&&n.close(),$.value=r,e.next=12;break;case 10:e.prev=10,e.t0=e.catch(1);case 12:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}(),oe=function(){var e=u(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t="php-"+(Number(k.value.php_version)/10).toFixed(1),_e({name:t})}catch(n){}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),se=function(){var e=u(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k.value.php_version=t,re(!0);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(e){var t,n,r;"string"==typeof e&&(k.value.site_path&&k.value.site_path!==Y.replace(/\/$/,"")||(W.value=!1),W.value||(k.value.site_path=(null===(t=Y)||void 0===t?void 0:t.replace(/\/\//g,"/"))+(null===(n=e.split("\n")[0])||void 0===n||null===(n=n.replace(/:/g,"_"))||void 0===n?void 0:n.trim())),k.value.datauser=null===(r=e.split("\n")[0])||void 0===r||null===(r=r.replace(/\W/g,"_"))||void 0===r?void 0:r.substr(0,16),k.value.datapassword=s(16),k.value.project_ps=e.split("\n")[0])},ce=function(e){var t,r=n(n({},e),{},{sql_user:e.datauser,sql_pwd:e.datapassword,sql_codeing:e.codeing,install_dependence:e.install_dependence?1:0,open_proxy:e.open_proxy?1:0,webname:{domain:"",domainlist:[],count:0}}),a=null===(t=e.domains)||void 0===t?void 0:t.split("\n");return a.forEach((function(e,t){0===t?r.webname.domain=e:r.webname.domainlist.push(a[t])})),r.webname.count=r.webname.domainlist.length,r.webname=JSON.stringify(r.webname),delete r.domains,delete r.datauser,delete r.datapassword,delete r.codeing,r},pe=function(){var e=u(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.value.validate();case 2:if($.value.status){e.next=5;break}return e.next=5,i({width:50,title:"提示",isHtml:!0,content:"当前版本PHP-安装扩展未安装fileinfo，可能导致项目无法启动，是否继续操作？",icon:"warning-filled"});case 5:return n=ce(k.value),e.next=8,c({loading:g,request:ne(n),message:!0});case 8:e.sent.status&&(b.value=!0,t());case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),de=function(){var e=u(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae();case 3:t=e.sent,T.value=t.data,e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),fe=function(){var e=u(a().mark((function e(){var t,n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.compData.getStatus();case 2:return t=e.sent,x.database=t.mysql,(n=w.value.sitePath)&&(k.value.site_path=n,Y=null===(r=n+"/")||void 0===r?void 0:r.replace(/\/\//g,"/")),e.next=8,ee();case 8:return e.next=10,re();case 10:de();case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return L(fe),v({init:fe,onConfirm:pe}),function(e,t){var n=p,r=A,a=R,l=he,u=Q,o=G,s=d,i=J,c=f;return C(),O("div",null,[S(i,{ref_key:"addThinkphpSiteFormRef",ref:y,disabled:E(g),model:E(k),rules:E(ye)},{default:D((function(){return[S(a,{label:"绑定域名",prop:"domains"},{default:D((function(){return[S(r,{ref:"popover",placement:"top-start","popper-class":"green-tips-popover !p-0",title:"",width:"400",visible:E(V),"onUpdate:visible":t[2]||(t[2]=function(e){return I(V)?V.value=e:null}),"trigger-keys":[],trigger:"focus"},{reference:D((function(){return[S(n,{onInput:ie,modelValue:E(k).domains,"onUpdate:modelValue":t[0]||(t[0]=function(e){return E(k).domains=e}),type:"textarea",width:"52rem",rows:4,resize:"none",onFocus:t[1]||(t[1]=function(e){return V.value=!0}),placeholder:"如需填写多个域名，请换行填写，每行一个域名，默认为80端口\nIP地址格式：192.168.1.199\n泛解析添加方法 *.domain.com\n如另加端口格式为 www.domain.com:88"},null,8,["modelValue"])]})),default:D((function(){return[t[15]||(t[15]=N("div",{class:"!p-[12px] bg-[#20a53a] text-white"},[q(" 如需填写多个域名，请换行填写，每行一个域名，默认为80端口 "),N("br"),q(" IP地址格式：192.168.1.199 "),N("br"),q(" 泛解析添加方法 *.domain.com "),N("br"),q(" 如另加端口格式为 www.domain.com:88 ")],-1))]})),_:1},8,["visible"])]})),_:1}),S(a,{label:"项目目录",prop:"site_path"},{default:D((function(){return[S(l,{modelValue:E(k).site_path,"onUpdate:modelValue":t[3]||(t[3]=function(e){return E(k).site_path=e}),placeholder:"请输入项目目录",icon:"el-folder-opened",width:"52rem",onFocus:t[4]||(t[4]=function(e){return W.value=!0}),onIconClick:X},null,8,["modelValue"])]})),_:1}),S(a,{label:"PHP版本"},{default:D((function(){return[N("div",Fe,[N("div",Ne,[S(o,{class:"!w-[16rem]",modelValue:E(k).php_version,"onUpdate:modelValue":t[5]||(t[5]=function(e){return E(k).php_version=e}),onChange:se},{default:D((function(){return[(C(!0),O(U,null,H(E(F),(function(e){return C(),z(u,{key:e.value,label:e.name,value:e.version},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]),S(a,{label:"fileinfo版本"},{default:D((function(){return[E($).status?(C(),O("span",He,"当前php已安装fileinfo扩展")):(C(),z(s,{key:0,onClick:oe},{default:D((function(){return t[16]||(t[16]=[q("当前php未安装fileinfo扩展 >>立即安装")])})),_:1}))]})),_:1})])]})),_:1}),S(a,{label:"数据库"},{default:D((function(){return[N("div",Te,[S(o,{class:"!w-[16rem]",modelValue:E(k).sql,"onUpdate:modelValue":t[6]||(t[6]=function(e){return E(k).sql=e}),disabled:!E(x).database},{default:D((function(){return[S(u,{label:"不创建",value:!1}),S(u,{label:"MySQL",value:"MYSQL"})]})),_:1},8,["modelValue","disabled"]),E(x).database?M("",!0):(C(),O("span",{key:0,onClick:t[7]||(t[7]=function(e){return Z("mysql")}),class:"ml-[4px] text-danger cursor-pointer !text-[1.2rem]"},"未安装数据库，点击安装")),E(k).sql?(C(),z(o,{key:1,class:"ml-[8px] !w-[16rem]",modelValue:E(k).codeing,"onUpdate:modelValue":t[8]||(t[8]=function(e){return E(k).codeing=e})},{default:D((function(){return[S(u,{label:"utf8mb4",value:"utf8mb4"}),S(u,{label:"utf8",value:"utf8"}),S(u,{label:"gbk",value:"gbk"}),S(u,{label:"big5",value:"big5"})]})),_:1},8,["modelValue"])):M("",!0)])]})),_:1}),E(k).sql?(C(),z(a,{key:0,label:"数据库账号"},{default:D((function(){return[N("div",Me,[S(a,{prop:"datauser"},{default:D((function(){return[S(n,{placeholder:"创建数据库账号",modelValue:E(k).datauser,"onUpdate:modelValue":t[9]||(t[9]=function(e){return E(k).datauser=e})},null,8,["modelValue"])]})),_:1}),S(a,{label:"密码",class:"!mt-0"},{default:D((function(){return[S(n,{placeholder:"数据库密码",modelValue:E(k).datapassword,"onUpdate:modelValue":t[10]||(t[10]=function(e){return E(k).datapassword=e})},null,8,["modelValue"])]})),_:1})]),t[17]||(t[17]=N("span",{class:"text-[#999] text-[1.2rem]"},"创建站点的同时，为站点创建一个对应的数据库帐户，方便不同站点使用不同数据库。",-1))]})),_:1})):M("",!0),S(a,{label:"运行用户"},{default:D((function(){return[S(o,{class:"!w-[16rem]",modelValue:E(k).run_user,"onUpdate:modelValue":t[11]||(t[11]=function(e){return E(k).run_user=e})},{default:D((function(){return[(C(!0),O(U,null,H(E(T),(function(e){return C(),z(u,{key:e,label:e,value:e},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"]),t[18]||(t[18]=N("span",{class:"text-[#999] text-[1.2rem] ml-[.4rem]"},"* 无特殊需求请选择www用户",-1))]})),_:1}),S(a,{label:"启动命令",prop:"project_cmd"},{default:D((function(){return[S(n,{modelValue:E(k).project_cmd,"onUpdate:modelValue":t[12]||(t[12]=function(e){return E(k).project_cmd=e}),width:"52rem",placeholder:"请输入项目的启动命令，例：php serve.php"},null,8,["modelValue"])]})),_:1}),S(a,{label:"依赖安装"},{default:D((function(){return[S(o,{class:"!w-[16rem]",modelValue:E(k).composer_version,"onUpdate:modelValue":t[13]||(t[13]=function(e){return E(k).composer_version=e}),"empty-values":[null,void 0]},{default:D((function(){return[S(u,{label:"不安装",value:""}),S(u,{label:"用composer2.7.3安装",value:"2.7.3"}),S(u,{label:"用1.10.27安装",value:"1.10.27"})]})),_:1},8,["modelValue"])]})),_:1}),S(a,{label:"备注"},{default:D((function(){return[S(n,{modelValue:E(k).project_ps,"onUpdate:modelValue":t[14]||(t[14]=function(e){return E(k).project_ps=e}),placeholder:"请输入备注,可为空",width:"52rem"},null,8,["modelValue"])]})),_:1})]})),_:1},8,["disabled","model","rules"]),S(c,{class:"mt-2rem pl-1rem",options:B})])}}}),Ae=v(ze,[["__scopeId","data-v-c81d23b6"]]),Re={class:"flex items-center"},Qe={class:"flex items-center mb-[4px]"},Ge=V({__name:"index",props:{compData:{default:{}}},setup:function(e,t){var i=t.expose,d=e,v=r().panel,m=xe().isRefreshList,h=j({database:!1}),w=P(),b=P(!1),_=P({site_path:"/www/wwwroot",project_cmd:"",install_dependence:0,php_version:"",domains:"",sql:!1,project_ps:"",project_port:"",codeing:"utf8mb4",open_proxy:!1,project_proxy_path:"",datauser:"",datapassword:"",run_user:"www",composer_version:""}),x=P(!1),y=P([]),g=P([]),k=P(!1),V="/www/wwwroot/",F=[{content:"当前仅支持nginx服务器使用"},{content:S(U,null,[q("【自动安装项目依赖】只尝试"),S("span",{class:"text-danger"},[q("composer install")]),q("进行安装依赖，最终安装结果请前往 项目-日志-安装依赖日志 进行确认，若安装依赖不成功，项目会"),S("span",{class:"text-danger"},[q("启动失败")])])},{content:"安装依赖不成功，可能和composer版本有关，可尝试切换composer版本"}],T=function(){be({type:"dir",path:_.value.site_path.replace(/\/$/,""),change:function(e){o(e,"string",""),_.value.site_path=e,k.value=!0,$()}})},$=function(){var e=u(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,te({path:_.value.site_path});case 3:t=e.sent,_.value.composer_version=t.data?"2.7.3":"",_.value.install_dependence=t.data?1:0,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=u(a().mark((function e(t){var n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l({sName:t});case 2:n=e.sent,r=n.data,we({name:r.name,type:"i",pluginInfo:r});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=u(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,le();case 3:n=e.sent,y.value=n.data.filter((function(e){return"纯静态"!==e.name})),y.value=y.value.reverse(),_.value.php_version=null!==(t=y.value)&&void 0!==t&&t.length?y.value[0].version:"",e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),B=function(e){var t,n,r;"string"==typeof e&&(_.value.site_path&&_.value.site_path!==V.replace(/\/$/,"")||(k.value=!1),k.value||(_.value.site_path=(null===(t=V)||void 0===t?void 0:t.replace(/\/\//g,"/"))+(null===(n=e.split("\n")[0])||void 0===n||null===(n=n.replace(/:/g,"_"))||void 0===n?void 0:n.trim())),_.value.datauser=null===(r=e.split("\n")[0])||void 0===r||null===(r=r.replace(/\W/g,"_"))||void 0===r?void 0:r.substr(0,16),_.value.datapassword=s(16),_.value.project_ps=e.split("\n")[0])},X=function(e){var t,r=n(n({},e),{},{sql_user:e.datauser,sql_pwd:e.datapassword,sql_codeing:e.codeing,install_dependence:e.install_dependence?1:0,open_proxy:e.open_proxy?1:0,webname:{domain:"",domainlist:[],count:0}}),a=null===(t=e.domains)||void 0===t?void 0:t.split("\n");return a.forEach((function(e,t){0===t?r.webname.domain=e:r.webname.domainlist.push(a[t])})),r.webname.count=r.webname.domainlist.length,r.webname=JSON.stringify(r.webname),delete r.domains,delete r.datauser,delete r.datapassword,delete r.codeing,r},K=function(){var e=u(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.value.validate();case 2:return n=X(_.value),e.next=5,c({loading:b,request:ne(n),message:!0});case 5:e.sent.status&&(m.value=!0,t());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=u(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae();case 3:t=e.sent,g.value=t.data,e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),ee=function(){var e=u(a().mark((function e(){var t,n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.compData.getStatus();case 2:t=e.sent,h.database=t.mysql,(n=v.value.sitePath)&&(_.value.site_path=n,V=null===(r=n+"/")||void 0===r?void 0:r.replace(/\/\//g,"/")),Y(),Z();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return L(ee),i({init:ee,onConfirm:K}),function(e,t){var n=p,r=A,a=R,l=he,u=Q,o=G,s=J,i=f;return C(),O("div",null,[S(s,{ref_key:"addUniversalSiteFormRef",ref:w,disabled:E(b),model:E(_),rules:E(ye)},{default:D((function(){return[S(a,{label:"绑定域名",prop:"domains"},{default:D((function(){return[S(r,{ref:"popover",placement:"top-start","popper-class":"green-tips-popover !p-0",title:"",width:"400",visible:E(x),"onUpdate:visible":t[2]||(t[2]=function(e){return I(x)?x.value=e:null}),"trigger-keys":[],trigger:"focus"},{reference:D((function(){return[S(n,{onInput:B,modelValue:E(_).domains,"onUpdate:modelValue":t[0]||(t[0]=function(e){return E(_).domains=e}),type:"textarea",width:"52rem",rows:4,resize:"none",onFocus:t[1]||(t[1]=function(e){return x.value=!0}),placeholder:"如需填写多个域名，请换行填写，每行一个域名，默认为80端口\nIP地址格式：192.168.1.199\n泛解析添加方法 *.domain.com\n如另加端口格式为 www.domain.com:88"},null,8,["modelValue"])]})),default:D((function(){return[t[15]||(t[15]=N("div",{class:"!p-[12px] bg-[#20a53a] text-white"},[q(" 如需填写多个域名，请换行填写，每行一个域名，默认为80端口 "),N("br"),q(" IP地址格式：192.168.1.199 "),N("br"),q(" 泛解析添加方法 *.domain.com "),N("br"),q(" 如另加端口格式为 www.domain.com:88 ")],-1))]})),_:1},8,["visible"])]})),_:1}),S(a,{label:"项目目录",prop:"site_path"},{default:D((function(){return[S(l,{modelValue:E(_).site_path,"onUpdate:modelValue":t[3]||(t[3]=function(e){return E(_).site_path=e}),placeholder:"请输入项目目录",icon:"el-folder-opened",width:"52rem",onFocus:t[4]||(t[4]=function(e){return k.value=!0}),onIconClick:T},null,8,["modelValue"])]})),_:1}),S(a,{label:"PHP版本"},{default:D((function(){return[S(o,{class:"!w-[16rem]",modelValue:E(_).php_version,"onUpdate:modelValue":t[5]||(t[5]=function(e){return E(_).php_version=e})},{default:D((function(){return[(C(!0),O(U,null,H(E(y),(function(e){return C(),z(u,{key:e.value,label:e.name,value:e.version},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),S(a,{label:"数据库"},{default:D((function(){return[N("div",Re,[S(o,{class:"!w-[16rem]",modelValue:E(_).sql,"onUpdate:modelValue":t[6]||(t[6]=function(e){return E(_).sql=e}),disabled:!E(h).database},{default:D((function(){return[S(u,{label:"不创建",value:!1}),S(u,{label:"MySQL",value:"MYSQL"})]})),_:1},8,["modelValue","disabled"]),E(h).database?M("",!0):(C(),O("span",{key:0,onClick:t[7]||(t[7]=function(e){return W("mysql")}),class:"ml-[4px] text-danger cursor-pointer !text-[1.2rem]"},"未安装数据库，点击安装")),E(_).sql?(C(),z(o,{key:1,class:"ml-[8px] !w-[16rem]",modelValue:E(_).codeing,"onUpdate:modelValue":t[8]||(t[8]=function(e){return E(_).codeing=e})},{default:D((function(){return[S(u,{label:"utf8mb4",value:"utf8mb4"}),S(u,{label:"utf8",value:"utf8"}),S(u,{label:"gbk",value:"gbk"}),S(u,{label:"big5",value:"big5"})]})),_:1},8,["modelValue"])):M("",!0)])]})),_:1}),E(_).sql?(C(),z(a,{key:0,label:"数据库账号"},{default:D((function(){return[N("div",Qe,[S(a,{prop:"datauser"},{default:D((function(){return[S(n,{placeholder:"创建数据库账号",modelValue:E(_).datauser,"onUpdate:modelValue":t[9]||(t[9]=function(e){return E(_).datauser=e})},null,8,["modelValue"])]})),_:1}),S(a,{label:"密码",class:"!mt-0"},{default:D((function(){return[S(n,{placeholder:"数据库密码",modelValue:E(_).datapassword,"onUpdate:modelValue":t[10]||(t[10]=function(e){return E(_).datapassword=e})},null,8,["modelValue"])]})),_:1})]),t[16]||(t[16]=N("span",{class:"text-[#999] text-[1.2rem]"},"创建站点的同时，为站点创建一个对应的数据库帐户，方便不同站点使用不同数据库。",-1))]})),_:1})):M("",!0),S(a,{label:"运行用户"},{default:D((function(){return[S(o,{class:"!w-[16rem]",modelValue:E(_).run_user,"onUpdate:modelValue":t[11]||(t[11]=function(e){return E(_).run_user=e})},{default:D((function(){return[(C(!0),O(U,null,H(E(g),(function(e){return C(),z(u,{key:e,label:e,value:e},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"]),t[17]||(t[17]=N("span",{class:"text-[#999] text-[1.2rem] ml-[.4rem]"},"* 无特殊需求请选择www用户",-1))]})),_:1}),S(a,{label:"启动命令",prop:"project_cmd"},{default:D((function(){return[S(n,{modelValue:E(_).project_cmd,"onUpdate:modelValue":t[12]||(t[12]=function(e){return E(_).project_cmd=e}),width:"52rem",placeholder:"请输入项目的启动命令，例：php serve.php"},null,8,["modelValue"])]})),_:1}),S(a,{label:"依赖安装"},{default:D((function(){return[S(o,{class:"!w-[16rem]",modelValue:E(_).composer_version,"onUpdate:modelValue":t[13]||(t[13]=function(e){return E(_).composer_version=e}),"empty-values":[null,void 0]},{default:D((function(){return[S(u,{label:"不安装",value:""}),S(u,{label:"用2.7.3安装",value:"2.7.3"}),S(u,{label:"用1.10.27安装",value:"1.10.27"})]})),_:1},8,["modelValue"])]})),_:1}),S(a,{label:"备注"},{default:D((function(){return[S(n,{modelValue:E(_).project_ps,"onUpdate:modelValue":t[14]||(t[14]=function(e){return E(_).project_ps=e}),placeholder:"请输入备注,可为空",width:"52rem"},null,8,["modelValue"])]})),_:1})]})),_:1},8,["disabled","model","rules"]),S(i,{class:"mt-2rem pl-1rem",options:F})])}}}),Je=v(Ge,[["__scopeId","data-v-cf1ba41e"]]),$e={class:"pb-0 w-full"},We={class:"py-[8px] px-[12px] text-[#666] bg-[#e8f6eb] !w-full block flex items-center"},Ye={class:"inline-grid grid-cols-3 text-[1.2rem] gap-x-6 gap-y-2 !w-[60rem] !h-[12.3rem]"},Be=["onClick"],Xe={class:"!p-[12px] flex flex-col text-[#666]"},Ke={class:"w-full flex items-center"},Ze={class:"flex flex-col items-start leading-9 w-full"},et={class:"truncate font-bold"},tt={class:"w-[14rem] truncate"},nt={class:"flex items-center"},rt={key:0,class:"svgtofont-el-success-filled text-[3.2rem] mr-[8px]"},at={class:"flex flex-col items-start leading-9 w-full"},lt={key:0,class:"truncate font-bold"},ut={class:"flex flex-col bg-[#f8f8f8] p-[12px] px-[16px] text-[1.2rem] w-full"},ot={class:"flex items-center justify-between"},st={class:"text-[#999] flex items-center"},it={class:"p-[20px]"},ct={class:"flex items-center mb-[4px]"},pt=["onClick"],dt=V({__name:"index",props:{compData:{default:{}}},setup:function(e,n){var l=n.expose,o=e,i=r().panel,c=xe().isRefreshList,f=m(),v=P([]),y=P(0),g=P(!1),k=P(),V=P(!1),K=W("popupClose"),Z="/www/wwwroot/",ee=P({menuType:"addDeployment",path:"/www/wwwroot",ftp:!1,type:"PHP",type_id:0,ps:"",port:"",version:"",need_index:0,need_404:0,sql:!1,codeing:"utf8mb4",webname:"",ftp_username:"",ftp_password:"",datauser:"",datapassword:""}),te=P({ftp:!0,ftpData:{username:"",password:""},sql:!0,databaseStatus:!0,sqlData:{username:"",password:""},siteStatus:!1,site:{name:""}}),ne=P({isSetup:!1,versions:[],version:"",code:"utf8mb4"}),re=P({title:"111",version:"222"}),ae=j({datauser:"",datapassword:"",type:"MySQL",code:"utf8mb4",version:""}),ue=P(null),pe=P([]),de=P(!1),fe=P(!1),ve=P([]),me=function(){be({type:"dir",path:ee.value.path,change:function(e){ee.value.path=e}})},_e=function(e){var t,n,r;"string"==typeof e&&(ee.value.ps=e.split("\n")[0],ee.value.path=(null===(t=Z)||void 0===t?void 0:t.replace(/\/\//g,"/"))+(null===(n=e.split("\n")[0])||void 0===n||null===(n=n.replace(/:/g,"_"))||void 0===n?void 0:n.trim()),ee.value.datapassword=s(),ee.value.datauser=null===(r=e.split("\n")[0])||void 0===r?void 0:r.replace(/\W/g,"_").substring(0,16))},ge=function(){var e=u(a().mark((function e(t){var n,r,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n="php-"+(Number(t)/10).toFixed(1),e.next=4,ce({sName:n});case 4:r=e.sent,l=r.data,we({name:n,type:"i",pluginInfo:l}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),ke=function(){var e=u(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ie();case 3:t=e.sent,n=t.data,v.value=n.list,pe.value=n.list,ue.value=n,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),Ve=function(){h({isAsync:!0,title:"模板",area:84,component:function(){return w((function(){return t.import("./other-template-legacy.js?v=1734676359")}),void 0,t.meta.url)},compData:{templateData:ue.value,templateId:y.value,selectTemplate:Le}})},je=function(){de.value=!0,ae.datauser=ee.value.datauser,ae.datapassword=ee.value.datapassword,ae.version=ne.value.version},Pe=function(){var e=u(a().mark((function e(t){var n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=null==t?void 0:t.php.split(","),r=ne.value.versions.filter((function(e){return n.includes(e.version)})).map((function(e){return e.version})),ve.value=n.map((function(e){return{name:"PHP-"+e,version:e,status:r.includes(e)}})),ne.value.version=r[r.length-1],ae.version=ne.value.version,ee.value.version=ne.value.version;case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Se=function(){var e=u(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.compData.getStatus();case 3:return t=e.sent,e.next=6,le();case 6:n=e.sent,ne.value.isSetup=t.mysql,ne.value.versions=n.data.filter((function(e){return"00"!==e.version})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),qe=function(){var e=u(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:de.value=!1,ee.value.datauser=ae.datauser,ee.value.datapassword=ae.datapassword,ee.value.codeing=ae.code,ne.value.version=ae.version,ne.value.code=ae.code,ee.value.version=ne.value.version;case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ue=function(){var e=u(a().mark((function e(n){var r,l,u,o,s,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=Object.assign({},ee.value)).ftp?(te.value.ftpData.username=r.ftp_username,te.value.ftpData.password=r.ftp_password):(delete r.ftp_username,delete r.ftp_password,te.value.ftp=!1),r.sql?(te.value.sqlData.username=r.user,te.value.sqlData.password=r.password):(delete r.datauser,delete r.datapassword,te.value.sql=!1),-1!==r.webname.split("\n")[0].indexOf(":")?r.port=r.webname.split("\n")[0].split(":")[1]:r.port=80,(l=r.webname.split("\n")).shift(),r.webname=JSON.stringify({domain:r.webname.split("\n")[0],domainlist:l,count:l.length}),delete r.menuType,e.next=10,k.value.validate();case 10:return e.prev=10,g.value=!0,e.next=14,oe(r);case 14:if(!1!==(u=e.sent).data.status){e.next=17;break}return e.abrupt("return",f.msg({customClass:"bt-message-error-html",dangerouslyUseHTMLString:!0,message:u.status?"添加网站成功":u.msg,type:u.status?"success":"error",duration:u.status?3e3:0,showClose:!u.status}));case 17:return u.status&&K(),o=f.load("正在部署中..."),e.next=21,se({source:1,site_name:JSON.parse(r.webname).domain,php_version:r.version,dname:v.value.find((function(e){return e.id===y.value})).name});case 21:s=e.sent,i=s.data,o.close(),u.data.siteStatus&&(te.value.siteStatus=!0,te.value.site.name=JSON.parse(r.webname).domain+i.msg.success_url),r.ftp||r.sql?(te.value.sqlData.username=r.datauser,te.value.sqlData.password=r.datapassword,te.value.databaseStatus=u.data.databaseStatus,h({isAsync:!0,title:"网站添加结果",area:46,component:function(){return w((function(){return t.import("./add-result-legacy.js?v=1734676359")}),void 0,t.meta.url)},compData:te.value})):f.msg({customClass:"bt-message-error-html",dangerouslyUseHTMLString:!0,message:u.data.status?"添加网站成功":u.data.msg,type:u.data.status?"success":"error",duration:u.data.status?3e3:0,showClose:!u.data.status}),c.value=!0,e.next=32;break;case 29:e.prev=29,e.t0=e.catch(10),b(e.t0);case 32:return e.prev=32,g.value=!1,e.finish(32);case 35:case"end":return e.stop()}}),e,null,[[10,29,32,35]])})));return function(t){return e.apply(this,arguments)}}(),Le=function(e){y.value=e;var t=pe.value.findIndex((function(t){return t.id===e}));t<5?(re.value={},Pe(pe.value[t])):(re.value=pe.value.find((function(t){return t.id===e})),Pe(re.value)),ee.value.datauser="sql"+s(6),ee.value.datapassword=s(6,"password")};Y((function(){return ne.value.version}),(function(){ee.value.version=ne.value.version}));var Ce=function(){var e=u(a().mark((function e(){var t,n,r,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,fe.value=!0,e.next=4,Se();case 4:return e.next=6,ke();case 6:return y.value=null===(t=pe.value[0])||void 0===t?void 0:t.id,e.next=9,Pe(pe.value[0]);case 9:Le(null===(n=pe.value[0])||void 0===n?void 0:n.id),fe.value=!1,ee.value.sql="MySQL",re.value={},(r=i.value.sitePath)&&(ee.value.path=r,Z=null===(l=r+"/")||void 0===l?void 0:l.replace(/\/\//g,"/")),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),fe.value=!1;case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(){return e.apply(this,arguments)}}();return L(Ce),l({init:Ce,onConfirm:Ue}),function(e,t){var n=d,r=x,a=A,l=R,u=p,o=he,s=J,i=Q,c=G,f=_,v=$;return C(),O("div",$e,[N("span",We,[t[12]||(t[12]=q(" 快速的部署网站程序，商城、论坛、博客、框架等程序， ")),S(n,{href:"https://www.bt.cn/bbs/thread-33063-1-1.html"},{default:D((function(){return t[11]||(t[11]=[q(" 免费入驻平台 ")])})),_:1})]),S(s,{model:E(ee),rules:E(ye),class:"pt-[12px]",ref_key:"addDeploySiteFormRef",ref:k},{default:D((function(){return[S(l,{label:"模板部署",class:""},{default:D((function(){var e,l;return[N("div",Ye,[(C(!0),O(U,null,H(E(pe),(function(e,t){return F((C(),O("div",{key:e.id,class:B([{"template-focus":E(y)===e.id},"mb-[4px] w-full flex items-center border border-[#ccc] py-[4px] px-[8px] rounded-[4px] cursor-pointer template-hover"]),onClick:function(t){return function(e){y.value=e.id,Le(e.id)}(e)}},[S(a,{ref_for:!0,ref:"popover",placement:"top-start",width:"200","popper-class":"white-tips-popover",trigger:"hover"},{reference:D((function(){return[N("div",Ke,[S(r,{src:"/site_dep_ico/".concat(e.name.toLowerCase(),".png"),class:"w-[3.6rem] mr-[4px]"},null,8,["src"]),N("div",Ze,[N("span",et,T(e.title)+" "+T(e.version),1),N("span",tt,T(e.ps.split("<")[0]),1)])])]})),default:D((function(){return[N("div",Xe,[N("span",null,"名称："+T(e.title),1),N("span",null,"版本："+T(e.version),1),N("span",null,"简介："+T(e.ps.split("<")[0]),1),N("span",null,"官网："+T(e.official),1),N("span",null,"评价："+T(e.score),1)])]})),_:2},1536)],10,Be)),[[X,t<5]])})),128)),N("div",{onClick:Ve,class:B([{"justify-center":!E(re).id,"template-focus":E(re).id},"mb-[4px] w-full flex items-center border border-[#ccc] py-[4px] px-[12px] rounded-[4px] cursor-pointer template-hover"])},[N("div",nt,[null!==(e=E(re))&&void 0!==e&&e.id?(C(),O("i",rt)):M("",!0),N("div",at,[null!==(l=E(re))&&void 0!==l&&l.id?(C(),O("span",lt,T(E(re).title)+" "+T(E(re).version),1)):M("",!0),S(n,null,{default:D((function(){return t[13]||(t[13]=[q("更多模板 >>")])})),_:1})])])],2)])]})),_:1}),S(l,{label:"域名",prop:"webname"},{default:D((function(){return[S(a,{ref:"popover",placement:"top-start","popper-class":"green-tips-popover !p-0",title:"",width:"400",visible:E(V),"onUpdate:visible":t[2]||(t[2]=function(e){return I(V)?V.value=e:null}),"trigger-keys":[],trigger:"focus"},{reference:D((function(){return[F(S(u,{onInput:_e,modelValue:E(ee).webname,"onUpdate:modelValue":t[0]||(t[0]=function(e){return E(ee).webname=e}),type:"textarea",width:"52rem",rows:4,resize:"none",onFocus:t[1]||(t[1]=function(e){return V.value=!0}),placeholder:"如需填写多个域名，请换行填写，每行一个域名，默认为80端口\nIP地址格式：192.168.1.199\n泛解析添加方法 *.domain.com\n如另加端口格式为 www.domain.com:88"},null,8,["modelValue"]),[[v,void 0,"popover"]])]})),default:D((function(){return[t[14]||(t[14]=N("div",{class:"!p-[12px] bg-[#20a53a] text-white"},[q(" 如需填写多个域名，请换行填写，每行一个域名，默认为80端口 "),N("br"),q(" IP地址格式：192.168.1.199 "),N("br"),q(" 泛解析添加方法 *.domain.com "),N("br"),q(" 如另加端口格式为 www.domain.com:88 ")],-1))]})),_:1},8,["visible"])]})),_:1}),S(l,{label:"备注"},{default:D((function(){return[S(u,{modelValue:E(ee).ps,"onUpdate:modelValue":t[3]||(t[3]=function(e){return E(ee).ps=e}),placeholder:"请输入备注,可为空",width:"52rem"},null,8,["modelValue"])]})),_:1}),S(l,{label:"根目录",prop:"path"},{default:D((function(){return[S(o,{modelValue:E(ee).path,"onUpdate:modelValue":t[4]||(t[4]=function(e){return E(ee).path=e}),placeholder:"请输入根目录",icon:"el-folder-opened",width:"52rem",onIconClick:me},null,8,["modelValue"])]})),_:1}),S(l,{label:"其他配置",prop:"other"},{default:D((function(){return[N("div",ut,[N("div",ot,[N("span",{class:B({"text-danger":!E(ne).isSetup})}," 数据库："+T(E(ne).isSetup?"MySQL数据库":"数据库未安装！"),3),N("span",null,"编码："+T(E(ne).code),1),N("span",null,"账号："+T(E(ee).datauser),1),N("span",null,"密码："+T(E(ee).datapassword),1),N("span",null,"PHP版本："+T(E(ne).version),1)])]),N("span",st,[t[16]||(t[16]=q(" 其他配置初始状态为默认选择的配置项，如需修改请点击 ")),S(n,{onClick:je},{default:D((function(){return t[15]||(t[15]=[q("编辑配置")])})),_:1})])]})),_:1})]})),_:1},8,["model","rules"]),S(f,{title:"编辑配置",modelValue:E(de),"onUpdate:modelValue":t[10]||(t[10]=function(e){return I(de)?de.value=e:null}),showFooter:"",area:62,onConfirm:qe},{default:D((function(){return[N("div",it,[S(s,{model:E(ae),rules:E(ye),ref:"editFormRef"},{default:D((function(){return[S(l,{label:"数据库"},{default:D((function(){return[S(c,{class:"!w-[16rem]",modelValue:E(ee).sql,"onUpdate:modelValue":t[5]||(t[5]=function(e){return E(ee).sql=e})},{default:D((function(){return[S(i,{label:"MySQL",value:"MySQL"})]})),_:1},8,["modelValue"]),S(c,{modelValue:E(ae).code,"onUpdate:modelValue":t[6]||(t[6]=function(e){return E(ae).code=e}),class:"ml-[8px] !w-[16rem]"},{default:D((function(){return[S(i,{label:"utf8mb4",value:"utf8mb4"}),S(i,{label:"utf8",value:"utf8"}),S(i,{label:"gbk",value:"gbk"}),S(i,{label:"big5",value:"big5"})]})),_:1},8,["modelValue"])]})),_:1}),S(l,{label:"数据库账号"},{default:D((function(){return[N("div",ct,[S(l,{prop:"datauser",label:""},{default:D((function(){return[S(u,{placeholder:"创建数据库账号",modelValue:E(ae).datauser,"onUpdate:modelValue":t[7]||(t[7]=function(e){return E(ae).datauser=e}),width:"17rem"},null,8,["modelValue"])]})),_:1}),S(l,{label:"",class:"!mt-0"},{default:D((function(){return[S(u,{class:"ml-[8px]",width:"16rem",placeholder:"数据库密码",modelValue:E(ae).datapassword,"onUpdate:modelValue":t[8]||(t[8]=function(e){return E(ae).datapassword=e})},null,8,["modelValue"])]})),_:1})]),t[17]||(t[17]=N("span",{class:"text-[#999] text-[1.2rem]"}," 创建站点的同时，为站点创建一个对应的数据库帐户，方便不同站点使用不同数据库。 ",-1))]})),_:1}),S(l,{label:"PHP版本"},{default:D((function(){return[S(c,{class:"!w-[16rem]",modelValue:E(ae).version,"onUpdate:modelValue":t[9]||(t[9]=function(e){return E(ae).version=e})},{default:D((function(){return[(C(!0),O(U,null,H(E(ve),(function(e){return C(),z(i,{key:e.value,label:e.name,disabled:!e.status,value:e.version},{default:D((function(){return[N("span",null,T(e.name),1),e.status?M("",!0):(C(),O(U,{key:0},[t[18]||(t[18]=q(" [ ")),N("a",{class:"my-4px bt-link",onClick:function(t){return ge(e.version)}},"未安装",8,pt),t[19]||(t[19]=q(" ] "))],64))]})),_:2},1032,["label","disabled","value"])})),128))]})),_:1},8,["modelValue"]),t[20]||(t[20]=N("span",{class:"text-[#999] text-[1.2rem] ml-1rem"},"* 仅显示选中模板所支持的PHP版本",-1))]})),_:1})]})),_:1},8,["model","rules"])])]})),_:1},8,["modelValue"])])}}}),ft=v(dt,[["__scopeId","data-v-b4ba70b5"]]),vt=V({__name:"index",setup:function(e,t){var n=t.expose,r=xe().isRefreshList,l=m(),o=P("域名|1|0|0|0\n域名|1|0|0|0\n域名|1|0|0|0"),s=W("popupClose"),i=function(e){return e.replace(/\s+/g,"")},c=[{label:"名称",prop:"name"},{label:"FTP",prop:"db_status",render:function(e){return"boolean"==typeof e.db_status?K("span",{class:e.db_status?"text-primary":""},e.db_status?"已配置":"未配置"):K("span",e.db_status)}},{label:"数据库",prop:"ftp_status",render:function(e){return"boolean"==typeof e.ftp_status?K("span",{class:e.ftp_status?"text-primary":""},e.ftp_status?"已配置":"未配置"):K("span",e.ftp_status)}},{label:"结果",render:function(e){return K("span",{class:e.status?"text-primary":"text-danger truncate !w-[9.6rem] inline-block"},e.status?"操作成功":e.msg)}}],d=function(){var e=u(a().mark((function e(t){var n,u,p,d,f,v,m,h,w,b,_,x,y,g,k,V,j;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=o.value.split("\n"),u=[],p=0;case 3:if(!(p<n.length)){e.next=45;break}if(d=n[p],f=d.split("|"),v=[],""!==d){e.next=9;break}return e.abrupt("continue",42);case 9:m=0;case 10:if(!(m<f.length)){e.next=41;break}h=p+1,w=i(f[m]),v.push(w),e.t0=m,e.next=0===e.t0?17:1===e.t0?33:38;break;case 17:b=w.split(","),_=0;case 19:if(!(_<b.length)){e.next=32;break}if(x=b[_].trim(),y=x.split(":"),a=y[0],/^([\w\u4e00-\u9fa5\-\*]{1,100}\.){1,10}([\w\u4e00-\u9fa5\-]{1,24}|[\w\u4e00-\u9fa5\-]{1,24}\.[\w\u4e00-\u9fa5\-]{1,24})$/.test(i(a))){e.next=25;break}return l.error("第"+h+"行,域名格式错误【"+y[0]+"】"),e.abrupt("return",!1);case 25:if(void 0===y[1]){e.next=29;break}if(t=y[1],/^([1-9]|[1-9]\d|[1-9]\d{2}|[1-9]\d{3}|[1-5]\d{4}|6[0-4]\d{3}|65[0-4]\d{2}|655[0-2]\d|6553[0-5])$/.test(t)){e.next=29;break}return l.error("第"+h+"行,端口格式错误【"+y[1]+"】"),e.abrupt("return",!1);case 29:_++,e.next=19;break;case 32:return e.abrupt("break",38);case 33:if("1"===w){e.next=37;break}if(!(w.indexOf("/")<-1)){e.next=37;break}return l.error("第"+h+"行,站点目录格式错误【"+w+"】"),e.abrupt("return",!1);case 37:return e.abrupt("break",38);case 38:m++,e.next=10;break;case 41:u.push(v.join("|").replace(/\r|\n/,""));case 42:p++,e.next=3;break;case 45:return g=l.load("正在批量添加站点,请稍后..."),e.prev=46,e.next=49,pe({create_type:"txt",websites_content:JSON.stringify(u)});case 49:k=e.sent,V=k.data,j=[],Object.keys(V.success).forEach((function(e){j.push({name:e,status:!0,ftp_status:V.success[e].ftp_status,db_status:V.success[e].db_status})})),Object.keys(V.error).forEach((function(e){j.push({name:e,status:!1,ftp_status:"--",db_status:"--",msg:V.error[e]})})),r.value=!0,s(),ge({resultColumn:c,resultData:j,resultTitle:"添加站点"},46),o.value="域名|1|0|0|0\n域名|1|0|0|0\n域名|1|0|0|0",e.next=63;break;case 60:e.prev=60,e.t1=e.catch(46);case 63:return e.prev=63,g.close(),e.finish(63);case 66:case"end":return e.stop()}var t,a}),e,null,[[46,60,63,66]])})));return function(t){return e.apply(this,arguments)}}();return n({onConfirm:d}),function(e,t){var n=p;return C(),O("div",null,[S(n,{type:"textarea",modelValue:E(o),"onUpdate:modelValue":t[0]||(t[0]=function(e){return I(o)?o.value=e:null}),rows:12,resize:"none",width:"72rem"},null,8,["modelValue"]),t[1]||(t[1]=N("ul",{class:"mt-[8px] text-[#999] leading-10"},[N("li",null,"批量格式：域名|根目录|FTP|数据库|PHP版本"),N("li",null,"域名参数：多个域名用 , 分割"),N("li",null,"根目录参数：填写 1 为自动创建，或输入具体目录"),N("li",null,"FTP参数：填写 1 为自动创建，填写 0 为不创建"),N("li",null,"数据库参数：填写 1 为自动创建，填写 0 为不创建"),N("li",null,"PHP版本参数：填写 0 为静态，或输入PHP具体版本号列如：56、71、74"),N("li",null,"如需添加多个站点，请换行填写"),N("li",null,[q(" 案例： "),N("span",null,"bt.cn,test.cn:8081|/www/wwwroot/bt.cn|1|1|56")])],-1))])}}}),mt={class:"h-[58rem]"},ht=V({__name:"index",setup:function(e,r){var l=r.expose,o=P(),s=W("popupClose"),p=P([]),d=P(!1),v=[{content:"请选择您的环境包进行网站部署"},{content:"如需导入,请选择本地计算机中后缀为tar.gz格式的应用环境包"}],m=function(){var e=u(a().mark((function e(t,n,r,l){var o,s,i,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=l.label,s=l.value,i=new Map([["delete","批量删除选中的应用包"]]),c=function(){var e=u(a().mark((function e(t,n){var r,l,u,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=new Map([["delete",de]]),l=t.app_name,u=t.app_version,o=r.get(s),e.t0=s,e.next="delete"===e.t0?6:10;break;case 6:if(!o){e.next=10;break}return e.next=9,o({app_name:l,app_version:u});case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.next=5,t({title:"批量".concat(o),content:"".concat(i.get(s),"，是否继续操作？"),column:[{label:"环境包",prop:"app_name"},Pe()],onConfirm:function(){var e=u(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(c);case 2:return k(),e.abrupt("return",!1);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()});case 5:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),b=function(){var e=u(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i({title:"删除环境包【".concat(t.app_name,"】"),content:"您真的要删除环境包【".concat(t.app_name,"】吗？")});case 2:return e.next=4,c({loading:"正在删除环境包，请稍后...",request:de({app_name:t.app_name,app_version:t.app_version}),message:!0});case 4:e.sent.status&&k();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=u(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h({title:"上传应用环境包",isAsync:!0,component:function(){return w((function(){return t.import("./upload-app-legacy.js?v=1734676359")}),void 0,t.meta.url)},area:80,btn:["开始上传","取消"],compData:{refreshEvent:k,path:"/www/backup/upload_package/temp",api:"/mod/php/aepg/upload_package",accept:".gz",help:[{text:"只支持.tar.gz文件格式导入"}],useEmptyPlaceholder:!1}});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(e){h({isAsync:!0,title:"部署应用环境包",area:70,btn:"确定",component:function(){return w((function(){return t.import("./deploy-package-legacy.js?v=1734676359")}),void 0,t.meta.url)},compData:n(n({},e),{},{close:s})})},k=function(){var e=u(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c({loading:d,request:fe(),data:{data:[Array,p]}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=P([Ve(),{label:"名称",prop:"app_name"},{label:"版本",prop:"app_version"},{label:"时间",width:150,prop:"addtime"},je([{onClick:x,title:"部署"},{onClick:b,title:"删除"}])]),j=[{label:"删除",value:"delete",event:m}];return L(k),l({init:k}),function(e,t){var n=ee,r=y,a=g,l=ke,u=f,s=Z("bt-loading");return C(),O("div",mt,[S(l,null,{"header-left":D((function(){return[S(n,{type:"primary",onClick:_},{default:D((function(){return t[0]||(t[0]=[q("导入应用包")])})),_:1})]})),"header-right":D((function(){return t[1]||(t[1]=[])})),content:D((function(){return[F(S(r,{ref_key:"appEnvPackRef",ref:o,column:E(V),data:E(p),"max-height":480},null,8,["column","data"]),[[s,E(d)]])]})),"footer-left":D((function(){return[S(a,{"table-ref":E(o),options:E(j)},null,8,["table-ref","options"])]})),_:1}),S(u,{options:v,class:"list-disc mt-[2rem] ml-[2rem]"})])}}}),wt={class:"p-[20px]"};e("default",V({__name:"index",props:{compData:{default:{}}},setup:function(e,t){var n=t.expose,l=e,o=r().plugin,s=m(),i=P("addSiteDefault");P(null);var c=W("popupSetFooter",(function(e){})),p=function(){var e=u(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ve();case 3:return t=e.sent,n=t.data,e.abrupt("return",{ftp:n.ftp,mysql:n.mysql});case 8:e.prev=8,e.t0=e.catch(0),b(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),d=l.compData,f=d.typeList,v=d.refresh,h=k({type:"card",value:i,options:[{label:"传统项目",name:"addSiteDefault",lazy:!0,render:S(me,{compData:{getStatus:p,typeList:f,refresh:v}},null)},{label:"swoole异步项目",name:"addSwoole",lazy:!0,render:S(Ie,{compData:{getStatus:p}},null)},{label:"thinkphp异步项目",name:"addThinkphp",lazy:!0,render:S(Ae,{compData:{getStatus:p}},null)},{label:"异步项目",name:"addUniversal",lazy:!0,render:S(Je,{compData:{getStatus:p}},null)},{label:"一键部署",name:"addDeployment",lazy:!0,render:S(ft,{compData:{getStatus:p}},null)},{label:"批量创建",name:"batchAddSite",lazy:!0,render:S(vt,null,null)},{label:"应用环境包",name:"addPack",lazy:!0,render:S(ht,null,null)}]}),w=h.BtTabs,_=h.tabsRefs;Y((function(){return i.value}),(function(e){c("addPack"!==e)}));var x=function(){var e=u(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("addSwoole"!==i.value&&"addThinkphp"!==i.value&&"addUniversal"!==i.value||"nginx"===o.value.webserver){e.next=2;break}return e.abrupt("return",s.error("当前仅支持nginx服务器使用"));case 2:_()[i.value].onConfirm(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return L((function(){"addPack"===i.value&&c(!1)})),n({onConfirm:x,getStatus:p}),function(e,t){return C(),O("div",wt,[S(E(w))])}}}))}}}))}();
