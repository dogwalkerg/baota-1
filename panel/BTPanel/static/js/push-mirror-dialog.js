import{c as e,h as a,r as l,o as r,k as s,l as o,e as t,x as u,p as m,N as n,a7 as i,a4 as c}from"./base-lib.js?v=1734676359";import{G as d,b as p,a4 as f,j as b,e as v}from"./utils-lib.js?v=1734676359";import{g,P as _,bj as h}from"./useStore3.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";const k={class:"flex flex-col p-[1.6rem] lib-box"},j=v(e({__name:"push-mirror-dialog",props:{compData:{default:()=>({})}},emits:["close"],setup(e,{expose:v,emit:j}){const w=p(),{refs:{isRefreshTableList:y}}=g(),x=e,V=j,E=a({tag:"",name:"",id:""}),S=l(),q={tag:[{validator:(e,a,l)=>{""===a?l(new Error("请输入版本，如：btphp_1.1")):l()},trigger:["blur"]}],name:[{validator:(e,a,l)=>{""===a?l(new Error("请选择仓库名")):l()},trigger:["blur"]}]},D=l([]);r((async()=>{E.id=x.compData.row.id,d({request:_(),data:Array,success:e=>{var a;if(1===e.length){const a=e[0];"docker.io"==a.url&&"docker官方库"==a.name&&""==a.username&&(w.error("docker官方库不支持推送镜像"),V("close"))}e.forEach((e=>{"docker.io"==e.url&&"docker官方库"==e.name&&""==e.username||D.value.push({value:e.url,label:"".concat(e.name).concat("docker.io"===e.url?"":"(".concat(e.url,")")),url:e.url,name:e.name})})),E.name=null==(a=D.value[0])?void 0:a.value}})}));return v({onConfirm:async()=>{try{await S.value.validate((async e=>{if(e){let e={...E,name:D.value.find((e=>e.url==E.name)).name,url:D.value.find((e=>e.url==E.name)).url};d({request:h({data:JSON.stringify(e)}),message:!0,success:({status:e})=>{e&&(y.value=!0,V("close"))}})}}))}catch(e){}}}),(e,a)=>{const l=f,r=i,d=b,p=c;return s(),o("div",k,[t(p,{ref_key:"cmdFormRef",ref:S,size:"small",model:m(E),rules:q,class:"relative w-full","label-position":"right",onSubmit:a[2]||(a[2]=n((()=>{}),["prevent"]))},{default:u((()=>[t(r,{prop:"name",label:"仓库名"},{default:u((()=>[t(l,{modelValue:m(E).name,"onUpdate:modelValue":a[0]||(a[0]=e=>m(E).name=e),options:m(D),class:"!w-[24rem]"},null,8,["modelValue","options"])])),_:1}),t(r,{prop:"tag",label:"标签"},{default:u((()=>[t(d,{modelValue:m(E).tag,"onUpdate:modelValue":a[1]||(a[1]=e=>m(E).tag=e),class:"w-[24rem]",placeholder:"请输入版本，如：btphp_1.1"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])}}}),[["__scopeId","data-v-661ebb04"]]);export{j as default};
