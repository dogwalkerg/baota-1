import{c as e,r as a,h as s,aD as r,o as t,k as i,l,e as o,x as p,p as d,J as n,z as u,bO as m,a7 as c,a4 as _}from"./base-lib.js?v=1734676359";import{j as g}from"./utils-lib.js?v=1734676359";import{H as v}from"./useMethod2.js?v=1734676359";import{s as j}from"./index105.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./validator.js?v=1734676359";import"./index91.js?v=1734676359";import"./column.js?v=1734676359";import"./index88.js?v=1734676359";import"./index13.js?v=1734676359";import"./index101.js?v=1734676359";import"./index90.js?v=1734676359";import"./index97.js?v=1734676359";import"./index99.js?v=1734676359";import"./index107.js?v=1734676359";import"./useMethod3.js?v=1734676359";import"./database.js?v=1734676359";const h={class:"p-2rem"},f=e({__name:"index",props:{compData:{default:()=>({})}},emits:["update:value"],setup(e,{expose:f,emit:x}){const b=e,y=a(),k=a(!1),V=a(),w=s({run_script_id:"",script:"",args:""}),C=s({is_args:"",args_holder:"",args_title:""}),D={label:"name",value:"script_id",children:"script_list"},O=s({run_script_id:[{required:!0,message:"请选择脚本",trigger:"change"}],args:[{required:!0,message:"请输入值",trigger:"blur"}]}),q=a(b.compData.value),A=a([]);r((()=>{q.value=b.compData.value}));const H=e=>{let a=V.value.getCheckedNodes()[0].data;w.script=a.script,1===a.is_args?(C.is_args=!0,C.args_holder=a.args_ps,C.args_title=a.args_title):C.is_args=!1};return t((()=>{(async()=>{try{const e=await v();A.value=Array.isArray(e)?e.filter((e=>"服务管理"==e.name)):[]}catch(e){}})()})),f({onConfirm:async e=>{await y.value.validate(),q.value=""!==q.value?q.value+"\n"+w.script:w.script,-1!==w.script.indexOf("php_version")&&(q.value=q.value.replace("${1/./}",w.args)),Object.assign(j.value,{scriptText:q.value,args:w.args}),e()}}),(e,a)=>{const s=m,r=c,t=g,v=_;return i(),l("div",h,[o(v,{ref_key:"taskEvent",ref:y,disabled:d(k),"label-width":"80px",model:d(w),rules:d(O)},{default:p((()=>[o(r,{label:"选择脚本",prop:"run_script_id"},{default:p((()=>[o(s,{"show-all-levels":!1,onChange:H,modelValue:d(w).run_script_id,"onUpdate:modelValue":a[0]||(a[0]=e=>d(w).run_script_id=e),ref_key:"scriptCascader",ref:V,props:D,options:d(A),placeholder:"请选择脚本,支持搜索",filterable:""},null,8,["modelValue","options"])])),_:1}),d(C).is_args?(i(),n(r,{key:0,label:d(C).args_title,prop:"args"},{default:p((()=>[o(t,{placeholder:d(C).args_holder,modelValue:d(w).args,"onUpdate:modelValue":a[1]||(a[1]=e=>d(w).args=e),width:"17rem"},null,8,["placeholder","modelValue"])])),_:1},8,["label"])):u("",!0)])),_:1},8,["disabled","model","rules"])])}}});export{f as default};
