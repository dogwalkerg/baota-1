import{_ as a}from"./index90.js?v=1734676359";import{G as e,o as l,k as s,j as t,h as o,b as i}from"./utils-lib.js?v=1734676359";import{c as u,p as n,r,R as d,o as c,B as m,k as p,l as v,e as f,x as h,M as b,y as g,C,q as w,N as y,aY as _,P as x,A as V,a7 as k,a4 as j}from"./base-lib.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";const P={class:"p-[20px]"},q={class:"p-[20px]"},O=u({__name:"class-manage",props:{compData:{default:()=>({ignore:[],getClassList:()=>Promise.resolve([]),addClass:()=>Promise.resolve({}),editClass:()=>Promise.resolve({}),deleteClass:()=>Promise.resolve({}),updateOptions:()=>Promise.resolve([]),field:"ps",showEdit:!0})}},setup(u){const O=u,{getClassList:U,addClass:D,editClass:E,deleteClass:L,ignore:S,field:A,updateOptions:B,showEdit:G}=n(O.compData),H=r(""),M=r(""),N=r(!1),R=r(!1),T=d([]),Y=d({label:"",value:0}),z=i(),F=[{label:"分类名称",prop:"label",showOverflowTooltip:!0},{label:"操作",align:"right",render:a=>"all"===a.value||(null==S?void 0:S.includes("".concat(a.value)))?"不可操作":f("div",{class:"flex items-center"},[G&&f("span",{class:"flex items-center"},[f("span",{class:"bt-link",onClick:()=>K(a)},[g("编辑")]),f(_,{direction:"vertical"},null)]),f("span",{class:"bt-link",onClick:()=>W(a)},[g("删除")])])}],I=async()=>{try{N.value=!0;const a=await U();T.value=a||[],B(T.value)}catch(a){}finally{N.value=!1}},J=async()=>{try{if(!H.value)return z.error("请输入分类名称");const a={[A]:H.value},l=await e({loading:"正在添加分类，请稍后...",request:D(a)});X(l),H.value=""}catch(a){}},K=a=>{R.value=!0,Y.value=a,M.value=a.label},Q=async()=>{try{const a={[A]:M.value,id:Y.value.value},l=await e({loading:"正在编辑分类，请稍后...",request:E(a)});l.status&&(R.value=!1),M.value="",X(l)}catch(a){}},W=async a=>{try{await l({title:"提示",content:"确认删除该分类吗？该分类下的所有数据将会被移动至默认分类下，是否继续？"});const s=await e({loading:"正在删除分类，请稍后...",request:L({id:a.value})});X(s)}catch(s){}},X=a=>{a.status&&I(),z.request(a)};return c((()=>{I()})),(e,l)=>{const i=x,u=V,r=s,d=t,c=k,_=j,O=o,U=a,D=m("bt-loading");return p(),v("div",P,[f(U,null,{"header-left":h((()=>[f(i,{modelValue:n(H),"onUpdate:modelValue":l[0]||(l[0]=a=>b(H)?H.value=a:null),placeholder:"请输入分类名称",class:"!w-[41rem]"},null,8,["modelValue"]),f(u,{type:"primary",class:"ml-[1rem]",onClick:J},{default:h((()=>l[4]||(l[4]=[g(" 添加分类 ")]))),_:1})])),content:h((()=>[C(f(r,{column:F,data:n(T),"max-height":"250"},null,8,["data"]),[[D,n(N)]])])),popup:h((()=>[f(O,{modelValue:n(R),"onUpdate:modelValue":l[3]||(l[3]=a=>b(R)?R.value=a:null),area:40,title:"编辑分类","show-footer":"",onConfirm:Q},{default:h((()=>[w("div",q,[f(_,{onSubmit:l[2]||(l[2]=y((()=>{}),["prevent"]))},{default:h((()=>[f(c,{label:"分类名称",prop:"name"},{default:h((()=>[f(d,{modelValue:n(M),"onUpdate:modelValue":l[1]||(l[1]=a=>b(M)?M.value=a:null),autofocus:"",placeholder:"请输入分类名称",onSubmit:Q,width:"22rem"},null,8,["modelValue"])])),_:1})])),_:1})])])),_:1},8,["modelValue"])])),_:1}),l[5]||(l[5]=w("ul",{class:"mt-[8px] leading-8 text-[1.2rem] list-disc ml-[20px]"},[w("li",null,"【批量操作-设置分类】可修改当前分类，仅具备批量操作的列表")],-1))])}}});export{O as default};
