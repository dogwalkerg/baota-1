import{c as a,r as e,o as l,B as s,k as t,l as u,e as n,x as o,p as r,M as m,q as d,y as i,z as v,I as p,aX as w,J as c,C as f,ay as h,Q as y,ag as b,ah as g,A as x}from"./base-lib.js?v=1734676359";import{B as V}from"./index185.js?v=1734676359";import{u as _,G as j,aa as C,b as B}from"./utils-lib.js?v=1734676359";import{getFileBody as k,getErrorConfig as S,setErrorConfig as q}from"./site.js?v=1734676359";import{S as z}from"./useStore7.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./ace.js?v=1734676359";const G={class:"flex flex-col"},U={class:"flex items-center justify-between mb-[8px]"},D={key:0},E={class:"h-[44rem] w-full"},F=a({__name:"default-page",setup(a,{expose:F}){const{saveFileEvent:H}=z(),I=B(),{plugin:A}=_(),{webserver:J}=A.value,K=e("/www/server/panel/data/defaultDoc.html"),M=e(""),N=e(),Q=e("utf-8"),R=e(["utf-8","GBK","GB2312","BIG5"]),X=e(!1),L=e(!1),O=async()=>{try{L.value=!0;const{data:a}=await k({path:K.value});M.value=a.data,Q.value=a.encoding||"utf-8",L.value=!1}catch(a){}},P=async a=>{L.value=!0,K.value=a,await O(),"/www/server/panel/data/404.html"===a&&T(),L.value=!1},T=async()=>{const{status:a}=await j({request:S(),data:{status:String}});X.value=Boolean(Number(a))},W=a=>{j({loading:"正在设置，请稍后...",request:q({status:a?1:0}),message:!0})},Y=async()=>{const a=await H({path:K.value,data:M.value,encoding:Q.value});I.request(a)};return l((()=>{O()})),F({onRefresh:()=>{K.value="/www/server/panel/data/defaultDoc.html",O()}}),(a,e)=>{const l=h,_=C,j=y,B=b,k=g,S=V,q=x,z=s("bt-loading");return t(),u("div",G,[n(_,{type:"card",modelValue:r(K),"onUpdate:modelValue":e[0]||(e[0]=a=>m(K)?K.value=a:null),onChange:P},{default:o((()=>[n(l,{label:"新建网站默认页面",name:"/www/server/panel/data/defaultDoc.html"}),n(l,{label:"404错误页",name:"/www/server/panel/data/404.html",lazy:!0}),n(l,{label:"网站不存在页",name:"/www/server/"+r(J)+"/"+("nginx"===r(J)?"html":"htdocs")+"/index.html",lazy:!0},null,8,["name"]),n(l,{label:"网站停用后的提示页",name:"/www/server/stop/index.html",lazy:!0})])),_:1},8,["modelValue"]),d("div",U,["/www/server/panel/data/404.html"===r(K)?(t(),u("div",D,[n(j,{modelValue:r(X),"onUpdate:modelValue":e[1]||(e[1]=a=>m(X)?X.value=a:null),onChange:W},{default:o((()=>e[4]||(e[4]=[i("开启404错误页设置")]))),_:1},8,["modelValue"])])):v("",!0),e[5]||(e[5]=i(" 提示：Ctrl+F 搜索关键字，Ctrl+S 保存，Ctrl+H 查找替换 ")),n(k,{class:"!w-[16rem]",modelValue:r(Q),"onUpdate:modelValue":e[2]||(e[2]=a=>m(Q)?Q.value=a:null),onChange:Y},{default:o((()=>[(t(!0),u(p,null,w(r(R),(a=>(t(),c(B,{key:a,value:a,label:a},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])]),f((t(),u("div",E,[n(S,{ref_key:"aceEditor",ref:N,"file-path":r(K),modelValue:r(M),"onUpdate:modelValue":e[3]||(e[3]=a=>m(M)?M.value=a:null),onSave:Y,class:"h-[40rem] w-full"},null,8,["file-path","modelValue"]),n(q,{class:"flex !mt-[12px]",type:"primary",onClick:Y},{default:o((()=>e[6]||(e[6]=[i("保存")]))),_:1})])),[[z,r(L)]])])}}});export{F as default};
