import{l as e,H as a,G as r,S as o,F as t,k as s,V as l,o as n}from"./utils-lib.js?v=1734676359";import{_ as d}from"./index90.js?v=1734676359";import{_ as i}from"./index97.js?v=1734676359";import{c as p,r as m,h as _,o as u,B as f,k as c,J as w,x as b,e as j,y as g,p as v,M as y,C as P,A as h}from"./base-lib.js?v=1734676359";import{w as T,x as A}from"./firewall.js?v=1734676359";import{a as S}from"./column.js?v=1734676359";import{r as x,d as E,e as V}from"./useMethod4.js?v=1734676359";import{_ as k}from"./index.vue_vue_type_script_setup_true_lang11.js?v=1734676359";import{getFirewallStore as C}from"./useStore4.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";import"./validator.js?v=1734676359";const F=p({__name:"index",setup(p){const{refs:{systemTabActive:F}}=C(),q=m(),H=m([]),I=m(""),U=m(0),D=m(!1),L=_({p:1,row:20}),M=(r,o)=>{e({title:r?"修改端口转发规则":"添加端口转发规则",area:44,component:()=>a((()=>import("./add-port-transmit.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),showFooter:!0,compData:{...o,isEdit:r,refreshFn:R}})},R=async()=>{"forward"===F.value&&await r({loading:D,request:T({query:I.value}),data:{data:[Array,H],page:o(U)}})},B=(e,a)=>({operation:a,protocol:e.Protocol.toLowerCase(),S_Address:e.S_Address,S_Port:e.S_Port,T_Address:e.T_Address,T_Port:e.T_Port}),G=[S(),{label:"协议",prop:"Protocol"},{label:"源端口",prop:"S_Port"},{label:"目标IP",render:e=>e.T_Address?e.T_Address:"127.0.0.1"},{label:"目标端口",prop:"T_Port"},{label:"时间",prop:"addtime",renderHeader:()=>x("时间","-- : 表示面板数据库中未记录创建时间，规则从系统中直接读取，忽略即可")},{label:"备注",prop:"brief"},E({editEvent:e=>{M(!0,e)},deleteEvent:async e=>{await n({icon:"warning-filled",title:"删除端口转发规则【源端口："+e.S_Port+" -> 目标端口："+e.T_Port+"】",content:"删除选中规则后，该源端口将停止转发至目标端口，是否继续操作？"}),await r({loading:"正在删除IP规则，请稍后...",request:A(B(e,"remove")),message:!0,success:R})}})],J=[{label:"删除",value:"delete",event:async(e,a)=>{await V(e,a,(async(e,a)=>await A(B(e,"remove"))),{label:"端口",prop:"T_Address"},R)}}];return u((()=>R())),(e,a)=>{const r=h,o=t,n=s,p=l,m=i,_=d,u=f("bt-loading");return c(),w(_,null,{"header-left":b((()=>[j(r,{type:"primary",onClick:a[0]||(a[0]=e=>M())},{default:b((()=>a[6]||(a[6]=[g(" 添加端口转发 ")]))),_:1}),j(k,{type:"forward",refreshFn:R})])),"header-right":b((()=>[j(o,{class:"!w-[32rem]",modelValue:v(I),"onUpdate:modelValue":a[1]||(a[1]=e=>y(I)?I.value=e:null),onSearch:a[2]||(a[2]=e=>R()),placeholder:"请输入端口/来源"},null,8,["modelValue"])])),content:b((()=>[P(j(n,{ref_key:"portTransmitRef",ref:q,column:G,data:v(H),description:"端口转发列表为空"},null,8,["data"]),[[u,v(D)],[u,"正在加载端口转发列表，请稍后...","title"]])])),"footer-left":b((()=>[j(p,{"table-ref":v(q),options:J},null,8,["table-ref"])])),"footer-right":b((()=>[j(m,{total:v(U),page:v(L).p,"onUpdate:page":a[3]||(a[3]=e=>v(L).p=e),row:v(L).row,"onUpdate:row":a[4]||(a[4]=e=>v(L).row=e),onChange:a[5]||(a[5]=e=>R()),name:"forward"},null,8,["total","page","row"])])),_:1})}}});export{F as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
