import{n as e,b6 as a,j as s,O as l,h as t,e as o,l as d,G as c,H as i}from"./utils-lib.js?v=1734676359";import{c as r,s as p,k as m,l as n,e as u,x as f,p as h,J as _,z as g,a7 as y,a4 as b,q as k,y as w,v,M as V,ag as j,ah as x,b3 as T,b2 as z,Q as F,A as S,g as C,r as U,ax as D,h as R}from"./base-lib.js?v=1734676359";import{_ as N}from"./index88.js?v=1734676359";const q=a=>e.post("files/GetFileBody",{data:a,check:"object"}),O=a=>e.post("files/GetDirNew",{data:a,check:"ignore"}),G=a=>e.post("/files?action=GetDirNew&tojs=GetFiles",{customType:"model",data:a}),E=a=>e.post("files/MvFile",{data:a,check:"msg"}),I=a=>e.post("files/".concat("dir"===a.type?"CreateDir":"CreateFile"),{data:{path:a.path},check:"msg"}),A=a=>e.post("files/".concat("dir"===a.type?"DeleteDir":"DeleteFile"),{data:{path:a.path},check:"msg"}),J=a=>e.post("files/add_files_store",{data:{path:a.path},check:"msg"}),L=a=>e.post("files/del_files_store",{data:{path:a.path},check:"msg"}),P=a=>e.post("/files/logs/set_topping_status",{customType:"model",data:{sfile:a.path,status:"set"===a.type?1:0},check:"msg"}),B=a=>{const s=a.name?{dfile:a.path,filename:a.name}:{dfile:a.path};return e.post("files/CheckExistsFiles",{loading:"正在粘贴文件，请稍候...",data:s,check:"array"})},M=a=>e.post("files/CopyFile",{data:{sfile:a.sfile,dfile:a.dfile},check:"msg"}),Z=a=>e.post("files/MvFile",{data:a,check:"msg"}),H=a=>e.post("/files/logs/copy_file_to",{customType:"model",data:{sfile:a.path},check:"msg"}),$=()=>e.post("system/GetDiskInfo",{check:"array"}),K=()=>e.post("files/get_files_store",{check:"array"}),Q=a=>e.post("files/get_download_url_list",{data:{p:1,...a},check:"object"}),Y=a=>e.post("files/Get_Recycle_bin",{data:a,check:"object"}),W=a=>e.post("files/Recycle_bin",{data:a,check:"msg"}),X=a=>e.post("files/Close_Recycle_bin",{data:a,check:"msg"}),ee=a=>e.post("files/Re_Recycle_bin",{data:a,check:"msg"}),ae=a=>e.post("files/Del_Recycle_bin",{data:a,check:"msg"}),se=a=>e.post("files/Batch_Del_Recycle_bin",{data:a,check:"msg"}),le=a=>e.post("files/download_file",{data:a,check:"object"}),te=a=>e.post("/files/zip/get_zip_files",{data:a,check:"object",customType:"model"}),oe=a=>e.post("/files/gz/get_zip_files",{data:a,check:"object",customType:"model"}),de=a=>e.post("files/SplitFile",{data:a,check:"object"}),ce=a=>e.post("files/JoinConfigFile",{data:a,check:"msg"}),ie=a=>e.post("files/JoinFile",{data:a,check:"msg"}),re=a=>e.post("files/create_download_url",{data:a,check:"msg"}),pe=a=>e.post("files/get_download_url_find",{data:a}),me=a=>e.post("files/remove_download_url",{data:a,check:"msg"}),ne=a=>e.post("/files/logs/get_logs_info",{data:a,check:"object",customType:"model"}),ue=a=>e.post("files/Zip",{data:a,check:"msg"}),fe=a=>e.post("files/ZipAndDownload",{data:a,check:"msg"}),he=a=>e.post("files/UnZip",{data:a,check:"msg"}),_e=()=>e.post("/files/upload/check_email_config",{check:"object",customType:"model"}),ge=a=>e.post("/files/upload/send_to_email",{data:a,check:"object",customType:"model"}),ye=a=>e.post("files/get_file_attribute",{data:a,check:"object"}),be=a=>e.post("files/re_history",{data:a,check:"object"}),ke=a=>e.post("files/GetFileAccess",{data:a,check:"object"}),we=a=>e.post("files/SetFileAccess",{data:a,check:"msg"}),ve=a=>e.post("database/InputSql",{data:a,check:"msg"}),Ve=a=>e.post("/files/zip/add_zip_file",{data:a,check:"msg",customType:"model"}),je=a=>e.post("/files/gz/add_zip_file",{data:a,check:"msg",customType:"model"}),xe=a=>e.post("/files/zip/get_fileinfo_by",{data:a,check:"object",customType:"model"}),Te=a=>e.post("/files/gz/get_fileinfo_by",{data:a,check:"object",customType:"model"}),ze=a=>e.post("/files/zip/write_zip_file",{data:a,check:"msg",customType:"model"}),Fe=a=>e.post("/files/gz/write_zip_file",{data:a,check:"msg",customType:"model"}),Se=a=>e.post("/files/zip/extract_byfiles",{data:a,check:"msg",customType:"model"}),Ce=a=>e.post("/files/gz/extract_byfiles",{data:a,check:"msg",customType:"model"}),Ue=a=>e.post("/files/zip/delete_zip_file",{data:a,check:"msg",customType:"model"}),De=a=>e.post("/files/gz/delete_zip_file",{data:a,check:"msg",customType:"model"}),Re=()=>e.post("/files/conversion/get_convert_liet",{check:"msg",customType:"model"}),Ne=a=>e.post("/files/conversion/run",{data:a,check:"msg",customType:"model"}),qe=a=>e.post("files/DownloadFile",{data:a,check:"msg"}),Oe=a=>e.post("/files/size/get_batch_path_size",{data:a,check:"msg",customType:"model"}),Ge=a=>e.post("files/set_file_ps",{data:a,check:"msg"}),Ee=a=>e.post("files/add_files_rsync",{data:a,check:"msg"}),Ie=()=>e.post("files/file_history_list",{check:"array"}),Ae=a=>e.post("files/GetFileHistory",{data:a,check:"msg"}),Je=a=>e.post("files/del_file_history",{data:a,check:"object"}),Le=a=>e.post("files/SetBatchData",{data:a,check:"msg"}),Pe=a=>e.post("files/BatchPaste",{data:a,check:"msg"}),Be=a=>e.post("/tamper_core/get_effective_path.json",{data:a,customType:"model"}),Me=a=>e.post("files/upload_files_exists",{data:a,check:"array"}),Ze=a=>e.post("/tamper_core/batch_setting.json",{data:a,check:"object",customType:"model"}),He=a=>e.post("/tamper_core/create_path.json",{data:a,check:"object",customType:"model"}),$e=a=>e.post("files/get_images_resize",{data:a,check:"object"}),Ke=a=>e.post("files/get_videos",{data:a,check:"array"}),Qe=a=>e.post("files/GetDirSize",{data:a,check:"string"}),Ye=a=>e.post("files/CreateLink",{data:a,check:"msg"}),We=a=>e.post("/files/conversion/get_log",{data:a,check:"object",customType:"model"}),Xe=a=>e.post("files/test_path",{data:a}),ea=a=>e.post("files/file_history",{data:a}),aa=a=>e.post("/files/size/get_dir_path_size",{data:{path:a,is_refresh:!0},check:"msg",customType:"model"}),sa=a=>e.post("files/read_history",{data:a,check:"object"}),la=a=>e.post("files/del_history",{data:a,check:"msg"}),ta=()=>e.post("/files/upload/get_oss_objects",{customType:"model"}),oa=a=>e.post("/plugin?action=a&s=get_list&name=".concat(a.pname),{data:{path:a.path},check:"object",customType:"model"}),da=(a,s)=>e.post("/files/".concat("upload"===s?"upload/upload_file":"down/download_file"),{data:{data:JSON.stringify(a)},check:"msg",customType:"model"}),ca={class:"p-20px"},ia=r({__name:"receive",setup(e){const t=ga(),{formDisabled:o,rules:d,isSuccess:c,receiveForm:i,receiveFormRef:r}=p(t);return(e,t)=>{const p=s,k=y,w=N,v=b,V=l;return m(),n("div",ca,[u(v,{ref_key:"receiveFormRef",ref:r,disabled:h(o),rules:h(d),model:h(i)},{default:f((()=>[u(k,{label:"用户名",prop:"mName"},{default:f((()=>[u(p,{class:"!w-[24rem]",modelValue:h(i).mName,"onUpdate:modelValue":t[0]||(t[0]=e=>h(i).mName=e),disabled:h(c),placeholder:"请填写用户名，不能有中文或特殊符号"},null,8,["modelValue","disabled"])])),_:1}),u(k,{label:"密码",prop:"password"},{default:f((()=>[h(c)?(m(),_(p,{key:1,class:"!w-[24rem]",modelValue:h(i).password,"onUpdate:modelValue":t[3]||(t[3]=e=>h(i).password=e),disabled:""},null,8,["modelValue"])):(m(),_(w,{key:0,class:"!w-[24rem]",icon:"el-refresh",modelValue:h(i).password,"onUpdate:modelValue":t[1]||(t[1]=e=>h(i).password=e),isActive:!0,onIconClick:t[2]||(t[2]=()=>h(i).password=h(a)(16))},null,8,["modelValue"]))])),_:1}),h(c)?g("",!0):(m(),_(k,{key:0,label:"同步到",prop:"path"},{default:f((()=>[u(p,{class:"!w-[24rem]",modelValue:h(i).path,"onUpdate:modelValue":t[4]||(t[4]=e=>h(i).path=e),disabled:""},null,8,["modelValue"])])),_:1}))])),_:1},8,["disabled","rules","model"]),h(c)?(m(),_(V,{key:0,class:"pl-2rem",options:[{content:"使用上面的用户信息，前往发送数据的服务器创建发送端"}]})):g("",!0)])}}}),ra={class:"p-20px"},pa={class:"flex items-center time-unit"},ma={key:1,class:"mt-20px"},na={class:"pt-2rem flex flex-col"},ua={class:"text-danger p-2rem text-[1.4rem] leading-10 ml-36px"},fa={class:"flex items-center mt-12px ml-4px px-2rem"},ha={class:"bg-[#f6f8f8] footer-btn flex items-center justify-end mt-2rem p-12px w-full"},_a=o(r({__name:"send",setup(e){const a=ga(),{formDisabled:o,sendFormRef:d,rulesSend:c,sendForm:i,alertRsync:r,checkOffRsync:C}=p(a),{helpList:U,handleChangeDelete:D,handleConfirm:R}=a;return(e,a)=>{const p=s,N=y,q=j,O=x,G=T,E=z,I=b,A=l,J=F,L=S,P=t;return m(),n("div",ra,[u(I,{ref_key:"sendFormRef",ref:d,disabled:h(o),rules:h(c),model:h(i)},{default:f((()=>[u(N,{label:"服务器IP",prop:"ip"},{default:f((()=>[u(p,{modelValue:h(i).ip,"onUpdate:modelValue":a[0]||(a[0]=e=>h(i).ip=e),placeholder:"请输入接收服务器IP",width:"34.8rem"},null,8,["modelValue"])])),_:1}),u(N,{label:"同步目录",prop:"path"},{default:f((()=>[u(p,{modelValue:h(i).path,"onUpdate:modelValue":a[1]||(a[1]=e=>h(i).path=e),disabled:"",width:"34.8rem"},null,8,["modelValue"])])),_:1}),u(N,{label:"同步方式",class:"form-row"},{default:f((()=>[u(G,null,{default:f((()=>[u(O,{modelValue:h(i).delete,"onUpdate:modelValue":a[2]||(a[2]=e=>h(i).delete=e),class:"!w-[12rem]",onChange:h(D)},{default:f((()=>[u(q,{label:"增量",value:!1}),u(q,{label:"完全",value:!0})])),_:1},8,["modelValue","onChange"]),u(N,{label:"同步周期"},{default:f((()=>[u(O,{modelValue:h(i).realtime,"onUpdate:modelValue":a[3]||(a[3]=e=>h(i).realtime=e),class:"!w-[12rem]"},{default:f((()=>[u(q,{label:"实时同步",value:!0}),u(q,{label:"定时同步",value:!1})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),h(i).realtime?g("",!0):(m(),_(N,{key:0,label:"定时周期",prop:"cron"},{default:f((()=>[u(G,null,{default:f((()=>[u(O,{modelValue:h(i).cron.type,"onUpdate:modelValue":a[4]||(a[4]=e=>h(i).cron.type=e),class:"!w-[10rem] mr-8px"},{default:f((()=>[u(q,{label:"每天",value:"day"}),u(q,{label:"N分钟",value:"minute-n"})])),_:1},8,["modelValue"]),k("div",pa,["minute-n"!==h(i).cron.type?(m(),_(p,{key:0,modelValue:h(i).cron.hour,"onUpdate:modelValue":a[5]||(a[5]=e=>h(i).cron.hour=e),type:"number",class:"!w-[11.6rem] mr-8px"},{append:f((()=>a[21]||(a[21]=[w(" 小时 ")]))),_:1},8,["modelValue"])):g("",!0),u(p,{modelValue:h(i).cron.minute,"onUpdate:modelValue":a[6]||(a[6]=e=>h(i).cron.minute=e),type:"number",class:"w-[12rem]"},{append:f((()=>a[22]||(a[22]=[w(" 分钟 ")]))),_:1},8,["modelValue"])])])),_:1})])),_:1})),u(N,{label:"限速",class:"form-row"},{default:f((()=>[u(G,null,{default:f((()=>[u(E,{span:8},{default:f((()=>[u(p,{modelValue:h(i).bwlimit,"onUpdate:modelValue":a[7]||(a[7]=e=>h(i).bwlimit=e),type:"number",class:"!w-[12rem]"},{append:f((()=>a[23]||(a[23]=[w("KB")]))),_:1},8,["modelValue"])])),_:1}),u(E,{span:14},{default:f((()=>[u(N,{label:"延迟"},{default:f((()=>[u(p,{modelValue:h(i).delay,"onUpdate:modelValue":a[8]||(a[8]=e=>h(i).delay=e),type:"number",class:"!w-[12rem]"},{append:f((()=>a[24]||(a[24]=[w("秒")]))),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),u(N,{label:"链接方式",class:"form-row"},{default:f((()=>[u(G,null,{default:f((()=>[u(O,{modelValue:h(i).rsync,"onUpdate:modelValue":a[9]||(a[9]=e=>h(i).rsync=e),class:"!w-[12rem]"},{default:f((()=>[u(q,{label:"密钥",value:"key"}),u(q,{label:"账号",value:"user"})])),_:1},8,["modelValue"]),u(N,{label:"压缩传输"},{default:f((()=>[u(O,{modelValue:h(i).compress,"onUpdate:modelValue":a[10]||(a[10]=e=>h(i).compress=e),class:"!w-[12rem]"},{default:f((()=>[u(q,{label:"开启",value:!0}),u(q,{label:"关闭",value:!1})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),"user"===h(i).rsync?(m(),n("div",ma,[u(N,{label:"用户名",prop:"sname"},{default:f((()=>[u(p,{modelValue:h(i).sname,"onUpdate:modelValue":a[11]||(a[11]=e=>h(i).sname=e),width:"34.8rem",placeholder:"请输入用户名"},null,8,["modelValue"])])),_:1}),u(N,{label:"密码",prop:"password"},{default:f((()=>[u(p,{modelValue:h(i).password,"onUpdate:modelValue":a[12]||(a[12]=e=>h(i).password=e),width:"34.8rem",placeholder:"请输入密码"},null,8,["modelValue"])])),_:1}),u(N,{label:"端口",prop:"port"},{default:f((()=>[u(p,{modelValue:h(i).port,"onUpdate:modelValue":a[13]||(a[13]=e=>h(i).port=e),width:"34.8rem",type:"number"},null,8,["modelValue"])])),_:1})])):g("",!0),"key"===h(i).rsync?(m(),_(N,{key:2,label:"密钥",prop:"secret_key"},{default:f((()=>[u(p,{modelValue:h(i).secret_key,"onUpdate:modelValue":a[14]||(a[14]=e=>h(i).secret_key=e),width:"34.8rem",type:"textarea",placeholder:"请输入密钥"},null,8,["modelValue"])])),_:1})):g("",!0)])),_:1},8,["disabled","rules","model"]),u(A,{class:"pl-2rem",options:h(U),"list-style":"disc"},null,8,["options"]),u(P,{title:"数据安全风险警告",area:[40,"auto"],modelValue:h(r),"onUpdate:modelValue":a[18]||(a[18]=e=>V(r)?r.value=e:null),onClose:a[19]||(a[19]=e=>h(R)(!1)),onCancel:a[20]||(a[20]=e=>h(R)(!1))},{default:f((()=>[k("div",na,[a[28]||(a[28]=k("div",{class:"flex items-center px-2rem"},[k("i",{class:"el-icon-warning text-[#e6a23c] text-[3rem] pr-4"}),k("span",{class:"text-[1.4rem] leading-10 text-danger"},"警告：您选择了完全同步，将会使本机同步与目标机器指定目录的文件保持一致， 请确认目录设置是否有误，一但设置错误，可能导致目标机器的目录文件被删除!")],-1)),k("span",ua,"注意： 同步程序将本机目录：【"+v(h(i).path)+"】的所有数据同步到目标服务器，若目标服务器的同步目录存在其它文件将被删除!",1),k("div",fa,[u(J,{modelValue:h(C),"onUpdate:modelValue":a[15]||(a[15]=e=>V(C)?C.value=e:null),class:"!mr-4px"},null,8,["modelValue"]),a[25]||(a[25]=w(" 我已了解风险，确认关闭 "))]),k("div",ha,[u(L,{type:"warning",onClick:a[16]||(a[16]=e=>h(R)(!1))},{default:f((()=>a[26]||(a[26]=[w("取消")]))),_:1}),u(L,{type:"danger",onClick:a[17]||(a[17]=e=>h(R)(!0)),disabled:!h(C)},{default:f((()=>a[27]||(a[27]=[w("确认选择")]))),_:1},8,["disabled"])])])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-26e9d310"]]),ga=C("FILES-RSYNC-STORE",(()=>{const a=U(),s=(e,s,l)=>{o.path=a.value.row.path,u.path=a.value.row.path,s&&(t.value=!1,p.value=!1,Object.assign(o,{mName:"",password:"",path:a.value.row.path,comment:""}),h.value=!1,_.value=!1,Object.assign(u,{ip:"",rsync:"user",sname:"",password:"",path:a.value.row.path,port:873,secret_key:"",delete:!1,realtime:!0,bwlimit:1024,delay:3,compress:!0,cron:{type:"day",where1:"",hour:0,minute:1,id:"",port:""}})),d("receive"===e?{title:"创建接收端",area:42,btn:["确认","取消"],showFooter:!p.value,component:ia,onConfirm:n}:{title:"创建发送端",area:58,btn:["确认","取消"],component:_a,onConfirm:y}),l&&l()},l=async()=>{var e;if("site"===(null==(e=a.value.row)?void 0:e.type))a.value.row.refreshEvent();else{const{default:e}=await i((()=>import("./store.js?v=1734676359").then((e=>e.aT))),__vite__mapDeps([]),import.meta.url),{refreshFilesList:a}=e();a()}};D("popupSetFooter",(e=>{}));const t=U(!1),o=R({mName:"",password:"",path:"",comment:""}),r=U(),p=U(!1),m=R({mName:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"},{validator:(e,a,s)=>{/^[a-zA-Z0-9_]{3,20}$/.test(a)?s():s(new Error("用户名不能有中文或特殊符号"))},trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}]}),n=async d=>{var i;await r.value.validate(),await c({loading:t,request:(i={...o,comment:o.mName},e.post("/plugin?action=a&name=rsync&s=add_module",{data:i,check:"msg",customType:"model"})),message:!0,success:async e=>{p.value=e.status,e.status&&(await Ee({path:a.value.row.path,s_type:"recv"}),d.unmount(),l(),s("receive"))}})},u=R({ip:"",rsync:"user",sname:"",password:"",path:"",port:873,secret_key:"",delete:!1,realtime:!0,bwlimit:1024,delay:3,compress:!0,cron:{type:"day",where1:"",hour:0,minute:1,id:"",port:""}}),f=U(),h=U(!1),_=U(!1),g=R({ip:[{required:!0,message:"请输入ip",trigger:"blur"},{validator:(e,a,s)=>{/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/.test(a)?s():s(new Error("请输入正确的ip"))}}],sname:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],secret_key:[{required:!0,message:"请输入密钥",trigger:"blur"}]}),y=async s=>{let o={...u,cron:JSON.stringify({...u.cron,port:String(u.port),hour:String(u.cron.hour),minute:String(u.cron.minute)})};"minute-n"===u.cron.type&&(o.cron=JSON.stringify({...u.cron,hour:String(u.cron.hour),where1:String(u.cron.minute),minute:"",port:String(u.port)})),"key"===u.rsync?(o.sname="",o.password=""):o.secret_key="",delete o.rsync,await f.value.validate();var d;return(await c({loading:t,request:(d=o,e.post("/plugin?action=a&name=rsync&s=add_ormodify_send",{data:d,check:"msg",customType:"model"})),message:!0,success:async e=>{e.status&&(await c({request:Ee({path:a.value.row.path,s_type:"send"})}),l())}})).status};return{compData:a,handleClick:s,formDisabled:t,rules:m,isSuccess:p,receiveForm:o,receiveFormRef:r,sendFormRef:f,rulesSend:g,sendForm:u,alertRsync:h,checkOffRsync:_,helpList:[{content:"【同步目录】：若不以/结尾，则表示将数据同步到二级目录，一般情况下目录路径请以/结尾"},{content:"【同步方式】增量： 数据更改/增加时同步，且只追加和替换文件"},{content:"【同步方式】完全： 保持两端的数据与目录结构的一致性，会同步删除、追加和替换文件和目录"},{content:"【限速】：限制数据同步任务的速度，防止因同步数据导致带宽跑高"},{content:"【延迟】：在延迟时间周期内仅记录不同步，到达周期后一次性同步数据，以节省开销"},{content:"【压缩传输】：开启后可减少带宽开销，但会增加CPU开销，如带宽充足，建议关闭此选项"}],handleChangeDelete:async e=>{e?(h.value=!0,u.delete=!e):h.value=!1},handleConfirm:e=>{u.delete=e,h.value=!1,_.value=!1}}})),ya=Object.freeze(Object.defineProperty({__proto__:null,default:ga},Symbol.toStringTag,{value:"Module"}));export{we as $,We as A,Re as B,Ne as C,B as D,M as E,Z as F,Pe as G,Ze as H,He as I,Be as J,ve as K,Ke as L,Q as M,me as N,re as O,pe as P,_e as Q,ge as R,de as S,ce as T,ie as U,ze as V,Fe as W,he as X,fe as Y,ue as Z,be as _,q as a,W as a0,X as a1,ee as a2,ae as a3,le as a4,Y as a5,se as a6,Ge as a7,H as a8,K as a9,$ as aa,ga as ab,J as ac,P as ad,qe as ae,Xe as af,O as ag,ta as ah,aa as ai,$e as aj,Me as ak,Ae as al,Je as am,Ie as an,sa as ao,la as ap,ya as aq,Qe as b,Oe as c,A as d,G as e,I as f,ne as g,ea as h,ke as i,Le as j,oa as k,da as l,Ve as m,je as n,Se as o,Ce as p,xe as q,Te as r,E as s,De as t,te as u,oe as v,Ye as w,L as x,ye as y,Ue as z};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
