import{u as a,l as e,H as l,G as t,M as s,o as n,af as i,k as r,j as o,h as u}from"./utils-lib.js?v=1734676359";import{_ as m}from"./index100.js?v=1734676359";import{_ as d}from"./index90.js?v=1734676359";import{c,r as p,a_ as _,e as g,aj as y,o as f,B as w,k as h,l as v,p as b,x as j,y as x,C as k,q as C,J as V,M as S,A as I}from"./base-lib.js?v=1734676359";import{M as H,F as q,N as T,O as A,P as D,j as E}from"./firewall.js?v=1734676359";import{u as F}from"./column.js?v=1734676359";import{i as O}from"./validator.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";const P={key:0},M={class:"p-[2rem] flex items-center"},N=c({__name:"index",setup(c){const{mainHeight:N,payment:z}=a(),L=p(!1),R=p(""),U=p(!1),B=p([]),G=p([]),J=p(!1),K=_({title:"SSH系统账号管理-功能介绍",ps:"SSH系统账号管理通常涉及到在服务器上创建、删除和管理SSH用户账户的过程。这些账户可以用于通过SSH（安全壳层）协议远程访问服务器。这种管理工作通常由系统管理员进行，以确保只有授权的用户可以访问服务器。",source:305,desc:["创建系统用户","修改系统用户密码","删除系统用户","记录日志","防入侵"],isInstall:J.value,tabImgs:[{title:"概览",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/ssh_system_manage.png"}],pluginInfo:{name:"bt_security"}}),Q=async()=>{O({name:"bt_security"})},W=()=>{e({title:"创建系统用户",area:42,showFooter:!0,compData:{refreshFn:Z},component:()=>l((()=>import("./add-user.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)})},X=async()=>{if(!R.value)return s.error("请输入新密码");await t({loading:"正在设置密码，请稍后...",request:q({username:G.value[0],password:R.value}),message:!0}),L.value=!1,R.value=""},Y=async(a,e,l)=>{await t({loading:"正在"+(a?"开启":"关闭")+(3===l?"防入侵":"记录日志")+"，请稍后...",request:3===l?A(a,{user:e[0]}):D(a,{uid:e[1]}),message:!0}),Z()},Z=async()=>{U.value=!0;const{data:a,msg:e}=await E();if(!a.status&&"插件不存在!"===e)return K.isInstall=!1,J.value=!0,void $();K.isInstall=!0,J.value=!1,B.value=a.system_user,U.value=!1},$=async()=>{try{const{data:a}=await i({sName:"bt_security"});K.pluginInfo=a}catch(a){}},aa=[{label:"用户名",render:a=>a[0]},{label:"防入侵",width:100,render:a=>g(y,{modelValue:a[3],size:"small",onChange:e=>Y(e,a,3)},null)},{label:"记录日志",width:100,render:a=>g(y,{modelValue:a[5],size:"small",onChange:e=>Y(e,a,5)},null)},{label:"备注",render:a=>a[6]},F([{onClick:async a=>{const n=await t({loading:"正在获取日志，请稍后...",request:H({user:a[0]}),data:Array});if(!n.length)return s.error("当前暂无日志");G.value={user:a[0],dateTime:n[0],dateOptions:n.map((a=>({title:a,key:a})))},e({title:"命令日志",area:72,component:()=>l((()=>import("./index372.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),compData:G.value})},title:"命令日志",width:70},{onClick:a=>{G.value=a,L.value=!0},title:"重置密码",width:70},{onClick:async a=>{await n({icon:"warning-filled",title:"删除[".concat(a[0],"]用户"),content:"危险操作，正在删除[".concat(a[0],"]用户，请在下方输入'确认删除'"),input:{content:"确认删除"},type:"input"}),await t({loading:"正在删除中,请稍后...",request:T({username:a[0]}),message:!0}),Z()},title:"删除"}])];return f(Z),(a,e)=>{const l=I,t=r,s=d,n=m,i=o,c=u,p=w("bt-loading");return h(),v("div",null,["ltd"!==b(z).authType||b(J)?(h(),V(n,{key:1,data:b(K),class:"px-[20%] py-[2rem]"},null,8,["data"])):(h(),v("div",P,[g(s,null,{"header-left":j((()=>[g(l,{type:"primary",onClick:W},{default:j((()=>e[3]||(e[3]=[x(" 创建系统用户 ")]))),_:1}),g(l,{onClick:Q},{default:j((()=>e[4]||(e[4]=[x("堡塔防入侵")]))),_:1})])),content:j((()=>[k(g(t,{column:aa,data:b(B),"max-height":b(N)-420},null,8,["data","max-height"]),[[p,b(U)],[p,"正在加载列表，请稍后...","title"]])])),_:1}),e[5]||(e[5]=C("ul",{class:"mt-[.8rem] leading-8 text-[1.2rem] list-disc ml-[2rem]"},[C("li",null,"开启防提权，系统会针对该用户操作命令进行限制，并记录跟踪"),C("li",null,"不开启防提权，系统只针对该用户操作过的命令做记录跟踪"),C("li",null,"目前防提权默认只针对www,redis,mysql操作引起的提权问题进行处理"),C("li",{class:"text-danger"},"消息推送需要更新至最新面板的版本(2020-06-17日之后安装的版本|或者2020-06-17日之后点击过修复面板)")],-1))])),g(c,{title:"修改密码",modelValue:b(L),"onUpdate:modelValue":e[1]||(e[1]=a=>S(L)?L.value=a:null),area:38,showFooter:"",onConfirm:X,onCancel:e[2]||(e[2]=()=>R.value="")},{default:j((()=>[C("div",M,[e[6]||(e[6]=C("span",{class:"inline-block w-[8rem] text-right"},"新密码",-1)),g(i,{class:"ml-[1.2rem]",isNull:!0,iconType:"refresh",modelValue:b(R),"onUpdate:modelValue":e[0]||(e[0]=a=>S(R)?R.value=a:null),placeholder:"请输入新密码"},null,8,["modelValue"])])])),_:1},8,["modelValue"])])}}});export{N as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
