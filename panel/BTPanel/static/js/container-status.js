import{c as e,ar as a,i as t,k as s,l,q as r,v as n,p as i,F as o,J as c,x as d,y as u,z as p,e as m,I as v,aX as k,G as y,C as g,D as f,A as b,aN as x}from"./base-lib.js?v=1734676359";import{g as h,x as w}from"./useStore3.js?v=1734676359";import{R as I,G as _,e as C}from"./utils-lib.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";const S={class:"container-dialog"},j={class:"pb-[3rem] border-b border-[#ececec]"},T={class:"flex items-center ml-[2rem]"},A={class:"ml-[1rem]"},D={class:"flex mt-[2rem] ml-[2rem]"},N={class:"table ml-[2rem] mt-[2rem]"},P={class:"w-[30%]"},G={key:0,class:"w-[70%] truncate"},O=["onClick"],q={key:1,class:"h-[5rem] flex items-center"},H=C(e({__name:"container-status",setup(e){const{refs:{currentConDetail:C},getCurrentCon:H,refreshActiveTable:J}=h(),M=[{key:"name",label:"容器名称"},{key:"id",label:"容器ID",tooltip:!0},{key:"image",label:"使用的镜像"},{key:"run",label:"运行时间"},{key:"created",label:"创建时间"},{key:"start",label:"启动时间"},{key:"port",label:"端口",tag:!0,expand:a(!1)},{key:"ip",label:"IP",tag:!0,expand:a(!1)},{key:"ipv6",label:"IPV6",tag:!0,expand:a(!1)}],z=t((()=>R(C.value))),E=t((()=>{var e,a;return"running"===(null==(a=null==(e=C.value)?void 0:e.State)?void 0:a.Status)})),F=e=>{const a=new Date(e).getTime();return I(a)},R=e=>{var a,t,s,l,r;if(!e.Id)return{name:"正在获取...",id:"正在获取...",idTip:"正在获取...",run:"正在获取...",created:"正在获取...",start:"正在获取...",image:"正在获取...",port:[],ip:[],ipv6:[]};const n=e.Name,i=e.Id.slice(0,12),o=(null==(a=e.Config)?void 0:a.Image)||"--",c=((e,a)=>{const t=Math.abs(e-a);return Math.floor(t/36e5)})((new Date).getTime(),new Date(null==(t=C.value.State)?void 0:t.StartedAt).getTime()),d=F(e.Created),u=F(null==(s=e.State)?void 0:s.StartedAt),p=Object.entries((null==(l=e.NetworkSettings)?void 0:l.Ports)||{})||[],m=[];p.forEach((e=>{e[1]&&m.push("".concat(e[1][0].HostPort,"--\x3e").concat(e[0]," "))}));const v=Object.values((null==(r=e.NetworkSettings)?void 0:r.Networks)||{}),k=v.map((e=>e.IPAddress)).filter((e=>""!==e))||[],y=v.map((e=>e.GlobalIPv6Address)).filter((e=>""!==e))||[];return{name:n,id:i,idTip:e.Id,image:o,run:c>0?"".concat(c,"小时"):"不到1小时",created:d,start:u,port:m,ip:k,ipv6:y}},V=async e=>{const a="start"==e?"启动":"stop"==e?"停止":"重启",t={id:C.value.Id,status:e};await _({request:w({data:JSON.stringify(t)}),message:!0,loading:"正在".concat(a,"容器，请稍候..."),success:e=>{e.status&&(H(C.value.Id),J())}})};return(e,a)=>{const t=b,h=x;return s(),l("div",S,[r("div",j,[r("div",T,[a[3]||(a[3]=r("span",null,"当前状态：",-1)),r("span",A,n(i(E)?"运行中":"已停止"),1),r("span",{class:o(i(E)?"svgtofont-icon-start text-[#20a53a]":"svgtofont-icon-stop text-[#ff0000]")},null,2)]),r("div",D,[i(E)?p("",!0):(s(),c(t,{key:0,onClick:a[0]||(a[0]=e=>V("start"))},{default:d((()=>a[4]||(a[4]=[u(" 启动 ")]))),_:1})),i(E)?(s(),c(t,{key:1,onClick:a[1]||(a[1]=e=>V("stop"))},{default:d((()=>a[5]||(a[5]=[u("停止")]))),_:1})):p("",!0),m(t,{onClick:a[2]||(a[2]=e=>V("restart"))},{default:d((()=>a[6]||(a[6]=[u("重启")]))),_:1})])]),r("div",N,[(s(),l(v,null,k(M,(e=>r("div",{key:e.key,class:"item"},[r("div",P,n(e.label),1),e.tag?p("",!0):(s(),l("div",G,[m(h,{ref_for:!0,ref:"tlp",content:i(z)["".concat(e.key,"Tip")],disabled:!e.tooltip,placement:"top"},{default:d((()=>[r("span",null,n(i(z)[e.key]),1)])),_:2},1032,["content","disabled"])])),e.tag?(s(),l("div",{key:1,class:o(["w-[70%] relative",{"cursor-pointer":i(z)[e.key].length>("ipv6"===e.key?2:3)}]),onClick:a=>(e=>{var a;!e.tag||(null==(a=z.value[e.key])?void 0:a.length)<=("ipv6"===e.key?2:3)||(e.expand.value=!e.expand.value)})(e)},[i(z)[e.key].length>0?(s(),l("div",{key:0,class:o(["py-[1rem] pr-[2rem] min-h-[5rem] grid gap-[1rem]",{"h-[5rem]":!e.expand.value,"items-center":!e.expand.value}]),style:y("grid-template-columns: repeat(auto-fill, minmax(".concat("ipv6"===e.key?"16":"13","rem, 1fr))"))},[(s(!0),l(v,null,k(i(z)[e.key],((a,t)=>g((s(),l("span",{key:a,class:"custom-success-tag"},n(a),513)),[[f,("ipv6"===e.key?t<2:t<3)||e.expand.value]]))),128)),i(z)[e.key].length>("ipv6"===e.key?2:3)?(s(),l("span",{key:0,class:o(["absolute top-[50%] right-[0rem] text-[2rem]",e.expand.value?"svgtofont-el-arrow-up":"svgtofont-el-arrow-down"]),style:{transform:"translateY(-50%)"}},null,2)):p("",!0)],6)):p("",!0),i(z)[e.key].length?p("",!0):(s(),l("div",q,"--"))],10,O)):p("",!0)]))),64))])])}}}),[["__scopeId","data-v-753c1e18"]]);export{H as default};
