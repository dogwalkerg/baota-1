!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */e=function(){return r};var n,r={},a=Object.prototype,i=a.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",l=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function f(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(n){f=function(t,e,n){return t[e]=n}}function p(t,e,n,r){var a=e&&e.prototype instanceof w?e:w,i=Object.create(a.prototype),s=new P(r||[]);return o(i,"_invoke",{value:T(t,n,s)}),i}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}r.wrap=p;var h="suspendedStart",v="suspendedYield",y="executing",m="completed",g={};function w(){}function b(){}function x(){}var k={};f(k,c,(function(){return this}));var _=Object.getPrototypeOf,E=_&&_(_(N([])));E&&E!==a&&i.call(E,c)&&(k=E);var S=x.prototype=w.prototype=Object.create(k);function L(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function j(e,n){function r(a,o,s,c){var l=d(e[a],e,o);if("throw"!==l.type){var u=l.arg,f=u.value;return f&&"object"==t(f)&&i.call(f,"__await")?n.resolve(f.__await).then((function(t){r("next",t,s,c)}),(function(t){r("throw",t,s,c)})):n.resolve(f).then((function(t){u.value=t,s(u)}),(function(t){return r("throw",t,s,c)}))}c(l.arg)}var a;o(this,"_invoke",{value:function(t,e){function i(){return new n((function(n,a){r(t,e,n,a)}))}return a=a?a.then(i,i):i()}})}function T(t,e,r){var a=h;return function(i,o){if(a===y)throw Error("Generator is already running");if(a===m){if("throw"===i)throw o;return{value:n,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var c=O(s,r);if(c){if(c===g)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===h)throw a=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=y;var l=d(t,e,r);if("normal"===l.type){if(a=r.done?m:v,l.arg===g)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(a=m,r.method="throw",r.arg=l.arg)}}}function O(t,e){var r=e.method,a=t.iterator[r];if(a===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=n,O(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var i=d(a,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,g;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,g):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,g)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function F(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function N(e){if(e||""===e){var r=e[c];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function t(){for(;++a<e.length;)if(i.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=n,t.done=!0,t};return o.next=o}}throw new TypeError(t(e)+" is not iterable")}return b.prototype=x,o(S,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:b,configurable:!0}),b.displayName=f(x,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},r.awrap=function(t){return{__await:t}},L(j.prototype),f(j.prototype,l,(function(){return this})),r.AsyncIterator=j,r.async=function(t,e,n,a,i){void 0===i&&(i=Promise);var o=new j(p(t,e,n,a),i);return r.isGeneratorFunction(e)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},L(S),f(S,u,"Generator"),f(S,c,(function(){return this})),f(S,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},r.values=N,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(F),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,a){return s.type="throw",s.arg=t,e.next=r,a&&(e.method="next",e.arg=n),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var c=i.call(o,"catchLoc"),l=i.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),F(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var a=r.arg;F(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:N(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=n),g}},r}function n(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function r(t){return function(){var e=this,r=arguments;return new Promise((function(a,i){var o=t.apply(e,r);function s(t){n(o,a,i,s,c,"next",t)}function c(t){n(o,a,i,s,c,"throw",t)}s(void 0)}))}}System.register(["./index-legacy100.js?v=1734676359","./utils-lib-legacy.js?v=1734676359","./base-lib-legacy.js?v=1734676359","./validator-legacy.js?v=1734676359","./site-legacy.js?v=1734676359","./useStore-legacy7.js?v=1734676359","./__commonjsHelpers__-legacy.js?v=1734676359","./index-legacy91.js?v=1734676359","./column-legacy.js?v=1734676359"],(function(t,n){"use strict";var a,i,o,s,c,l,u,f,p,d,h,v,y,m,g,w,b,x,k,_,E,S,L,j,T,O,C,F,P,N,G,I,z,D,q;return{setters:[function(t){a=t._},function(t){i=t.u,o=t.o,s=t.R,c=t._,l=t.d,u=t.b,f=t.a5,p=t.e},function(t){d=t.c,h=t.r,v=t.h,y=t.i,m=t.o,g=t.B,w=t.C,b=t.p,x=t.k,k=t.l,_=t.q,E=t.e,S=t.J,L=t.I,j=t.y,T=t.v,O=t.z,C=t.x,F=t.F,P=t.aX,N=t.D,G=t.A,I=t.aY},function(t){z=t.o},function(t){D=t.scanSingleSite},function(t){q=t.u},null,null,null],execute:function(){var n={id:"safeDetectList"},A={key:0},J={class:"progress-header"},M={class:"progress-header-cot"},Y={class:"flex items-center"},R={key:0,class:"scan-icon relative h-[8rem] w-[8rem] flex"},B={key:1},H={class:"progress-header-cot"},X={class:"scanning-progress-title"},K={class:"text-danger"},Q={class:"scanning-progress-cont"},U={class:"progress-header-cot"},V={class:"progress-cont-list"},W={key:0},Z={class:"inline-grid grid-cols-4 w-full mt-20px"},$=["onClick"],tt={class:"progress_type"},et={class:"flex-1"},nt={key:0,class:"text-danger mr-4px"},rt={key:1},at={key:2,class:"text-primary"},it={key:3},ot={class:"progress_fold text-[1.2rem] flex items-center"},st={class:"mr-4px"},ct={class:"progress_item_body"},lt={class:"flex flex-col py-8px px-12px text-[1.2rem]"},ut={class:"whitespace-normal leading-2rem"},ft={class:"whitespace-normal leading-2rem"},pt=d({__name:"index",setup:function(t,p){var d,pt=p.expose,dt=u(),ht=q().siteInfo,vt=i().payment,yt=h(!1),mt=h([{name:"vulscan",title:"漏洞扫描"},{name:"webscan",title:"网站配置安全性"},{name:"filescan",title:"文件泄露"},{name:"backup",title:"备份文件"},{name:"webshell",title:"木马程序"},{name:"index",title:"首页内容风险"},{name:"webhorse",title:"挂马排查"},{name:"deadchain",title:"坏链检测"},{name:"database",title:"数据库安全"},{name:"ftps",title:"网站FTP风险"},{name:"backend",title:"网站后台安全"}]),gt=h(0),wt=h(""),bt=h(""),xt=v({scanStatus:!1,isEnd:!1,error:0,warn:0,time:0,progress:0,progressColor:"#20a53a",progressConfig:{},statusTotal:{},result:{},progressStatus:{},active:{}}),kt=null,_t=v({title:"安全扫描-功能介绍",height:36,ps:"扫描服务器系统的漏洞，异常用户，已安装软件的安全问题并提供修复方案.",source:66,desc:["漏洞扫描","网站配置安全性","文件泄露","备份文件","木马程序"],tabImgs:["https://www.bt.cn/Public/new/plugin/introduce/site/security-Introduction.png"]}),Et=y((function(){return xt.scanStatus&&!xt.isEnd?"正在扫描":"定期扫描网站，提升网站安全性"})),St=y((function(){return xt.scanStatus&&!xt.isEnd?"".concat(wt.value||""):xt.time?"上次检测时间：".concat(xt.time):"当前安全风险未知，请立即检测"})),Lt=function(t,e){if(e.data){var n=JSON.parse(e.data.replace(/'/g,'"'));if(n.hasOwnProperty("end")&&n.end){var r,a,i;if((null===(r=n.webinfo)||void 0===r||null===(r=r.result)||void 0===r?void 0:r[n.type].length)>0?(xt.progressConfig[n.type]=n.webinfo.result[n.type],xt.statusTotal[n.type]=n.webinfo.result[n.type].length):xt.statusTotal[n.type]=0,wt.value=n.info,gt.value===mt.value.length-1)return null===(i=kt)||void 0===i||i.close(),gt.value=0,xt.scanStatus=!1,void(xt.isEnd=!0);var o=(new Date).getTime();gt.value++,null===(a=kt)||void 0===a||a.send({mod_name:"webscanning",def_name:"ScanSingleSite",ws_callback:o,name:ht.value.name,scan_list:[mt.value[gt.value].name]})}else wt.value=n.info,bt.value=n.type,n.is_error&&xt.error++}},jt=function(){var t=r(e().mark((function t(){var n,r,a,i,s;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(xt.scanStatus&&!xt.isEnd||xt.isEnd,!xt.scanStatus||xt.isEnd){t.next=10;break}return t.next=4,o({title:"取消扫描",content:"确定取消扫描吗?",icon:"warning"});case 4:return null===(a=kt)||void 0===a||a.close(),gt.value=0,Tt(),t.abrupt("return");case 10:if(!xt.isEnd){t.next=16;break}return t.next=13,null===(i=kt)||void 0===i?void 0:i.close();case 13:return gt.value=0,t.next=16,Tt();case 16:xt.scanStatus=!0,kt=f({route:"/ws_project",onMessage:Lt}),s=(new Date).getTime(),null===(n=kt)||void 0===n||n.send({"x-http-token":window.vite_public_request_token}),null===(r=kt)||void 0===r||r.send({mod_name:"webscanning",def_name:"ScanSingleSite",ws_callback:s,name:ht.value.name,scan_list:[mt.value[gt.value].name]});case 21:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Tt=function(){xt.scanStatus=!1,xt.isEnd=!1,xt.error=0,xt.warn=0,xt.time=0,xt.progress=0,xt.progressConfig={vulscan:[],webscan:[],filescan:[],backup:[],webshell:[],index:[],webhorse:[],deadchain:[],database:[],ftps:[],backend:[]},xt.statusTotal={},xt.result={},xt.progressStatus={},xt.active={vulscan:!1,webscan:!1,filescan:!1,backup:!1,webshell:!1,index:!1,webhorse:!1,deadchain:!1,database:!1,ftps:!1,backend:!1}},Ot=function(){var t=r(e().mark((function t(){var n;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return yt.value=!0,t.prev=1,t.next=4,D({data:JSON.stringify({name:ht.value.name})});case 4:if((n=t.sent).status){t.next=8;break}return dt.request(n),t.abrupt("return");case 8:xt.isEnd=xt.time||!1,xt.time=s(n.data.time,"yyyy-MM-dd"),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1);case 15:return t.prev=15,yt.value=!1,t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[1,12,15,18]])})));return function(){return t.apply(this,arguments)}}();return m((function(){Ot(),Tt()})),pt({onRefresh:(d=r(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Ot(),Tt();case 2:case"end":return t.stop()}}),t)}))),function(){return d.apply(this,arguments)})}),function(t,e){var r=c,i=G,o=I,s=l,u=a,f=g("bt-loading");return w((x(),k("div",n,["ltd"===b(vt).authType?(x(),k("div",A,[_("div",J,[_("div",M,[_("div",Y,[b(xt).scanStatus&&!b(xt).isEnd?(x(),k("div",R,[e[0]||(e[0]=_("div",{class:"animate-spin absolute top-0 border-[#F39C12] border-b-2 rounded-full h-full w-full bg-#cccccc00"},null,-1)),E(r,{icon:"scanning-danger",size:60,color:"#F39C12",class:"m-auto"})])):(x(),k("div",B,[b(xt).warn||b(xt).error?(x(),S(r,{key:0,icon:"scanning-danger",size:70,color:"#ef0808"})):(x(),S(r,{key:1,icon:"scanning-"+(b(xt).isEnd?"success":"danger"),size:72,color:b(xt).isEnd?"#20a53a":"#F39C12"},null,8,["icon","color"]))]))])]),_("div",H,[_("div",X,[b(xt).isEnd?(x(),k(L,{key:1},[e[3]||(e[3]=j(" 检测完成 ")),b(xt).error>0||b(xt).warn>0?(x(),k(L,{key:0},[e[2]||(e[2]=j(" ，共发现 ")),b(xt).error>0?(x(),k(L,{key:0},[_("span",K,T(b(xt).error),1),e[1]||(e[1]=j(" 项风险 "))],64)):O("",!0)],64)):O("",!0)],64)):(x(),k(L,{key:0},[j(T(b(Et)),1)],64))]),_("div",Q,T(b(St)),1)]),_("div",U,[E(i,{class:F({"warning-hover":b(xt).scanStatus&&!b(xt).isEnd}),type:b(xt).scanStatus&&!b(xt).isEnd?"warning":"primary",onClick:jt,plain:!(!b(xt).scanStatus||b(xt).isEnd)},{default:C((function(){return[j(T(b(xt).scanStatus&&!b(xt).isEnd?"取消扫描":b(xt).isEnd?"重新检测":"立即检测"),1)]})),_:1},8,["class","type","plain"]),b(xt).isEnd?(x(),S(i,{key:0,type:"default",onClick:b(z)},{default:C((function(){return e[4]||(e[4]=[j(" 立即修复 ")])})),_:1},8,["onClick"])):O("",!0)])]),E(o,{class:"!mt-0 !mb-20px !bg-[#F1F1F1]"}),_("div",V,[b(xt).scanStatus||b(xt).isEnd?O("",!0):(x(),k("div",W,[e[5]||(e[5]=_("div",{class:"font-bold text-[1.6rem] text-[#666] mb-[2rem]"},"支持网站以下安全扫描项:",-1)),_("div",Z,[(x(!0),k(L,null,P(b(mt),(function(t,e){return x(),k("div",{key:e,class:"flex flex-col inline-block items-center mb-[20px]"},[E(s,{class:"w-[4rem] inline-block mb-8px opacity-90",src:"/scan/scanning-"+t.name+"-ico.svg"},null,8,["src"]),j(" "+T(t.title),1)])})),128))])])),b(xt).scanStatus||b(xt).isEnd?(x(!0),k(L,{key:1},P(b(mt),(function(t,e){return x(),k("div",{key:e,class:F([t.name+"_item "+(b(xt).active[t.name]?"active":""),"progress_item"])},[_("div",{class:"progress_item_header",onClick:function(e){return function(t){xt.active[t]=!xt.active[t]}(t.name)}},[_("div",tt,[_("span",null,T(t.title),1)]),_("div",et,[b(xt).statusTotal[t.name]?(x(),k("span",nt," 发现"+T(b(xt).statusTotal[t.name])+"项危险 ",1)):O("",!0),b(xt).scanStatus&&b(bt)==t.name?(x(),k("span",rt," 正在扫描... ")):O("",!0),b(xt).scanStatus||b(xt).statusTotal[t.name]?O("",!0):(x(),k("span",at," 无风险项 ")),b(xt).scanStatus&&b(bt)!=t.name&&!b(xt).statusTotal[t.name]?(x(),k("span",it," 等待扫描 ")):O("",!0)]),_("div",ot,[_("span",st,T(b(xt).active[t.name]?"收起":"展开"),1),_("i",{class:F(b(xt).active[t.name]?"svgtofont-el-arrow-up":"svgtofont-el-arrow-down")},null,2)])],8,$),w(_("div",ct,[(x(!0),k(L,null,P(b(xt).progressConfig[t.name],(function(e,n){return x(),k("div",{key:n,class:"progress_item_info"},[_("div",lt,[_("span",null,T(e.name||e),1),w(_("div",null,[E(o,{class:"!my-8px"}),_("span",ut,T(e.repair),1)],512),[[N,e.repair]]),w(_("div",null,[E(o,{class:"!my-8px"}),_("span",ft," 修复方案：删除【"+T(e)+"】 ",1)],512),[[N,"webshell"===t.name]])])])})),128))],512),[[N,b(xt).active[t.name]]])],2)})),128)):O("",!0)])])):(x(),S(u,{key:1,data:b(_t)},null,8,["data"]))])),[[f,b(yt)]])}}});t("default",p(pt,[["__scopeId","data-v-5e1dce59"]]))}}}))}();
