import{u as e,M as a,du as l,ah as t,ai as s,dv as n,b5 as o,H as r,r as c,c as i,k as m,O as u,h as d,e as v}from"./utils-lib.js?v=1734676359";import{g as p,b4 as f,t as x,r as g,h as y,e as h,y as b,c as w,s as k,i as _,ax as C,a1 as S,B as I,k as D,l as T,q as V,p as j,z as A,F,v as O,J as E,x as P,M as R,C as N,D as J,I as M,aX as B,G as U,A as H,Q as L,b$ as $,bu as q,aN as z,b7 as G,au as K}from"./base-lib.js?v=1734676359";import{_ as Q}from"./index277.js?v=1734676359";import{o as X,p as Y}from"./validator.js?v=1734676359";import{k as W,g as Z,a as ee,b as ae,c as le,d as te}from"./index45.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";import"./column.js?v=1734676359";import"./index95.js?v=1734676359";import"./store3.js?v=1734676359";import"./store4.js?v=1734676359";import"./hooks.js?v=1734676359";const se=p("HOME-SECURITY-RISKS-STORE",(()=>{f();const{payment:r}=e(),{authType:c}=x(r.value),i=g(""),m=g(""),u=g("正在扫描中，请耐心等待..."),d=g(!1),v=g(!1),p=g(""),w=g(!1),k=g(!1),_=g(!1),C=g(!1),S=g(),I=g(!0),D=g(!1),T=g("primary"),V=g(100),j=g("!text-[#20a53A]"),A=g("safe"),F=g(),O=g("当前服务器未进行安全扫描，可能存在风险"),E=g(""),P=g(),R=g([]),N=g([]),J=g([]),M=g(!0),B=g([]),U=g([]),H=g(!0),L=g(!1),$=g(!0),q=y({progress:1,repairProgress:!1,repairText:"修复中.."}),z=y({processPercentage:0,processColor:"#20a53a"}),G={risk:{type:"danger",label:"风险项",list:[]},security:{type:"primary",label:"无风险项",list:[]},ignore:{type:"warning",label:"已忽略项",list:[]}},K=y({cannot_automatically:0,failed:0,success:0}),Q=g(0),te=g([{label:"风险项",prop:"m_name",width:150,render:e=>h("span",null,[e.m_name])},{label:"修复内容",prop:"msg",width:150},{label:"相关信息",prop:"type",align:"center",render:e=>Array.isArray(e.type)&&e.type.length>0?h("span",{class:"h-[3.2rem] inline-block whitespace-pre-wrap"},[e.type.join("，")]):"无"},{label:"操作结果",align:"right",render:e=>e.status?h("span",{class:"text-[#20a53a]"},[b("修复成功")]):h("span",{class:"text-[red]"},[b("修复失败")])}]),se=y({1:{text:"低危",bg:"rgba(232, 213, 68, 0.1)",color:"#D4BB00"},2:{text:"中危",bg:"rgba(240, 173, 78, 0.14)",color:"#f0ad4e"},3:{text:"高危",bg:"rgba(239, 8, 8, 0.1)",color:"#EF0808"}}),ne=e=>{J.value=e.is_autofix,$.value=!1,localStorage.setItem("isAutoFix",JSON.stringify(J.value));for(const a in G){const l=e[a];if(Array.isArray(l)){for(let e=0;e<l.length;e++){const t=G[a].list[e];l[e].show=(null==t?void 0:t.show)||!1,l[e].selection=(null==t?void 0:t.selection)||!1}Object.keys(G).includes(a)&&"risk"==a&&(N.value=[...N.value,...l]),G[a].list=l}}p.value=e.check_time,T.value="primary",w.value=!0,D.value=!0,re(!0),S.value=" !animate-none",localStorage.setItem("scanData",JSON.stringify(N.value)),localStorage.setItem("ignoreData",JSON.stringify(G.ignore.list)),s("lastScanTime",p.value)},oe=async(e=!1)=>{d.value=!0,u.value="正在扫描中，请稍等...";try{const a={};e&&(a.force=1);const{data:l}=await le(a);N.value=[],l.interrupt||(N.value=[],ne(l),V.value=l.score,Q.value=N.value.length,O.value="已完成安全扫描，",U.value=l.ignore)}catch(a){}d.value=!1},re=e=>{let a=!1;B.value=[],N.value.forEach((e=>{J.value.includes(e.m_name)&&(e.selection=!0,B.value.push(e),a=!0)})),a&&e?(M.value=!1,v.value=B.value.every((e=>1==e.selection))):a&&!e&&(v.value||(B.value=[],N.value.forEach((e=>{J.value.includes(e.m_name)&&(e.selection=!1)}))))},ce=async e=>{P.value=[],k.value=!0,K.cannot_automatically=e.cannot_automatically.length,K.failed=e.failed.length,K.success=e.success.length;for(const a in e)for(const l of e[a])R.value.push({m_name:l.m_name,type:l.result.type,msg:l.result.msg,status:l.result.status,name:a});P.value=R.value,d.value=!1,N.value=N.value.filter((a=>!e.success.some((e=>e.m_name===a.m_name)))),Q.value=N.value.length,localStorage.setItem("scanData",JSON.stringify(N.value))},ie=()=>{Y({sourceId:68})};return{showAnimation:C,scanScore:V,scanTextClass:j,scanOuterClass:A,animateFlag:S,scanPreText:O,riskNum:Q,scanButtonType:T,repairAutoRiskButton:w,cookieRepair:I,scanItemText:E,processData:z,lastScanTime:p,scanSelectShow:D,allSelect:v,allSelectionDis:M,isFirst:$,isIgnoreAll:L,ignoreData:U,emptyDetail:_,loading:d,loadingText:u,isShow:H,activeMent:i,activeMentIgnore:m,is_autofix:J,levelData:se,allData:N,repairData:q,resultConfirm:k,resultItemLength:K,resultTable:P,resultColumn:te,handleIgnore:async(e,l)=>{try{d.value=!0,u.value="正在忽略风险项,请耐心等候...";const{data:t}=await n({m_name:e.m_name});a.request(t),t.status&&(l?U.value=U.value.filter((a=>a.m_name!==e.m_name)):N.value=N.value.filter((a=>a.m_name!==e.m_name)),oe(!0))}catch(t){}finally{d.value=!1}},scanningProcess:async()=>{if(H.value=!1,_.value=!1,V.value=100,A.value="safe",j.value="!text-[#20a53A]","info"==T.value){clearInterval(F.value),await W();const e=await Z();ne(e.data),V.value="?",j.value="!text-[#EF0808]",A.value="danger",d.value=!1,Q.value=e.data.risk.length,O.value="扫描中断，"}else{z.processPercentage=0,C.value=!0,O.value="正在进行安全扫描...",Q.value=0,E.value="正在检测...",S.value="",T.value="info",I.value=!0,w.value=!1,oe(!0);try{clearInterval(F.value),F.value=setInterval((async function(){const e=await ee();z.processPercentage=e.data.percentage,Q.value=e.data.count,E.value=e.data.status,V.value=e.data.score,e.data.count&&"100"!=e.data.percentage&&(j.value="!text-[#EF0808]",A.value="danger",O.value="正在进行安全扫描，"),"100"==e.data.percentage&&clearInterval(F.value),V.value>=80&&V.value<=99?(j.value="!text-[#E8D544]",A.value="risk",z.processColor="#E8D544"):V.value>=60&&V.value<=79?(j.value="!text-[#F0AD4E]",z.processColor="#F0AD4E",A.value="warn"):V.value<60&&(j.value="!text-[#EF0808]",z.processColor="#EF0808",A.value="danger")}),1e3)}catch(e){}}},handleRepairAutoRisk:()=>{if("ltd"!==c.value)return ie();try{let e=N.value.filter((e=>1==e.selection)).map((e=>e.m_name));if(0==e.length)return d.value=!1,void a.error("暂无可自动修复的风险项！");d.value=!0,u.value="正在修复中,可能耗时较长,请耐心等候...",q.progress=0;const t=l({data:JSON.stringify({m_name:e})});q.repairProgress=!0;let s=setInterval((async()=>{const{data:e}=await ae();if(q.progress=e.percentage,q.repairText=e.status,100===e.percentage){q.repairText="修复完成",q.repairProgress=!1,q.progress=100,clearInterval(s);let e=await t;ce(e.data),oe(!0)}}),800)}catch(e){t(e)}finally{d.value=!1}},handleDownloadReport:()=>{window.open("/project/security/report/html","_blank")},changeSelectValue:e=>{e.selection=!e.selection,v.value=B.value.every((e=>1==e.selection))},handelAllSelection:re,handleRepair:async(e,s)=>{if("ltd"!==c.value)return void ie();let n=N.value.filter((e=>1==e.selection)).map((e=>e.m_name));try{if(!e&&0==n.length)return void a.error("请选择需要修复的风险项！");B.value.length,d.value=!0,u.value="正在修复中,可能耗时较长,请耐心等候...";const{data:t}=await l({data:JSON.stringify({m_name:e?[s.m_name]:n})});e&&t.success.length>0?(a.success("修复成功"),Q.value--,N.value=N.value.filter((e=>e.m_name!==s.m_name)),ce(t)):ce(t)}catch(o){t(o)}finally{d.value=!1}},vulnerabilityInvolvesSoftware:e=>{let a=Object.keys(e.soft_name),l="";return a.forEach(((t,s)=>{s===a.length-1?l+="".concat(a,":").concat(e.soft_name[t]):l+="".concat(a,":").concat(e.soft_name[t],"\n")})),l},onlineServiceDialog:X,onToggle:(e,a)=>{e.show||a.forEach((e=>e.show=!1)),e.show=!e.show},onOpen:()=>{const e=localStorage.getItem("scanData"),a=localStorage.getItem("isAutoFix"),l=localStorage.getItem("ignoreData");a&&(J.value=JSON.parse(a)),l&&JSON.parse(l).length&&(U.value=JSON.parse(l)),e&&JSON.parse(e).length?(N.value=JSON.parse(e),D.value=!0,w.value=!0,H.value=!1):(_.value=!0,w.value=!1),I.value=!1,p.value=o("lastScanTime")||""},$reset:()=>{R.value=[],N.value=[],B.value=[],U.value=[],J.value=[],clearInterval(F.value)}}})),ne={class:"h-full p-4rem"},oe={class:"scan-header flex items-center"},re={class:"flex items-center w-full"},ce={key:0,class:"w-[10rem] h-[10rem] relative flex-shrink-0"},ie={key:1,class:"w-[10rem] h-[10rem] relative flex-shrink-0"},me={class:"w-full text-[#333] text-[2rem] flex flex-col ml-[3rem]"},ue={class:"flex items-center w-full justify-between"},de={key:0},ve={class:"mx-[4px] text-[2.4rem] mx-[4px] text-danger"},pe={class:"flex items-center"},fe={key:0,class:"text-[1.4rem] text-[#666] mt-[1rem]"},xe={key:2,class:"text-[1.4rem] text-[#666] mt-[1rem]"},ge={key:4,class:"text-[1.4rem] mt-[12px] text-[#666] flex items-center"},ye={key:5,class:"text-[1.4rem] mt-[12px] text-[#F0AD4E] flex items-center"},he={key:0,class:"text-[1.4rem] w-full mt-[4rem] flex items-center justify-between"},be={class:"items-center flex"},we={class:"flex items-center"},ke=["v-bt-loading:title"],_e={class:"module-head flex items-center h-[5.4rem] justify-between border-b-1 pr-[0.8rem] w-full"},Ce={class:"w-full flex items-center"},Se=["title"],Ie={key:0,class:"text-[#666] !text-[1.2rem] ml-[5rem] flex"},De={class:"flex items-center text-[1.2rem]"},Te=["onClick"],Ve=["onClick"],je={class:"px-[3rem] py-[3.2rem] bg-[#F8F8F8]"},Ae={class:"flex items-center"},Fe={class:"text-[#333]"},Oe=["innerHTML"],Ee={class:"flex mt-[16px] items-center"},Pe={key:0,class:"collapse-item flex-col !items-start"},Re={key:1,class:"collapse-item"},Ne={class:"flex mt-[16px] items-center"},Je={class:"collapse-item"},Me={class:"scan-recommend"},Be={key:0,class:"scan-recommend-body"},Ue={class:"flex flex-col p-[20px]"},He={class:"text-[1.6rem] mb-[20px]"},Le={class:"text-primary"},$e={class:"text-danger"},qe={class:"text-medium"},ze={class:"p-[12px] flex flex-col items-start"},Ge={class:"mt-4px"},Ke={key:0,class:"scan-body p-[2rem]"},Qe={class:"module-list overflow-auto h-[38rem]"},Xe={class:"module-head flex items-center h-[5.4rem] justify-between border-b-1 pr-[0.8rem] w-full"},Ye={class:"w-full flex items-center"},We=["title"],Ze={class:"flex items-center"},ea={class:"px-[3rem] py-[3.2rem] bg-[#F8F8F8]"},aa={class:"flex items-center"},la={class:"text-[#333]"},ta=["innerHTML"],sa={class:"flex mt-[16px] items-center"},na={key:0,class:"collapse-item flex-col !items-start"},oa={key:1,class:"collapse-item"},ra={class:"flex mt-[16px] items-center"},ca={class:"collapse-item"},ia={class:"w-full bg-white flex items-center justify-between"},ma=v(w({__name:"index",setup(l,{expose:t}){const s=se(),{handleIgnore:n,onToggle:o,vulnerabilityInvolvesSoftware:v}=s,{showAnimation:p,scanScore:f,scanTextClass:x,scanOuterClass:y,animateFlag:w,scanPreText:X,riskNum:W,scanButtonType:Z,repairAutoRiskButton:ee,cookieRepair:ae,scanItemText:le,processData:ma,lastScanTime:ua,scanSelectShow:da,allSelect:va,allSelectionDis:pa,isFirst:fa,emptyDetail:xa,loading:ga,loadingText:ya,isShow:ha,isIgnoreAll:ba,ignoreData:wa,activeMent:ka,activeMentIgnore:_a,is_autofix:Ca,levelData:Sa,allData:Ia,repairData:Da,resultConfirm:Ta,resultItemLength:Va,resultTable:ja,resultColumn:Aa}=k(s),{mainHeight:Fa,payment:Oa}=e(),Ea=_((()=>Ia.value.filter((e=>1==e.selection)).map((e=>e.m_name)).length)),Pa=g(!1),Ra=C("popupClose",(()=>{})),Na=async()=>{if("ltd"===Oa.value.authType)try{const e=await te();if(!e.data.status)return a.error(e.data.msg);window.open("/download?filename=".concat(e.data.path))}catch(e){}else Y({sourceId:68})},Ja=async e=>{const{getFirewallStore:a}=await r((()=>import("./useStore4.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),{refs:{safeDetectActive:l}}=a();l.value=e,c.push({path:"/firewall/safe-detect"}),Ra()};return S(s.$reset),t({onOpen:s.onOpen}),(e,a)=>{const l=H,t=i,r=Q,c=L,g=$,k=q,_=z,C=m,S=u,Y=d,te=G,se=K,Fa=I("bt-loading");return D(),T("div",ne,[V("div",oe,[V("div",re,[j(p)?A("",!0):(D(),T("div",ce,a[17]||(a[17]=[V("span",{class:"inline-block scan-icon-img icon-img-safe"},null,-1),V("span",{class:"scan-icon-img-bg"},null,-1),V("span",{class:"text-[3.2rem] h-[4.4rem] w-[0.7rem] text-[#20a53a] font-bold absolute-center"},"i",-1)]))),j(p)?(D(),T("div",ie,[V("p",{class:F("box-text w-[5.8rem] "+j(x))},[b(O(j(f))+" ",1),a[18]||(a[18]=V("span",null,"分",-1))],2),V("span",{class:F("scan-icon-img icon-img-"+j(y))},null,2),a[21]||(a[21]=V("span",{class:"circle-inner"},null,-1)),V("span",{class:F("circle-outer "+j(y))},null,2),V("div",{class:F("animate-box"+j(w))},[V("div",{class:F("animate-box-left linear-"+j(y))},null,2),a[19]||(a[19]=V("div",{class:"animate-box-right"},null,-1)),a[20]||(a[20]=V("div",{class:"animate-box-bottom"},null,-1))],2)])):A("",!0),V("div",me,[V("div",ue,[V("span",null,[b(O(j(X)),1),j(W)?(D(),T("span",de,[a[22]||(a[22]=b("已检测到")),V("span",ve,O(j(W)),1),a[23]||(a[23]=b("个风险"))])):A("",!0)]),V("div",pe,[j(ee)&&j(ae)?A("",!0):(D(),E(l,{key:0,class:F("w-[9rem] "+("info"==j(Z)?"bg-[#CBCBCB]":"")),type:j(Z),round:"",onClick:j(s).scanningProcess},{default:P((()=>[b(O("info"==j(Z)?"停止扫描":"立即扫描"),1)])),_:1},8,["class","type","onClick"])),j(ee)&&j(ae)?(D(),T("span",{key:1,round:"",onClick:a[0]||(a[0]=(...e)=>j(s).scanningProcess&&j(s).scanningProcess(...e)),class:"!p-[0] bt-link text-[1.2rem] mr-4px"}," 重新扫描 ")):A("",!0),j(ee)&&j(ae)?(D(),E(l,{key:2,class:"w-[9rem]",round:"",type:j(Z),onClick:j(s).handleRepairAutoRisk},{default:P((()=>a[24]||(a[24]=[b(" 一键修复 ")]))),_:1},8,["type","onClick"])):A("",!0)])]),"info"===j(Z)||j(ee)?A("",!0):(D(),T("span",fe," 扫描后将自动修复所有可修复的风险项，并获取最新安全扫描报告 ")),"info"===j(Z)||j(ee)?A("",!0):(D(),E(t,{key:1,class:"!p-0 !mt-[12px] w-[150px]",onClick:a[1]||(a[1]=e=>Pa.value=!0)},{default:P((()=>a[25]||(a[25]=[b(" >>查看当前安全扫描报告 ")]))),_:1})),"info"==j(Z)?(D(),T("span",xe,O(j(le)),1)):A("",!0),"info"==j(Z)?(D(),E(r,{key:3,class:"mt-[1.6rem] h-[1rem]","process-color":j(ma).processColor,percentage:j(ma).processPercentage,"stroke-width":10,"show-text":!1},null,8,["process-color","percentage"])):A("",!0),j(ee)?(D(),T("span",ge," 上次扫描时间："+O(j(ua)),1)):A("",!0),j(ee)&&j(ae)?(D(),T("span",ye," 若安装了【系统加固】，请先关闭再进行一键修复 ")):A("",!0)])])]),j(da)?(D(),T("div",he,[V("div",be,[h(c,{onChange:j(s).handelAllSelection,class:"text-[#666] font-500 text-[12px]",modelValue:j(va),"onUpdate:modelValue":a[2]||(a[2]=e=>R(va)?va.value=e:null),disabled:j(pa)},{default:P((()=>a[26]||(a[26]=[b("全选")]))),_:1},8,["onChange","modelValue","disabled"]),N(h(t,{onClick:a[3]||(a[3]=e=>j(s).handleRepair(!1,null)),link:"",class:F(j(Ea)?"ml-[20px] text-[1.4rem] mt-[1px]":"ml-[20px] text-[1.4rem] text-[#999] mt-[1px] cursor-not-allowed ")},{default:P((()=>a[27]||(a[27]=[b("修复选中项 ")]))),_:1},8,["class"]),[[J,!j(fa)]])]),V("div",we,[h(t,{onClick:a[4]||(a[4]=e=>ba.value=!0)},{default:P((()=>a[28]||(a[28]=[b("忽略扫描项")]))),_:1}),a[30]||(a[30]=V("span",{class:"text-[#999] mx-[1.2rem]"},"|",-1)),h(l,{type:"primary",link:"",onClick:a[5]||(a[5]=e=>Pa.value=!0)},{default:P((()=>a[29]||(a[29]=[V("i",{class:"svgtofont-icon-safe-report text-[1.4rem] text-[#20a53a]"},null,-1),b(" 查看安全扫描报告")]))),_:1})])])):A("",!0),j(xa)?A("",!0):N((D(),T("div",{key:1,"v-bt-loading:title":j(ya),class:F([j(ha)?"h-[28rem]":"h-[38rem]","scan-body my-[2rem]"])},[h(k,{modelValue:j(ka),"onUpdate:modelValue":a[7]||(a[7]=e=>R(ka)?ka.value=e:null),accordion:""},{default:P((()=>[V("div",{class:F(["module-list overflow-auto",j(ha)?"h-[28rem]":"h-[38rem]"])},[(D(!0),T(M,null,B(j(Ia),((e,l)=>(D(),T("div",{class:"module-item text-[1.2rem]",key:"".concat(l)},[V("div",_e,[V("div",Ce,[h(c,{modelValue:e.selection,"onUpdate:modelValue":a=>e.selection=a,onChange:a=>j(s).changeSelectValue(e.selection),disabled:j(fa)||!j(Ca).includes(e.m_name)},null,8,["modelValue","onUpdate:modelValue","onChange","disabled"]),V("span",{class:"text-[1.2rem] h-[2.2rem] flex items-center px-[8px] rounded-[0.2rem] ml-[8px] mr-[1rem]",style:U({color:j(Sa)[e.level].color,backgroundColor:j(Sa)[e.level].bg})},O(j(Sa)[e.level].text),5),V("div",{class:"w-[16rem] max-w-[16rem] truncate",style:U({color:j(Sa)[e.level].color}),title:e.ps?e.ps:e.vuln_name},O(e.ps?e.ps:e.vuln_name),13,Se),j(Ca).includes(e.m_name)?A("",!0):(D(),T("div",Ie,[a[32]||(a[32]=b("无法自动修复，请手动处理或")),h(t,{onClick:a[6]||(a[6]=e=>j(s).onlineServiceDialog())},{default:P((()=>a[31]||(a[31]=[b("联系人工")]))),_:1})]))]),V("div",De,[N(V("span",{onClick:a=>j(s).handleRepair(!0,e),class:"w-[4.2rem] bt-link"},a[33]||(a[33]=[b(" 修复"),V("span",{class:"text-[#999] mx-[4px]"},"|",-1)]),8,Te),[[J,!j(fa)&&!!j(Ca).includes(e.m_name)]]),V("span",{underline:!1,onClick:a=>j(s).handleIgnore(e,!1),class:"w-[4.2rem] cursor-pointer text-[#999]"},a[34]||(a[34]=[b(" 忽略 "),V("span",{class:"text-[#999] mx-4px"},"|",-1)]),8,Ve),h(t,{onClick:a=>j(s).onToggle(e,j(Ia)),class:"w-[5.4rem] flex items-center"},{default:P((()=>[b(O(e.show?"折叠":"详情"),1),V("i",{class:F("text-[1.4rem] text-[#999] ml-[4px] svgtofont-el-arrow-"+(e.show?"up":"down"))},null,2)])),_:2},1032,["onClick"])])]),h(g,null,{default:P((()=>[N(V("div",je,[V("div",Ae,[V("div",Fe,O(e.ps?"风险描述":"涉及软件\t"),1),N(V("div",{class:"collapse-item",innerHTML:e.msg},null,8,Oe),[[J,e.msg]]),N(V("div",{class:"collapse-item"},O(e.soft_name?j(s).vulnerabilityInvolvesSoftware(e):""),513),[[J,e.soft_name]])]),V("div",Ee,[a[35]||(a[35]=V("div",null,"解决方案",-1)),e.tips?(D(),T("div",Pe,[(D(!0),T(M,null,B(e.tips,((e,a)=>(D(),T("p",{key:a,class:F(0==a?"":"mt-[4px]")},O(a+1)+"、"+O(e),3)))),128))])):A("",!0),e.vuln_solution?(D(),T("div",Re,O(e.vuln_solution),1)):A("",!0)]),N(V("div",Ne,[a[36]||(a[36]=V("div",null,"温馨提示",-1)),V("div",Je,O(e.remind),1)],512),[[J,e.remind]])],512),[[J,e.show]])])),_:2},1024)])))),128))],2)])),_:1},8,["modelValue"])],10,ke)),[[Fa,j(ga)]]),j(xa)?(D(),T("div",{key:2,class:F([j(ha)?"h-[32rem]":"h-[40rem]","scan-body flex justify-center flex-col my-[4rem] relative"])},[a[37]||(a[37]=V("span",{class:"bg-[#f2f2f2] h-[3rem] w-[33%] mb-[12px]"},null,-1)),(D(),T(M,null,B(4,((e,a)=>V("span",{class:"bg-[#f2f2f2] h-[3rem] w-full mb-[12px]",key:a}))),64)),a[38]||(a[38]=V("span",{class:"bg-[#f2f2f2] h-[3rem] w-[60%] mb-[12px]"},null,-1)),(D(),T(M,null,B(3,((e,a)=>V("span",{class:"bg-[#f2f2f2] h-[3rem] w-full mb-[12px]",key:a}))),64)),a[39]||(a[39]=V("span",{class:"bg-[#f2f2f2] h-[3rem] w-[40%] mb-[12px]"},null,-1))],2)):A("",!0),V("div",Me,[V("span",{class:"cursor-pointer",onClick:a[8]||(a[8]=e=>ha.value=!j(ha))},[V("i",{class:F(["mr-[0.6rem]",j(ha)?"svgtofont-el-arrow-up":"svgtofont-el-arrow-down"])},null,2),a[40]||(a[40]=V("span",null,"更多安全工具",-1))]),j(ha)?(D(),T("div",Be,[h(_,{class:"relative item",effect:"dark",content:"点击跳转到功能页",placement:"top-start"},{default:P((()=>[V("div",{class:"scan-recommend-body-box relative",onClick:a[9]||(a[9]=e=>Ja("spywareDetection"))},a[41]||(a[41]=[V("div",{class:"scan-recommend-body-box-title"},"动态查杀",-1),V("div",{class:"scan-recommend-body-box-desc"},"支持定时动态查杀木马隔离",-1),V("i",{class:"svgtofont-icon-dynamic-kill text-[#20a53a20] text-[6rem] absolute bottom-2rem left-[0.8rem]"},null,-1)]))])),_:1}),h(_,{class:"relative tem",effect:"dark",content:"点击跳转到功能页",placement:"top-start"},{default:P((()=>[V("div",{class:"scan-recommend-body-box safaty-detect relative",onClick:a[10]||(a[10]=e=>Ja("safeDetectTab"))},a[42]||(a[42]=[V("div",{class:"scan-recommend-body-box-title"},"安全检测",-1),V("div",{class:"scan-recommend-body-box-desc"},"更全面的服务器检测",-1),V("i",{class:"svgtofont-icon-safaty-detect text-[#20a53a20] text-[6rem] absolute bottom-2rem left-[0.8rem]"},null,-1)]))])),_:1}),h(_,{class:"relative item",effect:"dark",content:"点击跳转到功能页",placement:"top-start"},{default:P((()=>[V("div",{class:"scan-recommend-body-box bug-scan relative",onClick:a[11]||(a[11]=e=>Ja("vulnerabilityScanning"))},a[43]||(a[43]=[V("div",{class:"scan-recommend-body-box-title"},"网站漏洞扫描",-1),V("div",{class:"scan-recommend-body-box-desc"},"针对网站漏洞的专享扫描工具",-1),V("i",{class:"svgtofont-icon-bug-scan text-[#20a53a20] text-[6rem] absolute bottom-1.6rem left-[0.8rem]"},null,-1)]))])),_:1})])):A("",!0)]),h(Y,{title:"结果确认","show-footer":!1,area:54,modelValue:j(Ta),"onUpdate:modelValue":a[12]||(a[12]=e=>R(Ta)?Ta.value=e:null)},{default:P((()=>[V("div",Ue,[V("span",He,[a[44]||(a[44]=b("修复结果：修复成功")),V("span",Le,O(j(Va).success),1),a[45]||(a[45]=b("项，修复失败")),V("span",$e,O(j(Va).failed),1),a[46]||(a[46]=b("项，忽略")),V("span",qe,O(j(Va).cannot_automatically),1),a[47]||(a[47]=b("项"))]),h(C,{"max-height":400,data:j(ja),column:j(Aa)},null,8,["data","column"]),h(S,{options:[{content:"如有修复失败项，请关闭当前窗口，根据解决方案手动进行修复"}],"list-style":"none",class:"ml-[8px] mt-[12px]"})])])),_:1},8,["modelValue"]),h(Y,{title:!1,"show-footer":!1,area:54,modelValue:j(Da).repairProgress,"onUpdate:modelValue":a[13]||(a[13]=e=>j(Da).repairProgress=e),showClose:!1},{default:P((()=>[V("div",ze,[h(te,{class:"!w-full",color:"#20a53a","text-inside":!0,"stroke-width":20,percentage:j(Da).progress},null,8,["percentage"]),V("span",Ge,O(j(Da).repairText),1)])])),_:1},8,["modelValue"]),h(Y,{title:"忽略风险项",area:66,modelValue:j(ba),"onUpdate:modelValue":a[15]||(a[15]=e=>R(ba)?ba.value=e:null),"show-footer":!1},{default:P((()=>[j(xa)?A("",!0):(D(),T("div",Ke,[h(k,{modelValue:j(_a),"onUpdate:modelValue":a[14]||(a[14]=e=>R(_a)?_a.value=e:null),accordion:"",class:F("".concat(j(wa).length?"":"!border-none"))},{default:P((()=>[V("div",Qe,[(D(!0),T(M,null,B(j(wa),((e,l)=>(D(),T("div",{class:"module-item text-[1.2rem]",key:"".concat(l)},[V("div",Xe,[V("div",Ye,[V("span",{class:"text-[1.2rem] h-[2.2rem] flex items-center px-[8px] rounded-[0.2rem] ml-[8px] mr-[1rem]",style:U({color:j(Sa)[e.level].color,backgroundColor:j(Sa)[e.level].bg})},O(j(Sa)[e.level].text),5),V("div",{class:"w-[36rem] max-w-[36rem] truncate",style:U({color:j(Sa)[e.level].color}),title:e.ps?e.ps:e.vuln_name},O(e.ps?e.ps:e.vuln_name),13,We)]),V("div",Ze,[h(t,{onClick:a=>j(n)(e,!0),class:"w-[6.6rem]"},{default:P((()=>a[48]||(a[48]=[b(" 移除忽略 "),V("span",{class:"text-[#999] mx-[4px]"},"|",-1)]))),_:2},1032,["onClick"]),h(t,{onClick:a=>j(o)(e,j(wa)),class:"w-[5.4rem] flex items-center"},{default:P((()=>[b(O(e.show?"折叠":"详情"),1),V("i",{class:F("text-[1.4rem] text-[#999] ml-[4px] svgtofont-el-arrow-"+(e.show?"up":"down"))},null,2)])),_:2},1032,["onClick"])])]),h(g,null,{default:P((()=>[N(V("div",ea,[V("div",aa,[V("div",la,O(e.ps?"风险描述":"涉及软件"),1),N(V("div",{class:"collapse-item",innerHTML:e.msg},null,8,ta),[[J,e.msg]]),N(V("div",{class:"collapse-item"},O(e.soft_name?j(v)(e):""),513),[[J,e.soft_name]])]),V("div",sa,[a[49]||(a[49]=V("div",null,"解决方案",-1)),e.tips?(D(),T("div",na,[(D(!0),T(M,null,B(e.tips,((e,a)=>(D(),T("p",{key:a,class:F(0==a?"":"mt-[4px]")},O(a+1)+"、"+O(e),3)))),128))])):A("",!0),e.vuln_solution?(D(),T("div",oa,O(e.vuln_solution),1)):A("",!0)]),N(V("div",ra,[a[50]||(a[50]=V("div",null,"温馨提示",-1)),V("div",ca,O(e.remind),1)],512),[[J,e.remind]])],512),[[J,e.show]])])),_:2},1024)])))),128)),j(wa).length?A("",!0):(D(),E(se,{key:0,description:"暂无忽略的风险项"}))])])),_:1},8,["modelValue","class"])]))])),_:1},8,["modelValue"]),h(Y,{title:"安全扫描报告","show-footer":!1,area:[100,80],modelValue:j(Pa),"onUpdate:modelValue":a[16]||(a[16]=e=>R(Pa)?Pa.value=e:null)},{default:P((()=>[a[53]||(a[53]=V("div",{class:"box"},[V("iframe",{src:"/project/security/report/html",frameborder:"0",width:"200%",height:"200%"})],-1)),V("div",ia,[a[52]||(a[52]=V("span",null,null,-1)),h(t,{onClick:Na,class:"border border-solid border-[#20a53a] py-8px px-12px rounded-2px mr-20px my-8px"},{default:P((()=>a[51]||(a[51]=[V("i",{class:"svgtofont-icon-ltd text-[#A88E5F] mt-2px"},null,-1),b(" 下载报告")]))),_:1})])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-d90bf387"]]);export{ma as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
