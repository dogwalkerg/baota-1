import{u as a,l as e,H as t,G as s,o as l,k as o,h as n,b as i}from"./utils-lib.js?v=1734676359";import{_ as r}from"./index100.js?v=1734676359";import{_ as u}from"./index90.js?v=1734676359";import{B as m}from"./index185.js?v=1734676359";import{_ as d}from"./index99.js?v=1734676359";import{c,r as p,h,o as w,B as f,k as v,l as g,p as y,J as _,x,q as j,e as k,y as V,M as b,C,A as q,aj as A}from"./base-lib.js?v=1734676359";import{_ as E}from"./index91.js?v=1734676359";import{h as F,u as S}from"./column.js?v=1734676359";import{checkMonitorDir as I,setMonitorDir as U,webshellFileSingle as B,setHandleFile as H}from"./site.js?v=1734676359";import{S as J,u as O}from"./useStore7.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./validator.js?v=1734676359";import"./ace.js?v=1734676359";const P={class:"flex items-center"},R={class:"p-20px"},T=c({__name:"index",setup(c){const{getFileEvent:T,saveFileEvent:D}=J(),G=i(),{payment:L}=a(),{siteInfo:M}=O(),N=p([]),z=p(!1),K=p(""),Q=p(!1),W=p({}),X=p(!1),Y=h({title:"动态查杀-功能介绍",ps:"当查杀站点目录中的文件发生修改就会自动的进行木马查杀并进行隔离",source:185,desc:["网页内容修改检测","木马查杀隔离"],tabImgs:[{title:"概览",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/site/dynamic_kill.png"}]}),Z=()=>{e({isAsync:!0,title:"白名单",area:[70,55],component:()=>t((()=>import("./index375.js?v=1734676359")),__vite__mapDeps([]),import.meta.url),showFooter:!1})},$=async a=>{s({loading:"正在设置中，请稍后...",request:U(!a,{path:"/www/wwwroot/"+M.value.name}),message:!0})},aa=async()=>{const a=await D({path:W.value.path,data:K.value,encoding:"utf-8"});G.request(a)},ea=async()=>{z.value=!0;try{const a=await B({path:"/www/wwwroot/"+M.value.name+"/"});N.value=Array.isArray(a.data)?a.data:[]}catch(a){}z.value=!1},ta=p([{label:"隔离时间",prop:"time"},F(),S([{width:80,onClick:async a=>{W.value=a;const e=await T({path:a.path});if(!e.status)return G.request(e),!1;K.value=e.data||e.msg,Q.value=!0},title:"样本文件"},{onClick:a=>{l({title:"删除文件",content:"是否要删除关联的源文件?",type:"check",icon:"warning",check:{content:"源文件",onConfirm:e=>{s({loading:"正在删除文件中，请稍后...",request:H({data:JSON.stringify({path:a.path,md5:a.md5,type:e?"delete":""})}),message:!0,success:a=>{a.status&&ea()}})}}})},title:"删除"}])]);return w((()=>{(async()=>{try{const a=await I({path:"/www/wwwroot/"+M.value.name});X.value=a.data.is_run}catch(a){}})(),ea()})),(a,e)=>{const t=q,s=E,l=A,i=d,c=o,p=m,h=n,w=u,F=r,S=f("bt-loading");return v(),g("div",null,["ltd"===y(L).authType?(v(),_(w,{key:0},{"header-left":x((()=>[j("div",P,[k(t,{type:"default",onClick:Z},{default:x((()=>e[3]||(e[3]=[V(" 白名单 ")]))),_:1}),k(s),e[4]||(e[4]=j("div",{class:"mr-8px"},"动态查杀站点",-1)),j("div",null,[k(l,{modelValue:y(X),"onUpdate:modelValue":e[0]||(e[0]=a=>b(X)?X.value=a:null),width:36,onChange:$},null,8,["modelValue"])])])])),"header-right":x((()=>[k(i,{onRefresh:ea})])),content:x((()=>[C(k(c,{column:y(ta),"max-height":400,data:y(N)},null,8,["column","data"]),[[S,y(z)]])])),"footer-left":x((()=>e[5]||(e[5]=[j("ul",{class:"mt-8px leading-8 text-[1.2rem] list-disc ml-20px"},[j("li",null,"注意：隔离文件后的数字表示隔离文件总数。"),j("li",{class:"text-orange"},"动态查杀开启后，当查杀目录中的文件发生修改就会自动的进行木马查杀并进行隔离")],-1)]))),"footer-right":x((()=>e[6]||(e[6]=[]))),popup:x((()=>[k(h,{title:"在线编辑",showFooter:"",modelValue:y(Q),"onUpdate:modelValue":e[2]||(e[2]=a=>b(Q)?Q.value=a:null),area:70,onConfirm:aa},{default:x((()=>[j("div",R,[k(p,{modelValue:y(K),"onUpdate:modelValue":e[1]||(e[1]=a=>b(K)?K.value=a:null),class:"!h-[40rem]"},null,8,["modelValue"])])])),_:1},8,["modelValue"])])),_:1})):(v(),_(F,{key:1,data:y(Y)},null,8,["data"]))])}}});export{T as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
