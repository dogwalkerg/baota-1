!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function r(e){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?t(Object(o),!0).forEach((function(t){n(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function n(t,r,n){return(r=function(t){var r=function(t,r){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,r||"default");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==e(r)?r:r+""}(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}System.register(["./base-lib-legacy.js?v=1734676359","./utils-lib-legacy.js?v=1734676359","./site-legacy.js?v=1734676359","./__commonjsHelpers__-legacy.js?v=1734676359"],(function(e,t){"use strict";var n,o,u,l,a,i,c,s,m,f,d,p,y,w,h,b,v,g,_,k,V,x,j,D,O;return{setters:[function(e){n=e.c,o=e.r,u=e.h,l=e.o,a=e.k,i=e.J,c=e.x,s=e.e,m=e.p,f=e.q,d=e.l,p=e.I,y=e.aX,w=e.z,h=e.y,b=e.a7,v=e.ag,g=e.ah,_=e.Q,k=e.aw,V=e.a4},function(e){x=e.G,j=e.j},function(e){D=e.modifyCrontab,O=e.addCrontab},null],execute:function(){var t={class:"flex items-center"},P={class:"flex items-center"};e("default",n({__name:"add-crontab",props:{compData:{default:{}}},setup:function(e,n){var H=n.expose,S=e,M=o(!!S.compData.row),U=o(),q=o(!1),B=u({cron_name:"",type:"week",week:"1",where1:"3",hour:"1",minute:"30",flock:!1,sBody:""}),C=u({cron_name:[{required:!0,message:"请输入计划任务名称",trigger:"blur"}],hour:[{required:!0,message:"请输入执行时间",trigger:"blur"}],minute:[{required:!0,message:"请输入执行时间",trigger:"blur"}],sBody:[{required:!0,message:"请输入脚本内容",trigger:"blur"}]}),E=o(5),N=o([{type:"day",text:"每天",showDay:!1,showHour:!0,showMinute:!0},{type:"day-n",text:"N天",showDay:!0,showHour:!0,showMinute:!0},{type:"hour",text:"每小时",showDay:!1,showHour:!1,showMinute:!0},{type:"hour-n",text:"N小时",showDay:!1,showHour:!0,showMinute:!0},{type:"minute-n",text:"N分钟",showDay:!1,showHour:!1,showMinute:!0},{type:"week",text:"每周",showDay:!1,showHour:!0,showMinute:!0},{type:"month",text:"每月",showDay:!0,showHour:!0,showMinute:!0}]),z=function(e){B.type=e,E.value=N.value.findIndex((function(t){return t.type===e})),"minute-n"===B.type&&(B.where1=B.minute),"hour-n"===B.type&&(B.where1=B.hour),U.value&&U.value.clearValidate()};return l((function(){M.value=!!S.compData.row;var e=S.compData.row,t=e.type,r=e.where1,n=e.where_hour,o=e.where_minute,u=e.flock,l=e.sBody,a=e.rname,i=e.name;Object.assign(B,{cron_name:a||i||"",type:t||"week",week:"week"===t?r:"1",where1:r||"3",hour:n||"1",minute:o||"30",flock:!!u,sBody:l||""}),z(B.type)})),H({onConfirm:function(e){U.value.validate((function(t){if(t){q.value=!0;var n=r(r({sitename:S.compData.sitename},B),{},{flock:B.flock?1:0});M.value&&(n.id=S.compData.row.id);var o=M.value?D:O;x({loading:"正在".concat(M.value?"修改":"添加","计划任务，请稍候..."),request:o(n),message:!0,success:function(t){q.value=!1,t.status&&(e(),S.compData.refreshEvent())}})}}))}}),function(e,r){var n=j,o=b,u=v,l=g,x=_,D=k,O=V;return a(),i(O,{ref_key:"crontabFormRef",ref:U,model:m(B),rules:m(C),disabled:m(q),"label-width":"80px",class:"p-2rem"},{default:c((function(){return[s(o,{label:"任务名称",prop:"cron_name"},{default:c((function(){return[s(n,{modelValue:m(B).cron_name,"onUpdate:modelValue":r[0]||(r[0]=function(e){return m(B).cron_name=e}),placeholder:"请输入计划任务名称",width:"36rem"},null,8,["modelValue"])]})),_:1}),s(o,{label:"执行周期"},{default:c((function(){var e,b,v;return[f("div",t,[s(l,{onChange:r[1]||(r[1]=function(e){return z(m(B).type,!0)}),class:"!w-[8rem] mr-1rem",modelValue:m(B).type,"onUpdate:modelValue":r[2]||(r[2]=function(e){return m(B).type=e})},{default:c((function(){return[(a(!0),d(p,null,y(m(N),(function(e,t){return a(),i(u,{key:t,label:e.text,value:e.type},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"]),"week"==m(B).type?(a(),i(o,{key:0,class:"el-form-item-item mr-1rem"},{default:c((function(){return[s(l,{class:"!w-[8rem]",modelValue:m(B).week,"onUpdate:modelValue":r[3]||(r[3]=function(e){return m(B).week=e})},{default:c((function(){return[s(u,{label:"周一",value:"1"}),s(u,{label:"周二",value:"2"}),s(u,{label:"周三",value:"3"}),s(u,{label:"周四",value:"4"}),s(u,{label:"周五",value:"5"}),s(u,{label:"周六",value:"6"}),s(u,{label:"周日",value:"7"})]})),_:1},8,["modelValue"])]})),_:1})):w("",!0),null!==(e=m(N)[m(E)])&&void 0!==e&&e.showDay?(a(),i(o,{key:1,class:"el-form-item-item mr-1rem",prop:"where1"},{default:c((function(){return[s(n,{modelValue:m(B).where1,"onUpdate:modelValue":r[4]||(r[4]=function(e){return m(B).where1=e}),min:1,width:"12rem",type:"number"},{append:c((function(){return r[9]||(r[9]=[h("天")])})),_:1},8,["modelValue"])]})),_:1})):w("",!0),null!==(b=m(N)[m(E)])&&void 0!==b&&b.showHour?(a(),i(o,{key:2,class:"el-form-item-item mr-1rem",prop:"hour"},{default:c((function(){var e;return[null!==(e=m(N)[m(E)])&&void 0!==e&&e.showHour?(a(),i(n,{key:0,modelValue:m(B).hour,"onUpdate:modelValue":r[5]||(r[5]=function(e){return m(B).hour=e}),width:"12rem",max:"23",min:"0",type:"number"},{append:c((function(){return r[10]||(r[10]=[h("小时")])})),_:1},8,["modelValue"])):w("",!0)]})),_:1})):w("",!0),null!==(v=m(N)[m(E)])&&void 0!==v&&v.showMinute?(a(),i(o,{key:3,class:"el-form-item-item",prop:"minute"},{default:c((function(){var e;return[null!==(e=m(N)[m(E)])&&void 0!==e&&e.showMinute?(a(),i(n,{key:0,modelValue:m(B).minute,"onUpdate:modelValue":r[6]||(r[6]=function(e){return m(B).minute=e}),width:"12rem",max:"59",min:"0",type:"number"},{append:c((function(){return r[11]||(r[11]=[h("分钟")])})),_:1},8,["modelValue"])):w("",!0)]})),_:1})):w("",!0)])]})),_:1}),s(o,{label:" ","label-width":"0rem"},{default:c((function(){return[f("div",P,[s(x,{modelValue:m(B).flock,"onUpdate:modelValue":r[7]||(r[7]=function(e){return m(B).flock=e}),disabled:m(M)},{default:c((function(){return r[12]||(r[12]=[h("开启进程锁")])})),_:1},8,["modelValue","disabled"]),s(D,{placement:"right-start",width:"440","popper-class":"white-tips-popover",trigger:"hover",content:""},{reference:c((function(){return r[13]||(r[13]=[f("i",{class:"svgtofont-el-question-filled text-warning ml-[12px]"},null,-1)])})),default:c((function(){return[r[14]||(r[14]=f("div",{class:"p-[12px]"},[f("span",{class:"text-[#666]"},"在同一时间内只用一个进程在执行，若上一个进程未执行结束，下一次不执行")],-1))]})),_:1})])]})),_:1}),s(o,{label:"脚本内容",prop:"sBody"},{default:c((function(){return[s(n,{width:"58rem",placeholder:"请输入脚本内容",type:"textarea",modelValue:m(B).sBody,"onUpdate:modelValue":r[8]||(r[8]=function(e){return m(B).sBody=e}),resize:"both",rows:10},null,8,["modelValue"])]})),_:1})]})),_:1},8,["model","rules","disabled"])}}}))}}}))}();
