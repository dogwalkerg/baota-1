import{_ as t}from"./index90.js?v=1734676359";import{_ as e}from"./index97.js?v=1734676359";import{u as a,aj as s,R as o,G as r,S as i,k as l}from"./utils-lib.js?v=1734676359";import{getRiskList as n}from"./site.js?v=1734676359";import{c as p,R as m,r as c,a_ as u,o as d,B as _,k as h,J as j,x as f,C as w,p as x,e as b,F as g}from"./base-lib.js?v=1734676359";import{u as k}from"./column.js?v=1734676359";import{f as C}from"./useController6.js?v=1734676359";import{aQ as y}from"./store.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";import"./validator.js?v=1734676359";import"./useStore7.js?v=1734676359";import"./useController3.js?v=1734676359";import"./store2.js?v=1734676359";import"./index88.js?v=1734676359";const v=p({__name:"risk-list",props:{compData:{default:()=>({isPopup:!1})}},setup(p){const v=p,{mainHeight:R}=a(),U=m(!1),D=c([]),H=c(0),M=c(v.compData.isPopup),P=(t,e)=>{y({path:t})},S=t=>{var e;let a="/www/server/panel/class/projectModel/content/source/",s=a+t.source_file;(null==(e=t.risk_type)?void 0:e.indexOf("_update"))>-1?((t,e)=>{"title_hash_update"!==t.risk_type&&"tail_hash_update"!==t.risk_type||(e="/www/server/panel/class/projectModel/content/hash/"+t.site_name+"/"),t.source_content_file;let a=e+t.new_content_file;P(a)})(t,a):P(s,t.content)},q=u({p:1,limit:20}),A=[{label:"巡检时间",width:"150px",render:t=>{const e=s(t.time,"number",0);return b("span",null,[o(e)])}},{label:"URL",render:t=>b("span",{class:"bt-link",title:t.url,onClick:()=>window.open(t.url)},[t.url])},{label:"关键词",prop:"content",width:"200px"},{label:"类型",prop:"risk_content",width:"200px"},{label:"风险位置",width:"150px",render:t=>C[t.risk_type]},k([{onClick:S,title:"详情"}])];return d((()=>(async()=>{await r({loading:U,request:n({...q}),data:{data:[Array,D],page:i(H)}})})())),(a,s)=>{const o=l,r=e,i=t,p=_("bt-loading");return h(),j(i,{class:g({"p-[2rem]":x(M)})},{content:f((()=>[w(b(o,{ref:"table",column:x(A),data:x(D),description:"风险列表为空","max-height":x(M)?500:x(R)-300},null,8,["column","data","max-height"]),[[p,x(U)],[p,"正在加载风险列表，请稍后...","title"]])])),"footer-right":f((()=>[b(r,{total:x(H),page:x(q).p,"onUpdate:page":s[0]||(s[0]=t=>x(q).p=t),row:x(q).limit,"onUpdate:row":s[1]||(s[1]=t=>x(q).limit=t),onChange:x(n)},null,8,["total","page","row","onChange"])])),_:1},8,["class"])}}});export{v as default};
