import{_ as a}from"./index90.js?v=1734676359";import{G as e,o as s,k as t,b as i}from"./utils-lib.js?v=1734676359";import{c as r,R as o,h as l,o as n,B as p,k as m,l as d,e as c,x as h,p as u,y as f,C as b,A as _}from"./base-lib.js?v=1734676359";import{_ as g}from"./index88.js?v=1734676359";import{b0 as y,b1 as j,b2 as w}from"./firewall.js?v=1734676359";import{u as x}from"./column.js?v=1734676359";import{f as k}from"./validator.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";const v={class:"p-[2rem]"},C=r({__name:"index",setup(r){const C=i(),q=o([]),V=l({path:"",type:"dir"}),A=async()=>{e({request:y(),data:{"msg.scan_dir":[Array,a=>{q.value=a.map((a=>({path:a})))}]}})},H=async()=>{V.path?(await e({request:w({dir:V.path}),loading:"正在添加检测目录，请稍后...",message:!0}),A(),V.path=""):C.error("请填写检测目录")},B=[{label:"所在目录",prop:"path"},x([{onClick:async a=>{await s({icon:"question-filled",title:"删除检测目录",width:"34rem",content:"删除检测目录【"+a.path+"】，是否继续操作？"}),await e({request:j({path:JSON.stringify([a.path])}),loading:"正在删除检测目录，请稍后...",message:!0}),A()},title:"删除",isHide:a=>["/bin/","/sbin/","/usr/bin/","/usr/sbin/"].includes(a.path)}])];return n((()=>{A()})),(e,s)=>{const i=g,r=_,o=t,l=a,n=p("bt-loading");return m(),d("div",v,[c(l,null,{"header-left":h((()=>[c(i,{modelValue:u(V).path,"onUpdate:modelValue":s[0]||(s[0]=a=>u(V).path=a),name:"path",placeholder:"选择目录",icon:"icon-file_mode",onIconClick:s[1]||(s[1]=a=>{k({type:"dir",path:"/",change(a,e){a=a.replace(/\/\//g,"/"),V.path=a,V.type=e}})}),onChangePassive:s[2]||(s[2]=a=>{var e;V[e="path"]=V[e].replace(/\s+/g,"")}),width:"32rem"},null,8,["modelValue"]),c(r,{type:"primary",class:"!ml-[.8rem]",onClick:H},{default:h((()=>s[3]||(s[3]=[f(" 添加 ")]))),_:1})])),content:h((()=>[b(c(o,{ref:"detecList",column:B,data:u(q),description:"检测列表为空"},null,8,["data"]),[[n,"正在加载检测列表，请稍后...","title"]])])),_:1})])}}});export{C as default};
