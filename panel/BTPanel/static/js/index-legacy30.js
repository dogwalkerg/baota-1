!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */t=function(){return r};var n,r={},a=Object.prototype,o=a.hasOwnProperty,u=Object.defineProperty||function(e,t,n){e[t]=n.value},c="function"==typeof Symbol?Symbol:{},i=c.iterator||"@@iterator",l=c.asyncIterator||"@@asyncIterator",s=c.toStringTag||"@@toStringTag";function f(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(n){f=function(e,t,n){return e[t]=n}}function p(e,t,n,r){var a=t&&t.prototype instanceof x?t:x,o=Object.create(a.prototype),c=new R(r||[]);return u(o,"_invoke",{value:E(e,n,c)}),o}function m(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=p;var d="suspendedStart",v="suspendedYield",h="executing",g="completed",y={};function x(){}function w(){}function k(){}var _={};f(_,i,(function(){return this}));var b=Object.getPrototypeOf,C=b&&b(b(V([])));C&&C!==a&&o.call(C,i)&&(_=C);var j=k.prototype=x.prototype=Object.create(_);function L(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function S(t,n){function r(a,u,c,i){var l=m(t[a],t,u);if("throw"!==l.type){var s=l.arg,f=s.value;return f&&"object"==e(f)&&o.call(f,"__await")?n.resolve(f.__await).then((function(e){r("next",e,c,i)}),(function(e){r("throw",e,c,i)})):n.resolve(f).then((function(e){s.value=e,c(s)}),(function(e){return r("throw",e,c,i)}))}i(l.arg)}var a;u(this,"_invoke",{value:function(e,t){function o(){return new n((function(n,a){r(e,t,n,a)}))}return a=a?a.then(o,o):o()}})}function E(e,t,r){var a=d;return function(o,u){if(a===h)throw Error("Generator is already running");if(a===g){if("throw"===o)throw u;return{value:n,done:!0}}for(r.method=o,r.arg=u;;){var c=r.delegate;if(c){var i=P(c,r);if(i){if(i===y)continue;return i}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===d)throw a=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=h;var l=m(e,t,r);if("normal"===l.type){if(a=r.done?g:v,l.arg===y)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(a=g,r.method="throw",r.arg=l.arg)}}}function P(e,t){var r=t.method,a=e.iterator[r];if(a===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=n,P(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=m(a,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,y;var u=o.arg;return u?u.done?(t[e.resultName]=u.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,y):u:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,y)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function D(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function V(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,u=function e(){for(;++a<t.length;)if(o.call(t,a))return e.value=t[a],e.done=!1,e;return e.value=n,e.done=!0,e};return u.next=u}}throw new TypeError(e(t)+" is not iterable")}return w.prototype=k,u(j,"constructor",{value:k,configurable:!0}),u(k,"constructor",{value:w,configurable:!0}),w.displayName=f(k,s,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,k):(e.__proto__=k,f(e,s,"GeneratorFunction")),e.prototype=Object.create(j),e},r.awrap=function(e){return{__await:e}},L(S.prototype),f(S.prototype,l,(function(){return this})),r.AsyncIterator=S,r.async=function(e,t,n,a,o){void 0===o&&(o=Promise);var u=new S(p(e,t,n,a),o);return r.isGeneratorFunction(t)?u:u.next().then((function(e){return e.done?e.value:u.next()}))},L(j),f(j,s,"Generator"),f(j,i,(function(){return this})),f(j,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},r.values=V,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(D),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,a){return c.type="throw",c.arg=e,t.next=r,a&&(t.method="next",t.arg=n),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var u=this.tryEntries[a],c=u.completion;if("root"===u.tryLoc)return r("end");if(u.tryLoc<=this.prev){var i=o.call(u,"catchLoc"),l=o.call(u,"finallyLoc");if(i&&l){if(this.prev<u.catchLoc)return r(u.catchLoc,!0);if(this.prev<u.finallyLoc)return r(u.finallyLoc)}else if(i){if(this.prev<u.catchLoc)return r(u.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<u.finallyLoc)return r(u.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var u=a?a.completion:{};return u.type=e,u.arg=t,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(u)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),D(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;D(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:V(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),y}},r}function n(e,t,n,r,a,o,u){try{var c=e[o](u),i=c.value}catch(e){return void n(e)}c.done?t(i):Promise.resolve(i).then(r,a)}function r(e){return function(){var t=this,r=arguments;return new Promise((function(a,o){var u=e.apply(t,r);function c(e){n(u,a,o,c,i,"next",e)}function i(e){n(u,a,o,c,i,"throw",e)}c(void 0)}))}}System.register(["./utils-lib-legacy.js?v=1734676359","./base-lib-legacy.js?v=1734676359","./useStore-legacy3.js?v=1734676359","./useMethods-legacy.js?v=1734676359","./use-socket-request-legacy.js?v=1734676359","./index-legacy182.js?v=1734676359","./index-legacy101.js?v=1734676359","./index-legacy185.js?v=1734676359","./__commonjsHelpers__-legacy.js?v=1734676359","./column-legacy.js?v=1734676359","./index-legacy91.js?v=1734676359","./ace-legacy.js?v=1734676359"],(function(e,n){"use strict";var a,o,u,c,i,l,s,f,p,m,d,v,h,g,y,x,w,k,_,b,C,j,L,S,E,P,I,D,R,V,q,O,N,T,M,G,F,H,U,A,B,z,W,Y,J,X,K,Q,$,Z,ee,te,ne,re,ae,oe,ue,ce,ie,le,se,fe,pe,me,de,ve,he;return{setters:[function(e){a=e.u,o=e.o,u=e.aj,c=e.l,i=e.H,l=e.b,s=e.G,f=e.e,p=e.h,m=e.ai,d=e.R,v=e.c,h=e.M},function(e){g=e.c,y=e.r,x=e.ax,w=e.h,k=e.i,_=e.w,b=e.o,C=e.B,j=e.k,L=e.l,S=e.q,E=e.e,P=e.x,I=e.y,D=e.p,R=e.M,V=e.C,q=e.G,O=e.I,N=e.aX,T=e.D,M=e.F,G=e.az,F=e.A,H=e.P,U=e.Q,A=e.au,B=e.aw,z=e.N,W=e.v,Y=e.z,J=e.L,X=e.b5,K=e.J,Q=e.ap,$=e.ao,Z=e.an,ee=e.aN,te=e.n,ne=e.W,re=e.a1,ae=e.b2,oe=e.a$,ue=e.b3},function(e){ce=e.g,ie=e.H,le=e.I,se=e.x},function(e){fe=e.t,pe=e.N},function(e){me=e.u},function(e){de=e._},function(e){ve=e._},function(e){he=e.B},null,null,null,null],execute:function(){var ge={class:"flex items-center flex-wrap gap-[10px] p-[1.6rem]"},ye={class:"w-full relative"},xe=["onClick"],we={class:"w-[1.6rem]"},ke={class:"flex flex-col ml-[1rem] w-[60%] truncate"},_e={class:"truncate compose-title"},be=["onClick"],Ce=["value","onBlur"],je={class:"batch-select"},Le={class:"ml-[1rem]"},Se=g({__name:"orchestration-list",setup:function(e){var f=a().mainHeight,p=ce().refs.orchestrationData,m=l(),d=y(""),v=y({}),h=x("addCompose"),g=x("createComposeDialog",(function(){})),K=y([]),Q=y([]),$=w({checked:!1,showCheckPopover:!1,showSlectPopover:!1,popoverContent:"",type:""}),Z=y(!1),ee=[{active:!0,content:"添加容器编排",event:function(){return g(h)}}],te=null,ne=x("socketInstance"),re=x("isEmpty"),ae=x("createNewSocket"),oe=y(!0),ue=y({}),le=y(""),se=k((function(){return d.value?Q.value.filter((function(e){return e.name.includes(d.value)})):Q.value}));_((function(){return p.value.refreshList}),(function(e){e&&Oe(e)}));var fe=function(e){switch(e.run_status){case"running":return{text:"运行中",type:"success"};case"exited":return{text:"已停止",type:"danger"};default:return{text:"异常",type:"warning"}}},pe=k((function(){return 0===K.value.length})),me=k((function(){return Q.value.length!==K.value.length&&K.value.length>0})),ve=function(e){var t={},n=e.map((function(e){return t[e.name]=K.value.includes(e.name),e.name}));return K.value=K.value.filter((function(e){return n.includes(e)})),t},he=function(e){switch(clearTimeout(te),$.showSlectPopover=!1,$.showCheckPopover=!1,e){case"select":$.showSlectPopover=!0,te=setTimeout((function(){$.showSlectPopover=!1}),2e3);break;case"check":$.showCheckPopover=!0,te=setTimeout((function(){$.showCheckPopover=!1}),2e3)}},Se=function(){if(pe.value||""===$.type)switch(!0){case 0===K.value.length:$.popoverContent="请先选择要操作的容器编排",he("check");break;case""===$.type:$.popoverContent="请选择批量操作",he("select")}},Ee=function(e){e?(K.value=Q.value.map((function(e){return e.name})),v.value=ve(Q.value)):(K.value=[],v.value=ve(Q.value))},Pe=function(){return Ie()},Ie=function(){var e=r(t().mark((function e(){var r,a,l;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o({icon:"warning-filled",title:"批量删除容器编排",width:"35rem",content:"将批量删除选中的".concat(K.value.length,"个容器编排,是否继续？")});case 3:r={mod_name:"docker",sub_mod_name:"com",def_name:"batch_delete",project_list:[],ws_callback:"batch_delete"},K.value.map((function(e){var t=Q.value.find((function(t){return t.name===e}));t&&r.project_list.push({project_name:e,path:t.path})})),a=[],p.value.noRefresh=!0,l=m.load("正在删除中"),ne.value.socketRequest({params:r,onMessage:function(e){var t=u(e.data,"object",!1);t&&a.push({name:t.project_name,status:t.status}),-1===e.data&&(p.value.noRefresh=!1,l.close(),Z.value=!1,c({title:"批量删除结果",area:42,component:function(){return i((function(){return n.import("./index-legacy102.js?v=1734676359")}),void 0,n.meta.url)},compData:{resultData:a,autoTitle:"批量删除完成",resultColumn:[{label:"容器编排名称",prop:"name"},{label:"操作结果",align:"right",render:function(e){return G("span",{class:e.status?"text-primary":e.status?"text-danger":""},e.status?"删除成功":"删除失败")}}]}}))}}),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(0);case 13:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),De=function(e){e.target.blur()},Re=function(){var e=r(t().mark((function e(n,r){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ue.value[r.name]=!1,p.value.isEdit=!1,n.target.value!==r.remark){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,s({request:ie({remark:n.target.value,name:r.name,path:r.path}),message:!0,success:function(e){e.status&&(r.remark=n.target.value)}});case 6:Ve(r);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ve=function(){var e=r(t().mark((function e(n){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ue.value[n.name]){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,ae();case 4:Oe(),p.value.currentCompose=n,n.path===p.value.currentCompose.path&&(p.value.refreshItem=!p.value.refreshItem);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qe=function(){c({title:"编排模板",area:100,component:function(){return i((function(){return n.import("./index-legacy183.js?v=1734676359")}),void 0,n.meta.url)}})},Oe=function(){var e=r(t().mark((function e(n){var a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{a={mod_name:"docker",sub_mod_name:"com",def_name:"get_project_list",ws_callback:"get_project_list"},p.value.refreshList=!1,p.value.loading=!0,ne.value.socketRequest({params:a,onMessage:function(){var e=r(t().mark((function e(r){var a,o;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!p.value.isEdit){e.next=2;break}return e.abrupt("return");case 2:if(Q.value=r.data||[],p.value.loading=!1,v.value=ve(Q.value),re.value=0===Q.value.length,0!==Q.value.length){e.next=9;break}return oe.value=!1,e.abrupt("return");case 9:if(!p.value.noRefresh){e.next=11;break}return e.abrupt("return");case 11:if(Q.value.forEach((function(e){ue.value[e.name]||(ue.value[e.name]=!1)})),a=p.value.currentCompose.name,(o=Q.value.find((function(e){return e.name===a})))||!a){e.next=18;break}return e.next=17,ae();case 17:Oe();case 18:"force"===n?Ve(Q.value[0]):p.value.currentCompose=o||Q.value[0],oe.value=!1;case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})}catch(o){p.value.loading=!1,oe.value=!1}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return b((function(){Oe()})),function(e,t){var n=de,r=F,a=H,o=U,u=X,c=A,i=B,l=C("focus"),s=C("bt-loading");return j(),L("div",{class:"left-list",style:q({height:"".concat(D(f)-103,"px")})},[S("div",ge,[E(n,{options:ee}),E(r,{onClick:qe},{default:P((function(){return t[8]||(t[8]=[I("编排模板")])})),_:1}),S("div",ye,[E(a,{modelValue:D(d),"onUpdate:modelValue":t[0]||(t[0]=function(e){return R(d)?d.value=e:null}),placeholder:"请输入关键字",clear:""},{prefix:P((function(){return t[9]||(t[9]=[S("i",{class:"svgtofont-el-search"},null,-1)])})),_:1},8,["modelValue"])])]),V((j(),L("div",{class:"table-con",style:q({height:"".concat(D(f)-270,"px")})},[(j(!0),L(O,null,N(D(se),(function(e){return j(),L("div",{key:e.name,class:M(["list-item h-[5.4rem]",{active:e.name===D(p).currentCompose.name}]),onClick:function(t){return Ve(e)}},[E(o,{modelValue:D(v)[e.name],"onUpdate:modelValue":function(t){return D(v)[e.name]=t},onChange:function(t){return function(e){var t=K.value.indexOf(e.name);-1===t?(K.value.push(e.name),$.checked=K.value.length===Q.value.length):(K.value.splice(t,1),$.checked=!1)}(e)},onClick:t[1]||(t[1]=z((function(){}),["stop"]))},null,8,["modelValue","onUpdate:modelValue","onChange"]),V(S("div",we,null,512),[[T,!D(Z)]]),E(u,{type:fe(e).type,class:"ml-[1rem] w-[5rem] status-tag text-center !h-[1.9rem] !leading-[1.9rem] !px-[.4rem]"},{default:P((function(){return[I(W(fe(e).text),1)]})),_:2},1032,["type"]),S("div",ke,[S("span",_e,W(e.name),1),D(ue)[e.name]?Y("",!0):(j(),L("span",{key:0,class:M(["remark-text",e.remark?"":"empty-remark"]),onClick:z((function(t){return function(e){le.value=e.remark,ue.value[e.name]=!0}(e)}),["stop"])},W(e.remark||"点击编辑备注"),11,be)),D(ue)[e.name]?V((j(),L("input",{key:1,type:"text",class:"remark-input",title:"点击编辑备注，回车或失焦保存",value:D(le),placeholder:"点击编辑备注",onClick:t[2]||(t[2]=z((function(){}),["stop"])),onFocus:t[3]||(t[3]=function(e){return D(p).isEdit=!0}),onKeyup:J(De,["enter"]),onMousedown:t[4]||(t[4]=z((function(){}),["stop"])),onMouseup:t[5]||(t[5]=z((function(){}),["stop"])),onBlur:function(t){return Re(t,e)}},null,40,Ce)),[[l]]):Y("",!0)])],10,xe)})),128)),V(E(c,{description:"当前列表为空"},null,512),[[T,0===D(se).length]])],4)),[[s,D(oe)],[s,"正在获取列表","title"]]),S("div",je,[E(i,{modelValue:D($).showCheckPopover,"onUpdate:modelValue":t[7]||(t[7]=function(e){return D($).showCheckPopover=e}),trigger:"manual","popper-class":"popper-danger",placement:"top-start",content:D($).popoverContent},{reference:P((function(){return[E(o,{modelValue:D($).checked,"onUpdate:modelValue":t[6]||(t[6]=function(e){return D($).checked=e}),indeterminate:D(me),onChange:Ee},null,8,["modelValue","indeterminate"])]})),_:1},8,["modelValue","content"]),S("div",{class:"relative flex items-center",onClick:Se},[S("div",{class:M(["absolute w-full h-full z-999 cursor-not-allowed",D(pe)?"":"hidden"])},null,2),S("div",Le,[E(r,{type:"primary",disabled:D(pe),onClick:Pe},{default:P((function(){return t[10]||(t[10]=[I(" 批量删除 ")])})),_:1},8,["disabled"])])])])],4)}}}),Ee=f(Se,[["__scopeId","data-v-5d7b7697"]]),Pe={class:"menu-col h-full"},Ie={class:"p-[1.6rem] !pt-0 overflow-y-auto",style:{height:"calc(100% - 50px)"}},De={class:"flex flex-col w-full"},Re={class:"flex items-center w-full"},Ve=["title"],qe={class:"inline-block truncate leading-normal",style:{"max-width":"calc(100% - 60px)"}},Oe={class:"flex items-center ml-[2rem]"},Ne=["title"],Te={class:"flex flex-wrap content-center gap-[1rem]",style:{"grid-template-columns":"repeat(2, auto)"}},Me={class:"mt-[1.6rem] bg-white rounded-[.4rem]"},Ge=g({__name:"orchestration-menu",setup:function(e){var f=l(),m=a().mainHeight,d=ce().refs.orchestrationData,v=x("socketInstance"),h=x("delCompose",(function(){})),g=x("restartCompose"),T=k((function(){return d.value.currentCompose})),G=x("commandEvent"),H=y(""),U=y([]),B=w({con:!1,log:!1}),z=y("容器日志"),J=y(!1),te=y("暂无日志信息"),ne=function(e){var t=[{text:"重启",command:"restart"},{text:"停止",command:"stop"},{text:"强制停止",command:"kill"}],n=[{text:"启动",command:"start"}],r=[{text:"重启",command:"restart"},{text:"强制停止",command:"kill"}];switch(e){case"running":return t;case"exited":return n;default:return r}},re=function(e){switch(e){case"running":return{text:"运行中",type:"success"};case"exited":return{text:"已停止",type:"danger"};default:return{text:"异常",type:"warning"}}};_((function(){return T.value.path}),(function(){ie(),pe()})),_((function(){return d.value.refreshItem}),(function(e){ie(),pe()})),_((function(){return g.value}),(function(e){e&&(g.value=!1,ae("start",!1))}));var ae=function(){var e=r(t().mark((function e(r){var a,u,l,s=arguments;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=!(s.length>1&&void 0!==s[1])||s[1],e.prev=1,u="",e.t0=r,e.next="stop"===e.t0?6:"start"===e.t0?7:"restart"===e.t0?8:"update"===e.t0?9:"rebuild"===e.t0?10:"down"===e.t0?11:"delete"===e.t0?19:21;break;case 6:"stop"===r&&(u="停止");case 7:"start"===r&&(u="启动");case 8:"restart"===r&&(u="重启");case 9:"update"===r&&(u="更新");case 10:"rebuild"===r&&(u="重建");case 11:if("down"===r&&(u="停止并删除所有容器"),e.t1=a,!e.t1){e.next=16;break}return e.next=16,o({icon:"warning-filled",title:"【".concat(T.value.name,"】").concat(u),width:"35rem",content:"容器编排即将".concat(u,",是否继续？")});case 16:return l={mod_name:"docker",sub_mod_name:"com",def_name:r,path:T.value.path,project_name:T.value.name,ws_callback:r},c({isAsync:!0,title:"编排【".concat(T.value.name,"】日志"),area:60,component:function(){return i((function(){return n.import("./orchestration-terminal-legacy.js?v=1734676359")}),void 0,n.meta.url)},compData:{init:function(e){v.value.socketRequest({params:l,onMessage:function(t){-1===t.data&&f.request(t),e(t.msg)}})}}}),e.abrupt("break",21);case 19:return h(T.value),e.abrupt("break",21);case 21:e.next=26;break;case 23:e.prev=23,e.t2=e.catch(1);case 26:case"end":return e.stop()}}),e,null,[[1,23]])})));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=r(t().mark((function e(n){var r;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,le({container_id:n.ID});case 3:(r=e.sent).status?(z.value="容器【".concat(n.Name,"】日志"),te.value=r.msg,J.value=!0):f.error(r.msg),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),ue=function(){var e=r(t().mark((function e(n,r){var a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={id:r.ID,status:n},s({request:se({data:JSON.stringify(a)}),loading:"正在设置容器状态，请稍后...",message:!0});case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ie=function(){var e=r(t().mark((function e(){var n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,T.value.path){e.next=4;break}return B.con=!1,e.abrupt("return");case 4:n={mod_name:"docker",sub_mod_name:"com",def_name:"get_project_ps",path:T.value.path,ws_callback:"get_project_ps"},B.con=!0,v.value.socketRequest({params:n,onMessage:function(e){U.value=u(e.data,"array",[]),B.con=!1,U.value.map((function(e){e.port=e.Ports.split(",").filter((function(e){return""!==e}))}))}}),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),pe=function(){var e=r(t().mark((function e(){var n,r,a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,T.value.path){e.next=4;break}return B.log=!1,e.abrupt("return");case 4:n={mod_name:"docker",sub_mod_name:"com",def_name:"get_logs",path:T.value.path,ws_callback:"get_logs"},B.log=!0,r=0,a=[],v.value.socketRequest({params:n,onMessage:function(e){B.log=!1;var t=u(e.msg,"string","",null,!0);if("暂无日志信息"===t)return H.value=t,void(r=0);r>=200&&a.shift(),a.push(t),r++,H.value=a.join("\n")}}),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(0);case 13:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();return b((function(){G.value=ae})),function(e,t){var n=X,r=Q,a=$,o=Z,u=F,c=ee,i=A,l=ve,s=p,f=C("bt-loading");return j(),L("div",Pe,[S("div",{class:"mt-[1.6rem] bg-white rounded-[.4rem]",style:q("height: calc(100% - ".concat(D(m)>800?410:255,"px)"))},[t[3]||(t[3]=S("div",{class:"card-title"},"容器列表",-1)),V((j(),L("div",Ie,[(j(!0),L(O,null,N(D(U),(function(e){return j(),L("div",{class:"card-item con-item w-full",key:e.ID},[S("div",De,[S("div",Re,[S("div",{class:"flex items-center",style:{width:"calc(100% - 160px)"},title:e.Name},[S("span",qe,W(e.Name),1),E(o,{placement:"bottom",onCommand:function(t){return ue(t,e)}},{dropdown:P((function(){return[E(a,null,{default:P((function(){return[(j(!0),L(O,null,N(ne(e.State),(function(e){return j(),K(r,{key:e.command,command:e.command},{default:P((function(){return[I(W(e.text),1)]})),_:2},1032,["command"])})),128))]})),_:2},1024)]})),default:P((function(){return[E(n,{type:re(e.State).type,class:"status-tag w-[5rem] text-center ml-[.5rem]",title:""},{default:P((function(){return[I(W(re(e.State).text),1)]})),_:2},1032,["type"])]})),_:2},1032,["onCommand"])],8,Ve),S("div",Oe,[E(c,{effect:"dark",content:"容器终端",placement:"top","open-delay":500},{default:P((function(){return[E(u,{onClick:function(t){return D(fe)({id:e.ID,status:e.State})}},{default:P((function(){return t[1]||(t[1]=[S("div",{class:"flex items-center"},[S("span",{class:"fileTerminal-icon"}),I("终端")],-1)])})),_:2},1032,["onClick"])]})),_:2},1024),E(c,{effect:"dark",content:"容器日志",placement:"top","open-delay":500},{default:P((function(){return[E(u,{type:"default",onClick:function(t){return oe(e)},class:"ml-[1rem]"},{default:P((function(){return t[2]||(t[2]=[S("div",{class:"flex items-center"},[S("span",{class:"record-icon"}),I("日志")],-1)])})),_:2},1032,["onClick"])]})),_:2},1024)])]),S("div",{class:"text-[#ccc] w-[40%] truncate mt-[-.4rem]",title:e.ID},W(e.ID),9,Ne)]),S("div",{class:M(["flex items-center justify-between mt-[1.2rem]",e.port.length>0?"mt-[1.6rem]":""])},[S("div",Te,[(j(!0),L(O,null,N(e.port,(function(e){return j(),K(n,{key:e,type:"info"},{default:P((function(){return[I(W(e),1)]})),_:2},1024)})),128))])],2)])})),128)),0!==D(U).length||D(B).con?Y("",!0):(j(),K(i,{key:0,style:{height:"calc(100% - 50px)"},description:"暂无容器"}))])),[[f,D(B).con],[f,"正在获取容器列表","title"]])],4),S("div",Me,[t[4]||(t[4]=S("div",{class:"card-title"},"编排日志",-1)),V((j(),L("div",{class:"card-item p-[1.6rem] h-full",style:q({height:D(m)>800?"33rem":"18rem"})},[E(l,{title:"全屏查看-编排日志",content:D(H),isHtml:!0,fullScreen:{title:"全屏查看-编排日志",onRefresh:pe},class:"h-full font-[PingFang SC]"},null,8,["content","fullScreen"])],4)),[[f,D(B).log],[f,"正在获取编排日志","title"]])]),E(s,{title:D(z),area:[60,40],modelValue:D(J),"onUpdate:modelValue":t[0]||(t[0]=function(e){return R(J)?J.value=e:null})},{default:P((function(){return[E(l,{title:"全屏查看-日志",content:D(te),isHtml:!0,isRefreshBtn:!1,class:"h-[40rem] font-[PingFang SC]"},null,8,["content"])]})),_:1},8,["title","modelValue"])])}}}),Fe=f(Ge,[["__scopeId","data-v-601e3f7d"]]),He={class:"h-full"},Ue={class:"px-[1.6rem] pb-[1.6rem] h-full"},Ae={class:"text-[1.4rem] mt-[.8rem] mb-[1.2rem] !pt-0 flex items-center truncate"},Be=["title"],ze={style:{height:"calc(100% - 75px)"}},We={class:"flex items-center justify-end mt-[1.6rem]"},Ye=g({__name:"orchestration-editor",setup:function(e){var n=l(),c=a().mainHeight,i=ce().refs.orchestrationData,s=x("socketInstance"),f=x("restartCompose"),p=y(null),d=y(null),v=y(""),h=y(""),g={config:"",env:""},w=y(null),C=y(0),V={mode:"ace/mode/yaml",theme:"ace/theme/chrome"},O=k((function(){return i.value.currentCompose}));_((function(){return O.value.path}),(function(){N()})),_((function(){return i.value.refreshItem}),(function(e){N()}));var N=function(){var e=r(t().mark((function e(){var r,a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={mod_name:"docker",sub_mod_name:"com",def_name:"get_config",path:O.value.path,ws_callback:"get_config"},e.next=4,s.value.socketRequest({params:r});case 4:(a=e.sent).status?(g.config=u(a.data.config,"string",""),g.env=u(a.data.env,"string",""),v.value=g.config,h.value=g.env,te((function(){0}))):n.error(a.msg),setTimeout((function(){C.value=w.value.offsetWidth-20}),100),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),T=function(){var e=r(t().mark((function e(){var r,a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o({title:"保存文件",width:"35rem",icon:"warning-filled",content:"即将保存文件，保存后将重启容器编排，是否继续？"});case 3:return r={mod_name:"docker",sub_mod_name:"com",def_name:"save_config",config:v.value,env:h.value,path:O.value.path,ws_callback:"save_config"},e.next=6,s.value.socketRequest({params:r});case 6:(a=e.sent).status?(f.value=!0,g.config=v.value,g.env=h.value):n.request(a),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),M();case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),M=function(){v.value=g.config,h.value=g.env,te((function(){0}))};return b((function(){})),function(e,t){var n=he,r=F;return j(),L("div",He,[S("div",{ref_key:"editorRef",ref:w,class:"bg-white rounded-[.4rem] mt-[1.6rem] h-full"},[t[6]||(t[6]=S("div",{class:"card-title"},"配置文件",-1)),S("div",Ue,[S("div",Ae,[t[3]||(t[3]=I(" docker-compose文件内容 ")),S("span",{class:"ml-[1rem] path",title:D(O).path,onClick:t[0]||(t[0]=function(e){return t={path:D(O).path},m("Path",t.path),void(window.location.href=window.location.origin+"/files");var t})},"跳转目录",8,Be)]),S("div",ze,[E(n,{ref_key:"yamlRef",ref:p,style:q(" height: calc(100% - ".concat(D(c)>800?316:224,"px)")),class:"compose-editor",modelValue:D(v),"onUpdate:modelValue":t[1]||(t[1]=function(e){return R(v)?v.value=e:null}),autoSave:!1,request:{},editorOption:V,onSave:T},null,8,["style","modelValue"]),t[5]||(t[5]=S("div",{class:"my-[1rem] text-[1.4rem]"},".env",-1)),E(n,{ref_key:"envRef",ref:d,style:q({height:D(c)>800?"200px":"100px"}),modelValue:D(h),"onUpdate:modelValue":t[2]||(t[2]=function(e){return R(h)?h.value=e:null}),autoSave:!1,request:{},editorOption:V,onSave:T},null,8,["style","modelValue"]),S("div",We,[E(r,{type:"primary",onClick:T},{default:P((function(){return t[4]||(t[4]=[I("保存")])})),_:1})])])])],512)])}}}),Je=f(Ye,[["__scopeId","data-v-b1194c9c"]]),Xe={class:"relative h-full"},Ke={class:"p-[1.6rem] compose-menu !mt-[0rem] rounded-[.4rem] bg-white"},Qe={class:"flex items-center justify-between"},$e={class:"flex items-center"},Ze={class:"text-[1.8rem] whitespace-nowrap"},et={class:"flex justify-center mt-[1.6rem] gap-[1rem] items-center text-[1.2rem] text-[#909399]"},tt={class:"whitespace-nowrap"},nt={class:"whitespace-nowrap"},rt={class:"flex items-center ml-[5rem]"},at=g({__name:"index",setup:function(e){var u=a(),l=u.mainHeight,s=u.mainWidth,f=ce().refs.orchestrationData,p=y(null),m=y(!1),g=y(null),x=y(),w=function(e){switch(e){case"running":return{text:"运行中",type:"success"};case"exited":return{text:"已停止",type:"danger"};default:return{text:"异常",type:"warning"}}},_=y(!0),R=k((function(){return f.value.currentCompose})),O=function(){var e=r(t().mark((function e(r){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c({isAsync:!0,component:function(){return i((function(){return n.import("./index-legacy184.js?v=1734676359")}),void 0,n.meta.url)},compData:{wsConfirm:r},title:"添加容器编排",area:60,btn:"确定"});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=r(t().mark((function e(a){var o,u;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.params,u=a.close,e.prev=1,e.abrupt("return",new Promise(function(){var e=r(t().mark((function e(r,a){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c({isAsync:!0,title:"添加日志 - 请耐心等待不要关闭此窗口",area:60,component:function(){return i((function(){return n.import("./orchestration-terminal-legacy.js?v=1734676359")}),void 0,n.meta.url)},compData:{init:function(e){p.value.socketRequest({params:o,onMessage:function(t){u(),e(t.msg),-1===(null==t?void 0:t.data)&&(h.request(t),f.value.refreshList="force",r(t))}})}}});case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 5:e.prev=5,e.t0=e.catch(1);case 7:case"end":return e.stop()}}),e,null,[[1,5]])})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=r(t().mark((function e(n){var r;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o({icon:"warning-filled",title:"删除容器编排【".concat(n.name,"】"),width:"35rem",content:"将删除指定容器编排【".concat(n.name,"】,是否继续？")});case 3:return r={mod_name:"docker",sub_mod_name:"com",def_name:"delete",project_name:n.name,path:n.path,ws_callback:"delete"},f.value.noRefresh=!0,e.abrupt("return",new Promise((function(e,t){var n=h.load("正在删除中");p.value.socketRequest({params:r,onMessage:function(t){-1===(null==t?void 0:t.data)&&(n.close(),h.request(t),f.value.noRefresh=!1,f.value.refreshList=!0,e(t))}})})));case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=r(t().mark((function e(){var n,r,a,o;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(n=p.value)||void 0===n||n.socketDestroy(),r=me("/ws_modsoc",!1),a=r.socketRequest,o=r.socketDestroy,p.value={socketRequest:a,socketDestroy:o},e.abrupt("return",new Promise((function(e,t){e(p.value)})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();G(),ne("isEmpty",_),ne("socketInstance",p),ne("delCompose",M),ne("createNewSocket",G),ne("addCompose",N),ne("restartCompose",m),ne("actionTerminal",g),ne("commandEvent",x),ne("createComposeDialog",O);return f.value.currentCompose.path="",f.value.currentCompose.name="",f.value.loading=!0,b(r(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))),re((function(){var e;f.value.currentCompose.path="",null===(e=p.value)||void 0===e||e.socketDestroy()})),function(e,t){var n=ae,r=F,a=oe,o=v,u=ue,c=A,i=C("bt-loading");return j(),L("div",{class:"relative container-table-tab bg-[#f3f3f3]",style:q({height:"".concat(D(l)-130,"px")})},[S("div",Xe,[E(u,{gutter:20,class:"!mx-0"},{default:P((function(){return[E(n,{xs:24,sm:8,md:8,lg:5,xl:4,class:"!pl-0"},{default:P((function(){return[E(Ee)]})),_:1}),V((j(),K(n,{xs:24,sm:16,md:16,lg:19,xl:20,class:"!pl-[.8rem] !pr-0",style:q({height:"".concat(D(l)-100,"px"),overflowY:D(s)<984?"auto":"hidden",overflowX:"hidden"})},{default:P((function(){var e,c,i,s;return[S("div",Ke,[S("div",Qe,[S("div",$e,[S("span",Ze,[S("span",null,W(null===(e=D(R))||void 0===e?void 0:e.name),1),S("span",et,[S("span",tt,"创建时间："+W(null!==(c=D(R))&&void 0!==c&&c.time?D(d)(null===(i=D(R))||void 0===i?void 0:i.time):"--"),1),S("span",nt,"容量数量："+W(null===(s=D(R))||void 0===s?void 0:s.container_count),1)])]),S("div",rt,[E(a,null,{default:P((function(){return["danger"===w(D(R).run_status).type?(j(),K(r,{key:0,type:"default",onClick:t[0]||(t[0]=function(e){return D(x)("start")})},{default:P((function(){return t[6]||(t[6]=[I("启动")])})),_:1})):Y("",!0),"danger"!==w(D(R).run_status).type?(j(),K(r,{key:1,type:"default",onClick:t[1]||(t[1]=function(e){return D(x)("stop")})},{default:P((function(){return t[7]||(t[7]=[I("停止")])})),_:1})):Y("",!0),"danger"!==w(D(R).run_status).type?(j(),K(r,{key:2,type:"default",onClick:t[2]||(t[2]=function(e){return D(x)("restart")})},{default:P((function(){return t[8]||(t[8]=[I("重启")])})),_:1})):Y("",!0),E(r,{type:"default",onClick:t[3]||(t[3]=function(e){return D(x)("update")})},{default:P((function(){return t[9]||(t[9]=[I("更新镜像")])})),_:1}),E(r,{class:"!hover:bg-danger !hover:text-white !hover:border-danger",type:"default",onClick:t[4]||(t[4]=function(e){return D(x)("delete")})},{default:P((function(){return t[10]||(t[10]=[I("删除")])})),_:1})]})),_:1}),E(o,{class:"ml-[1.6rem]",onClick:D(pe)},{default:P((function(){return t[11]||(t[11]=[I("需求反馈")])})),_:1},8,["onClick"])])])])]),E(u,{gutter:20,style:q({height:"".concat(D(l)-178,"px")})},{default:P((function(){return[E(n,{xs:24,sm:24,md:24,lg:14,xl:16,style:{height:"100%"}},{default:P((function(){return[E(Fe)]})),_:1}),E(n,{xs:24,sm:24,md:24,lg:10,xl:8,style:{height:"100%"},class:"lt-xl:pt-[1.6rem]"},{default:P((function(){return[E(Je)]})),_:1})]})),_:1},8,["style"])]})),_:1},8,["style"])),[[T,!D(_)||D(f).loading],[i,D(f).loading],[i,"正在获取数据","title"]]),V(E(n,{class:"bg-white overflow-hidden rounded-[.4rem]",xs:24,sm:16,md:16,lg:19,xl:18},{default:P((function(){return[E(c,{style:q({height:"".concat(D(l)-100,"px")}),description:"当前暂无容器编排"},{default:P((function(){return[S("span",{class:"cursor-pointer text-primary hover:text-[#1d9534]",onClick:t[5]||(t[5]=function(e){return O(N)})},"点击添加容器编排")]})),_:1},8,["style"])]})),_:1},512),[[T,D(_)&&!D(f).loading]])]})),_:1})])],4)}}});e("default",f(at,[["__scopeId","data-v-d6f25cd0"]]))}}}))}();
