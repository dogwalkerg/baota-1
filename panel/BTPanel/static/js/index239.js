import{_ as a}from"./index90.js?v=1734676359";import{_ as t}from"./index97.js?v=1734676359";import{u as s,cz as e,aj as n,R as i,G as o,S as r,k as l}from"./utils-lib.js?v=1734676359";import{a7 as p,a8 as m}from"./firewall.js?v=1734676359";import{o as d}from"./useMethod4.js?v=1734676359";import{c,R as u,r as _,a_ as b,o as g,B as j,k as f,J as h,x as w,C as x,p as k,e as C,F as D,y as v}from"./base-lib.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./column.js?v=1734676359";import"./index91.js?v=1734676359";import"./useStore4.js?v=1734676359";import"./validator.js?v=1734676359";const y=c({__name:"index",props:{compData:{default:()=>({isPopup:!1,name:""})}},setup(c){const y=c,{mainHeight:R}=s(),U=u(!1),H=_([]),P=_(0),S=_(y.compData.isPopup);y.compData;const q=b({p:1,limit:20}),z=[{label:"网站列表",prop:"site_name",showOverflowTooltip:!0},{label:"扫描URL总数",prop:"scans",width:100},{label:"扫描耗时",prop:"time",render:a=>[a.end_time<=1||a.end_time-a.start_time<=0?C("span",null,[v("0秒")]):C("span",null,[e(a.end_time-a.start_time)])]},{label:"风险次数",render:a=>[0==a.risks?C("span",null,[v("无风险")]):C("span",{class:"bt-link !text-danger",onClick:()=>d(a)},[a.risks])]},{label:"状态",render:a=>[0===a.is_status&&0===a.end_time||1===a.end_time?C("span",{class:"text-red"},[v("扫描未完成")]):1===a.is_status&&0===a.end_time?C("span",{class:"text-[#fc6d26]"},[v("扫描中")]):C("span",null,[v("扫描完成")])]},{label:"扫描时间",width:150,render:a=>{const t=n(a.start_time,"number",0);return C("span",null,[i(t)])}},{label:"操作",align:"right",render:a=>[0===a.is_status&&0===a.end_time||1===a.end_time||1===a.is_status&&0===a.end_time?C("span",{class:"text-[#c8c9cc] cursor-not-allowed"},[v("扫描未完成")]):C("span",{class:"bt-link",onClick:()=>(a=>{window.open("/project/content/report/html?id="+a.testing_id)})(a)},[v("查看报告")])]}],A=async(a=1)=>{await o({loading:U,request:S.value?p({site_name:y.compData.name,...q}):m({...q}),data:{data:[Array,H],page:r(P)}})};return g((()=>{A()})),(s,e)=>{const n=l,i=t,o=a,r=j("bt-loading");return f(),h(o,{class:D({"p-[2rem]":k(S)})},{content:w((()=>[x(C(n,{ref:"table",column:z,data:k(H),"max-height":k(S)?500:k(R)-240,description:"检测历史列表为空"},null,8,["data","max-height"]),[[r,k(U)],[r,"正在加载检测历史列表，请稍后...","title"]])])),"footer-right":w((()=>[C(i,{total:k(P),page:k(q).p,"onUpdate:page":e[0]||(e[0]=a=>k(q).p=a),row:k(q).limit,"onUpdate:row":e[1]||(e[1]=a=>k(q).limit=a),onChange:A},null,8,["total","page","row"])])),popup:w((()=>e[2]||(e[2]=[]))),_:1},8,["class"])}}});export{y as default};
