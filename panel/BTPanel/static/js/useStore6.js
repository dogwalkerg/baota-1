import{g as t,s as a,r as e,R as s,h as o,b as c}from"./base-lib.js?v=1734676359";import{n as l,G as r,a7 as g,M as d,I as n}from"./utils-lib.js?v=1734676359";const u=t=>l.post("safe/syslog/get_ssh_list",{data:t,customType:"model",check:"array"}),p=()=>l.post("safe/syslog/get_sys_logfiles",{customType:"model",check:"array"}),m=t=>l.post("safe/syslog/get_sys_log",{data:t,customType:"model",check:"array"}),i=()=>l.post("monitor/soft/soft_log_list",{customType:"model",check:"array"}),y=t=>l.post("monitor/soft/get_log",{data:t,customType:"model",check:"object"}),_=t=>l.post("logs/panel/get_slow_logs",{data:t,customType:"model",check:"object"}),h=t=>l.post("database/GetErrorLog",{check:"string",data:t}),k=t=>l.post("data/getData",{data:t,check:"object"}),b=t=>l.post("logs/ftp/set_ftp_log",{check:"msg",customType:"model",data:t}),T=t=>l.post("ftp/get_login_logs",{data:t,check:"object"}),v=t=>l.post("ftp/get_action_logs",{check:"object",data:t}),j=t=>l.post("monitor/soft/get_docker_log?name=Docker",{data:t,customType:"model",check:"object"}),f=t=>l.post("monitor/soft/get_log",{data:t,customType:"model",check:"array"}),w=t=>l.post("monitor/soft/get_bt_security_log?name=bt_security",{data:t,customType:"model",check:"object"}),L=t=>l.post("monitor/soft/get_syssafe_log?name=syssafe",{data:t,customType:"model",check:"object"}),E=(t,a)=>{const e={};return e.limit=t,a&&(e.search=a),l.post("logs/panel/get_panel_error_logs",{data:e,check:"object",customType:"model"})},q=()=>l.post("/logs/site/get_site_list",{check:"object",customType:"model"}),x=t=>l.post("logs/site/get_site_access_logs",{data:t,customType:"model",check:"msg"}),S=t=>l.post("logs/site/get_site_error_logs",{data:t,customType:"model",check:"msg"}),A=t=>l.post("logs/panel/get_logs_bytype",{data:t,customType:"model",check:"object"}),D=t=>l.post("logs/site/get_site_log_file",{data:t,customType:"model",check:"object"}),O=t=>l.post("ajax/get_cron_task",{check:"object",data:t}),F=t=>l.post("ajax/set_cron_task",{check:"msg",data:t}),I=t=>l.post("ajax/get_result",{data:t,check:"object"}),R=t=>l.post("ajax/log_analysis",{data:t,check:"msg"}),z=t=>l.post("ajax/speed_log",{data:t,check:"object"}),G=t=>l.post("ajax/get_detailed",{data:t,check:"object"}),M=t=>l.post("logs/site/download_logs",{data:t,customType:"model",check:"msg"}),N=t=>l.post("logs/site/clear_logs",{data:t,check:"object",customType:"model"}),P=t=>l.post("safe/syslog/export_ssh_log",{data:t,customType:"model",check:"object"}),W=()=>l.post("logs/logserver/collect_list",{customType:"model",check:"array"}),B=t=>l.post("logs/logserver/add_source",{data:t,customType:"model",check:"array"}),C=t=>l.post("logs/logserver/remove_source",{data:t,customType:"model",check:"msg"}),V=t=>l.post("logs/logserver/modify_logserver",{data:t,customType:"model",check:"msg"}),H=t=>l.post("logs/logserver/add_logserver",{data:t,customType:"model",check:"msg"}),J=()=>l.post("logs/logserver/server_list",{customType:"model",check:"array"}),K=t=>l.post("/monitor/sitelogpush/get_site_log_push_status",{data:t,check:"object",customType:"model"}),Q=t=>l.post("/monitor/sitelogpush/set_push_task",{data:t,check:"msg",customType:"model"}),$=t=>l.post("/logs/panel/export_domain_log",{data:t,check:"object",customType:"model"}),U=t=>l.post("/ajax?action=remove_analysis",{data:t,check:"object",customType:"model"}),X=t=>l.post("/monitor/soft/del_soft_log",{data:t,check:"msg",customType:"model"}),Y=t=>l.post("/logs/panel/export_penel_login_log",{data:t,check:"object",customType:"model"}),Z=t=>l.post("safe/syslog/create_ip_rules",{data:t,check:"array",customType:"model"}),tt=t=>l.post("safe/syslog/remove_ip_rules",{data:t,check:"array",customType:"model"}),at=t("LOG-PANEL-STORE",(()=>{const t=st(),{outDataForm:c,searchValue:n}=a(t),u=e(!1),p=e("全部"),m=e(""),i=e(0),y=e(""),_=async t=>{try{await r({loading:"正在获取日志数据，请稍后...",request:E(500,t),data:{data:[String,m],size:[Number,i]},success:t=>({data:t.data,size:t.size})})}catch(a){return{data:"暂无日志",size:0}}},h=e("暂无数据"),b=s({id:0,name:"",type:""}),T=o({time_search:[],type:""}),v=async t=>{try{return{data:(await r({request:(a=t,l.post("crontab/GetLogs",{data:a,check:"object"})),data:{msg:[String,h]}})).msg||"当前日志为空!",status:!0}}catch(e){return{msg:"当前日志为空!",status:!1}}var a};return{isRefreshList:u,logType:p,clearOpLogsEvent:async()=>{try{return await r({loading:"正在清空面板操作日志，请稍后...",request:l.post("ajax/delClose",{check:"msg"}),message:!0}),{msg:"清空日志成功",status:!0}}catch(t){return d.error("清空日志失败"),{data:{},status:!1,msg:"清空错误"}}},getLogsInfoEvent:async t=>{try{const a=await r({request:k(t),data:{data:Array,page:String}});return{data:a.data,total:g(a.page),other:{}}}catch(a){return{data:[],total:0,other:{}}}},getLoginLogsEvent:async t=>{try{const e=await r({request:(a=t,l.post("/logs/panel/get_panel_login_log",{check:"object",customType:"model",data:a})),data:{data:Array,total:Number}});return{data:e.data,total:e.total,other:{}}}catch(e){return{data:[],total:0,other:{}}}var a},search:y,logMsg:m,size:i,getRunDataEvent:_,clearRunLogsEvent:async()=>{try{return await r({loading:"正在清空日志，请稍后...",request:l.post("config/clean_panel_error_logs",{check:"msg"}),message:!0,success:_}),{msg:"清空日志成功",status:!0}}catch(t){return{status:!1,msg:"清空日志失败"}}},logsMsg:h,currentItem:b,crontabForm:T,getLogsMenu:async t=>{try{return{data:(await r({request:k({search:n.value,limit:9999,table:"crontab",p:1}),data:{data:Array}})).data,status:!0}}catch(a){return{data:[],status:!1,msg:"获取日志菜单失败"}}},getLogsDataEvent:v,getIpDataEvent:async()=>{try{return{data:await r({loading:"正在获取ip数据，请稍后...",request:l.post("logs/panel/IP_geolocation",{customType:"model",check:"array"}),data:Array}),total:0,other:{}}}catch(t){return{data:[],total:0,other:{}}}},outWebSiteEvent:async(t="")=>{try{return{data:(await r({loading:"正在导出日志，请稍后...",request:(a={search:t},l.post("/logs/panel/export_panel_log",{data:a,check:"object",customType:"model"}))})).data,status:!0}}catch(e){return{data:{},status:!1,msg:"导出错误"}}var a},clearShellLogEvent:async({id:t,day:a})=>{try{const s=await r({loading:"正在清理日志，请稍后...",request:(e={id:t,day:a},l.post("crontab/clear_logs",{data:e,check:"msg"})),message:!0});return v(b.value),{msg:s.msg,status:s.status}}catch(s){return{status:!1,msg:"清理日志失败"}}var e},outShellLogEvent:async()=>{try{const{isOutError:a,day:e}=c.value,s=await r({loading:"正在导出日志，请稍后...",request:(t={type:a?"warring":"",day:"all"===e?"":e,id:b.value.id},l.post("crontab/download_logs",{data:t,check:"msg"})),data:{status:Boolean,msg:String}});return window.open("/download?filename="+s.msg),{data:s,status:s.status}}catch(a){return{status:!1,msg:"导出日志失败"}}var t},outLoginLogEvent:async t=>{const{count:a,type:e}=t;let s={limit:a,type:e};"all"===s.type&&delete s.type,"Accepted"!==s.type&&"Failed"!==s.type||(s.type={Accepted:"success",Failed:"failure"}[s.type]);try{return r({loading:"正在导出日志，请稍后...",request:Y(s),success:t=>{window.open("/download?filename="+t.data.output_file)}}),{status:!0,msg:"导出成功"}}catch(o){return{status:!1,msg:"导出失败"}}},clearLoginLogEvent:async()=>{try{return await r({loading:"正在清空日志，请稍后...",request:l.post("/logs/panel/clear_panel_login_log",{check:"object",customType:"model"}),message:!0}),{msg:"清空日志成功",status:!0}}catch(t){return{status:!1,msg:"清空日志失败"}}}}})),et=()=>{const t=at();return a(t)},st=t("LOG-STORE",(()=>{const t=e(""),a=e("panel"),l=e("operateLog"),r=e("WebLogs"),g=e(),d=s([{label:"所有日志",value:"all"},{label:"仅保留近7天日志",value:"7"},{label:"仅保留近30天日志",value:"30"},{label:"仅保留近180天日志",value:"180"}]),u=o({type:"access",day:"all"}),p=e(""),m=e(!1),i=e(""),y=e(["ssh","login"]),_=o({type:"all",day:"all",isOutError:"",count:100});return{selectedWebSite:t,tabActive:a,panelTabActive:l,webTabActive:r,cutTabs:t=>{a.value=t,n("/logs/"+t)},init:async()=>{const t=c();a.value=t.name||"panel-log"},clearOptions:d,clearDataForm:u,searchValue:p,logLoading:m,selectedItem:i,searchSubmit:()=>{at().searchMenuData(p.value)},countType:y,outDataForm:_,configData:g,getType:t=>y.value.includes(t)?"all":"access",$reset_out:()=>{_.type="all",_.day="all",_.isOutError="",_.count=100}}})),ot=()=>{const t=st();return a(t)};export{A,$ as B,C,V as D,H as E,B as F,W as G,J as H,et as I,D as J,I as K,st as L,R as M,z as N,O,U as P,G as Q,F as R,p as S,m as T,at as a,f as b,y as c,X as d,T as e,v as f,i as g,k as h,j as i,L as j,w as k,_ as l,h as m,u as n,Z as o,P as p,q,tt as r,b as s,N as t,ot as u,M as v,S as w,x,K as y,Q as z};
