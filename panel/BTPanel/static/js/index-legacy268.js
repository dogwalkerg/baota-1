!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,l=function(){};return{s:l,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function n(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||r(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){if(e){if("string"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function l(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */l=function(){return n};var t,n={},r=Object.prototype,a=r.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},i=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function f(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(t){f=function(e,t,n){return e[t]=n}}function m(e,t,n,r){var a=t&&t.prototype instanceof g?t:g,l=Object.create(a.prototype),s=new L(r||[]);return o(l,"_invoke",{value:j(e,n,s)}),l}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=m;var v="suspendedStart",d="suspendedYield",h="executing",y="completed",x={};function g(){}function b(){}function w(){}var k={};f(k,i,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(D([])));S&&S!==r&&a.call(S,i)&&(k=S);var C=w.prototype=g.prototype=Object.create(k);function E(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function I(t,n){function r(l,o,s,i){var c=p(t[l],t,o);if("throw"!==c.type){var u=c.arg,f=u.value;return f&&"object"==e(f)&&a.call(f,"__await")?n.resolve(f.__await).then((function(e){r("next",e,s,i)}),(function(e){r("throw",e,s,i)})):n.resolve(f).then((function(e){u.value=e,s(u)}),(function(e){return r("throw",e,s,i)}))}i(c.arg)}var l;o(this,"_invoke",{value:function(e,t){function a(){return new n((function(n,a){r(e,t,n,a)}))}return l=l?l.then(a,a):a()}})}function j(e,n,r){var a=v;return function(l,o){if(a===h)throw Error("Generator is already running");if(a===y){if("throw"===l)throw o;return{value:t,done:!0}}for(r.method=l,r.arg=o;;){var s=r.delegate;if(s){var i=T(s,r);if(i){if(i===x)continue;return i}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===v)throw a=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=h;var c=p(e,n,r);if("normal"===c.type){if(a=r.done?y:d,c.arg===x)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(a=y,r.method="throw",r.arg=c.arg)}}}function T(e,n){var r=n.method,a=e.iterator[r];if(a===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),x;var l=p(a,e.iterator,n.arg);if("throw"===l.type)return n.method="throw",n.arg=l.arg,n.delegate=null,x;var o=l.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,x):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,x)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function D(n){if(n||""===n){var r=n[i];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var l=-1,o=function e(){for(;++l<n.length;)if(a.call(n,l))return e.value=n[l],e.done=!1,e;return e.value=t,e.done=!0,e};return o.next=o}}throw new TypeError(e(n)+" is not iterable")}return b.prototype=w,o(C,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:b,configurable:!0}),b.displayName=f(w,u,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,f(e,u,"GeneratorFunction")),e.prototype=Object.create(C),e},n.awrap=function(e){return{__await:e}},E(I.prototype),f(I.prototype,c,(function(){return this})),n.AsyncIterator=I,n.async=function(e,t,r,a,l){void 0===l&&(l=Promise);var o=new I(m(e,t,r,a),l);return n.isGeneratorFunction(t)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},E(C),f(C,u,"Generator"),f(C,i,(function(){return this})),f(C,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=D,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,a){return s.type="throw",s.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var l=this.tryEntries.length-1;l>=0;--l){var o=this.tryEntries[l],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var i=a.call(o,"catchLoc"),c=a.call(o,"finallyLoc");if(i&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var l=r;break}}l&&("break"===e||"continue"===e)&&l.tryLoc<=t&&t<=l.finallyLoc&&(l=null);var o=l?l.completion:{};return o.type=e,o.arg=t,l?(this.method="next",this.next=l.finallyLoc,x):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),x},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),x}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;A(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:D(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),x}},n}function o(e,t,n,r,a,l,o){try{var s=e[l](o),i=s.value}catch(e){return void n(e)}s.done?t(i):Promise.resolve(i).then(r,a)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var l=e.apply(t,n);function s(e){o(l,r,a,s,i,"next",e)}function i(e){o(l,r,a,s,i,"throw",e)}s(void 0)}))}}System.register(["./utils-lib-legacy.js?v=1734676359","./base-lib-legacy.js?v=1734676359","./index-legacy277.js?v=1734676359","./validator-legacy.js?v=1734676359","./index-legacy45.js?v=1734676359","./__commonjsHelpers__-legacy.js?v=1734676359","./index-legacy91.js?v=1734676359","./column-legacy.js?v=1734676359","./index-legacy95.js?v=1734676359","./store-legacy3.js?v=1734676359","./store-legacy4.js?v=1734676359","./hooks-legacy.js?v=1734676359"],(function(e,r){"use strict";var a,o,i,c,u,f,m,p,v,d,h,y,x,g,b,w,k,_,S,C,E,I,j,T,O,A,L,D,F,V,P,N,R,J,M,U,B,G,H,$,Y,q,z,K,Q,X,W,Z,ee,te,ne,re,ae,le,oe,se,ie,ce;return{setters:[function(e){a=e.u,o=e.M,i=e.du,c=e.ah,u=e.ai,f=e.dv,m=e.b5,p=e.H,v=e.r,d=e.c,h=e.k,y=e.O,x=e.h,g=e.e},function(e){b=e.g,w=e.b4,k=e.t,_=e.r,S=e.h,C=e.e,E=e.y,I=e.c,j=e.s,T=e.i,O=e.ax,A=e.a1,L=e.B,D=e.k,F=e.l,V=e.q,P=e.p,N=e.z,R=e.F,J=e.v,M=e.J,U=e.x,B=e.M,G=e.C,H=e.D,$=e.I,Y=e.aX,q=e.G,z=e.A,K=e.Q,Q=e.b$,X=e.bu,W=e.aN,Z=e.b7,ee=e.au},function(e){te=e._},function(e){ne=e.o,re=e.p},function(e){ae=e.k,le=e.g,oe=e.a,se=e.b,ie=e.c,ce=e.d},null,null,null,null,null,null,null],execute:function(){var ue=b("HOME-SECURITY-RISKS-STORE",(function(){w();var e=a().payment,r=k(e.value).authType,p=_(""),v=_(""),d=_("正在扫描中，请耐心等待..."),h=_(!1),y=_(!1),x=_(""),g=_(!1),b=_(!1),I=_(!1),j=_(!1),T=_(),O=_(!0),A=_(!1),L=_("primary"),D=_(100),F=_("!text-[#20a53A]"),V=_("safe"),P=_(),N=_("当前服务器未进行安全扫描，可能存在风险"),R=_(""),J=_(),M=_([]),U=_([]),B=_([]),G=_(!0),H=_([]),$=_([]),Y=_(!0),q=_(!1),z=_(!0),K=S({progress:1,repairProgress:!1,repairText:"修复中.."}),Q=S({processPercentage:0,processColor:"#20a53a"}),X={risk:{type:"danger",label:"风险项",list:[]},security:{type:"primary",label:"无风险项",list:[]},ignore:{type:"warning",label:"已忽略项",list:[]}},W=S({cannot_automatically:0,failed:0,success:0}),Z=_(0),ee=_([{label:"风险项",prop:"m_name",width:150,render:function(e){return C("span",null,[e.m_name])}},{label:"修复内容",prop:"msg",width:150},{label:"相关信息",prop:"type",align:"center",render:function(e){return Array.isArray(e.type)&&e.type.length>0?C("span",{class:"h-[3.2rem] inline-block whitespace-pre-wrap"},[e.type.join("，")]):"无"}},{label:"操作结果",align:"right",render:function(e){return e.status?C("span",{class:"text-[#20a53a]"},[E("修复成功")]):C("span",{class:"text-[red]"},[E("修复失败")])}}]),te=S({1:{text:"低危",bg:"rgba(232, 213, 68, 0.1)",color:"#D4BB00"},2:{text:"中危",bg:"rgba(240, 173, 78, 0.14)",color:"#f0ad4e"},3:{text:"高危",bg:"rgba(239, 8, 8, 0.1)",color:"#EF0808"}}),ce=function(){var e=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Y.value=!1,I.value=!1,D.value=100,V.value="safe",F.value="!text-[#20a53A]","info"!=L.value){e.next=21;break}return clearInterval(P.value),e.next=9,ae();case 9:return e.next=11,le();case 11:t=e.sent,ue(t.data),D.value="?",F.value="!text-[#EF0808]",V.value="danger",h.value=!1,Z.value=t.data.risk.length,N.value="扫描中断，",e.next=32;break;case 21:Q.processPercentage=0,j.value=!0,N.value="正在进行安全扫描...",Z.value=0,R.value="正在检测...",T.value="",L.value="info",O.value=!0,g.value=!1,fe(!0);try{clearInterval(P.value),P.value=setInterval(s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe();case 2:t=e.sent,Q.processPercentage=t.data.percentage,Z.value=t.data.count,R.value=t.data.status,D.value=t.data.score,t.data.count&&"100"!=t.data.percentage&&(F.value="!text-[#EF0808]",V.value="danger",N.value="正在进行安全扫描，"),"100"==t.data.percentage&&clearInterval(P.value),D.value>=80&&D.value<=99?(F.value="!text-[#E8D544]",V.value="risk",Q.processColor="#E8D544"):D.value>=60&&D.value<=79?(F.value="!text-[#F0AD4E]",Q.processColor="#F0AD4E",V.value="warn"):D.value<60&&(F.value="!text-[#EF0808]",Q.processColor="#EF0808",V.value="danger");case 10:case"end":return e.stop()}}),e)}))),1e3)}catch(n){}case 32:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ue=function(e){for(var t in B.value=e.is_autofix,z.value=!1,localStorage.setItem("isAutoFix",JSON.stringify(B.value)),X){var r=e[t];if(Array.isArray(r)){for(var a=0;a<r.length;a++){var l=X[t].list[a];r[a].show=(null==l?void 0:l.show)||!1,r[a].selection=(null==l?void 0:l.selection)||!1}Object.keys(X).includes(t)&&"risk"==t&&(U.value=[].concat(n(U.value),n(r))),X[t].list=r}}x.value=e.check_time,L.value="primary",g.value=!0,A.value=!0,me(!0),T.value=" !animate-none",localStorage.setItem("scanData",JSON.stringify(U.value)),localStorage.setItem("ignoreData",JSON.stringify(X.ignore.list)),u("lastScanTime",x.value)},fe=function(){var e=s(l().mark((function e(){var t,n,r,a,o=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]&&o[0],h.value=!0,d.value="正在扫描中，请稍等...",e.prev=3,n={},t&&(n.force=1),e.next=8,ie(n);case 8:r=e.sent,a=r.data,U.value=[],a.interrupt||(U.value=[],ue(a),D.value=a.score,Z.value=U.value.length,N.value="已完成安全扫描，",$.value=a.ignore),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3);case 17:h.value=!1;case 18:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(){return e.apply(this,arguments)}}(),me=function(e){var t=!1;H.value=[],U.value.forEach((function(e){B.value.includes(e.m_name)&&(e.selection=!0,H.value.push(e),t=!0)})),t&&e?(G.value=!1,y.value=H.value.every((function(e){return 1==e.selection}))):t&&!e&&(y.value||(H.value=[],U.value.forEach((function(e){B.value.includes(e.m_name)&&(e.selection=!1)}))))},pe=function(){var e=s(l().mark((function e(t,n){var a,s,u;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("ltd"===r.value){e.next=3;break}return he(),e.abrupt("return");case 3:if(a=U.value.filter((function(e){return 1==e.selection})).map((function(e){return e.m_name})),e.prev=4,t||0!=a.length){e.next=10;break}return o.error("请选择需要修复的风险项！"),e.abrupt("return");case 10:H.value.length;case 11:return h.value=!0,d.value="正在修复中,可能耗时较长,请耐心等候...",e.next=15,i({data:JSON.stringify({m_name:t?[n.m_name]:a})});case 15:s=e.sent,u=s.data,t&&u.success.length>0?(o.success("修复成功"),Z.value--,U.value=U.value.filter((function(e){return e.m_name!==n.m_name})),de(u)):de(u),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(4),c(e.t0);case 24:return e.prev=24,h.value=!1,e.finish(24);case 27:case"end":return e.stop()}}),e,null,[[4,20,24,27]])})));return function(t,n){return e.apply(this,arguments)}}(),ve=function(){var e=s(l().mark((function e(t,n){var r,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,h.value=!0,d.value="正在忽略风险项,请耐心等候...",e.next=5,f({m_name:t.m_name});case 5:r=e.sent,a=r.data,o.request(a),a.status&&(n?$.value=$.value.filter((function(e){return e.m_name!==t.m_name})):U.value=U.value.filter((function(e){return e.m_name!==t.m_name})),fe(!0)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0);case 14:return e.prev=14,h.value=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[0,11,14,17]])})));return function(t,n){return e.apply(this,arguments)}}(),de=function(){var e=s(l().mark((function e(n){var r,a,o,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in J.value=[],b.value=!0,W.cannot_automatically=n.cannot_automatically.length,W.failed=n.failed.length,W.success=n.success.length,n){a=t(n[r]);try{for(a.s();!(o=a.n()).done;)s=o.value,M.value.push({m_name:s.m_name,type:s.result.type,msg:s.result.msg,status:s.result.status,name:r})}catch(l){a.e(l)}finally{a.f()}}J.value=M.value,h.value=!1,U.value=U.value.filter((function(e){return!n.success.some((function(t){return t.m_name===e.m_name}))})),Z.value=U.value.length,localStorage.setItem("scanData",JSON.stringify(U.value));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),he=function(){re({sourceId:68})};return{showAnimation:j,scanScore:D,scanTextClass:F,scanOuterClass:V,animateFlag:T,scanPreText:N,riskNum:Z,scanButtonType:L,repairAutoRiskButton:g,cookieRepair:O,scanItemText:R,processData:Q,lastScanTime:x,scanSelectShow:A,allSelect:y,allSelectionDis:G,isFirst:z,isIgnoreAll:q,ignoreData:$,emptyDetail:I,loading:h,loadingText:d,isShow:Y,activeMent:p,activeMentIgnore:v,is_autofix:B,levelData:te,allData:U,repairData:K,resultConfirm:b,resultItemLength:W,resultTable:J,resultColumn:ee,handleIgnore:ve,scanningProcess:ce,handleRepairAutoRisk:function(){if("ltd"!==r.value)return he();try{var e=U.value.filter((function(e){return 1==e.selection})).map((function(e){return e.m_name}));if(0==e.length)return h.value=!1,void o.error("暂无可自动修复的风险项！");h.value=!0,d.value="正在修复中,可能耗时较长,请耐心等候...",K.progress=0;var t=i({data:JSON.stringify({m_name:e})});K.repairProgress=!0;var n=setInterval(s(l().mark((function e(){var r,a,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se();case 2:if(r=e.sent,a=r.data,K.progress=a.percentage,K.repairText=a.status,100!==a.percentage){e.next=16;break}return K.repairText="修复完成",K.repairProgress=!1,K.progress=100,clearInterval(n),e.next=13,t;case 13:o=e.sent,de(o.data),fe(!0);case 16:case"end":return e.stop()}}),e)}))),800)}catch(a){c(a)}finally{h.value=!1}},handleDownloadReport:function(){window.open("/project/security/report/html","_blank")},changeSelectValue:function(e){e.selection=!e.selection,y.value=H.value.every((function(e){return 1==e.selection}))},handelAllSelection:me,handleRepair:pe,vulnerabilityInvolvesSoftware:function(e){var t=Object.keys(e.soft_name),n="";return t.forEach((function(r,a){a===t.length-1?n+="".concat(t,":").concat(e.soft_name[r]):n+="".concat(t,":").concat(e.soft_name[r],"\n")})),n},onlineServiceDialog:ne,onToggle:function(e,t){e.show||t.forEach((function(e){return e.show=!1})),e.show=!e.show},onOpen:function(){var e=localStorage.getItem("scanData"),t=localStorage.getItem("isAutoFix"),n=localStorage.getItem("ignoreData");t&&(B.value=JSON.parse(t)),n&&JSON.parse(n).length&&($.value=JSON.parse(n)),e&&JSON.parse(e).length?(U.value=JSON.parse(e),A.value=!0,g.value=!0,Y.value=!1):(I.value=!0,g.value=!1),O.value=!1,x.value=m("lastScanTime")||""},$reset:function(){M.value=[],U.value=[],H.value=[],$.value=[],B.value=[],clearInterval(P.value)}}})),fe={class:"h-full p-4rem"},me={class:"scan-header flex items-center"},pe={class:"flex items-center w-full"},ve={key:0,class:"w-[10rem] h-[10rem] relative flex-shrink-0"},de={key:1,class:"w-[10rem] h-[10rem] relative flex-shrink-0"},he={class:"w-full text-[#333] text-[2rem] flex flex-col ml-[3rem]"},ye={class:"flex items-center w-full justify-between"},xe={key:0},ge={class:"mx-[4px] text-[2.4rem] mx-[4px] text-danger"},be={class:"flex items-center"},we={key:0,class:"text-[1.4rem] text-[#666] mt-[1rem]"},ke={key:2,class:"text-[1.4rem] text-[#666] mt-[1rem]"},_e={key:4,class:"text-[1.4rem] mt-[12px] text-[#666] flex items-center"},Se={key:5,class:"text-[1.4rem] mt-[12px] text-[#F0AD4E] flex items-center"},Ce={key:0,class:"text-[1.4rem] w-full mt-[4rem] flex items-center justify-between"},Ee={class:"items-center flex"},Ie={class:"flex items-center"},je=["v-bt-loading:title"],Te={class:"module-head flex items-center h-[5.4rem] justify-between border-b-1 pr-[0.8rem] w-full"},Oe={class:"w-full flex items-center"},Ae=["title"],Le={key:0,class:"text-[#666] !text-[1.2rem] ml-[5rem] flex"},De={class:"flex items-center text-[1.2rem]"},Fe=["onClick"],Ve=["onClick"],Pe={class:"px-[3rem] py-[3.2rem] bg-[#F8F8F8]"},Ne={class:"flex items-center"},Re={class:"text-[#333]"},Je=["innerHTML"],Me={class:"flex mt-[16px] items-center"},Ue={key:0,class:"collapse-item flex-col !items-start"},Be={key:1,class:"collapse-item"},Ge={class:"flex mt-[16px] items-center"},He={class:"collapse-item"},$e={class:"scan-recommend"},Ye={key:0,class:"scan-recommend-body"},qe={class:"flex flex-col p-[20px]"},ze={class:"text-[1.6rem] mb-[20px]"},Ke={class:"text-primary"},Qe={class:"text-danger"},Xe={class:"text-medium"},We={class:"p-[12px] flex flex-col items-start"},Ze={class:"mt-4px"},et={key:0,class:"scan-body p-[2rem]"},tt={class:"module-list overflow-auto h-[38rem]"},nt={class:"module-head flex items-center h-[5.4rem] justify-between border-b-1 pr-[0.8rem] w-full"},rt={class:"w-full flex items-center"},at=["title"],lt={class:"flex items-center"},ot={class:"px-[3rem] py-[3.2rem] bg-[#F8F8F8]"},st={class:"flex items-center"},it={class:"text-[#333]"},ct=["innerHTML"],ut={class:"flex mt-[16px] items-center"},ft={key:0,class:"collapse-item flex-col !items-start"},mt={key:1,class:"collapse-item"},pt={class:"flex mt-[16px] items-center"},vt={class:"collapse-item"},dt={class:"w-full bg-white flex items-center justify-between"},ht=I({__name:"index",setup:function(e,t){var n=t.expose,i=ue(),c=i.handleIgnore,u=i.onToggle,f=i.vulnerabilityInvolvesSoftware,m=j(i),g=m.showAnimation,b=m.scanScore,w=m.scanTextClass,k=m.scanOuterClass,S=m.animateFlag,I=m.scanPreText,ne=m.riskNum,ae=m.scanButtonType,le=m.repairAutoRiskButton,oe=m.cookieRepair,se=m.scanItemText,ie=m.processData,ht=m.lastScanTime,yt=m.scanSelectShow,xt=m.allSelect,gt=m.allSelectionDis,bt=m.isFirst,wt=m.emptyDetail,kt=m.loading,_t=m.loadingText,St=m.isShow,Ct=m.isIgnoreAll,Et=m.ignoreData,It=m.activeMent,jt=m.activeMentIgnore,Tt=m.is_autofix,Ot=m.levelData,At=m.allData,Lt=m.repairData,Dt=m.resultConfirm,Ft=m.resultItemLength,Vt=m.resultTable,Pt=m.resultColumn,Nt=a(),Rt=(Nt.mainHeight,Nt.payment),Jt=T((function(){return At.value.filter((function(e){return 1==e.selection})).map((function(e){return e.m_name})).length})),Mt=_(!1),Ut=O("popupClose",(function(){})),Bt=function(){var e=s(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("ltd"===Rt.value.authType){e.next=3;break}return re({sourceId:68}),e.abrupt("return");case 3:return e.prev=3,e.next=6,ce();case 6:if((t=e.sent).data.status){e.next=10;break}return e.abrupt("return",o.error(t.data.msg));case 10:window.open("/download?filename=".concat(t.data.path)),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3);case 16:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(){return e.apply(this,arguments)}}(),Gt=function(){var e=s(l().mark((function e(t){var n,a,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p((function(){return r.import("./useStore-legacy4.js?v=1734676359")}),void 0,r.meta.url);case 2:n=e.sent,a=n.getFirewallStore,o=a(),o.refs.safeDetectActive.value=t,v.push({path:"/firewall/safe-detect"}),Ut();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return A(i.$reset),n({onOpen:i.onOpen}),function(e,t){var n=z,r=d,a=te,l=K,o=Q,s=X,m=W,p=h,v=y,_=x,j=Z,T=ee,O=L("bt-loading");return D(),F("div",fe,[V("div",me,[V("div",pe,[P(g)?N("",!0):(D(),F("div",ve,t[17]||(t[17]=[V("span",{class:"inline-block scan-icon-img icon-img-safe"},null,-1),V("span",{class:"scan-icon-img-bg"},null,-1),V("span",{class:"text-[3.2rem] h-[4.4rem] w-[0.7rem] text-[#20a53a] font-bold absolute-center"},"i",-1)]))),P(g)?(D(),F("div",de,[V("p",{class:R("box-text w-[5.8rem] "+P(w))},[E(J(P(b))+" ",1),t[18]||(t[18]=V("span",null,"分",-1))],2),V("span",{class:R("scan-icon-img icon-img-"+P(k))},null,2),t[21]||(t[21]=V("span",{class:"circle-inner"},null,-1)),V("span",{class:R("circle-outer "+P(k))},null,2),V("div",{class:R("animate-box"+P(S))},[V("div",{class:R("animate-box-left linear-"+P(k))},null,2),t[19]||(t[19]=V("div",{class:"animate-box-right"},null,-1)),t[20]||(t[20]=V("div",{class:"animate-box-bottom"},null,-1))],2)])):N("",!0),V("div",he,[V("div",ye,[V("span",null,[E(J(P(I)),1),P(ne)?(D(),F("span",xe,[t[22]||(t[22]=E("已检测到")),V("span",ge,J(P(ne)),1),t[23]||(t[23]=E("个风险"))])):N("",!0)]),V("div",be,[P(le)&&P(oe)?N("",!0):(D(),M(n,{key:0,class:R("w-[9rem] "+("info"==P(ae)?"bg-[#CBCBCB]":"")),type:P(ae),round:"",onClick:P(i).scanningProcess},{default:U((function(){return[E(J("info"==P(ae)?"停止扫描":"立即扫描"),1)]})),_:1},8,["class","type","onClick"])),P(le)&&P(oe)?(D(),F("span",{key:1,round:"",onClick:t[0]||(t[0]=function(){var e;return P(i).scanningProcess&&(e=P(i)).scanningProcess.apply(e,arguments)}),class:"!p-[0] bt-link text-[1.2rem] mr-4px"}," 重新扫描 ")):N("",!0),P(le)&&P(oe)?(D(),M(n,{key:2,class:"w-[9rem]",round:"",type:P(ae),onClick:P(i).handleRepairAutoRisk},{default:U((function(){return t[24]||(t[24]=[E(" 一键修复 ")])})),_:1},8,["type","onClick"])):N("",!0)])]),"info"===P(ae)||P(le)?N("",!0):(D(),F("span",we," 扫描后将自动修复所有可修复的风险项，并获取最新安全扫描报告 ")),"info"===P(ae)||P(le)?N("",!0):(D(),M(r,{key:1,class:"!p-0 !mt-[12px] w-[150px]",onClick:t[1]||(t[1]=function(e){return Mt.value=!0})},{default:U((function(){return t[25]||(t[25]=[E(" >>查看当前安全扫描报告 ")])})),_:1})),"info"==P(ae)?(D(),F("span",ke,J(P(se)),1)):N("",!0),"info"==P(ae)?(D(),M(a,{key:3,class:"mt-[1.6rem] h-[1rem]","process-color":P(ie).processColor,percentage:P(ie).processPercentage,"stroke-width":10,"show-text":!1},null,8,["process-color","percentage"])):N("",!0),P(le)?(D(),F("span",_e," 上次扫描时间："+J(P(ht)),1)):N("",!0),P(le)&&P(oe)?(D(),F("span",Se," 若安装了【系统加固】，请先关闭再进行一键修复 ")):N("",!0)])])]),P(yt)?(D(),F("div",Ce,[V("div",Ee,[C(l,{onChange:P(i).handelAllSelection,class:"text-[#666] font-500 text-[12px]",modelValue:P(xt),"onUpdate:modelValue":t[2]||(t[2]=function(e){return B(xt)?xt.value=e:null}),disabled:P(gt)},{default:U((function(){return t[26]||(t[26]=[E("全选")])})),_:1},8,["onChange","modelValue","disabled"]),G(C(r,{onClick:t[3]||(t[3]=function(e){return P(i).handleRepair(!1,null)}),link:"",class:R(P(Jt)?"ml-[20px] text-[1.4rem] mt-[1px]":"ml-[20px] text-[1.4rem] text-[#999] mt-[1px] cursor-not-allowed ")},{default:U((function(){return t[27]||(t[27]=[E("修复选中项 ")])})),_:1},8,["class"]),[[H,!P(bt)]])]),V("div",Ie,[C(r,{onClick:t[4]||(t[4]=function(e){return Ct.value=!0})},{default:U((function(){return t[28]||(t[28]=[E("忽略扫描项")])})),_:1}),t[30]||(t[30]=V("span",{class:"text-[#999] mx-[1.2rem]"},"|",-1)),C(n,{type:"primary",link:"",onClick:t[5]||(t[5]=function(e){return Mt.value=!0})},{default:U((function(){return t[29]||(t[29]=[V("i",{class:"svgtofont-icon-safe-report text-[1.4rem] text-[#20a53a]"},null,-1),E(" 查看安全扫描报告")])})),_:1})])])):N("",!0),P(wt)?N("",!0):G((D(),F("div",{key:1,"v-bt-loading:title":P(_t),class:R([P(St)?"h-[28rem]":"h-[38rem]","scan-body my-[2rem]"])},[C(s,{modelValue:P(It),"onUpdate:modelValue":t[7]||(t[7]=function(e){return B(It)?It.value=e:null}),accordion:""},{default:U((function(){return[V("div",{class:R(["module-list overflow-auto",P(St)?"h-[28rem]":"h-[38rem]"])},[(D(!0),F($,null,Y(P(At),(function(e,n){return D(),F("div",{class:"module-item text-[1.2rem]",key:"".concat(n)},[V("div",Te,[V("div",Oe,[C(l,{modelValue:e.selection,"onUpdate:modelValue":function(t){return e.selection=t},onChange:function(t){return P(i).changeSelectValue(e.selection)},disabled:P(bt)||!P(Tt).includes(e.m_name)},null,8,["modelValue","onUpdate:modelValue","onChange","disabled"]),V("span",{class:"text-[1.2rem] h-[2.2rem] flex items-center px-[8px] rounded-[0.2rem] ml-[8px] mr-[1rem]",style:q({color:P(Ot)[e.level].color,backgroundColor:P(Ot)[e.level].bg})},J(P(Ot)[e.level].text),5),V("div",{class:"w-[16rem] max-w-[16rem] truncate",style:q({color:P(Ot)[e.level].color}),title:e.ps?e.ps:e.vuln_name},J(e.ps?e.ps:e.vuln_name),13,Ae),P(Tt).includes(e.m_name)?N("",!0):(D(),F("div",Le,[t[32]||(t[32]=E("无法自动修复，请手动处理或")),C(r,{onClick:t[6]||(t[6]=function(e){return P(i).onlineServiceDialog()})},{default:U((function(){return t[31]||(t[31]=[E("联系人工")])})),_:1})]))]),V("div",De,[G(V("span",{onClick:function(t){return P(i).handleRepair(!0,e)},class:"w-[4.2rem] bt-link"},t[33]||(t[33]=[E(" 修复"),V("span",{class:"text-[#999] mx-[4px]"},"|",-1)]),8,Fe),[[H,!P(bt)&&!!P(Tt).includes(e.m_name)]]),V("span",{underline:!1,onClick:function(t){return P(i).handleIgnore(e,!1)},class:"w-[4.2rem] cursor-pointer text-[#999]"},t[34]||(t[34]=[E(" 忽略 "),V("span",{class:"text-[#999] mx-4px"},"|",-1)]),8,Ve),C(r,{onClick:function(t){return P(i).onToggle(e,P(At))},class:"w-[5.4rem] flex items-center"},{default:U((function(){return[E(J(e.show?"折叠":"详情"),1),V("i",{class:R("text-[1.4rem] text-[#999] ml-[4px] svgtofont-el-arrow-"+(e.show?"up":"down"))},null,2)]})),_:2},1032,["onClick"])])]),C(o,null,{default:U((function(){return[G(V("div",Pe,[V("div",Ne,[V("div",Re,J(e.ps?"风险描述":"涉及软件\t"),1),G(V("div",{class:"collapse-item",innerHTML:e.msg},null,8,Je),[[H,e.msg]]),G(V("div",{class:"collapse-item"},J(e.soft_name?P(i).vulnerabilityInvolvesSoftware(e):""),513),[[H,e.soft_name]])]),V("div",Me,[t[35]||(t[35]=V("div",null,"解决方案",-1)),e.tips?(D(),F("div",Ue,[(D(!0),F($,null,Y(e.tips,(function(e,t){return D(),F("p",{key:t,class:R(0==t?"":"mt-[4px]")},J(t+1)+"、"+J(e),3)})),128))])):N("",!0),e.vuln_solution?(D(),F("div",Be,J(e.vuln_solution),1)):N("",!0)]),G(V("div",Ge,[t[36]||(t[36]=V("div",null,"温馨提示",-1)),V("div",He,J(e.remind),1)],512),[[H,e.remind]])],512),[[H,e.show]])]})),_:2},1024)])})),128))],2)]})),_:1},8,["modelValue"])],10,je)),[[O,P(kt)]]),P(wt)?(D(),F("div",{key:2,class:R([P(St)?"h-[32rem]":"h-[40rem]","scan-body flex justify-center flex-col my-[4rem] relative"])},[t[37]||(t[37]=V("span",{class:"bg-[#f2f2f2] h-[3rem] w-[33%] mb-[12px]"},null,-1)),(D(),F($,null,Y(4,(function(e,t){return V("span",{class:"bg-[#f2f2f2] h-[3rem] w-full mb-[12px]",key:t})})),64)),t[38]||(t[38]=V("span",{class:"bg-[#f2f2f2] h-[3rem] w-[60%] mb-[12px]"},null,-1)),(D(),F($,null,Y(3,(function(e,t){return V("span",{class:"bg-[#f2f2f2] h-[3rem] w-full mb-[12px]",key:t})})),64)),t[39]||(t[39]=V("span",{class:"bg-[#f2f2f2] h-[3rem] w-[40%] mb-[12px]"},null,-1))],2)):N("",!0),V("div",$e,[V("span",{class:"cursor-pointer",onClick:t[8]||(t[8]=function(e){return St.value=!P(St)})},[V("i",{class:R(["mr-[0.6rem]",P(St)?"svgtofont-el-arrow-up":"svgtofont-el-arrow-down"])},null,2),t[40]||(t[40]=V("span",null,"更多安全工具",-1))]),P(St)?(D(),F("div",Ye,[C(m,{class:"relative item",effect:"dark",content:"点击跳转到功能页",placement:"top-start"},{default:U((function(){return[V("div",{class:"scan-recommend-body-box relative",onClick:t[9]||(t[9]=function(e){return Gt("spywareDetection")})},t[41]||(t[41]=[V("div",{class:"scan-recommend-body-box-title"},"动态查杀",-1),V("div",{class:"scan-recommend-body-box-desc"},"支持定时动态查杀木马隔离",-1),V("i",{class:"svgtofont-icon-dynamic-kill text-[#20a53a20] text-[6rem] absolute bottom-2rem left-[0.8rem]"},null,-1)]))]})),_:1}),C(m,{class:"relative tem",effect:"dark",content:"点击跳转到功能页",placement:"top-start"},{default:U((function(){return[V("div",{class:"scan-recommend-body-box safaty-detect relative",onClick:t[10]||(t[10]=function(e){return Gt("safeDetectTab")})},t[42]||(t[42]=[V("div",{class:"scan-recommend-body-box-title"},"安全检测",-1),V("div",{class:"scan-recommend-body-box-desc"},"更全面的服务器检测",-1),V("i",{class:"svgtofont-icon-safaty-detect text-[#20a53a20] text-[6rem] absolute bottom-2rem left-[0.8rem]"},null,-1)]))]})),_:1}),C(m,{class:"relative item",effect:"dark",content:"点击跳转到功能页",placement:"top-start"},{default:U((function(){return[V("div",{class:"scan-recommend-body-box bug-scan relative",onClick:t[11]||(t[11]=function(e){return Gt("vulnerabilityScanning")})},t[43]||(t[43]=[V("div",{class:"scan-recommend-body-box-title"},"网站漏洞扫描",-1),V("div",{class:"scan-recommend-body-box-desc"},"针对网站漏洞的专享扫描工具",-1),V("i",{class:"svgtofont-icon-bug-scan text-[#20a53a20] text-[6rem] absolute bottom-1.6rem left-[0.8rem]"},null,-1)]))]})),_:1})])):N("",!0)]),C(_,{title:"结果确认","show-footer":!1,area:54,modelValue:P(Dt),"onUpdate:modelValue":t[12]||(t[12]=function(e){return B(Dt)?Dt.value=e:null})},{default:U((function(){return[V("div",qe,[V("span",ze,[t[44]||(t[44]=E("修复结果：修复成功")),V("span",Ke,J(P(Ft).success),1),t[45]||(t[45]=E("项，修复失败")),V("span",Qe,J(P(Ft).failed),1),t[46]||(t[46]=E("项，忽略")),V("span",Xe,J(P(Ft).cannot_automatically),1),t[47]||(t[47]=E("项"))]),C(p,{"max-height":400,data:P(Vt),column:P(Pt)},null,8,["data","column"]),C(v,{options:[{content:"如有修复失败项，请关闭当前窗口，根据解决方案手动进行修复"}],"list-style":"none",class:"ml-[8px] mt-[12px]"})])]})),_:1},8,["modelValue"]),C(_,{title:!1,"show-footer":!1,area:54,modelValue:P(Lt).repairProgress,"onUpdate:modelValue":t[13]||(t[13]=function(e){return P(Lt).repairProgress=e}),showClose:!1},{default:U((function(){return[V("div",We,[C(j,{class:"!w-full",color:"#20a53a","text-inside":!0,"stroke-width":20,percentage:P(Lt).progress},null,8,["percentage"]),V("span",Ze,J(P(Lt).repairText),1)])]})),_:1},8,["modelValue"]),C(_,{title:"忽略风险项",area:66,modelValue:P(Ct),"onUpdate:modelValue":t[15]||(t[15]=function(e){return B(Ct)?Ct.value=e:null}),"show-footer":!1},{default:U((function(){return[P(wt)?N("",!0):(D(),F("div",et,[C(s,{modelValue:P(jt),"onUpdate:modelValue":t[14]||(t[14]=function(e){return B(jt)?jt.value=e:null}),accordion:"",class:R("".concat(P(Et).length?"":"!border-none"))},{default:U((function(){return[V("div",tt,[(D(!0),F($,null,Y(P(Et),(function(e,n){return D(),F("div",{class:"module-item text-[1.2rem]",key:"".concat(n)},[V("div",nt,[V("div",rt,[V("span",{class:"text-[1.2rem] h-[2.2rem] flex items-center px-[8px] rounded-[0.2rem] ml-[8px] mr-[1rem]",style:q({color:P(Ot)[e.level].color,backgroundColor:P(Ot)[e.level].bg})},J(P(Ot)[e.level].text),5),V("div",{class:"w-[36rem] max-w-[36rem] truncate",style:q({color:P(Ot)[e.level].color}),title:e.ps?e.ps:e.vuln_name},J(e.ps?e.ps:e.vuln_name),13,at)]),V("div",lt,[C(r,{onClick:function(t){return P(c)(e,!0)},class:"w-[6.6rem]"},{default:U((function(){return t[48]||(t[48]=[E(" 移除忽略 "),V("span",{class:"text-[#999] mx-[4px]"},"|",-1)])})),_:2},1032,["onClick"]),C(r,{onClick:function(t){return P(u)(e,P(Et))},class:"w-[5.4rem] flex items-center"},{default:U((function(){return[E(J(e.show?"折叠":"详情"),1),V("i",{class:R("text-[1.4rem] text-[#999] ml-[4px] svgtofont-el-arrow-"+(e.show?"up":"down"))},null,2)]})),_:2},1032,["onClick"])])]),C(o,null,{default:U((function(){return[G(V("div",ot,[V("div",st,[V("div",it,J(e.ps?"风险描述":"涉及软件"),1),G(V("div",{class:"collapse-item",innerHTML:e.msg},null,8,ct),[[H,e.msg]]),G(V("div",{class:"collapse-item"},J(e.soft_name?P(f)(e):""),513),[[H,e.soft_name]])]),V("div",ut,[t[49]||(t[49]=V("div",null,"解决方案",-1)),e.tips?(D(),F("div",ft,[(D(!0),F($,null,Y(e.tips,(function(e,t){return D(),F("p",{key:t,class:R(0==t?"":"mt-[4px]")},J(t+1)+"、"+J(e),3)})),128))])):N("",!0),e.vuln_solution?(D(),F("div",mt,J(e.vuln_solution),1)):N("",!0)]),G(V("div",pt,[t[50]||(t[50]=V("div",null,"温馨提示",-1)),V("div",vt,J(e.remind),1)],512),[[H,e.remind]])],512),[[H,e.show]])]})),_:2},1024)])})),128)),P(Et).length?N("",!0):(D(),M(T,{key:0,description:"暂无忽略的风险项"}))])]})),_:1},8,["modelValue","class"])]))]})),_:1},8,["modelValue"]),C(_,{title:"安全扫描报告","show-footer":!1,area:[100,80],modelValue:P(Mt),"onUpdate:modelValue":t[16]||(t[16]=function(e){return B(Mt)?Mt.value=e:null})},{default:U((function(){return[t[53]||(t[53]=V("div",{class:"box"},[V("iframe",{src:"/project/security/report/html",frameborder:"0",width:"200%",height:"200%"})],-1)),V("div",dt,[t[52]||(t[52]=V("span",null,null,-1)),C(r,{onClick:Bt,class:"border border-solid border-[#20a53a] py-8px px-12px rounded-2px mr-20px my-8px"},{default:U((function(){return t[51]||(t[51]=[V("i",{class:"svgtofont-icon-ltd text-[#A88E5F] mt-2px"},null,-1),E(" 下载报告")])})),_:1})])]})),_:1},8,["modelValue"])])}}});e("default",g(ht,[["__scopeId","data-v-d90bf387"]]))}}}))}();
