import{c as a,k as e,l as t,e as s,x as l,y as o,v as c,p as i,q as n,bL as r,bM as d,A as m}from"./base-lib.js?v=1734676359";import{R as p,o as f,G as u,c as _,e as b}from"./utils-lib.js?v=1734676359";import{ad as w}from"./firewall.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";const x={class:"p-[2rem]"},D={class:"mb-[1.2rem] flex flex-col"},v={class:"detail-content"},j={class:"mb-[1.2rem] flex flex-col"},g={class:"detail-content"},L={class:"mb-[1.2rem] flex flex-col"},R={class:"flex justify-between items-end"},U={class:"detail-content"},k={class:"mb-[1.2rem] flex flex-col"},y={class:"detail-content"},q=b(a({__name:"log-detail",props:{compData:{default:{}}},setup(a){const b=a,q=()=>{b.compData.addIpWhiteEvent(b.compData.row)},I=async()=>{await f({title:"加入URL白名单",content:"加入URL白名单后此URL将不再进行防御，是否继续操作？",icon:"warning-filled"}),await u({loading:"正在加入URL白名单...",request:w({url_rule:b.compData.row.url}),message:!0})};return(a,f)=>{const u=r,b=_,w=d,h=m;return e(),t("div",x,[s(w,{title:"",direction:"vertical",column:4,border:"",class:"mb-[1.2rem]"},{default:l((()=>[s(u,{label:"时间"},{default:l((()=>[o(c(i(p)(a.compData.row.addtime)),1)])),_:1}),s(u,{label:"用户Ip"},{default:l((()=>[s(b,{onClick:q},{default:l((()=>[o(c(a.compData.row.address),1)])),_:1})])),_:1}),s(u,{label:"触发函数"},{default:l((()=>[o(c(a.compData.row.fun_name),1)])),_:1}),s(u,{label:"过滤器"},{default:l((()=>[o(c(a.compData.row.intercept),1)])),_:1})])),_:1}),n("div",D,[f[0]||(f[0]=n("span",{class:"detail-title"},"URL地址",-1)),n("span",v,c(a.compData.row.url),1)]),n("div",j,[f[1]||(f[1]=n("span",{class:"detail-title"},"User-Agent",-1)),n("span",g,c(a.compData.row.data_info.data.request.headers["user-agent"]),1)]),n("div",L,[n("div",R,[f[3]||(f[3]=n("span",{class:"detail-title"},"传入值",-1)),s(h,{type:"text",onClick:I},{default:l((()=>f[2]||(f[2]=[o("URL加白")]))),_:1})]),n("span",U,c(a.compData.row.data_info.data.args.join("\n")),1)]),n("div",k,[f[4]||(f[4]=n("span",{class:"detail-title"},"调用栈",-1)),n("span",y,c(a.compData.row.data_info.data.stack_trace.join("\n")),1)])])}}}),[["__scopeId","data-v-4d1bca38"]]);export{q as default};
