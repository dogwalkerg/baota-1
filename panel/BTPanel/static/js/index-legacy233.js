!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */e=function(){return n};var r,n={},o=Object.prototype,a=o.hasOwnProperty,s=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},c=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(r){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var o=e&&e.prototype instanceof w?e:w,a=Object.create(o.prototype),i=new N(n||[]);return s(a,"_invoke",{value:L(t,r,i)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}n.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",g="completed",m={};function w(){}function b(){}function _(){}var k={};f(k,c,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(G([])));E&&E!==o&&a.call(E,c)&&(k=E);var O=_.prototype=w.prototype=Object.create(k);function S(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function j(e,r){function n(o,s,i,c){var u=h(e[o],e,s);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==t(f)&&a.call(f,"__await")?r.resolve(f.__await).then((function(t){n("next",t,i,c)}),(function(t){n("throw",t,i,c)})):r.resolve(f).then((function(t){l.value=t,i(l)}),(function(t){return n("throw",t,i,c)}))}c(u.arg)}var o;s(this,"_invoke",{value:function(t,e){function a(){return new r((function(r,o){n(t,e,r,o)}))}return o=o?o.then(a,a):a()}})}function L(t,e,n){var o=d;return function(a,s){if(o===v)throw Error("Generator is already running");if(o===g){if("throw"===a)throw s;return{value:r,done:!0}}for(n.method=a,n.arg=s;;){var i=n.delegate;if(i){var c=P(i,n);if(c){if(c===m)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=h(t,e,n);if("normal"===u.type){if(o=n.done?g:y,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=g,n.method="throw",n.arg=u.arg)}}}function P(t,e){var n=e.method,o=t.iterator[n];if(o===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=r,P(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=h(o,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,m;var s=a.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,m):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,m)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function N(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function G(e){if(e||""===e){var n=e[c];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,s=function t(){for(;++o<e.length;)if(a.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=r,t.done=!0,t};return s.next=s}}throw new TypeError(t(e)+" is not iterable")}return b.prototype=_,s(O,"constructor",{value:_,configurable:!0}),s(_,"constructor",{value:b,configurable:!0}),b.displayName=f(_,l,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,f(t,l,"GeneratorFunction")),t.prototype=Object.create(O),t},n.awrap=function(t){return{__await:t}},S(j.prototype),f(j.prototype,u,(function(){return this})),n.AsyncIterator=j,n.async=function(t,e,r,o,a){void 0===a&&(a=Promise);var s=new j(p(t,e,r,o),a);return n.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(O),f(O,l,"Generator"),f(O,c,(function(){return this})),f(O,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},n.values=G,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(C),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,o){return i.type="throw",i.arg=t,e.next=n,o&&(e.method="next",e.arg=r),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],i=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var c=a.call(s,"catchLoc"),u=a.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:G(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=r),m}},n}function r(t,e,r,n,o,a,s){try{var i=t[a](s),c=i.value}catch(t){return void r(t)}i.done?e(c):Promise.resolve(c).then(n,o)}function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function o(e,r,n){return(r=function(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,r||"default");if("object"!=t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}System.register(["./utils-lib-legacy.js?v=1734676359","./base-lib-legacy.js?v=1734676359","./firewall-legacy.js?v=1734676359","./__commonjsHelpers__-legacy.js?v=1734676359"],(function(t,a){"use strict";var s,i,c,u,l,f,p,h,d,y,v,g,m,w,b,_,k,x,E,O,S,j,L,P,T,C,N,G,D,F;return{setters:[function(t){s=t.dm,i=t.R,c=t.ah,u=t.d,l=t.c,f=t.a5,p=t.e},function(t){h=t.c,d=t.r,y=t.h,v=t.i,g=t.o,m=t.B,w=t.C,b=t.p,_=t.k,k=t.l,x=t.q,E=t.F,O=t.J,S=t.I,j=t.e,L=t.y,P=t.v,T=t.z,C=t.x,N=t.aX,G=t.b7,D=t.A},function(t){F=t.T},null],execute:function(){var a={id:"safeDetectList"},I={class:"progress-header"},A={class:"progress-header-cot"},J={key:0,class:"relative"},M={class:"absolute top-[1.6rem] left-[2.6rem] flex flex-col"},H={class:"progress-header-cot"},Y={class:"scanning-progress-title"},q={class:"color-org"},z={class:"color-red"},B={class:"scanning-progress-cont"},R={class:"progress-header-cot"},X={class:"progress-cont-list"},K=["onClick"],Q={class:"progress_type"},U={class:"progress_status"},V={key:0,class:"text-danger"},W={key:1,class:"text-warning"},Z={key:1},$={key:2,class:"text-[#666]"},tt={key:0},et={class:"progress_fold"},rt={class:"progress_item_body"},nt={class:"info_cont"},ot={class:"info_cont_desc"},at=h({__name:"index",setup:function(t){var p=d(!1),h=[{color:"#888",text:"未安装"},{color:"#666",text:"良好"},{color:"#e6a23c",text:"警告"},{color:"red",text:"危险"}],at={system_account:"系统账户",sshd_service:"SSHD远程服务",file_mode:"重要文件权限及属性",software:"重点软件检测",website_permissions:"网站权限检测",other:"其他项目检测",backdoor:"后门检测",proc:"恶意进程",history:"历史命令",log:"日志排查",rootkit:"rootkit检测"},st={scanStatus:!1,isEnd:!1,error:0,warn:0,time:0,progress:0,progressColor:"#20a53a",progressConfig:{system_account:[],sshd_service:[],file_mode:[],software:[],website_permissions:[],other:[],backdoor:[],proc:[],history:[],log:[],rootkit:[]},statusTotal:{},allArr:[],result:{},progressStatus:{},active:{system_account:!1,sshd_service:!1,file_mode:!1,software:!1,website_permissions:!1,other:!1,backdoor:!1,proc:!1,history:!1,log:!1,rootkit:!1}},it=d({}),ct=y(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},st)),ut=function(t){return t+" 分"},lt=null,ft=v((function(){return ct.scanStatus&&!ct.isEnd?"正在扫描":it.value.status?"上次检测时间 "+("刚刚"===s(it.value.msg.time)?"一分钟内":s(it.value.msg.time)):"当前未进行安全检测"})),pt=d(""),ht=d(""),dt=v((function(){return ct.scanStatus&&!ct.isEnd?"正在扫描-".concat(pt.value):ct.isEnd?"检测时间："+i(ct.time/1e3,"yyyy-MM-dd"):it.value.status?"若长时间未检测，服务器可能存在安全风险，建议立即检测":"当前安全风险未知，请立即检测"})),yt=function(t,e){if(e.data){var r,n=JSON.parse(e.data.replace(/'/g,'"'));if(n.hasOwnProperty("callback"))null===(r=lt)||void 0===r||r.close(),ct.scanStatus=!1,ct.isEnd=!0,ct.time=(new Date).getTime();else pt.value=n.name,ht.value=n.topic,ct.progress=parseInt(n.progress),ct.progressConfig[n.topic].push(n),ct.statusTotal[n.topic]=vt(ct.progressConfig[n.topic]),ct.allArr.push(n),3===n.status?ct.error++:2===n.status&&ct.warn++,1!==n.status&&(ct.progressColor="#fc6d26")}},vt=function(t){var e={};return t.forEach((function(t){e[t.status]?e[t.status]++:e[t.status]=1})),e},gt=function(){var t,e;if(ct.scanStatus&&!ct.isEnd||ct.isEnd,ct.scanStatus&&!ct.isEnd)return null===(e=lt)||void 0===e||e.close(),void mt();ct.isEnd&&mt(),ct.scanStatus=!0,null===(t=lt=f({route:"/ws_project",onMessage:yt}))||void 0===t||t.send({mod_name:"safe_detect",def_name:"get_safe_scan",ws_callback:""})},mt=function(){Object.assign(ct,JSON.parse(JSON.stringify(st)))},wt=function(){var t,n=(t=e().mark((function t(){var r;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,F();case 3:r=t.sent,it.value=r.data,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),c(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})),function(){var e=this,n=arguments;return new Promise((function(o,a){var s=t.apply(e,n);function i(t){r(s,o,a,i,c,"next",t)}function c(t){r(s,o,a,i,c,"throw",t)}i(void 0)}))});return function(){return n.apply(this,arguments)}}();return g((function(){wt()})),function(t,e){var r,n,o=u,s=G,i=D,c=l,f=m("bt-loading");return w((_(),k("div",a,[x("div",I,[x("div",A,[x("div",{class:E("progresscirclebar "+(b(it).status?"security ":"")+"text-["+(100===(null===(r=b(it).msg)||void 0===r?void 0:r.security_count)?" #20a53a ":" #fc6d26 ")+"]")},[b(it).status?(_(),k(S,{key:1},[b(ct).scanStatus&&!b(ct).isEnd?(_(),k("div",J,[j(s,{class:"animate-spin",type:"circle",percentage:70,"show-text":!1,"stroke-width":4,"define-back-color":"#fff",color:b(ct).warn||b(ct).error?"#fc6d26":"#20a53a",width:100},null,8,["color"]),x("div",M,[j(o,{class:"w-[full] px-[.4rem]",src:"/firewall/icon-safe-detect".concat(b(ct).warn||b(ct).error?"-org":"",".svg")},null,8,["src"]),e[0]||(e[0]=x("span",{class:"text-[1.2rem] font-bold py-[.4rem] leading-none"}," 安全检测 ",-1))])])):(_(),O(s,{key:1,type:"circle",percentage:null===(n=b(it).msg)||void 0===n?void 0:n.security_count,format:ut,color:b(ct).warn||b(ct).error?"#fc6d26":"#20a53a",width:100},null,8,["percentage","color"]))],64)):(_(),O(o,{key:0,class:"w-[10rem]",src:"/firewall/icon-safe-detect.svg"}))],2)]),x("div",H,[x("div",Y,[b(ct).isEnd?(_(),k(S,{key:1},[e[5]||(e[5]=L(" 检测已完成 ")),b(ct).error>0||b(ct).warn>0?(_(),k(S,{key:0},[e[4]||(e[4]=L(" ，一共发现 ")),b(ct).warn>0?(_(),k(S,{key:0},[x("span",q,P(b(ct).warn),1),e[1]||(e[1]=L(" 项风险项 "))],64)):T("",!0),b(ct).error>0?(_(),k(S,{key:1},[e[2]||(e[2]=L(" （包含 ")),x("span",z,P(b(ct).error),1),e[3]||(e[3]=L(" 项危险项，请立即处理） "))],64)):T("",!0)],64)):T("",!0)],64)):(_(),k(S,{key:0},[L(P(b(ft)),1)],64))]),b(ct).scanStatus?(_(),O(s,{key:0,percentage:b(ct).progress,color:b(ct).warn||b(ct).error?"#fc6d26":"#20a53a","stroke-width":10},null,8,["percentage","color"])):T("",!0),x("div",B,P(b(dt)),1)]),x("div",R,[j(i,{type:b(ct).scanStatus&&!b(ct).isEnd?"warning":"primary",onClick:gt,plain:!(!b(ct).scanStatus||b(ct).isEnd)},{default:C((function(){return[L(P(b(ct).scanStatus&&!b(ct).isEnd?"取消扫描":b(ct).isEnd?"重新检测":"立即检测"),1)]})),_:1},8,["type","plain"]),j(c,{class:"!absolute -bottom-[2.5rem] right-[1.4rem]",href:"https://www.bt.cn/bbs/thread-126643-1-1.html"},{default:C((function(){return e[6]||(e[6]=[L(" 需求反馈>> ")])})),_:1})])]),x("div",X,[(_(),k(S,null,N(at,(function(t,e){return x("div",{key:e,class:E([e+"_item "+(b(ct).active[e]?"active":""),"progress_item"])},[x("div",{class:"progress_item_header",onClick:function(t){return function(t){ct.active[t]=!ct.active[t]}(e)}},[x("div",Q,[j(o,{class:"title-icon",src:"/firewall/icon-"+e+".svg"},null,8,["src"]),x("span",null,P(t),1)]),x("div",U,[b(ct).statusTotal[e]?(_(),k(S,{key:0},[b(ct).statusTotal[e][3]||b(ct).statusTotal[e][2]?(_(),k(S,{key:0},[b(ct).statusTotal[e][3]?(_(),k("span",V," 发现"+P(b(ct).statusTotal[e][3])+"项危险 ",1)):T("",!0),b(ct).statusTotal[e][2]?(_(),k("span",W,P((b(ct).statusTotal[e][3]?"":"发现")+b(ct).statusTotal[e][2])+"项警告 ",1)):T("",!0)],64)):b(ct).scanStatus&&b(ht)==e?(_(),k("span",Z," 正在扫描... ")):(_(),k("span",$,"无风险项"))],64)):(_(),k(S,{key:1},[b(ct).scanStatus&&!b(ct).statusTotal[e]?(_(),k("span",tt," 等待扫描 ")):T("",!0)],64))]),x("div",et,[j(o,{src:"/firewall/arrow-down.svg"})])],8,K),x("div",rt,[b(ct).progressConfig[e]&&b(ct).progressConfig[e].length?(_(!0),k(S,{key:0},N(b(ct).progressConfig[e],(function(t,e){return _(),k("div",{key:e,class:E([t.info?"active":"","progress_item_info"])},[x("div",nt,[x("div",null,P(t.name.replace("分析网站","")),1),x("div",{class:E("text-["+h[t.status<0?0:t.status].color+"]")},P(h[t.status<0?0:t.status].text),3)]),x("div",ot,P(t.info||""),1)],2)})),128)):T("",!0)])],2)})),64))])])),[[f,b(p)]])}}});t("default",p(at,[["__scopeId","data-v-73f8e457"]]))}}}))}();
