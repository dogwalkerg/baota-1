import{_ as e}from"./index90.js?v=1734676359";import{b as a,G as s,k as l,j as t,h as o}from"./utils-lib.js?v=1734676359";import{c as n,r,h as u,k as i,l as d,e as p,x as c,C as m,p as f,A as _,aZ as y,D as g,R as h,o as k,B as w,J as b,y as v,q as x,M as j,a7 as q,a4 as C}from"./base-lib.js?v=1734676359";import{b5 as V,b6 as R,b7 as z,b8 as U,b9 as A}from"./firewall.js?v=1734676359";import{u as D}from"./column.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";const S=n({__name:"upload-thesaurus",emits:["upload-success"],setup(e,{expose:s,emit:l}){const t=a(),o=r(),n=r(),h=l,k=window.location.protocol+"//"+window.location.host+"/project/content/in_thesaurus",w=u({f_size:0,f_path:"/tmp/",f_name:"inthesaurus.txt",f_start:0}),b=r([]),v=[".txt"].join(","),x=()=>{h("upload-success")},j=()=>{t.error("导入失败")},q={"x-http-token":window.vite_public_request_token},C=e=>{e.value=e,w.f_size=e.size,w.f_start=0},V=(e,a)=>{b.value=a},R=(e,a,s)=>{w.f_start=e.percent,b.value=s.map((s=>(s.uid===a.uid&&(s.percentage=e.percent),s)))};return s({onConfirm:()=>{n.value.submit()},open:()=>{o.value.$el.click()},fileData:w}),(e,a)=>{const s=_,l=y;return i(),d("div",null,[p(l,{class:"upload-demo",ref_key:"uploadRef",ref:n,name:"blob",data:f(w),action:k,headers:q,accept:f(v),"on-error":j,multiple:!1,"show-file-list":!1,"auto-upload":!0,"on-success":x,"on-progress":R,"file-list":f(b),"on-change":V,"before-upload":C},{default:c((()=>[m(p(s,{ref_key:"openRef",ref:o,size:"small",type:"primary"},null,512),[[g,!1]])])),_:1},8,["data","accept","file-list"])])}}}),B=n({__name:"own-thesaurus",setup(a){const n=r(null),d=h([]),y=r(!1),g=r(null),B=r(!1),F=u({key:""}),G=u({key:[{trigger:["blur","change"],required:!0,message:"请输入关键词"}]}),H=async()=>{n.value.open()},I=async()=>{const e=await s({loading:"正在导出关键词文件，请稍后...",request:V(),data:{msg:String}});window.open("/download?filename="+e.msg)},J=async e=>{Z()},M=[{label:"关键词\t",render:e=>p("span",null,[e])},D([{onClick:async e=>{await s({loading:"正在删除关键词，请稍后...",request:R({key:e}),message:!0}),Z()},title:"删除"}])],T=async()=>{await s({loading:"正在清空自定义词库，请稍后...",request:z(),message:!0}),Z()},Z=async()=>{await s({loading:"正在加载词库列表，请稍后...",request:U(),data:[Array,d]})},$=async e=>{await g.value.validate(),await s({loading:"正在添加关键词，请稍候...",request:A(F),message:!0}),F.key="",B.value=!1,Z()};return k((()=>Z())),(a,s)=>{const r=_,u=l,h=t,k=q,V=C,R=o,z=e,U=w("bt-loading");return i(),b(z,{class:"px-[1.6rem] py-[1.6rem]"},{"header-left":c((()=>[p(r,{onClick:s[0]||(s[0]=e=>B.value=!0),type:"primary"},{default:c((()=>s[3]||(s[3]=[v("添加")]))),_:1}),p(r,{onClick:H},{default:c((()=>s[4]||(s[4]=[v("导入")]))),_:1}),p(r,{onClick:I},{default:c((()=>s[5]||(s[5]=[v("导出")]))),_:1}),p(r,{onClick:T},{default:c((()=>s[6]||(s[6]=[v("清空")]))),_:1}),p(S,{ref_key:"fileIpRef",ref:n,onUploadSuccess:J},null,512)])),content:c((()=>[m(p(u,{"max-height":"260",column:M,data:f(d),description:"词库列表为空"},null,8,["data"]),[[U,f(y)],[U,"正在加载词库列表，请稍后...","title"]])])),popup:c((()=>[p(R,{title:"添加自定义词库",modelValue:f(B),"onUpdate:modelValue":s[2]||(s[2]=e=>j(B)?B.value=e:null),area:42,onConfirm:$,showFooter:""},{default:c((()=>[p(V,{ref_key:"addThesaurusRef",ref:g,rules:f(G),model:f(F),class:"p-[2rem]","label-width":"5rem"},{default:c((()=>[p(k,{label:"关键词",prop:"key"},{default:c((()=>[p(h,{modelValue:f(F).key,"onUpdate:modelValue":s[1]||(s[1]=e=>f(F).key=e),width:"20rem",placeholder:"请输入你需要扫描的关键词"},null,8,["modelValue"])])),_:1}),s[7]||(s[7]=x("ul",{class:"leading-8 text-[1.2rem] list-disc ml-20px"},[x("li",null,"关键字小于2时会引起大量误报，请设置大于等于2个关键字！")],-1))])),_:1},8,["rules","model"])])),_:1},8,["modelValue"])])),_:1})}}});export{B as default};
