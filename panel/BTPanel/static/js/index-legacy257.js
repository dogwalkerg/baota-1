!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function r(t){for(var r=1;r<arguments.length;r++){var a=null!=arguments[r]?arguments[r]:{};r%2?e(Object(a),!0).forEach((function(e){n(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):e(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function n(e,r,n){return(r=function(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,r||"default");if("object"!=t(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function a(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */a=function(){return r};var e,r={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},u="function"==typeof Symbol?Symbol:{},s=u.iterator||"@@iterator",c=u.asyncIterator||"@@asyncIterator",l=u.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(e){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var a=e&&e.prototype instanceof b?e:b,o=Object.create(a.prototype),u=new I(n||[]);return i(o,"_invoke",{value:L(t,r,u)}),o}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}r.wrap=p;var h="suspendedStart",v="suspendedYield",y="executing",m="completed",g={};function b(){}function _(){}function w(){}var x={};f(x,s,(function(){return this}));var k=Object.getPrototypeOf,P=k&&k(k(N([])));P&&P!==n&&o.call(P,s)&&(x=P);var O=w.prototype=b.prototype=Object.create(x);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function S(e,r){function n(a,i,u,s){var c=d(e[a],e,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==t(f)&&o.call(f,"__await")?r.resolve(f.__await).then((function(t){n("next",t,u,s)}),(function(t){n("throw",t,u,s)})):r.resolve(f).then((function(t){l.value=t,u(l)}),(function(t){return n("throw",t,u,s)}))}s(c.arg)}var a;i(this,"_invoke",{value:function(t,e){function o(){return new r((function(r,a){n(t,e,r,a)}))}return a=a?a.then(o,o):o()}})}function L(t,r,n){var a=h;return function(o,i){if(a===y)throw Error("Generator is already running");if(a===m){if("throw"===o)throw i;return{value:e,done:!0}}for(n.method=o,n.arg=i;;){var u=n.delegate;if(u){var s=T(u,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===h)throw a=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=y;var c=d(t,r,n);if("normal"===c.type){if(a=n.done?m:v,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(a=m,n.method="throw",n.arg=c.arg)}}}function T(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,T(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=d(a,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var i=o.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function F(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function N(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var a=-1,i=function t(){for(;++a<r.length;)if(o.call(r,a))return t.value=r[a],t.done=!1,t;return t.value=e,t.done=!0,t};return i.next=i}}throw new TypeError(t(r)+" is not iterable")}return _.prototype=w,i(O,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:_,configurable:!0}),_.displayName=f(w,l,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,f(t,l,"GeneratorFunction")),t.prototype=Object.create(O),t},r.awrap=function(t){return{__await:t}},j(S.prototype),f(S.prototype,c,(function(){return this})),r.AsyncIterator=S,r.async=function(t,e,n,a,o){void 0===o&&(o=Promise);var i=new S(p(t,e,n,a),o);return r.isGeneratorFunction(e)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},j(O),f(O,l,"Generator"),f(O,s,(function(){return this})),f(O,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=N,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(F),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,a){return u.type="throw",u.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],u=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=o.call(i,"catchLoc"),c=o.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),F(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var a=n.arg;F(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:N(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},r}function o(t,e,r,n,a,o,i){try{var u=t[o](i),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,a)}function i(t){return function(){var e=this,r=arguments;return new Promise((function(n,a){var i=t.apply(e,r);function u(t){o(i,n,a,u,s,"next",t)}function s(t){o(i,n,a,u,s,"throw",t)}u(void 0)}))}}System.register(["./utils-lib-legacy.js?v=1734676359","./base-lib-legacy.js?v=1734676359","./useStore-legacy5.js?v=1734676359","./column-legacy.js?v=1734676359","./validator-legacy.js?v=1734676359"],(function(t,e){"use strict";var n,o,u,s,c,l,f,p,d,h,v,y,m,g,b,_,w,x,k,P,O,j,S,L,T,E,F,I,N,D,q,A,B,C,G,J,Y,z,M,W,H,X;return{setters:[function(t){n=t.u,o=t.l,u=t.H,s=t.G,c=t.o,l=t.M,f=t.ah,p=t.J,d=t.k,h=t.e},function(t){v=t.s,y=t.g,m=t.r,g=t.h,b=t.e,_=t.a_,w=t.c,x=t.k,k=t.l,P=t.q,O=t.p,j=t.v,S=t.y,L=t.x,T=t.I,E=t.aX,F=t.F,I=t.A},function(t){N=t.t,D=t.k,q=t.v,A=t.w,B=t.x,C=t.y,G=t.z,J=t.A,Y=t.B,z=t.C,M=t.D,W=t.E},function(t){H=t.u},function(t){X=t.p}],execute:function(){var $=y("FTP_LOGS_ANALYSIS",(function(){var t=m(),e=m({scanStatus:!1,autoScanText:"定时自动扫描",btn:"立即扫描",data:[]}),r=m({login_error:!0,time:!0,area:!0,anonymous:!0,upload_shell:!0,day:7,otherDay:1,user:"all",userList:[],cycle:1,channel:[],option:{},config:{login_error:5,time:{start_time:0,end_time:24},area:{country:[],city:[]},upload_shell:[],login_error_des:"超过5次",time_des:"0点至24点范围外",area_des:"非地区",upload_shell_des:"未配置"},search:"",status:!0}),n=m([]),a=m(null),o=m([]),i=m(),u=m(!1),s=m(),c=m([]);return{ftpAnalysisList:e,ftpScanTable:t,ruleForm:r,whiteTableData:o,ip:i,setScanInfo:a,addFtpInfo:m(),isAutoScan:s,userOptions:c,isLoading:u,areaOptions:n}})),K=t("u",(function(){return v($())})),Q=n().payment,R=K(),U=R.ftpAnalysisList,V=R.ruleForm,Z=R.whiteTableData,tt=R.ip,et=R.setScanInfo,rt=R.addFtpInfo,nt=R.isAutoScan,at=R.userOptions,ot=R.isLoading,it=R.areaOptions,ut=function(){var t=i(a().mark((function t(e){var r,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.ip,t.next=3,c({icon:"warning-filled",title:"IP封禁",content:"封禁【"+r+"】后，将不再允许此IP访问服务器，是否继续操作？"});case 3:return n=JSON.stringify({choose:"address",address:r,domain:"",types:"drop",brief:"FTP日志分析点击IP拉黑"}),t.next=6,s({loading:"正在封禁IP，请稍后...",request:q({data:n}),data:{status:Boolean},message:!0});case 6:t.sent.status&&ft();case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),st=function(){var t=i(a().mark((function t(e){var r,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.user,0!==(n=e.id)){t.next=4;break}return l.error("匿名用户不可删除"),t.abrupt("return",!1);case 4:return t.next=6,c({icon:"warning-filled",title:"删除FTP用户",content:"删除选中的FTP用户后，该FTP用户将彻底失去访问和操作权限，是否继续操作？"});case 6:return t.next=8,s({loading:"正在删除FTP用户，请稍后...",request:A({id:n,username:r}),data:{status:Boolean},message:!0});case 8:t.sent.status&&(ft(),refreshTableData());case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),ct=function(){var t=i(a().mark((function t(e){var r,n,o;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.user,0!==(n=e.id)){t.next=3;break}return t.abrupt("return",l.error("匿名用户不可停用"));case 3:return t.next=5,c({icon:"warning-filled",title:"停用FTP用户",content:"停用【"+r+"】后，该FTP用户将失去访问权限，是否继续操作？"});case 5:return t.next=7,s({loading:"正在停用FTP用户，请稍后...",request:B({id:n,username:r,status:0}),data:{status:Boolean},message:!0});case 7:null!=(o=t.sent)&&o.status&&(ft(),refreshTableData());case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),lt=function(){var t=i(a().mark((function t(e){var r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.ip,t.next=3,c({icon:"warning-filled",title:"忽略IP",content:"忽略【"+r+"】后，该IP将加入白名单中，FTP日志分析将不在记录该IP的数据，是否继续操作？"});case 3:return t.next=5,s({loading:"正在忽略IP，请稍后...",request:C({ip:r,type:"add"}),data:{status:Boolean},message:!0});case 5:t.sent.status&&ft();case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),ft=function(){var t=i(a().mark((function t(){var e,r,n,o,i=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=i.length>0&&void 0!==i[0]?i[0]:{search:V.value.search,day:"other"===V.value.day?Number(V.value.otherDay):Number(V.value.day),user:"all"===V.value.user?"[]":JSON.stringify(V.value.userList)},t.prev=1,t.next=4,G(e);case 4:if((r=t.sent).status)for(n in U.value.data=[],r.data)o=r.data[n],U.value.data.push({time:o.exec_time,type:o.type,user:o.user,ip:n,id:o.id});t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),f(t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(){return t.apply(this,arguments)}}(),pt=function(){U.value={scanStatus:!1,autoScanText:"定时自动扫描",btn:"立即扫描",data:[]},V.value={login_error:!0,time:!0,area:!0,anonymous:!0,upload_shell:!0,day:7,otherDay:1,user:"all",userList:[],cycle:1,channel:[],option:{},config:{login_error:5,time:{start_time:0,end_time:24},area:{country:[],city:[]},upload_shell:[],login_error_des:"超过5次",time_des:"0点至24点范围外",area_des:"非地区",upload_shell_des:"未配置"},search:"",status:!0}},dt=(t("r",g({login_error:[{validator:function(t,e,r){e>0?r():r("请输入大于0的整数")},trigger:["change"]}],se_time:[{validator:function(t,e,r){V.value.config.start_time&&V.value.config.end_time?r():r("开始时间和结束时间不能为空")},trigger:["blur"]}]})),t("s",(function(t){V.value.config.start_time=t})),t("e",(function(t){V.value.config.end_time=t})),function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V.value.config;return{time:JSON.stringify({start_time:Number(t.start_time.split(":")[0]),end_time:Number(t.end_time.split(":")[0])}),area:JSON.stringify({country:t.area.country,city:[]}),upload_shell:JSON.stringify(t.upload_shell_br.split("\n")),login_error:t.login_error}}),ht=(t("o",function(){var t=i(a().mark((function t(e){var r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,et.value.validate();case 2:return r=dt(),t.next=5,s({loading:"正在提交中数据，请稍候...",request:z(r),message:!0});case 5:t.sent.status&&(mt(),e&&e());case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),function(){var t=i(a().mark((function t(e){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s({loading:"正在删除白名单IP，请稍后...",request:C({ip:e,type:"del"}),data:{status:Boolean},message:!0});case 2:t.sent.status&&(vt(),ft());case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),vt=(t("w",[{label:"IP",render:function(t){return b("span",null,[t])}},H([{onClick:ht,title:"删除"}])]),t("a",i(a().mark((function t(){var e,r=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((e=r.length>0&&void 0!==r[0]?r[0]:{ip:tt.value,type:"add"}).ip){t.next=4;break}return l.error("请输入ip地址"),t.abrupt("return");case 4:if(/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/.test(e.ip)){t.next=7;break}return l.error("请输入正确的ip地址"),t.abrupt("return");case 7:return t.next=9,s({loading:"正在添加白名单IP，请稍后...",request:C(e),data:{status:Boolean},message:!0,success:function(t){t.status&&(tt.value="",vt(),ft())}});case 9:case"end":return t.stop()}}),t)})))),t("g",i(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s({loading:"正在获取白名单列表，请稍后...",request:J(),data:{ip:[Array,Z]}});case 2:case"end":return t.stop()}}),t)}))))),yt=(t("t",_({otherDay:[{validator:function(t,e,r){"other"===V.value.day&&(e<1||!Number.isInteger(parseFloat(e)))?r(new Error("天数必须大于0的整数")):r()},trigger:["change"]}],userList:[{validator:function(t,e,r){"other"===V.value.user&&0===e.length?r("请选择指定用户"):r()},trigger:["change"]}],risk:[{validator:function(t,e,r){V.value.login_error||V.value.time||V.value.area||V.value.anonymous||V.value.upload_shell?r():r("请至少选择一个安全风险")},trigger:["change"]}],cycle:[{required:!0,message:"请输入周期",trigger:"blur"},{validator:function(t,e,r){var n=Number(e);""===e?r(new Error("周期不能为空")):n<1?r(new Error("周期必须大于0")):r()},trigger:["input"]}],channel:[{type:"array",required:!0,message:"请至少选择一个告警方式",trigger:"change"}]})),function(t){var e=t.country,r=t.city,n=p(e)?e.join(","):"",a=p(r)?r.join(","):"";return"非".concat(n).concat(n&&a?",":"").concat(a,"地区")}),mt=function(){var t=i(a().mark((function t(){var e,n,o,i,u,s,c,l,d,h,v;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ot.value=!0,t.prev=1,t.next=4,M();case 4:e=t.sent,n=e.data,o=n.area,i=n.cron_task_status,u=n.time,s=n.login_error,c=n.upload_shell,l=n.cron_task,V.value.config=r(r({},n),{},{login_error_des:"超过".concat(s,"次"),time_des:"".concat(u.start_time,"点至").concat(u.end_time,"点范围外"),area_des:yt(o),upload_shell_des:p(c)?c.join(","):""}),nt.value&&i?(d=l.task_type,h=l.cycle,v=l.channel,Object.assign(V.value,{anonymous:d.anonymous,area:d.area,login_error:d.login_error,time:d.time,upload_shell:d.upload_shell,cycle:h,channel:v?v.split(","):[],status:!!i})):Object.assign(V.value,{anonymous:!0,area:!0,login_error:!0,time:!0,upload_shell:!0}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),f(t.t0);case 14:return t.prev=14,ot.value=!1,t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[1,11,14,17]])})));return function(){return t.apply(this,arguments)}}(),gt=(t("d",(function(){o({title:"扫描触发条件",area:[50,34],btn:["保存","取消"],component:function(){return u((function(){return e.import("./scan-legacy.js?v=1734676359")}),void 0,e.meta.url)}})})),t("j",(function(t){V.value.user=t,"other"===t&&(V.value.anonymous=!1)})),function(){var t=i(a().mark((function t(){var e,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,W();case 3:e=t.sent,r=e.data,p(r)&&(at.value=[],r.forEach((function(t){at.value.push({label:t,value:t})})),V.value.userList=r.length>0?[r[0]]:[]),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}}()),bt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V.value,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nt.value,r=JSON.stringify({anonymous:t.anonymous,area:t.area,login_error:t.login_error,time:t.time,upload_shell:t.upload_shell});return e?{task_type:r,cycle:t.cycle,channel:t.channel.join(","),status:t.status?1:0}:{search:r,day:"other"===t.day?Number(t.otherDay):t.day,username:"all"===t.user?"[]":JSON.stringify(t.userList)}},_t=(t("c",function(){var t=i(a().mark((function t(e){var r,n,o,i,u,s,c;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,rt.value.validate();case 2:if(t.prev=2,r=l.load("扫描中..."),n=bt(),V.value.search=(null==n?void 0:n.search)||(null==n?void 0:n.task_type),nt.value){t.next=14;break}return t.next=9,G(n);case 9:if(o=t.sent,l.request({status:o.status,msg:o.status?"扫描成功":"扫描失败",time:500}),o.status){for(i in U.value.data=[],o.data)u=o.data[i],U.value.data.push({time:u.exec_time,type:u.type,user:u.user,ip:i,id:u.id}),U.value.data.sort((function(t,e){var r,n;return new Date(null===(r=e.time)||void 0===r?void 0:r.replace(/-/g,"/")).getTime()-new Date(null===(n=t.time)||void 0===n?void 0:n.replace(/-/g,"/")).getTime()}));U.value.btn="重新扫描",U.value.scanStatus=!0,e()}t.next=20;break;case 14:return t.next=16,Y(n);case 16:s=t.sent,l.request(s),s.status&&mt(),e();case 20:t.next=25;break;case 22:t.prev=22,t.t0=t.catch(2),f(t.t0);case 25:return t.prev=25,null===(c=r)||void 0===c||c.close(),t.finish(25);case 28:case"end":return t.stop()}}),t,null,[[2,22,25,28]])})));return function(e){return t.apply(this,arguments)}}()),t("b",(function(){V.value.config={login_error:5,time:{start_time:0,end_time:24},area:{country:[],city:[]},upload_shell:[],login_error_des:"超过5次",time_des:"0点至24点范围外",area_des:"非地区",upload_shell_des:"未配置"},gt(),mt()})),t("i",(function(){var t=V.value.config;Object.assign(V.value.config,r(r({},t),{},{start_time:t.time.start_time<10?"0".concat(t.time.start_time,":00"):"".concat(t.time.start_time,":00"),end_time:t.time.end_time<10?"0".concat(t.time.end_time,":00"):"".concat(t.time.end_time,":00"),upload_shell_br:t.upload_shell.join("\n")})),it.value=["美国","中国","印度","日本","德国","英国","法国","俄罗斯","巴西","加拿大","意大利","澳大利亚","韩国","墨西哥","印度尼西亚","沙特阿拉伯","南非","阿根廷","土耳其","西班牙"].map((function(t){return{label:t,value:t}}))})),[{label:"类型",prop:"type",minWidth:100},{label:"用户名",prop:"user",minWidth:60},{label:"IP",prop:"ip"},{label:"操作时间",prop:"time"},H([{onClick:ut,title:"IP拉黑",width:50},{onClick:st,title:"删除账号",width:60},{onClick:ct,title:"停用账号",width:60},{onClick:lt,title:"忽略"}])]),wt=function(){return o({title:"FTP日志白名单",area:[70,45],component:function(){return u((function(){return e.import("./whitelist-legacy.js?v=1734676359")}),void 0,e.meta.url)}})},xt=function(t){o({title:"FTP日志".concat(t?"分析条件":"自动分析推送"),area:t?[66,30]:[70],btn:t?"立即扫描":"保存配置",component:function(){return u((function(){return e.import("./timed-scan-legacy.js?v=1734676359")}),void 0,e.meta.url)}})},kt=function(){var t=i(a().mark((function t(e){var r,n,o,i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(nt.value=!Boolean(e),"ltd"!==Q.value.authType){t.next=17;break}return t.next=4,s({loading:"正在获取日志服务状态，请稍后...",request:N({exec_name:"getlog"}),data:{status:Boolean,msg:String}});case 4:if(r=t.sent,n=r.status,o=r.msg,n&&"stop"!==o){t.next=14;break}return t.next=10,c({icon:"warning-filled",title:"开启FTP日志服务",content:"FTP日志服务未启动，无法记录访问日志，是否启动日志服务?"});case 10:return t.next=12,s({loading:"正在开启FTP日志服务，请稍后...",request:N({exec_name:"start"}),data:{status:Boolean},message:!0});case 12:null!=(i=t.sent)&&i.status&&xt(e);case 14:xt(e),t.next=20;break;case 17:return l.error("企业版专享功能！"),t.next=20,X({sourceId:D.value?260:220});case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Pt=[{icon:"user",title:"多次登录失败"},{icon:"login-address",title:"登录地区异常"},{icon:"shell-file",title:"上传脚本文件"},{icon:"anonymous",title:"匿名用户登录"},{icon:"login-time",title:"登录时间异常"}],Ot=(t("f",[{label:"7天",value:7},{label:"30天",value:30},{label:"自定义",value:"other"}]),t("h",[{label:"全部",value:"all"},{label:"指定用户",value:"other"}]),{class:"ftp-log-scan"}),jt={class:"scan-header"},St={class:"scan-header-left"},Lt={class:"scan-header-title"},Tt={key:0},Et={key:1},Ft={class:"scan-content"},It={key:0,class:"scan-content-preview"},Nt={class:"scan-content-preview-list"},Dt={class:"text-[1.2rem]"},qt={key:1},At=w({__name:"index",setup:function(t,e){var r=e.expose,n=K(),a=n.ftpAnalysisList,o=n.ftpScanTable;return r(pt),function(t,e){var r=I,n=d;return x(),k("div",Ot,[P("div",jt,[P("div",St,[e[4]||(e[4]=P("i",{class:"svgtofont-icon-ftp-log !text-[5.4rem] text-[#888] mr-16px"},null,-1)),P("div",Lt,[O(a).scanStatus?(x(),k("div",Et," 扫描完成，"+j(O(a).data.length?"共扫描出"+O(a).data.length+"条风险记录":"未扫描出风险记录"),1)):(x(),k("div",Tt," FTP日志扫描，快速扫描当前FTP的安全详情 ")),P("p",null,[e[2]||(e[2]=S(" 推荐定期自动扫描功能，定期扫描生成分析结果并发送通知【 ")),P("span",{class:"bt-link",onClick:e[0]||(e[0]=function(t){return O(kt)(0)})},j(O(a).autoScanText),1),e[3]||(e[3]=S(" 】 "))])])]),b(r,{class:"scan-header-btn",type:"primary",title:O(a).btn,onClick:e[1]||(e[1]=function(t){return O(kt)(1)})},{default:L((function(){return[S(j(O(a).btn),1)]})),_:1},8,["title"])]),P("div",Ft,[O(a).scanStatus?(x(),k("div",qt,[b(r,{class:"!mb-[1rem]",onClick:O(wt)},{default:L((function(){return e[6]||(e[6]=[S(" 白名单 ")])})),_:1},8,["onClick"]),b(n,{ref_key:"ftpScanTable",ref:o,"max-height":"310",column:O(_t),data:O(a).data,description:"扫描列表为空"},null,8,["column","data"])])):(x(),k("div",It,[e[5]||(e[5]=P("div",null,"支持以下FTP日志安全风险扫描：",-1)),P("div",Nt,[(x(!0),k(T,null,E(O(Pt),(function(t,e){return x(),k("div",{class:"preview-list-item",key:e},[P("i",{class:F("svgtofont-icon-".concat(t.icon," text-2rem mr-4px text-[#888]"))},null,2),P("span",Dt,j(t.title),1)])})),128))])]))])])}}}),Bt=h(At,[["__scopeId","data-v-8e79f7ef"]]),Ct=Object.freeze(Object.defineProperty({__proto__:null,default:Bt},Symbol.toStringTag,{value:"Module"}));t("k",Ct)}}}))}();
