import{G as e,u as a,H as s,aa as t}from"./utils-lib.js?v=1734676359";import{_ as n}from"./index100.js?v=1734676359";import{i,j as l}from"./firewall.js?v=1734676359";import{c as r,R as o,a_ as u,w as m,B as d,C as p,p as c,k as w,l as _,q as v,e as g,y as b,F as f,v as h,aj as x,r as j,W as y,o as I,M as V,J as E}from"./base-lib.js?v=1734676359";import{c as P}from"./useMethod4.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./validator.js?v=1734676359";import"./index91.js?v=1734676359";import"./column.js?v=1734676359";import"./useStore4.js?v=1734676359";const R={class:"tab-header-operate"},S=r({__name:"index",props:{data:{default:{isIntrusion:!1,num:0,days:0}}},emits:["refresh"],setup(a,{emit:s}){const t=a,n=s,l=o(!1),r=u({isIntrusion:!1,num:0,days:0}),j=async a=>{await e({loading:"正在"+(a?"开启":"关闭")+"入侵防御，请稍后...",request:i(a),message:!0}),n("refresh")};return m((()=>t.data),(e=>{r.isIntrusion=e.open,r.num=e.totla_times,r.days=e.totla_days}),{immediate:!0}),(e,a)=>{const s=x,t=d("bt-loading");return p((w(),_("div",R,[a[2]||(a[2]=v("div",{class:"mr-4"},"入侵防御开关",-1)),v("div",null,[g(s,{modelValue:c(r).isIntrusion,"onUpdate:modelValue":a[0]||(a[0]=e=>c(r).isIntrusion=e),width:36,onChange:j},null,8,["modelValue"])]),a[3]||(a[3]=v("div",{class:"bg-[#ccc] w-[1px] h-2rem mx-16px"},null,-1)),v("div",null,[a[1]||(a[1]=b(" 总拦截次数: ")),v("span",{class:f(c(r).num>0?"text-danger":"")},h(c(r).num),3)]),a[4]||(a[4]=v("div",{class:"bg-[#ccc] w-[1px] h-2rem mx-16px"},null,-1)),v("div",null,"保护天数: "+h(c(r).days),1)])),[[t,c(l)]])}}}),D={key:0,class:"flex flex-col"},L=r({__name:"index",setup(i){a();const r=o("overview"),m=j(),d=o({}),p=u({title:"入侵防御-功能介绍",ps:"原防提权, 防御大多数的入侵提权攻击造成的挂马和被挖矿,有效拦截webshell执行提权,并及时告警通知",source:105,desc:["违规词内容检测","网页内容修改检测","输出检测报告"],tabImgs:[{title:"概览",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/intrusion_1.png"},{title:"进程白名单",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/intrusion_2.png"},{title:"操作日志",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/intrusion_3.png"}],isInstall:!1,productSrc:"https://www.bt.cn/bbs/thread-50998-1-1.html",pluginInfo:{}}),v=[{label:"概览",name:"overview",render:()=>s((()=>import("./index247.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)},{label:"进程白名单",name:"white",render:()=>s((()=>import("./index248.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)},{label:"操作日志",name:"operationLog",render:()=>s((()=>import("./index249.js?v=1734676359")),__vite__mapDeps([]),import.meta.url)}],b=e=>{"overview"===e&&f()},f=async()=>{const{data:a}=await e({loading:"正在获取入侵防御配置信息，请稍后...",request:l()});m.value=a};return y("infoData",m),y("getIntrusionInfo",f),I((async()=>{d.value=await P("bt_security"),p.pluginInfo=d.value,d.value.setup&&d.value.endtime>-1&&f()})),(e,a)=>{var s;const i=t,l=n;return w(),_("div",null,[(null==(s=c(d))?void 0:s.setup)&&c(d).endtime>-1?(w(),_("div",D,[g(S,{data:c(m),onRefresh:f},null,8,["data"]),g(i,{type:"card",modelValue:c(r),"onUpdate:modelValue":a[0]||(a[0]=e=>V(r)?r.value=e:null),options:v,onChange:b},null,8,["modelValue"])])):(w(),E(l,{key:1,data:c(p),class:"px-[20%] my-[8rem]"},null,8,["data"]))])}}});export{L as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
