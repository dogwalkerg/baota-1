import{c as e,i as a,e as l,C as s,B as t,y as o,A as r,r as i,o as d,k as n,l as u,x as m,q as p,p as c,aw as f,M as v,v as y,D as b,I as x,aX as _,J as V,F as g,N as h,z as j,a7 as w,ae as A,aN as C,ad as k,ag as U,ah as S,at as M,av as N,P as I,a4 as E}from"./base-lib.js?v=1734676359";import{D as H,aO as D,bR as O,M as z,aM as R,j as B,U as F,h as T,O as q,e as J}from"./utils-lib.js?v=1734676359";import{n as L}from"./form-item.js?v=1734676359";import{_ as P}from"./input-popover.vue_vue_type_script_setup_true_lang.js?v=1734676359";import{f as G,g as K,h as Q,j as X,k as W,n as Y,p as Z,q as $,v as ee,w as ae,x as le,y as se,z as te,A as oe,B as re,D as ie,E as de,F as ne,G as ue,H as me,I as pe,J as ce,K as fe,L as ve,M as ye,N as be,O as xe,P as _e,Q as Ve}from"./useController7.js?v=1734676359";import{u as ge,S as he}from"./useStore11.js?v=1734676359";import{applyBusSsl as je}from"./site.js?v=1734676359";import{g as we}from"./useStore10.js?v=1734676359";import{c as Ae}from"./index67.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";import"./index90.js?v=1734676359";import"./column.js?v=1734676359";import"./useStore7.js?v=1734676359";import"./useController3.js?v=1734676359";import"./validator.js?v=1734676359";import"./useStore9.js?v=1734676359";import"./useMethod5.js?v=1734676359";import"./index182.js?v=1734676359";import"./ssl.js?v=1734676359";import"./useMethod6.js?v=1734676359";import"./index124.js?v=1734676359";import"./index107.js?v=1734676359";import"./index.vue_vue_type_style_index_0_scoped_03ce946a_lang.js?v=1734676359";const Ce={class:"px-3rem py-1.2rem"},ke={class:"flex flex-col"},Ue={class:"!p-[12px] bg-[#20a53a] text-white"},Se={class:"mr-[2px]"},Me=["onClick"],Ne={key:1,class:"!caret-medium inline-flex items-center"},Ie={class:"flex justify-between"},Ee={class:"flex flex-col p-[20px] error"},He={class:"p-[20px]"},De={class:"mb-[8px] border-light"},Oe={class:"p-[20px]"},ze=J(e({__name:"index",setup(e){const{orderInfo:J,sslDnsApiInfo:ze,sslApplicationInfo:Re}=ge(),{verifyBusCertEvent:Be,getCertAdminInfoEvent:Fe}=he(),{refs:{isRefreshCertificateList:Te}}=we(),{BtForm:qe,param:Je}=H({data:G.value,options:e=>a((()=>[{type:"custom",render:()=>l(D,{label:"证书信息"},{default:()=>[l("span",{class:"text-primary"},[l("span",null,[J.value.title]),s(l("span",null,[o("，包含"),J.value.limit,o("个域名")]),[[t("if"),J.value.limit>1]])])]})},{type:"slots",key:"domains",rules:{domains:[O({message:"域名不能为空"})]}},{type:"slots",key:"sslVerifyType"},..."CNAME_CSR_HASH"===K.value?[{type:"slots",key:"dnsVerify"}]:[],L(Q,"证书用户信息"),...Q.value?[{type:"custom",render:()=>l(D,{label:"所在地区"},{default:()=>[l("div",{class:"flex flex-row"},[l(P,{"custom-class":"mr-[16px] !w-[20rem]",modelValue:e.value.Administrator.state,"onUpdate:modelValue":a=>e.value.Administrator.state=a,"placeholder-tips":"请输入所在省份，必填项"},null),l(P,{"custom-class":"!w-[20rem]",modelValue:e.value.Administrator.city,"onUpdate:modelValue":a=>e.value.Administrator.city=a,"placeholder-tips":"请输入所在市/县，必填项"},null)])]})},..."dv"!==J.value.type?[{type:"custom",render:()=>l(D,{label:"公司详细地址"},{default:()=>[l(P,{"custom-class":"!w-[42rem]",modelValue:e.value.Administrator.address,"onUpdate:modelValue":a=>e.value.Administrator.address=a,"placeholder-tips":"请输入公司详细地址，具体要求见说明，必填项"},null)]})}]:[],{type:"custom",render:()=>l(D,{label:"公司名称"},{default:()=>[l(P,{"custom-class":"!w-[42rem]",modelValue:e.value.Administrator.organation,"onUpdate:modelValue":a=>e.value.Administrator.organation=a,"placeholder-tips":"请输入公司名称，如为个人申请请输入个人姓名，必填项"},null)]})},{type:"custom",render:()=>l(D,{label:"姓名"},{default:()=>[l(P,{"custom-class":"!w-[42rem]",modelValue:e.value.Administrator.name,"onUpdate:modelValue":a=>e.value.Administrator.name=a,"placeholder-tips":"请输入姓名，必填项"},null)]})},{type:"custom",render:()=>l(D,{label:"邮箱"},{default:()=>[l(P,{"custom-class":"!w-[42rem]",modelValue:e.value.Administrator.email,"onUpdate:modelValue":a=>e.value.Administrator.email=a,"placeholder-tips":"请输入邮箱地址，必填项"},null)]})},{type:"custom",render:()=>l(D,{label:"手机"},{default:()=>[l(P,{"custom-class":"!w-[42rem]",modelValue:e.value.Administrator.mobile,"onUpdate:modelValue":a=>e.value.Administrator.mobile=a,"placeholder-tips":"请输入手机号码，若为空，则使用当前绑定手机号"},null)]})}]:[],{type:"custom",render:()=>l(D,{label:" "},{default:()=>[l(r,{type:"primary",onClick:Pe},{default:()=>[o("提交资料")]})]})},{type:"help",options:X.value}]))}),Le=i(!1),Pe=async()=>{var e;let a=null;if(!G.value.domains)return z.error("域名不能为空");if(!G.value.Administrator.state&&!G.value.Administrator.city)return z.error("所在地区不能为空");if(!G.value.Administrator.address&&"dv"!==J.value.type)return z.error("公司详细地址不能为空");if(!G.value.Administrator.organation)return z.error("公司名称不能为空");if(!G.value.Administrator.name)return z.error("姓名不能为空");if(!G.value.Administrator.email)return z.error("邮箱不能为空");if(!G.value.Administrator.mobile)return z.error("手机不能为空");try{a=z.load("正在提交证书信息，请稍后...");const{job:l,postCode:s,country:t,firstName:o,lastName:r,name:i,state:d,city:n,address:u,organation:m,email:p,mobile:c}=G.value.Administrator,f=await je(JSON.stringify({pid:J.value.pid,oid:J.value.oid,domains:null==(e=G.value.domains)?void 0:e.split("\n").filter((e=>e.trim())),dcvMethod:K.value,auth_to:W.value,Administrator:{job:l,postCode:s,country:t,lastName:i,state:d,city:n,address:u,organation:m,email:p,mobile:c}}));if(R(f.data.msg)&&f.data.msg.hasOwnProperty("code")){let e=f.data.errors;Y.value=[],Object.keys(e).forEach((a=>{e[a].forEach(((e,l)=>{Y.value.push({field:a,error:e})}))})),Z.value=!0}else{let e=f.msg||f.data.msg,a=f.data.status;z.request(f.data||{msg:a?e||"提交成功":e||"资料提交错误，请检查管理员信息是否填写正确，如填写错误请联系客服重置订单",status:a})}f.data.status&&(Te.value=!0,Ae(J.value.oid))}catch(l){}finally{a&&a.close()}};return d((async()=>{const e=await Fe();Re.value={...Re.value,...e.data},$(),ee()})),(e,a)=>{const t=w,i=A,d=C,H=k,O=U,R=S,J=M,L=N,P=T,G=I,Q=q,X=E;return n(),u("div",Ce,[l(c(qe),{"label-width":"80px"},{domains:m((()=>[l(t,{label:"域名",prop:"domains"},{default:m((()=>[p("div",ke,[l(c(f),{ref:"popover",placement:"top-start","popper-class":"green-tips-popover",title:"",width:"200",disabled:!c(ae),visible:c(Le),"onUpdate:visible":a[2]||(a[2]=e=>v(Le)?Le.value=e:null),"trigger-keys":[],trigger:"focus"},{reference:m((()=>[l(c(B),{modelValue:c(Je).domains,"onUpdate:modelValue":a[0]||(a[0]=e=>c(Je).domains=e),disabled:!c(ae),width:"42rem",resize:"none",rows:3,class:"disabled-input",type:c(ae)?"textarea":"text",onFocus:a[1]||(a[1]=e=>Le.value=!0),placeholder:c(le)},null,8,["modelValue","disabled","type","placeholder"])])),default:m((()=>[p("div",Ue,y(c(le)),1)])),_:1},8,["disabled","visible"]),s(p("div",null,[l(c(r),{size:"small",type:"primary",onClick:c(se)},{default:m((()=>a[13]||(a[13]=[o("选择已有域名")]))),_:1},8,["onClick"]),l(c(r),{size:"small",type:"default",onClick:c(te)},{default:m((()=>a[14]||(a[14]=[o("自定义域名")]))),_:1},8,["onClick"])],512),[[b,!c(ae)]])])])),_:1})])),sslVerifyType:m((()=>[l(c(D),{label:"验证方式"},{default:m((()=>[l(H,{class:"!leading-[2.4rem]",modelValue:c(K),"onUpdate:modelValue":a[3]||(a[3]=e=>v(K)?K.value=e:null)},{default:m((()=>[(n(!0),u(x,null,_(c(oe),(e=>(n(),u(x,{key:e.value},[c(re)&&"CNAME_CSR_HASH"===e.value||!c(re)?(n(),V(d,{key:e.value,effect:"dark",content:e.tips,placement:"top-start",enterable:!1},{default:m((()=>[l(i,{value:e.value},{default:m((()=>[p("span",Se,y(e.label),1),""!==e.isCheck?(n(),u("span",{key:0,class:g(["cursor-pointer",e.isCheck?"!text-primary":"!text-danger"]),onClick:h((a=>(e=>{z.msg({customClass:"el-error-html-message",dangerouslyUseHTMLString:!0,message:e.join("<br>"),type:"error"})})(e.checkTips)),["stop"])}," ["+y(e.isCheck?"正常":"异常")+"] ",11,Me)):j("",!0),c(ie)?(n(),u("span",Ne,a[15]||(a[15]=[o(" [ "),p("i",{class:"svgtofont-el-loading mx-[2px]"},null,-1),p("span",{class:"align-middle"},"检测中",-1),o(" ] ")]))):j("",!0)])),_:2},1032,["value"])])),_:2},1032,["content"])):j("",!0)],64)))),128))])),_:1},8,["modelValue"])])),_:1})])),dnsVerify:m((()=>[l(c(D),{label:"选择DNS接口"},{default:m((()=>[l(R,{class:"mr-[16px] !w-[16rem]",modelValue:c(W),"onUpdate:modelValue":a[4]||(a[4]=e=>v(W)?W.value=e:null),placeholder:"请选择",onChange:a[5]||(a[5]=e=>c(de)(!0))},{default:m((()=>[(n(!0),u(x,null,_(c(ze),(e=>(n(),V(O,{key:e.value,label:e.label,value:e.value},{default:m((()=>[p("span",Ie,[p("span",null,y(e.label),1),s(p("span",{class:g(e.data?"text-primary":"text-orange")},y(e.data?"[已配置]":"[未配置]"),3),[[b,e.config]])])])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"]),s(l(c(r),{class:"ml-[8px]",type:"default",onClick:a[6]||(a[6]=e=>c(de)(!1))},{default:m((()=>a[16]||(a[16]=[o("配置")]))),_:1},512),[[b,"dns"!==c(W)]])])),_:1})])),_:1}),l(P,{modelValue:c(Z),"onUpdate:modelValue":a[7]||(a[7]=e=>v(Z)?Z.value=e:null),area:50},{default:m((()=>[p("div",Ee,[a[17]||(a[17]=p("span",{class:"flex items-center mb-[12px]"},[p("i",{class:"svgtofont-el-warning text-warning text-[4rem] mr-[4px]"}),p("span",{class:"text-[1.6rem]"},"当前提交信息存在以下问题，请解决后重新提交！")],-1)),l(L,{data:c(Y),border:""},{default:m((()=>[l(J,{prop:"field",label:"错误字段"}),l(J,{prop:"error",label:"错误信息"})])),_:1},8,["data"])])])),_:1},8,["modelValue"]),l(P,{title:"选择域名",modelValue:c(fe),"onUpdate:modelValue":a[10]||(a[10]=e=>v(fe)?fe.value=e:null),area:57,"show-footer":!0,onConfirm:c(ve)},{default:m((()=>[p("div",He,[l(G,{class:"!w-[53rem] mb-[16px]",modelValue:c(ne),"onUpdate:modelValue":a[8]||(a[8]=e=>v(ne)?ne.value=e:null),placeholder:"支持字段模糊搜索",onInput:c(ue),clearable:""},null,8,["modelValue","onInput"]),p("div",De,[a[18]||(a[18]=p("div",{class:"flex justify-between items-center bg-[#f6f6f6] py-[1rem] pl-[1rem]"},"域名",-1)),l(c(F),{modelValue:c(me),"onUpdate:modelValue":a[9]||(a[9]=e=>v(me)?me.value=e:null),options:c(pe),class:"custom-radio-group whitespace-nowrap py-[2px] w-full"},null,8,["modelValue","options"])]),l(Q,{options:c(ce),class:"ml-[20px]"},null,8,["options"])])])),_:1},8,["modelValue","onConfirm"]),l(P,{title:"自定义域名",modelValue:c(_e),"onUpdate:modelValue":a[12]||(a[12]=e=>v(_e)?_e.value=e:null),area:57,"show-footer":!0,onConfirm:c(Ve)},{default:m((()=>[p("div",Oe,[l(X,{class:"mb-[16px]",ref_key:"customDomainRef",ref:ye,model:c(be),rules:c(xe)},{default:m((()=>[l(t,{label:"自定义域名",prop:"domain"},{default:m((()=>[l(G,{autofocus:"",class:"!w-[40rem] mb-[8px]",modelValue:c(be).domain,"onUpdate:modelValue":a[11]||(a[11]=e=>c(be).domain=e),placeholder:"请输入需要申请证书的域名（单域名证书），必填项，例如：www.bt.cn"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"]),l(Q,{options:c(ce),class:"ml-[20px]"},null,8,["options"])])])),_:1},8,["modelValue","onConfirm"])])}}}),[["__scopeId","data-v-4c0b56c3"]]);export{ze as default};
