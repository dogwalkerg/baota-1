!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}var e=["limit"];function r(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(e,r,n){return(r=function(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,r||"default");if("object"!=t(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function i(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */i=function(){return r};var e,r={},n=Object.prototype,a=n.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},u="function"==typeof Symbol?Symbol:{},c=u.iterator||"@@iterator",s=u.asyncIterator||"@@asyncIterator",l=u.toStringTag||"@@toStringTag";function p(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{p({},"")}catch(e){p=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var a=e&&e.prototype instanceof b?e:b,u=Object.create(a.prototype),i=new A(n||[]);return o(u,"_invoke",{value:E(t,r,i)}),u}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}r.wrap=f;var v="suspendedStart",g="suspendedYield",y="executing",m="completed",d={};function b(){}function w(){}function x(){}var L={};p(L,c,(function(){return this}));var O=Object.getPrototypeOf,S=O&&O(O(C([])));S&&S!==n&&a.call(S,c)&&(L=S);var j=x.prototype=b.prototype=Object.create(L);function k(t){["next","throw","return"].forEach((function(e){p(t,e,(function(t){return this._invoke(e,t)}))}))}function P(e,r){function n(o,u,i,c){var s=h(e[o],e,u);if("throw"!==s.type){var l=s.arg,p=l.value;return p&&"object"==t(p)&&a.call(p,"__await")?r.resolve(p.__await).then((function(t){n("next",t,i,c)}),(function(t){n("throw",t,i,c)})):r.resolve(p).then((function(t){l.value=t,i(l)}),(function(t){return n("throw",t,i,c)}))}c(s.arg)}var u;o(this,"_invoke",{value:function(t,e){function a(){return new r((function(r,a){n(t,e,r,a)}))}return u=u?u.then(a,a):a()}})}function E(t,r,n){var a=v;return function(o,u){if(a===y)throw Error("Generator is already running");if(a===m){if("throw"===o)throw u;return{value:e,done:!0}}for(n.method=o,n.arg=u;;){var i=n.delegate;if(i){var c=_(i,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===v)throw a=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=y;var s=h(t,r,n);if("normal"===s.type){if(a=n.done?m:g,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(a=m,n.method="throw",n.arg=s.arg)}}}function _(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,_(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=h(a,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,d;var u=o.arg;return u?u.done?(r[t.resultName]=u.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,d):u:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function D(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(D,this),this.reset(!0)}function C(r){if(r||""===r){var n=r[c];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,u=function t(){for(;++o<r.length;)if(a.call(r,o))return t.value=r[o],t.done=!1,t;return t.value=e,t.done=!0,t};return u.next=u}}throw new TypeError(t(r)+" is not iterable")}return w.prototype=x,o(j,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=p(x,l,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,p(t,l,"GeneratorFunction")),t.prototype=Object.create(j),t},r.awrap=function(t){return{__await:t}},k(P.prototype),p(P.prototype,s,(function(){return this})),r.AsyncIterator=P,r.async=function(t,e,n,a,o){void 0===o&&(o=Promise);var u=new P(f(t,e,n,a),o);return r.isGeneratorFunction(e)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},k(j),p(j,l,"Generator"),p(j,c,(function(){return this})),p(j,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=C,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,a){return i.type="throw",i.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var u=this.tryEntries[o],i=u.completion;if("root"===u.tryLoc)return n("end");if(u.tryLoc<=this.prev){var c=a.call(u,"catchLoc"),s=a.call(u,"finallyLoc");if(c&&s){if(this.prev<u.catchLoc)return n(u.catchLoc,!0);if(this.prev<u.finallyLoc)return n(u.finallyLoc)}else if(c){if(this.prev<u.catchLoc)return n(u.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<u.finallyLoc)return n(u.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var u=o?o.completion:{};return u.type=t,u.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(u)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var a=n.arg;T(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),d}},r}function c(t,e,r,n,a,o,u){try{var i=t[o](u),c=i.value}catch(t){return void r(t)}i.done?e(c):Promise.resolve(c).then(n,a)}function s(t){return function(){var e=this,r=arguments;return new Promise((function(n,a){var o=t.apply(e,r);function u(t){c(o,n,a,u,i,"next",t)}function i(t){c(o,n,a,u,i,"throw",t)}u(void 0)}))}}System.register(["./utils-lib-legacy.js?v=1734676359","./index-legacy277.js?v=1734676359","./index-legacy90.js?v=1734676359","./base-lib-legacy.js?v=1734676359","./useStore-legacy6.js?v=1734676359"],(function(t,n){"use strict";var a,u,c,l,p,f,h,v,g,y,m,d,b,w,x,L,O,S,j,k,P,E,_,D,T,A,C,q,N,I,F,G,R,B,U,M,H,V,Y,J;return{setters:[function(t){a=t.G,u=t.M,c=t.a7,l=t.u,p=t.o,f=t.l,h=t.H,v=t.b,g=t.bJ,y=t.an,m=t.h,d=t.e},function(t){b=t._},function(t){w=t._},function(t){x=t.g,L=t.s,O=t.r,S=t.h,j=t.R,k=t.e,P=t.c,E=t.k,_=t.l,D=t.x,T=t.p,A=t.y,C=t.F,q=t.q,N=t.v,I=t.M,F=t.A},function(t){G=t.J,R=t.K,B=t.M,U=t.N,M=t.O,H=t.P,V=t.Q,Y=t.R,J=t.L}],execute:function(){var Q=t("L",x("LOG-ANALYSE-STORE",(function(){var t=O(!1),e=O({type:"logs",name:""}),r=O([]),n=O({status:!1,channel:"",cycle:0,path:""}),o=O({}),l=O(""),p=O(!1),f=O(!1),h=O(0),v=S({p:1,row:10,path:""}),g=function(){var t=s(i().mark((function t(){var r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a({loading:p,request:G({siteName:e.value.name}),data:{log_file:String,status:Boolean,msg:String},success:function(t){l.value=t.log_file,v.path=t.log_file,t.status||u.error(t.msg)}});case 3:return r=t.sent,t.abrupt("return",{data:r.log_file,status:r.status,msg:r.msg});case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",{data:"",status:!1,msg:"获取日志路径失败"});case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}(),y=function(){var t=s(i().mark((function t(e){var r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a({loading:p,request:R(e),data:{data:Array,page:String}});case 3:return r=t.sent,t.abrupt("return",{data:r.data,total:c(r.page)});case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",{data:[],total:0,other:{}});case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),m=function(){var t=s(i().mark((function t(){var e,r,n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a({loading:p,request:B({path:l.value}),data:{status:Boolean,msg:String}});case 3:return e=t.sent,r=e.status,n=e.msg,t.abrupt("return",{status:r,msg:n});case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",{status:!1,msg:"扫描失败"});case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(){return t.apply(this,arguments)}}(),d=function(){var e=s(i().mark((function e(r){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f.value=!0,n=setInterval(s(i().mark((function e(){var a,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U({path:l.value});case 2:a=e.sent,o=a.data,h.value=o.msg,100===o.msg&&(clearInterval(n),f.value=!1,u.success("扫描完成"),t.value=!0,r&&r());case 6:case"end":return e.stop()}}),e)}))),1e3);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var t=s(i().mark((function t(){var e,r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a({request:M({path:l.value}),success:function(t){var e=t.data;n.value=e,k.give=e.channel?e.channel.split(","):[],k.status=1==e.status,k.cycle=e.cycle}});case 3:return e=t.sent,r=e.data,t.abrupt("return",{data:{give:r.channel,status:1==r.status,cycle:r.cycle},status:!0,msg:"获取扫描数据成功"});case 8:return t.prev=8,t.t0=t.catch(0),t.abrupt("return",{status:!1,msg:"获取扫描数据失败"});case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}}(),w=function(){var t=s(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a({loading:"正在清空日志，请稍后...",request:H({path:l.value}),message:!0});case 3:return t.abrupt("return",{status:!0,msg:"清空日志成功"});case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",{status:!1,msg:"清空日志失败"});case 10:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(){return t.apply(this,arguments)}}(),x=O(),L=function(){var t=s(i().mark((function t(){var r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,V({path:"/www/wwwlogs/"+e.value.name+".log",type:o.value.type,time:o.value.start_time});case 3:return r=t.sent,t.abrupt("return",{data:r.data.msg||[],status:r.status,msg:"获取详情数据成功"});case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",{data:[],status:!1,msg:"获取详情数据失败"});case 11:return t.prev=11,t.finish(11);case 13:case"end":return t.stop()}}),t,null,[[0,7,11,13]])})));return function(){return t.apply(this,arguments)}}(),j=O(),k=S({give:n.value.channel,status:Boolean(n.value.status),cycle:1}),P=function(){var t=s(i().mark((function t(e){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a({loading:"正在设置定期扫描,请稍候...",request:Y(e),data:{msg:String},message:!0});case 3:return t.abrupt("return",{status:!0,msg:"设置定期扫描成功"});case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",{status:!1,msg:"设置定期扫描失败"});case 10:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}();return{isRefreshList:t,routeData:e,logPath:l,msgForm:k,scanData:n,tableData:r,tableParam:v,loading:p,processPopup:f,percentum:h,rowData:o,getLogsTableData:y,logScanEvent:m,delAllLogDataEvent:w,tableColumn:x,getDetailData:L,logScanForm:j,onConfirmScanConfig:P,getLogsPath:g,getScanData:b,startScanTimer:d}}))),W=(t("u",(function(){return L(Q())})),v());l();var K=[["xss","XSS"],["sql","SQL"],["san","扫描"],["php","PHP攻击"],["ip","IP(top100)"],["url","URL(top100)"]],X=Q(),$=L(X),z=$.routeData,Z=$.logPath,tt=$.rowData,et=$.msgForm,rt=$.isRefreshList,nt=Q(),at=nt.getLogsPath,ot=nt.getLogsTableData,ut=nt.getScanData,it=nt.startScanTimer,ct=nt.logScanEvent,st=nt.delAllLogDataEvent,lt=nt.getDetailData,pt=nt.onConfirmScanConfig,ft=function(){var t=s(i().mark((function t(e,r){var n,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,Z.value){t.next=6;break}if(z.value=r,"site"===r.type||(n=L(J()),a=n.selectedWebSite,z.value={name:a.value,type:r.type}),z.value.name){t.next=6;break}return t.abrupt("return",{data:[],total:0});case 6:return t.next=8,at();case 8:return t.next=10,ut();case 10:return t.next=12,ot(o(o({},e),{},{path:Z.value}));case 12:return t.abrupt("return",t.sent);case 15:return t.prev=15,t.t0=t.catch(0),t.abrupt("return",{data:[],total:0});case 19:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(e,r){return t.apply(this,arguments)}}(),ht=function(){var t=s(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p({title:"清空扫描日志【".concat(z.value.name,"】"),type:"input",input:{content:"清空日志"},icon:"warning-filled",content:"风险操作，清空该扫描日志后，将无法查到以往的扫描日志记录，此操作不可逆，是否继续清空？"});case 2:return t.next=4,st();case 4:rt.value=!0;case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),vt=function(){var t=s(i().mark((function t(){var e;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p({title:"日志扫描",icon:"warning-filled",content:"建议在服务器负载较低时进行安全分析，本次将对【".concat(z.value.name,".log】文件进行扫描，可能等待时间较长，是否继续？")});case 2:return t.next=4,ct();case 4:if((e=t.sent).status){t.next=7;break}return t.abrupt("return",W.error(e.msg));case 7:it();case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),gt=O([{label:"访问次数",prop:"num",width:80},{label:"访问路径",prop:"path",showOverflowTooltip:!0}]),yt=function(){var t=s(i().mark((function t(e,r){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:tt.value=e,tt.value.type=r,["sql","san","xss","php"].includes(r)||(gt.value[1].label="url"===r?"访问URL":"访问ip"),f({title:"日志详情",area:72,compData:{row:e,type:r},component:function(){return h((function(){return n.import("./log-detail-legacy.js?v=1734676359")}),void 0,n.meta.url)}});case 5:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),mt=j([{label:"攻击ip",prop:"ip"},{label:"攻击时间",prop:"time"},{label:"user-agent",prop:"ua",showOverflowTooltip:!0},{label:"请求URL",width:210,render:function(t){return"san"===tt.value.type?t.url:k("span",{class:"bg-[#f9f2f4] text-[#c7254e] break-words"},[t.url])}}]),dt=t("t",O()),bt=(t("r",function(){var t=s(i().mark((function t(e){var r,n,a,o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,lt();case 3:if(r=t.sent,n=r.data,a=r.status,r.msg,o=["sql","san","xss","php"],dt.value=o.includes(e)?mt.value:gt.value,a){t.next=11;break}return t.abrupt("return",{data:[],total:0,other:{}});case 11:return t.abrupt("return",{data:n,total:n.length,other:{}});case 14:return t.prev=14,t.t0=t.catch(0),t.abrupt("return",{data:[],total:0,other:{}});case 18:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e){return t.apply(this,arguments)}}()),t("s",function(){var t=s(i().mark((function t(e,r,n){var a,o,u,c,s,l;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r();case 3:return a=et.value,o=a.give,u=a.cycle,c=a.status,s={status:c?1:0,cycle:u,channel:o,path:Z.value},t.next=7,pt(s);case 7:return l=t.sent,rt.value=!0,t.abrupt("return",l.status);case 12:t.prev=12,t.t0=t.catch(0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e,r,n){return t.apply(this,arguments)}}()),function(){if(""===Z.value)return W.error("配置文件丢失");f({title:"定期扫描",area:48,showFooter:!0,component:function(){return h((function(){return n.import("./scan-form-legacy.js?v=1734676359")}),void 0,n.meta.url)}})}),wt={class:"p-2rem"},xt={class:"py-[12px] px-[16px]"},Lt={class:"flex justify-between mb-[4px]"},Ot={class:"download-speed-top-score"},St=P({__name:"index",props:{type:{default:"logs"},name:{default:""}},setup:function(t,n){var a=n.expose,u=t,i=l().mainHeight,c=Q(),s=L(c),p=s.isRefreshList,f=s.scanData,h=s.processPopup,v=s.percentum,d=g({request:function(t){var r=t.limit,n=function(t,e){if(null==t)return{};var r,n,a=function(t,e){if(null==t)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)r=o[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}(t,e);return ft(o(o({},n),{},{row:r}),u)},columns:[{label:"扫描时间",prop:"start_time",showOverflowTooltip:!0},{label:"耗时",prop:"time",render:function(t){var e;return(null===(e=t.time)||void 0===e?void 0:e.substring(0,4))+"秒"}}].concat(r(K.map((function(t){return{label:t[1],prop:t[0],width:"ip"!==t[0]&&"php"!==t[0]&&"url"!==t[0]?50:"auto",render:function(e){return e[t[0]]?k("span",{class:"bt-link ".concat("ip"===t[0]||"url"===t[0]?"":"!text-danger"),onClick:function(){return yt(e,t[0])}},[e[t[0]]]):k("span",null,[e[t[0]]])}}}))),[{label:"合计",render:function(t){var e=0;for(var r in t)"start_time"!=r&&"time"!=r&&"ip"!=r&&"url"!=r&&"is_status"!=r&&t[r]>0&&(e+=t[r]);return k("span",null,[e])}}]),extension:[y(p)]}),x=d.BtTable,O=d.BtPage;return a({init:d.refresh}),function(t,e){var r=F,n=w,a=b,o=m;return E(),_("div",null,[k(n,null,{"header-left":D((function(){return[k(r,{onClick:T(vt),type:"primary"},{default:D((function(){return e[1]||(e[1]=[A("日志扫描")])})),_:1},8,["onClick"]),k(r,{type:"default",class:C({"not-status":!Boolean(T(f).status)}),onClick:T(bt)},{default:D((function(){return[e[2]||(e[2]=A(" 定期扫描 ")),q("i",{class:C("text-[1.2rem] svgtofont-icon-".concat(T(f).status?"start text-[#20a53a]":"stop text-danger"," "))},null,2)]})),_:1},8,["class","onClick"]),k(r,{onClick:T(ht)},{default:D((function(){return e[3]||(e[3]=[A("清空扫描日志")])})),_:1},8,["onClick"])]})),content:D((function(){return[k(T(x),{"max-height":T(i)-426},null,8,["max-height"])]})),"footer-right":D((function(){return[k(T(O))]})),_:1}),e[5]||(e[5]=q("ul",{class:"mt-8px leading-8 text-[1.2rem] list-disc ml-20px"},[q("li",null,[A(" 日志安全分析：扫描网站(.log)日志中含有攻击类型的请求(类型包含： "),q("span",{class:"text-danger"},"xss,sql,san,php"),A(" ) ")]),q("li",null,"分析的日志数据包含已拦截的请求"),q("li",null,"如日志文件过大，扫描可能等待时间较长，请耐心等待")],-1)),k(o,{modelValue:T(h),"onUpdate:modelValue":e[0]||(e[0]=function(t){return I(h)?h.value=t:null}),area:40},{default:D((function(){return[q("div",wt,[q("div",xt,[q("div",Lt,[e[4]||(e[4]=q("div",{class:"download-speed-top-title"},"正在扫描中，扫描进度...",-1)),q("div",Ot,N(T(v))+"%",1)]),k(a,{strokeWidth:5,percentage:T(v),showText:!1},null,8,["percentage"])])])]})),_:1},8,["modelValue"])])}}});t("A",d(St,[["__scopeId","data-v-3277a99b"]]))}}}))}();
