import{_ as a}from"./index90.js?v=1734676359";import{o as s,G as e,dk as t,k as l,h as o}from"./utils-lib.js?v=1734676359";import{_ as i}from"./index99.js?v=1734676359";import{c as r,r as n,az as p,ax as u,o as c,B as d,k as m,l as f,e as h,x as v,y as b,C as j,p as x,M as _,q as w,v as y,I as g,aX as k,A as C}from"./base-lib.js?v=1734676359";import{u as q}from"./column.js?v=1734676359";import{uploadCertToCloud as D,removeCloudCert as S}from"./site.js?v=1734676359";import{u as V}from"./useStore7.js?v=1734676359";import{c as A}from"./useController7.js?v=1734676359";import"./__commonjsHelpers__.js?v=1734676359";import"./index91.js?v=1734676359";import"./useStore11.js?v=1734676359";import"./useController3.js?v=1734676359";import"./validator.js?v=1734676359";import"./useStore9.js?v=1734676359";import"./useMethod5.js?v=1734676359";import"./useStore10.js?v=1734676359";const H={class:"p-[20px]"},I={class:"relative h-full"},M={class:"p-[20px]"},z={class:"flex flex-col p-[12px] bg-[#f5faf2]"},B={class:"mb-[4px]"},G={class:"mb-[4px]"},L={class:"mb-[4px]"},O={class:"overflow-auto h-[12rem] border border-[#efefef] p-[12px]"},R={class:"absolute bottom-0 w-full bg-[#f6f8f8] flex items-center justify-end p-[12px]"},T=r({__name:"index",props:{compData:{default:()=>({})}},setup(r){var T,U;const{siteInfo:X}=V(),E=r,F=n(null==(U=null==(T=X.value)?void 0:T.project_type)?void 0:U.toLowerCase()),J=n(!1),K=n({}),N=n([{label:"域名",prop:"subject"},{label:"到期时间",prop:"not_after"},{label:"品牌",prop:"info.issuer",showOverflowTooltip:!0},{label:"位置",render:a=>p("span",[a.cloud_id>0?"云端":"本地"])},q([{width:70,onClick:async a=>{await s({title:"上传云端证书",content:"将会上传证书信息至云端进行替换，是否继续操作？",icon:"warning-filled",type:"calc"});(await e({loading:"正在上传证书...",request:D({ssl_hash:a.hash}),message:!0})).status&&await W()},isHide:a=>a.cloud_id>0,title:"上传云端"},{onClick:a=>{K.value=a,J.value=!0},title:"部署"},{width:70,onClick:async a=>{await s({title:"删除证书",content:"删除后该证书将不会显示在证书夹，是否继续操作？",icon:"warning-filled"});(await e({loading:"正在删除证书...",request:S({local:a.cloud_id>0?0:1,ssl_hash:a.hash}),message:!0})).status&&await W()},title:"删除"}])]),P=n([]),Q=n(!1),W=async()=>{await e({loading:Q,request:t(),data:[Array,P]})},Y=u("popupClose");return c((async()=>{await W()})),(s,e)=>{const t=C,r=i,n=l,p=o,u=a,c=d("bt-loading");return m(),f("div",H,[h(u,null,{"header-left":v((()=>[h(t,{type:"default",onClick:W},{default:v((()=>e[3]||(e[3]=[b("从云端同步")]))),_:1})])),"header-right":v((()=>[h(r,{onRefresh:W})])),content:v((()=>[j(h(n,{column:x(N),data:x(P),"max-height":500},null,8,["column","data"]),[[c,x(Q)],[c,"正在加载中，请稍后...","title"]])])),popup:v((()=>[h(p,{title:"部署当前证书",modelValue:x(J),"onUpdate:modelValue":e[2]||(e[2]=a=>_(J)?J.value=a:null),area:[52,36]},{default:v((()=>{var a;return[w("div",I,[w("div",M,[w("div",z,[w("span",B,"认证域名："+y(x(K).subject),1),w("span",G,"证书类型："+y(null==(a=x(K).info)?void 0:a.issuer),1),w("span",L,"到期时间："+y(x(K).not_after),1)]),e[4]||(e[4]=w("span",{class:"!mt-[24px] !mb-[4px] inline-block"},"如下是需要批量部署证书的站点：",-1)),w("div",O,[(m(!0),f(g,null,k(s.compData,((a,s)=>(m(),f("div",{key:s,class:"p-[4px] w-full"},y(a.name),1)))),128))])]),w("div",R,[h(t,{type:"warning",onClick:e[0]||(e[0]=a=>J.value=!1)},{default:v((()=>e[5]||(e[5]=[b("取消")]))),_:1}),h(t,{type:"primary",onClick:e[1]||(e[1]=a=>(async(a=F.value)=>{const{hash:s,subject:e}=K.value;await A({hash:s,subject:e,list:E.compData,type:a}),J.value=!1,Y()})())},{default:v((()=>[b("部署("+y(s.compData.length)+"项目)",1)])),_:1})])])]})),_:1},8,["modelValue"])])),_:1})])}}});export{T as default};
